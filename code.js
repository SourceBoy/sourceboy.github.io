"use strict";const net=require("net"),util=require("util"),EventEmitter=require("events"),debug=util.debuglog("http"),{async_id_symbol}=require("internal/async_hooks").symbols;function Agent(e){if(!(this instanceof Agent))return new Agent(e);EventEmitter.call(this),this.defaultPort=80,this.protocol="http:",this.options=util._extend({},e),this.options.path=null,this.requests={},this.sockets={},this.freeSockets={},this.keepAliveMsecs=this.options.keepAliveMsecs||1e3,this.keepAlive=this.options.keepAlive||!1,this.maxSockets=this.options.maxSockets||Agent.defaultMaxSockets,this.maxFreeSockets=this.options.maxFreeSockets||256,this.on("free",(e,t)=>{var s=this.getName(t);if(debug("agent.on(free)",s),e.writable&&this.requests[s]&&this.requests[s].length){setRequestSocket(this,this.requests[s].shift(),e),0===this.requests[s].length&&delete this.requests[s]}else{var o=e._httpMessage;if(o&&o.shouldKeepAlive&&e.writable&&this.keepAlive){var i=this.freeSockets[s],n=i?i.length:0,r=n;this.sockets[s]&&(r+=this.sockets[s].length),r>this.maxSockets||n>=this.maxFreeSockets?e.destroy():this.keepSocketAlive(e)?(i=i||[],this.freeSockets[s]=i,e[async_id_symbol]=-1,e._httpMessage=null,this.removeSocket(e,t),i.push(e)):e.destroy()}else e.destroy()}})}function calculateServerName(e,t){let s=e.host;const o=t.getHeader("host");if(o)if(o.startsWith("[")){const e=o.indexOf("]");s=-1===e?o:o.substr(1,e-1)}else s=o.split(":",1)[0];return s}function installListeners(e,t,s){function o(){debug("CLIENT socket onFree"),e.emit("free",t,s)}function i(o){debug("CLIENT socket onClose"),e.removeSocket(t,s)}t.on("free",o),t.on("close",i),t.on("agentRemove",function n(){debug("CLIENT socket onRemove"),e.removeSocket(t,s),t.removeListener("close",i),t.removeListener("free",o),t.removeListener("agentRemove",n)})}function handleSocketCreation(e,t,s){return function(o,i){o?process.nextTick(emitErrorNT,t,o):s?setRequestSocket(e,t,i):i.emit("free")}}function setRequestSocket(e,t,s){t.onSocket(s);const o=e.options.timeout||0;void 0!==t.timeout&&t.timeout!==o&&(s.setTimeout(t.timeout),t.once("response",e=>{e.once("end",()=>{s.timeout!==o&&s.setTimeout(o)})}))}function emitErrorNT(e,t){e.emit("error",t)}util.inherits(Agent,EventEmitter),Agent.defaultMaxSockets=1/0,Agent.prototype.createConnection=net.createConnection,Agent.prototype.getName=function(e){var t=e.host||"localhost";return t+=":",e.port&&(t+=e.port),t+=":",e.localAddress&&(t+=e.localAddress),4!==e.family&&6!==e.family||(t+=`:${e.family}`),e.socketPath&&(t+=`:${e.socketPath}`),t},Agent.prototype.addRequest=function(e,t,s,o){"string"==typeof t&&(t={host:t,port:s,localAddress:o}),t=util._extend({},t),util._extend(t,this.options),t.socketPath&&(t.path=t.socketPath),t.servername||(t.servername=calculateServerName(t,e));var i=this.getName(t);this.sockets[i]||(this.sockets[i]=[]);var n=this.freeSockets[i]?this.freeSockets[i].length:0,r=n+this.sockets[i].length;if(n){var c=this.freeSockets[i].shift();c._handle&&"function"==typeof c._handle.asyncReset&&(c._handle.asyncReset(),c[async_id_symbol]=c._handle.getAsyncId()),this.freeSockets[i].length||delete this.freeSockets[i],this.reuseSocket(c,e),setRequestSocket(this,e,c),this.sockets[i].push(c)}else r<this.maxSockets?(debug("call onSocket",r,n),this.createSocket(e,t,handleSocketCreation(this,e,!0))):(debug("wait for socket"),this.requests[i]||(this.requests[i]=[]),this.requests[i].push(e))},Agent.prototype.createSocket=function(e,t,s){t=util._extend({},t),util._extend(t,this.options),t.socketPath&&(t.path=t.socketPath),t.servername||(t.servername=calculateServerName(t,e));var o=this.getName(t);t._agentKey=o,debug("createConnection",o,t),t.encoding=null;var i=!1;const n=(e,n)=>{if(!i){if(i=!0,e)return s(e);this.sockets[o]||(this.sockets[o]=[]),this.sockets[o].push(n),debug("sockets",o,this.sockets[o].length),installListeners(this,n,t),s(null,n)}},r=this.createConnection(t,n);r&&n(null,r)},Agent.prototype.removeSocket=function(e,t){var s=this.getName(t);debug("removeSocket",s,"writable:",e.writable);var o=[this.sockets];e.writable||o.push(this.freeSockets);for(var i=0;i<o.length;i++){var n=o[i];if(n[s]){var r=n[s].indexOf(e);-1!==r&&(n[s].splice(r,1),0===n[s].length&&delete n[s])}}if(this.requests[s]&&this.requests[s].length){debug("removeSocket, have a request, make a socket");const e=this.requests[s][0],o=handleSocketCreation(this,e,!1);this.createSocket(e,t,o)}},Agent.prototype.keepSocketAlive=function(e){return e.setKeepAlive(!0,this.keepAliveMsecs),e.unref(),!0},Agent.prototype.reuseSocket=function(e,t){debug("have free socket"),e.ref()},Agent.prototype.destroy=function(){for(var e=[this.freeSockets,this.sockets],t=0;t<e.length;t++)for(var s=e[t],o=Object.keys(s),i=0;i<o.length;i++)for(var n=s[o[i]],r=0;r<n.length;r++)n[r].destroy()},module.exports={Agent,globalAgent:new Agent};"use strict";const util=require("util"),net=require("net"),url=require("url"),{HTTPParser}=internalBinding("http_parser"),assert=require("assert").ok,{_checkIsHttpToken:checkIsHttpToken,debug,freeParser,httpSocketSetup,parsers}=require("_http_common"),{OutgoingMessage}=require("_http_outgoing"),Agent=require("_http_agent"),{Buffer}=require("buffer"),{defaultTriggerAsyncIdScope}=require("internal/async_hooks"),{urlToOptions,searchParamsSymbol}=require("internal/url"),{outHeadersKey,ondrain}=require("internal/http"),{ERR_HTTP_HEADERS_SENT,ERR_INVALID_ARG_TYPE,ERR_INVALID_DOMAIN_NAME,ERR_INVALID_HTTP_TOKEN,ERR_INVALID_PROTOCOL,ERR_UNESCAPED_CHARACTERS}=require("internal/errors").codes,{validateTimerDuration}=require("internal/timers"),is_reused_symbol=require("internal/freelist").symbols.is_reused_symbol,INVALID_PATH_REGEX=/[^\u0021-\u00ff]/;function validateHost(e,t){if(null!=e&&"string"!=typeof e)throw new ERR_INVALID_ARG_TYPE(`options.${t}`,["string","undefined","null"],e);return e}function ClientRequest(e,t,s){if(OutgoingMessage.call(this),"string"==typeof e){if(!(e=url.parse(e)).hostname)throw new ERR_INVALID_DOMAIN_NAME}else e&&e[searchParamsSymbol]&&e[searchParamsSymbol][searchParamsSymbol]?e=urlToOptions(e):(s=t,t=e,e=null);"function"==typeof t&&(s=t,t=null);var o=(t=util._extend(e||{},t||{})).agent,r=t._defaultAgent||Agent.globalAgent;if(!1===o)o=new r.constructor;else if(null==o)"function"!=typeof t.createConnection&&(o=r);else if("function"!=typeof o.addRequest)throw new ERR_INVALID_ARG_TYPE("options.agent",["Agent-like Object","undefined","false"],o);this.agent=o;var i,n=t.protocol||r.protocol,a=r.protocol;if(this.agent&&this.agent.protocol&&(a=this.agent.protocol),t.path&&(i=String(t.path),INVALID_PATH_REGEX.test(i)))throw new ERR_UNESCAPED_CHARACTERS("Request path");if(n!==a)throw new ERR_INVALID_PROTOCOL(n,a);var c=t.defaultPort||this.agent&&this.agent.defaultPort,h=t.port=t.port||c||80,u=t.host=validateHost(t.hostname,"hostname")||validateHost(t.host,"host")||"localhost",l=void 0===t.setHost||Boolean(t.setHost);this.socketPath=t.socketPath,this.timeout=t.timeout;var d=t.method,p="string"==typeof d;if(null!=d&&!p)throw new ERR_INVALID_ARG_TYPE("method","string",d);if(p&&d){if(!checkIsHttpToken(d))throw new ERR_INVALID_HTTP_TOKEN("Method",d);d=this.method=d.toUpperCase()}else d=this.method="GET";this.path=t.path||"/",s&&this.once("response",s),this.useChunkedEncodingByDefault="GET"!==d&&"HEAD"!==d&&"DELETE"!==d&&"OPTIONS"!==d&&"CONNECT"!==d,this._ended=!1,this.res=null,this.aborted=void 0,this.timeoutCb=null,this.upgradeOrConnect=!1,this.parser=null,this.maxHeadersCount=null;var f=!1;if(this.agent&&(this.agent.keepAlive||Number.isFinite(this.agent.maxSockets)?(this._last=!1,this.shouldKeepAlive=!0):(this._last=!0,this.shouldKeepAlive=!1)),Array.isArray(t.headers))this._storeHeader(this.method+" "+this.path+" HTTP/1.1\r\n",t.headers);else{if(t.headers)for(var _=Object.keys(t.headers),m=0;m<_.length;m++){var E=_[m];this.setHeader(E,t.headers[E])}if(u&&!this.getHeader("host")&&l){var T=u,g=T.indexOf(":");-1!==g&&-1!==T.indexOf(":",g+1)&&91!==T.charCodeAt(0)&&(T=`[${T}]`),h&&+h!==c&&(T+=":"+h),this.setHeader("Host",T)}if(t.auth&&!this.getHeader("Authorization")&&this.setHeader("Authorization","Basic "+Buffer.from(t.auth).toString("base64")),this.getHeader("expect")){if(this._header)throw new ERR_HTTP_HEADERS_SENT("render");this._storeHeader(this.method+" "+this.path+" HTTP/1.1\r\n",this[outHeadersKey])}}if(this.agent)this.agent.addRequest(this,t);else if(this._last=!0,this.shouldKeepAlive=!1,"function"==typeof t.createConnection){const e=t.createConnection(t,(e,t)=>{f||(f=!0,e?process.nextTick(()=>this.emit("error",e)):(this.onSocket(t),this._deferToConnect(null,null,()=>this._flush())))});if(!e||f)return;f=!0,this.onSocket(e)}else debug("CLIENT use net.createConnection",t),this.onSocket(net.createConnection(t));this._deferToConnect(null,null,()=>this._flush())}function emitAbortNT(){this.emit("abort")}function createHangUpError(){var e=new Error("socket hang up");return e.code="ECONNRESET",e}function socketCloseListener(){var e=this._httpMessage;debug("HTTP socket close"),this.read();const t=this.parser,s=e.res;s?(s.complete||(s.aborted=!0,s.emit("aborted")),e.emit("close"),s.readable?(s.on("end",function(){this.emit("close")}),s.push(null)):s.emit("close")):(e.socket._hadError||(e.socket._hadError=!0,e.emit("error",createHangUpError())),e.emit("close")),e.output&&(e.output.length=0),e.outputEncodings&&(e.outputEncodings.length=0),t&&(t.finish(),freeParser(t,e,this))}function socketErrorListener(e){var t=this._httpMessage;debug("SOCKET ERROR:",e.message,e.stack),t&&(t.socket._hadError=!0,t.emit("error",e)),this.read();var s=this.parser;s&&(s.finish(),freeParser(s,t,this)),this.removeListener("data",socketOnData),this.removeListener("end",socketOnEnd),this.destroy()}function freeSocketErrorListener(e){debug("SOCKET ERROR on FREE socket:",e.message,e.stack),this.destroy(),this.emit("agentRemove")}function socketOnEnd(){var e=this._httpMessage,t=this.parser;e.res||e.socket._hadError||(e.socket._hadError=!0,e.emit("error",createHangUpError())),t&&(t.finish(),freeParser(t,e,this)),this.destroy()}function socketOnData(e){var t=this._httpMessage,s=this.parser;assert(s&&s.socket===this);var o=s.execute(e);if(o instanceof Error)debug("parse error",o),freeParser(s,t,this),this.destroy(),t.socket._hadError=!0,t.emit("error",o);else if(s.incoming&&s.incoming.upgrade){var r=o,i=s.incoming;t.res=i,this.removeListener("data",socketOnData),this.removeListener("end",socketOnEnd),this.removeListener("drain",ondrain),s.finish(),freeParser(s,t,this);var n=e.slice(r,e.length),a="CONNECT"===t.method?"connect":"upgrade";t.listenerCount(a)>0?(t.upgradeOrConnect=!0,this.emit("agentRemove"),this.removeListener("close",socketCloseListener),this.removeListener("error",socketErrorListener),this._httpMessage=null,this.readableFlowing=null,t.emit(a,i,this,n),t.emit("close")):this.destroy()}else s.incoming&&s.incoming.complete&&!statusIsInformational(s.incoming.statusCode)&&(this.removeListener("data",socketOnData),this.removeListener("end",socketOnEnd),freeParser(s,t,this))}function statusIsInformational(e){return e<200&&e>=100&&101!==e}function parserOnIncomingClient(e,t){var s=this.socket,o=s._httpMessage;if(debug("AGENT incoming response!"),o.res)return s.destroy(),0;if(o.res=e,e.upgrade)return 2;const r=o.method;return"CONNECT"===r?(e.upgrade=!0,2):statusIsInformational(e.statusCode)?(o.res=null,100===e.statusCode&&o.emit("continue"),o.emit("information",{statusCode:e.statusCode}),1):(!o.shouldKeepAlive||t||o.upgradeOrConnect||(o.shouldKeepAlive=!1),DTRACE_HTTP_CLIENT_RESPONSE(s,o),COUNTER_HTTP_CLIENT_RESPONSE(),o.res=e,e.req=o,e.on("end",responseOnEnd),o.on("prefinish",requestOnPrefinish),o.emit("response",e)||e._dump(),"HEAD"===r?1:0)}function responseKeepAlive(e,t){var s=t.socket;if(t.shouldKeepAlive){debug("AGENT socket keep-alive"),t.timeoutCb&&(s.setTimeout(0,t.timeoutCb),t.timeoutCb=null),s.removeListener("close",socketCloseListener),s.removeListener("error",socketErrorListener),s.once("error",freeSocketErrorListener);const e=s._handle?s._handle.getAsyncId():void 0;defaultTriggerAsyncIdScope(e,process.nextTick,emitFreeNT,s)}else s.writable&&(debug("AGENT socket.destroySoon()"),"function"==typeof s.destroySoon?s.destroySoon():s.end()),assert(!s.writable)}function responseOnEnd(){const e=this.req;e._ended=!0,e.shouldKeepAlive&&!e.finished||responseKeepAlive(this,e)}function requestOnPrefinish(){const e=this.res;this.shouldKeepAlive&&this._ended&&responseKeepAlive(e,this)}function emitFreeNT(e){e.emit("free")}function tickOnSocket(e,t){var s=parsers.alloc();e.socket=t,e.connection=t,s.reinitialize(HTTPParser.RESPONSE,s[is_reused_symbol]),s.socket=t,s.outgoing=e,e.parser=s,t.parser=s,t._httpMessage=e,httpSocketSetup(t),"number"==typeof e.maxHeadersCount&&(s.maxHeaderPairs=e.maxHeadersCount<<1),s.onIncoming=parserOnIncomingClient,t.removeListener("error",freeSocketErrorListener),t.on("error",socketErrorListener),t.on("data",socketOnData),t.on("end",socketOnEnd),t.on("close",socketCloseListener),void 0!==e.timeout&&listenSocketTimeout(e),e.emit("socket",t)}function listenSocketTimeout(e){if(e.timeoutCb)return;const t=()=>e.emit("timeout");e.timeoutCb=t,e.socket?e.socket.once("timeout",t):e.on("socket",e=>{e.once("timeout",t)}),e.once("response",s=>{s.once("end",()=>{e.socket.removeListener("timeout",t)})})}function onSocketNT(e,t){e.aborted?e.agent?t.emit("free"):t.destroy():tickOnSocket(e,t)}function _deferToConnect(e,t,s){const o=()=>{e&&this.socket[e].apply(this.socket,t),"function"==typeof s&&s()},r=()=>{this.socket.writable?o():this.socket.once("connect",o)};this.socket?r():this.once("socket",r)}function setSocketTimeout(e,t){e.connecting?e.once("connect",function(){e.setTimeout(t)}):e.setTimeout(t)}util.inherits(ClientRequest,OutgoingMessage),ClientRequest.prototype._finish=function(){DTRACE_HTTP_CLIENT_REQUEST(this,this.connection),COUNTER_HTTP_CLIENT_REQUEST(),OutgoingMessage.prototype._finish.call(this)},ClientRequest.prototype._implicitHeader=function(){if(this._header)throw new ERR_HTTP_HEADERS_SENT("render");this._storeHeader(this.method+" "+this.path+" HTTP/1.1\r\n",this[outHeadersKey])},ClientRequest.prototype.abort=function(){this.aborted||process.nextTick(emitAbortNT.bind(this)),this.aborted=Date.now(),this.res?this.res._dump():this.once("response",function(e){e._dump()}),this.socket&&this.socket.destroy()},ClientRequest.prototype.onSocket=function(e){process.nextTick(onSocketNT,this,e)},ClientRequest.prototype._deferToConnect=_deferToConnect,ClientRequest.prototype.setTimeout=function(e,t){return listenSocketTimeout(this),e=validateTimerDuration(e),t&&this.once("timeout",t),this.socket?setSocketTimeout(this.socket,e):this.once("socket",t=>setSocketTimeout(t,e)),this},ClientRequest.prototype.setNoDelay=function(e){this._deferToConnect("setNoDelay",[e])},ClientRequest.prototype.setSocketKeepAlive=function(e,t){this._deferToConnect("setKeepAlive",[e,t])},ClientRequest.prototype.clearTimeout=function(e){this.setTimeout(0,e)},module.exports={ClientRequest};"use strict";const{methods,HTTPParser}=internalBinding("http_parser"),{FreeList}=require("internal/freelist"),{ondrain}=require("internal/http"),incoming=require("_http_incoming"),{IncomingMessage,readStart,readStop}=incoming,debug=require("util").debuglog("http"),kIncomingMessage=Symbol("IncomingMessage"),kOnHeaders=0|HTTPParser.kOnHeaders,kOnHeadersComplete=0|HTTPParser.kOnHeadersComplete,kOnBody=0|HTTPParser.kOnBody,kOnMessageComplete=0|HTTPParser.kOnMessageComplete,kOnExecute=0|HTTPParser.kOnExecute,MAX_HEADER_PAIRS=2e3;function parserOnHeaders(e,r){(this.maxHeaderPairs<=0||this._headers.length<this.maxHeaderPairs)&&(this._headers=this._headers.concat(e)),this._url+=r}function parserOnHeadersComplete(e,r,n,s,t,a,o,i,c){const d=this,{socket:u}=d;void 0===n&&(n=d._headers,d._headers=[]),void 0===t&&(t=d._url,d._url="");const l=u&&u.server&&u.server[kIncomingMessage]||IncomingMessage,h=d.incoming=new l(u);h.httpVersionMajor=e,h.httpVersionMinor=r,h.httpVersion=`${e}.${r}`,h.url=t,h.upgrade=i;var p=n.length;return d.maxHeaderPairs>0&&(p=Math.min(p,d.maxHeaderPairs)),h._addHeaderLines(n,p),"number"==typeof s?h.method=methods[s]:(h.statusCode=a,h.statusMessage=o),d.onIncoming(h,c)}function parserOnBody(e,r,n){const s=this.incoming;if(null!==s&&n>0&&!s._dumped){var t=e.slice(r,r+n);s.push(t)||readStop(this.socket)}}function parserOnMessageComplete(){const e=this,r=e.incoming;if(null!==r){r.complete=!0;const n=e._headers;n.length&&(r._addHeaderLines(n,n.length),e._headers=[],e._url=""),r.push(null)}readStart(e.socket)}const parsers=new FreeList("parsers",1e3,function(){const e=new HTTPParser(HTTPParser.REQUEST);return cleanParser(e),e.onIncoming=null,e[kOnHeaders]=parserOnHeaders,e[kOnHeadersComplete]=parserOnHeadersComplete,e[kOnBody]=parserOnBody,e[kOnMessageComplete]=parserOnMessageComplete,e});function closeParserInstance(e){e.close()}function freeParser(e,r,n){e&&(e._consumed&&e.unconsume(),cleanParser(e),!1===parsers.free(e)?setImmediate(closeParserInstance,e):e.free()),r&&(r.parser=null),n&&(n.parser=null)}function httpSocketSetup(e){e.removeListener("drain",ondrain),e.on("drain",ondrain)}const tokenRegExp=/^[\^_`a-zA-Z\-0-9!#$%&'*+.|~]+$/;function checkIsHttpToken(e){return tokenRegExp.test(e)}const headerCharRegex=/[^\t\x20-\x7e\x80-\xff]/;function checkInvalidHeaderChar(e){return headerCharRegex.test(e)}function cleanParser(e){e._headers=[],e._url="",e.socket=null,e.incoming=null,e.outgoing=null,e.maxHeaderPairs=MAX_HEADER_PAIRS,e[kOnExecute]=null,e._consumed=!1}module.exports={_checkInvalidHeaderChar:checkInvalidHeaderChar,_checkIsHttpToken:checkIsHttpToken,chunkExpression:/(?:^|\W)chunked(?:$|\W)/i,continueExpression:/(?:^|\W)100-continue(?:$|\W)/i,CRLF:"\r\n",debug,freeParser,httpSocketSetup,methods,parsers,kIncomingMessage};"use strict";const util=require("util"),Stream=require("stream");function readStart(e){e&&!e._paused&&e.readable&&e.resume()}function readStop(e){e&&e.pause()}function IncomingMessage(e){Stream.Readable.call(this),this._readableState.readingMore=!0,this.socket=e,this.connection=e,this.httpVersionMajor=null,this.httpVersionMinor=null,this.httpVersion=null,this.complete=!1,this.headers={},this.rawHeaders=[],this.trailers={},this.rawTrailers=[],this.readable=!0,this.aborted=!1,this.upgrade=null,this.url="",this.method=null,this.statusCode=null,this.statusMessage=null,this.client=e,this._consuming=!1,this._dumped=!1}function _addHeaderLines(e,t){if(e&&e.length){var r;this.complete?(this.rawTrailers=e,r=this.trailers):(this.rawHeaders=e,r=this.headers);for(var a=0;a<t;a+=2)this._addHeaderLine(e[a],e[a+1],r)}}function matchKnownFields(e){for(var t=!1;;)switch(e){case"Content-Type":case"content-type":return"content-type";case"Content-Length":case"content-length":return"content-length";case"User-Agent":case"user-agent":return"user-agent";case"Referer":case"referer":return"referer";case"Host":case"host":return"host";case"Authorization":case"authorization":return"authorization";case"Proxy-Authorization":case"proxy-authorization":return"proxy-authorization";case"If-Modified-Since":case"if-modified-since":return"if-modified-since";case"If-Unmodified-Since":case"if-unmodified-since":return"if-unmodified-since";case"From":case"from":return"from";case"Location":case"location":return"location";case"Max-Forwards":case"max-forwards":return"max-forwards";case"Retry-After":case"retry-after":return"retry-after";case"ETag":case"etag":return"etag";case"Last-Modified":case"last-modified":return"last-modified";case"Server":case"server":return"server";case"Age":case"age":return"age";case"Expires":case"expires":return"expires";case"Set-Cookie":case"set-cookie":return"";case"Cookie":case"cookie":return"cookie";case"Transfer-Encoding":case"transfer-encoding":return"\0transfer-encoding";case"Date":case"date":return"\0date";case"Connection":case"connection":return"\0connection";case"Cache-Control":case"cache-control":return"\0cache-control";case"Vary":case"vary":return"\0vary";case"Content-Encoding":case"content-encoding":return"\0content-encoding";case"Origin":case"origin":return"\0origin";case"Upgrade":case"upgrade":return"\0upgrade";case"Expect":case"expect":return"\0expect";case"If-Match":case"if-match":return"\0if-match";case"If-None-Match":case"if-none-match":return"\0if-none-match";case"Accept":case"accept":return"\0accept";case"Accept-Encoding":case"accept-encoding":return"\0accept-encoding";case"Accept-Language":case"accept-language":return"\0accept-language";case"X-Forwarded-For":case"x-forwarded-for":return"\0x-forwarded-for";case"X-Forwarded-Host":case"x-forwarded-host":return"\0x-forwarded-host";case"X-Forwarded-Proto":case"x-forwarded-proto":return"\0x-forwarded-proto";default:if(t)return"\0"+e;e=e.toLowerCase(),t=!0}}function _addHeaderLine(e,t,r){var a=(e=matchKnownFields(e)).charCodeAt(0);0===a||2===a?"string"==typeof r[e=e.slice(1)]?r[e]+=(0===a?", ":"; ")+t:r[e]=t:1===a?void 0!==r["set-cookie"]?r["set-cookie"].push(t):r["set-cookie"]=[t]:void 0===r[e]&&(r[e]=t)}util.inherits(IncomingMessage,Stream.Readable),IncomingMessage.prototype.setTimeout=function(e,t){return t&&this.on("timeout",t),this.socket.setTimeout(e),this},IncomingMessage.prototype._read=function(e){this._consuming||(this._readableState.readingMore=!1,this._consuming=!0),this.socket.readable&&readStart(this.socket)},IncomingMessage.prototype.destroy=function(e){this.socket&&this.socket.destroy(e)},IncomingMessage.prototype._addHeaderLines=_addHeaderLines,IncomingMessage.prototype._addHeaderLine=_addHeaderLine,IncomingMessage.prototype._dump=function(){this._dumped||(this._dumped=!0,this.removeAllListeners("data"),this.resume())},module.exports={IncomingMessage,readStart,readStop};"use strict";const assert=require("assert").ok,Stream=require("stream"),util=require("util"),internalUtil=require("internal/util"),{outHeadersKey,utcDate}=require("internal/http"),{Buffer}=require("buffer"),common=require("_http_common"),checkIsHttpToken=common._checkIsHttpToken,checkInvalidHeaderChar=common._checkInvalidHeaderChar,{defaultTriggerAsyncIdScope,symbols:{async_id_symbol}}=require("internal/async_hooks"),{ERR_HTTP_HEADERS_SENT,ERR_HTTP_INVALID_HEADER_VALUE,ERR_HTTP_TRAILER_INVALID,ERR_INVALID_HTTP_TOKEN,ERR_INVALID_ARG_TYPE,ERR_INVALID_CHAR,ERR_METHOD_NOT_IMPLEMENTED,ERR_STREAM_CANNOT_PIPE,ERR_STREAM_WRITE_AFTER_END}=require("internal/errors").codes,{validateString}=require("internal/validators"),{CRLF,debug}=common,kIsCorked=Symbol("isCorked"),hasOwnProperty=Function.call.bind(Object.prototype.hasOwnProperty);var RE_CONN_CLOSE=/(?:^|\W)close(?:$|\W)/i,RE_TE_CHUNKED=common.chunkExpression;function isCookieField(e){return 6===e.length&&"cookie"===e.toLowerCase()}function noopPendingOutput(e){}function OutgoingMessage(){Stream.call(this),this.output=[],this.outputEncodings=[],this.outputCallbacks=[],this.outputSize=0,this.writable=!0,this._last=!1,this.chunkedEncoding=!1,this.shouldKeepAlive=!0,this.useChunkedEncodingByDefault=!0,this.sendDate=!1,this._removedConnection=!1,this._removedContLen=!1,this._removedTE=!1,this._contentLength=null,this._hasBody=!0,this._trailer="",this.finished=!1,this._headerSent=!1,this[kIsCorked]=!1,this.socket=null,this.connection=null,this._header=null,this[outHeadersKey]=null,this._onPendingData=noopPendingOutput}function _writeRaw(e,t,n){const i=this.connection;if(i&&i.destroyed)return!1;if("function"==typeof t&&(n=t,t=null),i&&i._httpMessage===this&&i.writable&&!i.destroyed){if(this.output.length)this._flushOutput(i);else if(!e.length)return"function"==typeof n&&defaultTriggerAsyncIdScope(i[async_id_symbol],process.nextTick,n),!0;return i.write(e,t,n)}return this.output.push(e),this.outputEncodings.push(t),this.outputCallbacks.push(n),this.outputSize+=e.length,this._onPendingData(e.length),!1}function _storeHeader(e,t){const n={connection:!1,contLen:!1,te:!1,date:!1,expect:!1,trailer:!1,header:e};var i;if(t===this[outHeadersKey])for(i in t){const e=t[i];processHeader(this,n,e[0],e[1],!1)}else if(Array.isArray(t))for(var s=0;s<t.length;s++){const e=t[s];processHeader(this,n,e[0],e[1],!0)}else if(t)for(i in t)hasOwnProperty(t,i)&&processHeader(this,n,i,t[i],!0);let{header:o}=n;if(this.sendDate&&!n.date&&(o+="Date: "+utcDate()+CRLF),!this.chunkedEncoding||204!==this.statusCode&&304!==this.statusCode||(debug(this.statusCode+" response should not use chunked encoding, closing connection."),this.chunkedEncoding=!1,this.shouldKeepAlive=!1),this._removedConnection)this._last=!0,this.shouldKeepAlive=!1;else if(!n.connection){this.shouldKeepAlive&&(n.contLen||this.useChunkedEncodingByDefault||this.agent)?o+="Connection: keep-alive\r\n":(this._last=!0,o+="Connection: close\r\n")}if(n.contLen||n.te||(this._hasBody?this.useChunkedEncodingByDefault?n.trailer||this._removedContLen||"number"!=typeof this._contentLength?this._removedTE?debug("Both Content-Length and Transfer-Encoding are removed"):(o+="Transfer-Encoding: chunked\r\n",this.chunkedEncoding=!0):o+="Content-Length: "+this._contentLength+CRLF:this._last=!0:this.chunkedEncoding=!1),!0!==this.chunkedEncoding&&n.trailer)throw new ERR_HTTP_TRAILER_INVALID;this._header=o+CRLF,this._headerSent=!1,n.expect&&this._send("")}function processHeader(e,t,n,i,s){if(s&&validateHeaderName(n),Array.isArray(i)){if(i.length<2||!isCookieField(n)){for(var o=0;o<i.length;o++)storeHeader(e,t,n,i[o],s);return}i=i.join("; ")}storeHeader(e,t,n,i,s)}function storeHeader(e,t,n,i,s){s&&validateHeaderValue(n,i),t.header+=n+": "+escapeHeaderValue(i)+CRLF,matchHeader(e,t,n,i)}function matchHeader(e,t,n,i){if(!(n.length<4||n.length>17))switch(n=n.toLowerCase()){case"connection":t.connection=!0,e._removedConnection=!1,RE_CONN_CLOSE.test(i)?e._last=!0:e.shouldKeepAlive=!0;break;case"transfer-encoding":t.te=!0,e._removedTE=!1,RE_TE_CHUNKED.test(i)&&(e.chunkedEncoding=!0);break;case"content-length":t.contLen=!0,e._removedContLen=!1;break;case"date":case"expect":case"trailer":t[n]=!0}}function validateHeaderName(e){if("string"!=typeof e||!e||!checkIsHttpToken(e)){const t=new ERR_INVALID_HTTP_TOKEN("Header name",e);throw Error.captureStackTrace(t,validateHeaderName),t}}function validateHeaderValue(e,t){let n;if(void 0===t?n=new ERR_HTTP_INVALID_HEADER_VALUE(t,e):checkInvalidHeaderChar(t)&&(debug('Header "%s" contains invalid characters',e),n=new ERR_INVALID_CHAR("header content",e)),void 0!==n)throw Error.captureStackTrace(n,validateHeaderValue),n}util.inherits(OutgoingMessage,Stream),Object.defineProperty(OutgoingMessage.prototype,"_headers",{get:function(){return this.getHeaders()},set:function(e){if(null==e)this[outHeadersKey]=null;else if("object"==typeof e){const n=this[outHeadersKey]=Object.create(null),i=Object.keys(e);for(var t=0;t<i.length;++t){const s=i[t];n[s.toLowerCase()]=[s,e[s]]}}}}),Object.defineProperty(OutgoingMessage.prototype,"_headerNames",{get:function(){const e=this[outHeadersKey];if(null!==e){const n=Object.create(null),i=Object.keys(e);for(var t=0;t<i.length;++t){const s=i[t],o=e[s][0];n[s]=o}return n}return null},set:function(e){if("object"==typeof e&&null!==e){const n=this[outHeadersKey];if(!n)return;const i=Object.keys(e);for(var t=0;t<i.length;++t){const s=n[i[t]];s&&(s[0]=e[i[t]])}}}}),OutgoingMessage.prototype._renderHeaders=function(){if(this._header)throw new ERR_HTTP_HEADERS_SENT("render");var e=this[outHeadersKey];const t={};if(null!==e){const s=Object.keys(e);for(var n=0,i=s.length;n<i;n++){const i=s[n];t[e[i][0]]=e[i][1]}}return t},OutgoingMessage.prototype.setTimeout=function(e,t){return t&&this.on("timeout",t),this.socket?this.socket.setTimeout(e):this.once("socket",function(t){t.setTimeout(e)}),this},OutgoingMessage.prototype.destroy=function(e){this.socket?this.socket.destroy(e):this.once("socket",function(t){t.destroy(e)})},OutgoingMessage.prototype._send=function(e,t,n){if(!this._headerSent){if("string"!=typeof e||"utf8"!==t&&"latin1"!==t&&t){var i=this._header;0===this.output.length?(this.output=[i],this.outputEncodings=["latin1"],this.outputCallbacks=[null]):(this.output.unshift(i),this.outputEncodings.unshift("latin1"),this.outputCallbacks.unshift(null)),this.outputSize+=i.length,this._onPendingData(i.length)}else e=this._header+e;this._headerSent=!0}return this._writeRaw(e,t,n)},OutgoingMessage.prototype._writeRaw=_writeRaw,OutgoingMessage.prototype._storeHeader=_storeHeader,OutgoingMessage.prototype.setHeader=function(e,t){if(this._header)throw new ERR_HTTP_HEADERS_SENT("set");validateHeaderName(e),validateHeaderValue(e,t);let n=this[outHeadersKey];null===n&&(this[outHeadersKey]=n=Object.create(null)),n[e.toLowerCase()]=[e,t]},OutgoingMessage.prototype.getHeader=function(e){validateString(e,"name");const t=this[outHeadersKey];if(null===t)return;const n=t[e.toLowerCase()];return n&&n[1]},OutgoingMessage.prototype.getHeaderNames=function(){return null!==this[outHeadersKey]?Object.keys(this[outHeadersKey]):[]},OutgoingMessage.prototype.getHeaders=function(){const e=this[outHeadersKey],t=Object.create(null);if(e){const i=Object.keys(e);for(var n=0;n<i.length;++n){const s=i[n],o=e[s][1];t[s]=o}}return t},OutgoingMessage.prototype.hasHeader=function(e){return validateString(e,"name"),null!==this[outHeadersKey]&&!!this[outHeadersKey][e.toLowerCase()]},OutgoingMessage.prototype.removeHeader=function(e){if(validateString(e,"name"),this._header)throw new ERR_HTTP_HEADERS_SENT("remove");var t=e.toLowerCase();switch(t){case"connection":this._removedConnection=!0;break;case"content-length":this._removedContLen=!0;break;case"transfer-encoding":this._removedTE=!0;break;case"date":this.sendDate=!1}null!==this[outHeadersKey]&&delete this[outHeadersKey][t]},OutgoingMessage.prototype._implicitHeader=function(){this.emit("error",new ERR_METHOD_NOT_IMPLEMENTED("_implicitHeader()"))},Object.defineProperty(OutgoingMessage.prototype,"headersSent",{configurable:!0,enumerable:!0,get:function(){return!!this._header}});const crlf_buf=Buffer.from("\r\n");function write_(e,t,n,i,s){if(e.finished){const t=new ERR_STREAM_WRITE_AFTER_END,n=e.socket?e.socket[async_id_symbol]:void 0;return defaultTriggerAsyncIdScope(n,process.nextTick,writeAfterEndNT,e,t,i),!0}if(e._header||e._implicitHeader(),!e._hasBody)return debug("This type of response MUST NOT have a body. Ignoring write() calls."),!0;if(!(s||"string"==typeof t||t instanceof Buffer))throw new ERR_INVALID_ARG_TYPE("first argument",["string","Buffer"],t);return 0===t.length?(debug("received empty string or buffer and waiting for more input"),!0):(s||!e.connection||e[kIsCorked]||(e.connection.cork(),e[kIsCorked]=!0,process.nextTick(connectionCorkNT,e,e.connection)),e.chunkedEncoding?(o="string"==typeof t?Buffer.byteLength(t,n):t.length,e._send(o.toString(16),"latin1",null),e._send(crlf_buf,null,null),e._send(t,n,null),r=e._send(crlf_buf,null,i)):r=e._send(t,n,i),debug("write ret = "+r),r);var o,r}function writeAfterEndNT(e,t,n){e.emit("error",t),n&&n(t)}function connectionCorkNT(e,t){e[kIsCorked]=!1,t.uncork()}function escapeHeaderValue(e){return/[\r\n]/.test(e)?e.replace(/[\r\n]+[ \t]*/g,""):e}function onFinish(e){e.emit("finish")}OutgoingMessage.prototype.write=function(e,t,n){return write_(this,e,t,n,!1)},OutgoingMessage.prototype.addTrailers=function(e){this._trailer="";for(var t,n,i=Object.keys(e),s=Array.isArray(e),o=0,r=i.length;o<r;o++){var a=i[o];if(s?(t=e[a][0],n=e[a][1]):(t=a,n=e[a]),"string"!=typeof t||!t||!checkIsHttpToken(t))throw new ERR_INVALID_HTTP_TOKEN("Trailer name",t);if(checkInvalidHeaderChar(n))throw debug('Trailer "%s" contains invalid characters',t),new ERR_INVALID_CHAR("trailer content",t);this._trailer+=t+": "+escapeHeaderValue(n)+CRLF}},OutgoingMessage.prototype.end=function(e,t,n){if("function"==typeof e?(n=e,e=null):"function"==typeof t&&(n=t,t=null),this.finished)return this;var i;if(e){if("string"!=typeof e&&!(e instanceof Buffer))throw new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer"],e);this._header||(this._contentLength="string"==typeof e?Buffer.byteLength(e,t):e.length),this.connection&&(this.connection.cork(),i=!0),write_(this,e,t,null,!0)}else this._header||(this._contentLength=0,this._implicitHeader());"function"==typeof n&&this.once("finish",n);var s=onFinish.bind(void 0,this);return this._hasBody&&this.chunkedEncoding?this._send("0\r\n"+this._trailer+"\r\n","latin1",s):this._send("","latin1",s),i&&this.connection.uncork(),this.finished=!0,debug("outgoing message end."),0===this.output.length&&this.connection&&this.connection._httpMessage===this&&this._finish(),this},OutgoingMessage.prototype._finish=function(){assert(this.connection),this.emit("prefinish")},OutgoingMessage.prototype._flush=function(){var e,t=this.socket;t&&t.writable&&(e=this._flushOutput(t),this.finished?this._finish():e&&this.emit("drain"))},OutgoingMessage.prototype._flushOutput=function(e){var t,n=this.output.length;if(n<=0)return t;var i=this.output,s=this.outputEncodings,o=this.outputCallbacks;e.cork();for(var r=0;r<n;r++)t=e.write(i[r],s[r],o[r]);return e.uncork(),this.output=[],this.outputEncodings=[],this.outputCallbacks=[],this._onPendingData(-this.outputSize),this.outputSize=0,t},OutgoingMessage.prototype.flushHeaders=function(){this._header||this._implicitHeader(),this._send("")},OutgoingMessage.prototype.flush=internalUtil.deprecate(function(){this.flushHeaders()},"OutgoingMessage.flush is deprecated. Use flushHeaders instead.","DEP0001"),OutgoingMessage.prototype.pipe=function(){this.emit("error",new ERR_STREAM_CANNOT_PIPE)},module.exports={OutgoingMessage};"use strict";const util=require("util"),net=require("net"),{HTTPParser}=internalBinding("http_parser"),assert=require("assert").ok,{parsers,freeParser,debug,CRLF,continueExpression,chunkExpression,httpSocketSetup,kIncomingMessage,_checkInvalidHeaderChar:checkInvalidHeaderChar}=require("_http_common"),{OutgoingMessage}=require("_http_outgoing"),{outHeadersKey,ondrain,nowDate}=require("internal/http"),{defaultTriggerAsyncIdScope,getOrSetAsyncId}=require("internal/async_hooks"),is_reused_symbol=require("internal/freelist").symbols.is_reused_symbol,{IncomingMessage}=require("_http_incoming"),{ERR_HTTP_HEADERS_SENT,ERR_HTTP_INVALID_STATUS_CODE,ERR_INVALID_CHAR}=require("internal/errors").codes,Buffer=require("buffer").Buffer,kServerResponse=Symbol("ServerResponse"),STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a Teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},kOnExecute=0|HTTPParser.kOnExecute;function ServerResponse(e){OutgoingMessage.call(this),"HEAD"===e.method&&(this._hasBody=!1),this.sendDate=!0,this._sent100=!1,this._expect_continue=!1,(e.httpVersionMajor<1||e.httpVersionMinor<1)&&(this.useChunkedEncodingByDefault=chunkExpression.test(e.headers.te),this.shouldKeepAlive=!1)}function onServerResponseClose(){this._httpMessage&&this._httpMessage.emit("close")}function writeHead(e,t,n){var o,s=e;if((e|=0)<100||e>999)throw new ERR_HTTP_INVALID_STATUS_CODE(s);if("string"==typeof t?this.statusMessage=t:(this.statusMessage||(this.statusMessage=STATUS_CODES[e]||"unknown"),n=t),this.statusCode=e,this[outHeadersKey]){var r;if(n)for(var i=Object.keys(n),a=0;a<i.length;a++)(r=i[a])&&this.setHeader(r,n[r]);if(void 0===r&&this._header)throw new ERR_HTTP_HEADERS_SENT("render");o=this[outHeadersKey]}else o=n;if(checkInvalidHeaderChar(this.statusMessage))throw new ERR_INVALID_CHAR("statusMessage");var u=`HTTP/1.1 ${e} ${this.statusMessage}${CRLF}`;(204===e||304===e||e>=100&&e<=199)&&(this._hasBody=!1),this._expect_continue&&!this._sent100&&(this.shouldKeepAlive=!1),this._storeHeader(u,o)}function Server(e,t){if(!(this instanceof Server))return new Server(e,t);"function"==typeof e?(t=e,e={}):null!=e&&"object"!=typeof e||(e=util._extend({},e)),this[kIncomingMessage]=e.IncomingMessage||IncomingMessage,this[kServerResponse]=e.ServerResponse||ServerResponse,net.Server.call(this,{allowHalfOpen:!0}),t&&this.on("request",t),this.httpAllowHalfOpen=!1,this.on("connection",connectionListener),this.timeout=12e4,this.keepAliveTimeout=5e3,this._pendingResponseData=0,this.maxHeadersCount=null,this.headersTimeout=4e4}function connectionListener(e){defaultTriggerAsyncIdScope(getOrSetAsyncId(e),connectionListenerInternal,this,e)}function connectionListenerInternal(e,t){debug("SERVER new http connection"),httpSocketSetup(t),null===t.server&&(t.server=e),e.timeout&&"function"==typeof t.setTimeout&&t.setTimeout(e.timeout),t.on("timeout",socketOnTimeout);var n=parsers.alloc();n.reinitialize(HTTPParser.REQUEST,n[is_reused_symbol]),n.socket=t,n.parsingHeadersStart=nowDate(),t.parser=n,"number"==typeof e.maxHeadersCount&&(n.maxHeaderPairs=e.maxHeadersCount<<1);var o={onData:null,onEnd:null,onClose:null,onDrain:null,outgoing:[],incoming:[],outgoingData:0,keepAliveTimeoutSet:!1};if(o.onData=socketOnData.bind(void 0,e,t,n,o),o.onEnd=socketOnEnd.bind(void 0,e,t,n,o),o.onClose=socketOnClose.bind(void 0,t,o),o.onDrain=socketOnDrain.bind(void 0,t,o),t.on("data",o.onData),t.on("error",socketOnError),t.on("end",o.onEnd),t.on("close",o.onClose),t.on("drain",o.onDrain),n.onIncoming=parserOnIncoming.bind(void 0,e,t,o),t.on("resume",onSocketResume),t.on("pause",onSocketPause),t.on=socketOnWrap,t._handle){var s=t._handle._externalStream;!t._handle._consumed&&s&&(n._consumed=!0,t._handle._consumed=!0,n.consume(s))}n[kOnExecute]=onParserExecute.bind(void 0,e,t,n,o),t._paused=!1}function updateOutgoingData(e,t,n){if(t.outgoingData+=n,e._paused&&t.outgoingData<e.writableHighWaterMark)return socketOnDrain(e,t)}function socketOnDrain(e,t){var n=t.outgoingData>e.writableHighWaterMark;e._paused&&!n&&(e._paused=!1,e.parser&&e.parser.resume(),e.resume())}function socketOnTimeout(){var e=this.parser&&this.parser.incoming,t=e&&!e.complete&&e.emit("timeout",this),n=this._httpMessage,o=n&&n.emit("timeout",this),s=this.server.emit("timeout",this);t||o||s||this.destroy()}function socketOnClose(e,t){debug("server socket close"),e.parser&&freeParser(e.parser,null,e),abortIncoming(t.incoming)}function abortIncoming(e){for(;e.length;){var t=e.shift();t.aborted=!0,t.emit("aborted"),t.emit("close")}}function socketOnEnd(e,t,n,o){var s=n.finish();if(s instanceof Error)return debug("parse error"),void socketOnError.call(t,s);e.httpAllowHalfOpen?o.outgoing.length?o.outgoing[o.outgoing.length-1]._last=!0:t._httpMessage?t._httpMessage._last=!0:t.writable&&t.end():(abortIncoming(o.incoming),t.writable&&t.end())}function socketOnData(e,t,n,o,s){assert(!t._paused),debug("SERVER socketOnData %d",s.length);var r=n.execute(s);onParserExecuteCommon(e,t,n,o,r,s)}function onParserExecute(e,t,n,o,s){t._unrefTimer();const r=n.parsingHeadersStart;if(debug("SERVER socketOnParserExecute %d",s),0!==r&&nowDate()-r>e.headersTimeout){e.emit("timeout",t)||t.destroy()}else onParserExecuteCommon(e,t,n,o,s,void 0)}util.inherits(ServerResponse,OutgoingMessage),ServerResponse.prototype._finish=function(){DTRACE_HTTP_SERVER_RESPONSE(this.connection),COUNTER_HTTP_SERVER_RESPONSE(),OutgoingMessage.prototype._finish.call(this)},ServerResponse.prototype.statusCode=200,ServerResponse.prototype.statusMessage=void 0,ServerResponse.prototype.assignSocket=function(e){assert(!e._httpMessage),e._httpMessage=this,e.on("close",onServerResponseClose),this.socket=e,this.connection=e,this.emit("socket",e),this._flush()},ServerResponse.prototype.detachSocket=function(e){assert(e._httpMessage===this),e.removeListener("close",onServerResponseClose),e._httpMessage=null,this.socket=this.connection=null},ServerResponse.prototype.writeContinue=function(e){this._writeRaw(`HTTP/1.1 100 Continue${CRLF}${CRLF}`,"ascii",e),this._sent100=!0},ServerResponse.prototype.writeProcessing=function(e){this._writeRaw(`HTTP/1.1 102 Processing${CRLF}${CRLF}`,"ascii",e)},ServerResponse.prototype._implicitHeader=function(){this.writeHead(this.statusCode)},ServerResponse.prototype.writeHead=writeHead,ServerResponse.prototype.writeHeader=ServerResponse.prototype.writeHead,util.inherits(Server,net.Server),Server.prototype.setTimeout=function(e,t){return this.timeout=e,t&&this.on("timeout",t),this};const badRequestResponse=Buffer.from(`HTTP/1.1 400 ${STATUS_CODES[400]}${CRLF}${CRLF}`,"ascii");function socketOnError(e){this.removeListener("error",socketOnError),this.on("error",()=>{}),this.server.emit("clientError",e,this)||(this.writable&&this.write(badRequestResponse),this.destroy(e))}function onParserExecuteCommon(e,t,n,o,s,r){if(resetSocketTimeout(e,t,o),s instanceof Error)s.rawPacket=r||n.getCurrentBuffer(),debug("parse error",s),socketOnError.call(t,s);else if(n.incoming&&n.incoming.upgrade){var i=s,a=n.incoming;debug("SERVER upgrade or connect",a.method),r||(r=n.getCurrentBuffer()),t.removeListener("data",o.onData),t.removeListener("end",o.onEnd),t.removeListener("close",o.onClose),t.removeListener("drain",o.onDrain),t.removeListener("drain",ondrain),t.removeListener("error",socketOnError),unconsume(n,t),n.finish(),freeParser(n,a,t),n=null;var u="CONNECT"===a.method?"connect":"upgrade";if("upgrade"===u||e.listenerCount(u)>0){debug("SERVER have listener for %s",u);var c=r.slice(i,r.length);t.readableFlowing=null,e.emit(u,a,t,c)}else t.destroy()}t._paused&&t.parser&&(debug("pause parser"),t.parser.pause())}function resOnFinish(e,t,n,o,s){if(assert(0===o.incoming.length||o.incoming[0]===e),o.incoming.shift(),e._consuming||e._readableState.resumeScheduled||e._dump(),t.detachSocket(n),t._last)"function"==typeof n.destroySoon?n.destroySoon():n.end();else if(0===o.outgoing.length)s.keepAliveTimeout&&"function"==typeof n.setTimeout&&(n.setTimeout(0),n.setTimeout(s.keepAliveTimeout),o.keepAliveTimeoutSet=!0);else{var r=o.outgoing.shift();r&&r.assignSocket(n)}}function parserOnIncoming(e,t,n,o,s){if(resetSocketTimeout(e,t,n),t.parser.parsingHeadersStart=0,o.upgrade&&(o.upgrade="CONNECT"===o.method||e.listenerCount("upgrade")>0,o.upgrade))return 2;(n.incoming.push(o),t._paused)||(t._writableState.needDrain||n.outgoingData>=t.writableHighWaterMark)&&(t._paused=!0,t.pause());var r=new e[kServerResponse](o);return r._onPendingData=updateOutgoingData.bind(void 0,t,n),r.shouldKeepAlive=s,DTRACE_HTTP_SERVER_REQUEST(o,t),COUNTER_HTTP_SERVER_REQUEST(),t._httpMessage?n.outgoing.push(r):r.assignSocket(t),r.on("finish",resOnFinish.bind(void 0,o,r,t,n,e)),void 0!==o.headers.expect&&1===o.httpVersionMajor&&1===o.httpVersionMinor?continueExpression.test(o.headers.expect)?(r._expect_continue=!0,e.listenerCount("checkContinue")>0?e.emit("checkContinue",o,r):(r.writeContinue(),e.emit("request",o,r))):e.listenerCount("checkExpectation")>0?e.emit("checkExpectation",o,r):(r.writeHead(417),r.end()):e.emit("request",o,r),0}function resetSocketTimeout(e,t,n){n.keepAliveTimeoutSet&&(t.setTimeout(e.timeout||0),n.keepAliveTimeoutSet=!1)}function onSocketResume(){this._paused?this.pause():this._handle&&!this._handle.reading&&(this._handle.reading=!0,this._handle.readStart())}function onSocketPause(){this._handle&&this._handle.reading&&(this._handle.reading=!1,this._handle.readStop())}function unconsume(e,t){t._handle&&(e._consumed&&e.unconsume(),e._consumed=!1,t.removeListener("pause",onSocketPause),t.removeListener("resume",onSocketResume))}function socketOnWrap(e,t){var n=net.Socket.prototype.on.call(this,e,t);return this.parser?("data"!==e&&"readable"!==e||unconsume(this.parser,this),n):(this.on=net.Socket.prototype.on,n)}module.exports={STATUS_CODES,Server,ServerResponse,_connectionListener:connectionListener,kServerResponse};"use strict";module.exports=Duplex;const util=require("util"),Readable=require("_stream_readable"),Writable=require("_stream_writable");util.inherits(Duplex,Readable);{const e=Object.keys(Writable.prototype);for(var v=0;v<e.length;v++){const t=e[v];Duplex.prototype[t]||(Duplex.prototype[t]=Writable.prototype[t])}}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",onend)))}function onend(){this._writableState.ended||process.nextTick(onEndNT,this)}function onEndNT(e){e.end()}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:!1,get(){return this._writableState.highWaterMark}}),Object.defineProperty(Duplex.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Duplex.prototype,"writableLength",{enumerable:!1,get(){return this._writableState.length}}),Object.defineProperty(Duplex.prototype,"destroyed",{enumerable:!1,get(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}});"use strict";module.exports=PassThrough;const Transform=require("_stream_transform"),util=require("util");function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,o){o(null,r)};"use strict";module.exports=Readable,Readable.ReadableState=ReadableState;const EE=require("events"),Stream=require("stream"),{Buffer}=require("buffer"),util=require("util"),debug=util.debuglog("stream"),BufferList=require("internal/streams/buffer_list"),destroyImpl=require("internal/streams/destroy"),{getHighWaterMark}=require("internal/streams/state"),{ERR_INVALID_ARG_TYPE,ERR_STREAM_PUSH_AFTER_EOF,ERR_METHOD_NOT_IMPLEMENTED,ERR_STREAM_UNSHIFT_AFTER_END_EVENT}=require("internal/errors").codes,{emitExperimentalWarning}=require("internal/util");let StringDecoder,createReadableStreamAsyncIterator;util.inherits(Readable,Stream);const kProxyEvents=["error","close","destroy","pause","resume"];function prependListener(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function ReadableState(e,t,r){e=e||{},"boolean"!=typeof r&&(r=t instanceof Stream.Duplex),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=getHighWaterMark(this,e,"readableHighWaterMark",r),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.emitClose=!1!==e.emitClose,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(!(this instanceof Readable))return new Readable(e);const t=this instanceof Stream.Duplex;this._readableState=new ReadableState(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),Stream.call(this)}function readableAddChunk(e,t,r,a,n){debug("readableAddChunk",t);var i,d=e._readableState;if(null===t)d.reading=!1,onEofChunk(e,d);else if(n||(i=chunkInvalid(d,t)),i)e.emit("error",i);else if(d.objectMode||t&&t.length>0)if("string"==typeof t||d.objectMode||Object.getPrototypeOf(t)===Buffer.prototype||(t=Stream._uint8ArrayToBuffer(t)),a)d.endEmitted?e.emit("error",new ERR_STREAM_UNSHIFT_AFTER_END_EVENT):addChunk(e,d,t,!0);else if(d.ended)e.emit("error",new ERR_STREAM_PUSH_AFTER_EOF);else{if(d.destroyed)return!1;d.reading=!1,d.decoder&&!r?(t=d.decoder.write(t),d.objectMode||0!==t.length?addChunk(e,d,t,!1):maybeReadMore(e,d)):addChunk(e,d,t,!1)}else a||(d.reading=!1,maybeReadMore(e,d));return!d.ended&&(d.length<d.highWaterMark||0===d.length)}function addChunk(e,t,r,a){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,a?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e)),maybeReadMore(e,t)}function chunkInvalid(e,t){var r;return Stream._isUint8Array(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer","Uint8Array"],t)),r}Object.defineProperty(Readable.prototype,"destroyed",{enumerable:!1,get(){return void 0!==this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}}),Readable.prototype.destroy=destroyImpl.destroy,Readable.prototype._undestroy=destroyImpl.undestroy,Readable.prototype._destroy=function(e,t){t(e)},Readable.prototype.push=function(e,t){var r,a=this._readableState;return a.objectMode?r=!0:"string"==typeof e&&((t=t||a.defaultEncoding)!==a.encoding&&(e=Buffer.from(e,t),t=""),r=!0),readableAddChunk(this,e,t,!1,r)},Readable.prototype.unshift=function(e){return readableAddChunk(this,e,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=this._readableState.decoder.encoding,this};const MAX_HWM=8388608;function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:Number.isNaN(e)?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function onEofChunk(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?emitReadable(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,emitReadable_(e)))}}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,process.nextTick(emitReadable_,e))}function emitReadable_(e){var t=e._readableState;debug("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||e.emit("readable"),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(var r=t.length;!t.reading&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EE.listenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function updateReadableListening(e){e._readableState.readableListening=e.listenerCount("readable")>0,e.listenerCount("data")>0&&e.resume()}function nReadingNextTick(e){debug("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(resume_,e,t))}function resume_(e,t){debug("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){const t=e._readableState;for(debug("flow",t.flowing);t.flowing&&null!==e.read(););}function fromList(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function endReadable(e){var t=e._readableState;debug("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process.nextTick(endReadableNT,t,e))}function endReadableNT(e,t){debug("endReadableNT",e.endEmitted,e.length),e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}Readable.prototype.read=function(e){debug("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var a,n=t.needReadable;return debug("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&debug("length less than watermark",n=!0),t.ended||t.reading?debug("reading or ended",n=!1):n&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=howMuchToRead(r,t))),null===(a=e>0?fromList(e,t):null)?(t.needReadable=!0,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&endReadable(this)),null!==a&&this.emit("data",a),a},Readable.prototype._read=function(e){this.emit("error",new ERR_METHOD_NOT_IMPLEMENTED("_read()"))},Readable.prototype.pipe=function(e,t){var r=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,debug("pipe count=%d opts=%j",a.pipesCount,t);var n=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?d:h;function i(t,n){debug("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,debug("cleanup"),e.removeListener("close",b),e.removeListener("finish",p),e.removeListener("drain",o),e.removeListener("error",u),e.removeListener("unpipe",i),r.removeListener("end",d),r.removeListener("end",h),r.removeListener("data",l),s=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||o())}function d(){debug("onend"),e.end()}a.endEmitted?process.nextTick(n):r.once("end",n),e.on("unpipe",i);var o=pipeOnDrain(r);e.on("drain",o);var s=!1;function l(t){debug("ondata");var n=e.write(t);debug("dest.write",n),!1===n&&((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==a.pipes.indexOf(e))&&!s&&(debug("false write response, pause",a.awaitDrain),a.awaitDrain++),r.pause())}function u(t){debug("onerror",t),h(),e.removeListener("error",u),0===EE.listenerCount(e,"error")&&e.emit("error",t)}function b(){e.removeListener("finish",p),h()}function p(){debug("onfinish"),e.removeListener("close",b),h()}function h(){debug("unpipe"),r.unpipe(e)}return r.on("data",l),prependListener(e,"error",u),e.once("close",b),e.once("finish",p),e.emit("pipe",r),a.flowing||(debug("pipe resume"),r.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var a=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)a[i].emit("unpipe",this,{hasUnpiped:!1});return this}var d=t.pipes.indexOf(e);return-1===d?this:(t.pipes.splice(d,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},Readable.prototype.on=function(e,t){const r=Stream.prototype.on.call(this,e,t),a=this._readableState;return"data"===e?(a.readableListening=this.listenerCount("readable")>0,!1!==a.flowing&&this.resume()):"readable"===e&&(a.endEmitted||a.readableListening||(a.readableListening=a.needReadable=!0,a.flowing=!1,a.emittedReadable=!1,debug("on readable",a.length,a.reading),a.length?emitReadable(this):a.reading||process.nextTick(nReadingNextTick,this))),r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.removeListener=function(e,t){const r=Stream.prototype.removeListener.call(this,e,t);return"readable"===e&&process.nextTick(updateReadableListening,this),r},Readable.prototype.removeAllListeners=function(e){const t=Stream.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||process.nextTick(updateReadableListening,this),t},Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!e.readableListening,resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,r=!1;for(var a in e.on("end",()=>{if(debug("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&this.push(e)}this.push(null)}),e.on("data",a=>{(debug("wrapped data"),t.decoder&&(a=t.decoder.write(a)),t.objectMode&&null==a)||(t.objectMode||a&&a.length)&&(this.push(a)||(r=!0,e.pause()))}),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));for(var n=0;n<kProxyEvents.length;n++)e.on(kProxyEvents[n],this.emit.bind(this,kProxyEvents[n]));return this._read=(t=>{debug("wrapped _read",t),r&&(r=!1,e.resume())}),this},Readable.prototype[Symbol.asyncIterator]=function(){return emitExperimentalWarning("Readable[Symbol.asyncIterator]"),void 0===createReadableStreamAsyncIterator&&(createReadableStreamAsyncIterator=require("internal/streams/async_iterator")),createReadableStreamAsyncIterator(this)},Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Readable.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Readable.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),Readable._fromList=fromList,Object.defineProperty(Readable.prototype,"readableLength",{enumerable:!1,get(){return this._readableState.length}});"use strict";module.exports=Transform;const{ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK,ERR_TRANSFORM_ALREADY_TRANSFORMING,ERR_TRANSFORM_WITH_LENGTH_0}=require("internal/errors").codes,Duplex=require("_stream_duplex"),util=require("util");function afterTransform(r,t){var e=this._transformState;e.transforming=!1;var n=e.writecb;if(null===n)return this.emit("error",new ERR_MULTIPLE_CALLBACK);e.writechunk=null,e.writecb=null,null!=t&&this.push(t),n(r);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState={afterTransform:afterTransform.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",prefinish)}function prefinish(){"function"!=typeof this._flush||this._readableState.destroyed?done(this,null,null):this._flush((r,t)=>{done(this,r,t)})}function done(r,t,e){if(t)return r.emit("error",t);if(null!=e&&r.push(e),r._writableState.length)throw new ERR_TRANSFORM_WITH_LENGTH_0;if(r._transformState.transforming)throw new ERR_TRANSFORM_ALREADY_TRANSFORMING;return r.push(null)}util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,e){e(new ERR_METHOD_NOT_IMPLEMENTED("_transform()"))},Transform.prototype._write=function(r,t,e){var n=this._transformState;if(n.writecb=e,n.writechunk=r,n.writeencoding=t,!n.transforming){var a=this._readableState;(n.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},Transform.prototype._destroy=function(r,t){Duplex.prototype._destroy.call(this,r,r=>{t(r)})};"use strict";module.exports=require("internal/wrap_js_stream");"use strict";module.exports=Writable,Writable.WritableState=WritableState;const util=require("util"),internalUtil=require("internal/util"),Stream=require("stream"),{Buffer}=require("buffer"),destroyImpl=require("internal/streams/destroy"),{getHighWaterMark}=require("internal/streams/state"),{ERR_INVALID_ARG_TYPE,ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK,ERR_STREAM_CANNOT_PIPE,ERR_STREAM_DESTROYED,ERR_STREAM_NULL_VALUES,ERR_STREAM_WRITE_AFTER_END,ERR_UNKNOWN_ENCODING}=require("internal/errors").codes;function nop(){}function WritableState(e,t,r){e=e||{},"boolean"!=typeof r&&(r=t instanceof Stream.Duplex),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=getHighWaterMark(this,e,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=onwrite.bind(void 0,t),this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.bufferedRequestCount=0;var n={next:null,entry:null,finish:void 0};n.finish=onCorkedFinish.bind(void 0,n,this),this.corkedRequestsFree=n}var realHasInstance;function Writable(e){const t=this instanceof Stream.Duplex;if(!t&&!realHasInstance.call(Writable,this))return new Writable(e);this._writableState=new WritableState(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),Stream.call(this)}function writeAfterEnd(e,t){var r=new ERR_STREAM_WRITE_AFTER_END;e.emit("error",r),process.nextTick(t,r)}function validChunk(e,t,r,i){var n;return null===r?n=new ERR_STREAM_NULL_VALUES:"string"==typeof r||t.objectMode||(n=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer"],r)),!n||(e.emit("error",n),process.nextTick(i,n),!1)}function decodeChunk(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Buffer.from(t,r)),t}function writeOrBuffer(e,t,r,i,n,o){if(!r){var a=decodeChunk(t,i,n);i!==a&&(r=!0,n="buffer",i=a)}var s=t.objectMode?1:i.length;t.length+=s;var f=t.length<t.highWaterMark;if(f||(t.needDrain=!0),t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,s,i,n,o);return f}function doWrite(e,t,r,i,n,o,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new ERR_STREAM_DESTROYED("write")):r?e._writev(n,t.onwrite):e._write(n,o,t.onwrite),t.sync=!1}function onwriteError(e,t,r,i,n){--t.pendingcb,r?(process.nextTick(n,i),process.nextTick(finishMaybe,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(n(i),e._writableState.errorEmitted=!0,e.emit("error",i),finishMaybe(e,t))}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if("function"!=typeof n)throw new ERR_MULTIPLE_CALLBACK;if(onwriteStateUpdate(r),t)onwriteError(e,r,i,t,n);else{var o=needFinish(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),i?process.nextTick(afterWrite,e,r,o,n):afterWrite(e,r,o,n)}}function afterWrite(e,t,r,i){r||onwriteDrain(e,t),t.pendingcb--,i(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),o=t.corkedRequestsFree;o.entry=r;for(var a=0,s=!0;r;)n[a]=r,r.isBuf||(s=!1),r=r.next,a+=1;if(n.allBuffers=s,doWrite(e,t,!0,t.length,n,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next)t.corkedRequestsFree=o.next,o.next=null;else{var f={next:null,entry:null,finish:void 0};f.finish=onCorkedFinish.bind(void 0,f,t),t.corkedRequestsFree=f}t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,u=r.encoding,d=r.callback;if(doWrite(e,t,!1,t.objectMode?1:l.length,l,u,d),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function callFinal(e,t){e._final(r=>{t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),finishMaybe(e,t)})}function prefinish(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,process.nextTick(callFinal,e,t)))}function finishMaybe(e,t){var r=needFinish(t);return r&&(prefinish(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?process.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function onCorkedFinish(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(r),i=i.next}t.corkedRequestsFree.next=e}util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")}),"function"==typeof Symbol&&Symbol.hasInstance?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(e){return!!realHasInstance.call(this,e)||this===Writable&&(e&&e._writableState instanceof WritableState)}})):realHasInstance=function(e){return e instanceof this},Writable.prototype.pipe=function(){this.emit("error",new ERR_STREAM_CANNOT_PIPE)},Writable.prototype.write=function(e,t,r){var i=this._writableState,n=!1,o=!i.objectMode&&Stream._isUint8Array(e);return o&&Object.getPrototypeOf(e)!==Buffer.prototype&&(e=Stream._uint8ArrayToBuffer(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=nop),i.ending?writeAfterEnd(this,r):(o||validChunk(this,i,e,r))&&(i.pendingcb++,n=writeOrBuffer(this,i,o,e,t,r)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!Buffer.isEncoding(e))throw new ERR_UNKNOWN_ENCODING(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(Writable.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Writable.prototype._write=function(e,t,r){r(new ERR_METHOD_NOT_IMPLEMENTED("_write()"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){var i=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||endWritable(this,i,r),this},Object.defineProperty(Writable.prototype,"writableLength",{enumerable:!1,get(){return this._writableState.length}}),Object.defineProperty(Writable.prototype,"destroyed",{enumerable:!1,get(){return void 0!==this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(e,t){t(e)};"use strict";const{parseCertString}=require("internal/tls"),{isArrayBufferView}=require("internal/util/types"),tls=require("tls"),{ERR_CRYPTO_CUSTOM_ENGINE_NOT_SUPPORTED,ERR_INVALID_ARG_TYPE}=require("internal/errors").codes,{SSL_OP_CIPHER_SERVER_PREFERENCE}=process.binding("constants").crypto;var crypto=null;const{SecureContext:NativeSecureContext}=internalBinding("crypto");function SecureContext(e,t,r){if(!(this instanceof SecureContext))return new SecureContext(e,t,r);r?this.context=r:(this.context=new NativeSecureContext,e?this.context.init(e):this.context.init()),t&&this.context.setOptions(t)}function validateKeyCert(e,t){if("string"!=typeof t&&!isArrayBufferView(t))throw new ERR_INVALID_ARG_TYPE(`options.${e}`,["string","Buffer","TypedArray","DataView"],t)}exports.SecureContext=SecureContext,exports.createSecureContext=function(e,t){e||(e={});var r=e.secureOptions;e.honorCipherOrder&&(r|=SSL_OP_CIPHER_SERVER_PREFERENCE);const n=new SecureContext(e.secureProtocol,r,t);var s,i;if(t)return n;const{ca:c}=e;if(c)if(Array.isArray(c))for(s=0;s<c.length;++s)validateKeyCert("ca",i=c[s]),n.context.addCACert(i);else validateKeyCert("ca",c),n.context.addCACert(c);else n.context.addRootCerts();const{cert:o}=e;if(o)if(Array.isArray(o))for(s=0;s<o.length;++s)validateKeyCert("cert",i=o[s]),n.context.setCert(i);else validateKeyCert("cert",o),n.context.setCert(o);var a=e.key,C=e.passphrase;if(a)if(Array.isArray(a))for(s=0;s<a.length;++s){const e=null!=(i=a[s])&&void 0!==i.pem?i.pem:i;validateKeyCert("key",e),n.context.setKey(e,i.passphrase||C)}else validateKeyCert("key",a),n.context.setKey(a,C);if(e.ciphers?n.context.setCiphers(e.ciphers):n.context.setCiphers(tls.DEFAULT_CIPHERS),void 0===e.ecdhCurve?n.context.setECDHCurve(tls.DEFAULT_ECDH_CURVE):e.ecdhCurve&&n.context.setECDHCurve(e.ecdhCurve),e.dhparam){const t=n.context.setDHParam(e.dhparam);t&&process.emitWarning(t,"SecurityWarning")}if(e.crl)if(Array.isArray(e.crl))for(s=0;s<e.crl.length;s++)n.context.addCRL(e.crl[s]);else n.context.addCRL(e.crl);if(e.sessionIdContext&&n.context.setSessionIdContext(e.sessionIdContext),e.pfx)if(crypto||(crypto=require("crypto")),Array.isArray(e.pfx))for(s=0;s<e.pfx.length;s++){const t=e.pfx[s],r=t.buf?t.buf:t,i=crypto._toBuf(r),c=t.passphrase||e.passphrase;c?n.context.loadPKCS12(i,crypto._toBuf(c)):n.context.loadPKCS12(i)}else{const t=crypto._toBuf(e.pfx),r=e.passphrase;r?n.context.loadPKCS12(t,crypto._toBuf(r)):n.context.loadPKCS12(t)}if(e.singleUse&&(n.singleUse=!0,n.context.setFreeListLength(0)),"string"==typeof e.clientCertEngine){if(!n.context.setClientCertEngine)throw new ERR_CRYPTO_CUSTOM_ENGINE_NOT_SUPPORTED;n.context.setClientCertEngine(e.clientCertEngine)}else if(null!=e.clientCertEngine)throw new ERR_INVALID_ARG_TYPE("options.clientCertEngine",["string","null","undefined"],e.clientCertEngine);return n},exports.translatePeerCertificate=function e(t){if(!t)return null;if(null!=t.issuer&&(t.issuer=parseCertString(t.issuer)),null!=t.issuerCertificate&&t.issuerCertificate!==t&&(t.issuerCertificate=e(t.issuerCertificate)),null!=t.subject&&(t.subject=parseCertString(t.subject)),null!=t.infoAccess){var r=t.infoAccess;t.infoAccess=Object.create(null),r.replace(/([^\n:]*):([^\n]*)(?:\n|$)/g,(e,r,n)=>{r in t.infoAccess?t.infoAccess[r].push(n):t.infoAccess[r]=[n]})}return t};"use strict";require("internal/util").assertCrypto();const assert=require("assert"),crypto=require("crypto"),net=require("net"),tls=require("tls"),util=require("util"),common=require("_tls_common"),{StreamWrap}=require("_stream_wrap"),{Buffer}=require("buffer"),debug=util.debuglog("tls"),{TCP,constants:TCPConstants}=internalBinding("tcp_wrap"),tls_wrap=internalBinding("tls_wrap"),{Pipe,constants:PipeConstants}=internalBinding("pipe_wrap"),{owner_symbol}=require("internal/async_hooks").symbols,{SecureContext:NativeSecureContext}=process.binding("crypto"),{ERR_INVALID_ARG_TYPE,ERR_MULTIPLE_CALLBACK,ERR_SOCKET_CLOSED,ERR_TLS_DH_PARAM_SIZE,ERR_TLS_HANDSHAKE_TIMEOUT,ERR_TLS_RENEGOTIATE,ERR_TLS_RENEGOTIATION_DISABLED,ERR_TLS_REQUIRED_SERVER_NAME,ERR_TLS_SESSION_ATTACK,ERR_TLS_SNI_FROM_SERVER}=require("internal/errors").codes,{validateString}=require("internal/validators"),kConnectOptions=Symbol("connect-options"),kDisableRenegotiation=Symbol("disable-renegotiation"),kErrorEmitted=Symbol("error-emitted"),kHandshakeTimeout=Symbol("handshake-timeout"),kRes=Symbol("res"),kSNICallback=Symbol("snicallback"),noop=()=>{};function onhandshakestart(e){debug("onhandshakestart");const{lastHandshakeTime:t}=this;if(assert(e>=t,`now (${e}) < lastHandshakeTime (${t})`),this.lastHandshakeTime=e,0===t)return;e-t>=1e3*tls.CLIENT_RENEG_WINDOW?this.handshakes=1:this.handshakes++;const s=this[owner_symbol];this.handshakes>tls.CLIENT_RENEG_LIMIT?s._emitTLSError(new ERR_TLS_SESSION_ATTACK):s[kDisableRenegotiation]&&s._emitTLSError(new ERR_TLS_RENEGOTIATION_DISABLED)}function onhandshakedone(){debug("onhandshakedone");const e=this[owner_symbol];e._newSessionPending?e._securePending=!0:e._finishInit()}function loadSession(e){const t=this[owner_symbol];var s=!1;(e.sessionId.length<=0||e.tlsTicket||t.server&&!t.server.emit("resumeSession",e.sessionId,function(e,n){return s?t.destroy(new ERR_MULTIPLE_CALLBACK):(s=!0,e?t.destroy(e):null===t._handle?t.destroy(new ERR_SOCKET_CLOSED):(t._handle.loadSession(n),void t._handle.endParser()))}))&&t._handle.endParser()}function loadSNI(e){const t=this[owner_symbol],s=e.servername;if(!s||!t._SNICallback)return requestOCSP(t,e);let n=!1;t._SNICallback(s,(s,r)=>n?t.destroy(new ERR_MULTIPLE_CALLBACK):(n=!0,s?t.destroy(s):null===t._handle?t.destroy(new ERR_SOCKET_CLOSED):(r&&(t._handle.sni_context=r.context||r),void requestOCSP(t,e))))}function requestOCSP(e,t){if(!t.OCSPRequest||!e.server)return requestOCSPDone(e);let s=e._handle.sni_context;if(!s&&!(s=e.server._sharedCreds))return requestOCSPDone(e);if(s.context&&(s=s.context),0===e.server.listenerCount("OCSPRequest"))return requestOCSPDone(e);let n=!1;e.server.emit("OCSPRequest",s.getCertificate(),s.getIssuer(),(t,s)=>n?e.destroy(new ERR_MULTIPLE_CALLBACK):(n=!0,t?e.destroy(t):null===e._handle?e.destroy(new ERR_SOCKET_CLOSED):(s&&e._handle.setOCSPResponse(s),void requestOCSPDone(e))))}function requestOCSPDone(e){try{e._handle.certCbDone()}catch(t){e.destroy(t)}}function onnewsession(e,t){const s=this[owner_symbol];if(!s.server)return;var n=!1;const r=()=>{if(!n){if(n=!0,null===s._handle)return s.destroy(new ERR_SOCKET_CLOSED);this.newSessionDone(),s._newSessionPending=!1,s._securePending&&s._finishInit(),s._securePending=!1}};s._newSessionPending=!0,s.server.emit("newSession",e,t,r)||r()}function onocspresponse(e){this[owner_symbol].emit("OCSPResponse",e)}function onerror(e){const t=this[owner_symbol];t._hadError||(t._hadError=!0,t._secureEstablished?t._tlsOptions.isServer&&t._rejectUnauthorized&&/peer did not return a certificate/.test(e.message)?t.destroy():t._emitTLSError(e):t.destroy(e))}function initRead(e,t){if(e._handle){if(t&&t.readableLength)for(var s;null!==(s=t.read());)e._handle.receive(s);e.read(0)}}function TLSSocket(e,t){const s=Object.assign({},t);var n;s.ALPNProtocols&&tls.convertALPNProtocols(s.ALPNProtocols,s),this._tlsOptions=s,this._secureEstablished=!1,this._securePending=!1,this._newSessionPending=!1,this._controlReleased=!1,this._SNICallback=null,this.servername=null,this.alpnProtocol=null,this.authorized=!1,this.authorizationError=null,this[kRes]=null,n=e instanceof net.Socket&&e._handle||!e?e:new StreamWrap(e),this.encrypted=!0,net.Socket.call(this,{handle:this._wrapHandle(n),allowHalfOpen:e&&e.allowHalfOpen,readable:!1,writable:!1}),this.ssl=this._handle,this.on("error",this._tlsError),this._init(e,n),this.readable=!0,this.writable=!0,process.nextTick(initRead,this,e)}util.inherits(TLSSocket,net.Socket),exports.TLSSocket=TLSSocket;var proxiedMethods=["ref","unref","open","bind","listen","connect","bind6","connect6","getsockname","getpeername","setNoDelay","setKeepAlive","setSimultaneousAccepts","setBlocking","setPendingInstances"];function makeMethodProxy(e){return function(...t){if(this._parent[e])return this._parent[e].apply(this._parent,t)}}for(var n=0;n<proxiedMethods.length;n++)tls_wrap.TLSWrap.prototype[proxiedMethods[n]]=makeMethodProxy(proxiedMethods[n]);function defineHandleReading(e,t){Object.defineProperty(t,"reading",{get:()=>e[kRes].reading,set:t=>{e[kRes].reading=t}})}function onSocketCloseDestroySSL(){setImmediate(destroySSL,this),this[kRes]=null}function destroySSL(e){e._destroySSL()}function onSocketSecure(){if(this._requestCert){const e=this._handle.verifyError();e?(this.authorizationError=e.code,this._rejectUnauthorized&&this.destroy()):this.authorized=!0}!this.destroyed&&this._releaseControl()&&this._tlsOptions.server.emit("secureConnection",this)}function onSocketTLSError(e){this._controlReleased||this[kErrorEmitted]||(this[kErrorEmitted]=!0,this._tlsOptions.server.emit("tlsClientError",e,this))}function onSocketClose(e){if(!e&&!this._controlReleased&&!this[kErrorEmitted]){this[kErrorEmitted]=!0;const e=new Error("socket hang up");e.code="ECONNRESET",this._tlsOptions.server.emit("tlsClientError",e,this)}}function tlsConnectionListener(e){const t=new TLSSocket(e,{secureContext:this._sharedCreds,isServer:!0,server:this,requestCert:this.requestCert,rejectUnauthorized:this.rejectUnauthorized,handshakeTimeout:this[kHandshakeTimeout],ALPNProtocols:this.ALPNProtocols,SNICallback:this[kSNICallback]||SNICallback});t.on("secure",onSocketSecure),t[kErrorEmitted]=!1,t.on("close",onSocketClose),t.on("_tlsError",onSocketTLSError)}function Server(e,t){if(!(this instanceof Server))return new Server(e,t);if("function"==typeof e)t=e,e={};else{if(null!=e&&"object"!=typeof e)throw new ERR_INVALID_ARG_TYPE("options","Object",e);e=e||{}}if(this._contexts=[],this.setOptions(e),this._sharedCreds=tls.createSecureContext({pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,clientCertEngine:this.clientCertEngine,ca:this.ca,ciphers:this.ciphers,ecdhCurve:this.ecdhCurve,dhparam:this.dhparam,secureProtocol:this.secureProtocol,secureOptions:this.secureOptions,honorCipherOrder:this.honorCipherOrder,crl:this.crl,sessionIdContext:this.sessionIdContext}),this[kHandshakeTimeout]=e.handshakeTimeout||12e4,this[kSNICallback]=e.SNICallback,"number"!=typeof this[kHandshakeTimeout])throw new ERR_INVALID_ARG_TYPE("options.handshakeTimeout","number",e.handshakeTimeout);this.sessionTimeout&&this._sharedCreds.context.setSessionTimeout(this.sessionTimeout),this.ticketKeys&&this._sharedCreds.context.setTicketKeys(this.ticketKeys),net.Server.call(this,tlsConnectionListener),t&&this.on("secureConnection",t)}function SNICallback(e,t){const s=this.server._contexts;for(var n=0;n<s.length;n++){const r=s[n];if(r[0].test(e))return void t(null,r[1])}t(null,void 0)}function normalizeConnectArgs(e){var t=net._normalizeArgs(e),s=t[0],n=t[1];return null!==e[1]&&"object"==typeof e[1]?util._extend(s,e[1]):null!==e[2]&&"object"==typeof e[2]&&util._extend(s,e[2]),n?[s,n]:[s]}function onConnectSecure(){const e=this[kConnectOptions],t=this.getEphemeralKeyInfo();if("DH"===t.type&&t.size<e.minDHSize){const e=new ERR_TLS_DH_PARAM_SIZE(t.size);return this.emit("error",e),void this.destroy()}let s=this._handle.verifyError();if(!s&&!this.isSessionReused()){const t=e.servername||e.host||e.socket&&e.socket._host||"localhost",n=this.getPeerCertificate(!0);s=e.checkServerIdentity(t,n)}if(s){if(this.authorized=!1,this.authorizationError=s.code||s.message,e.rejectUnauthorized)return void this.destroy(s);this.emit("secureConnect")}else this.authorized=!0,this.emit("secureConnect");this.removeListener("end",onConnectEnd)}function onConnectEnd(){if(!this._hadError){const e=this[kConnectOptions];this._hadError=!0;const t=new Error("Client network socket disconnected before secure TLS connection was established");t.code="ECONNRESET",t.path=e.path,t.host=e.host,t.port=e.port,t.localAddress=e.localAddress,this.destroy(t)}}tls_wrap.TLSWrap.prototype.close=function(e){let t;this[owner_symbol]&&(t=this[owner_symbol].ssl,this[owner_symbol].ssl=null);const s=()=>{t&&(t.destroySSL(),t._secureContext.singleUse&&(t._secureContext.context.close(),t._secureContext.context=null)),e&&e()};return this._parentWrap&&this._parentWrap._handle===this._parent?(this._parentWrap.once("close",s),this._parentWrap.destroy()):this._parent.close(s)},TLSSocket.prototype.disableRenegotiation=function(){this[kDisableRenegotiation]=!0},TLSSocket.prototype._wrapHandle=function(e){var t;e&&(t=e._handle);var s=this._tlsOptions;t||((t=s.pipe?new Pipe(PipeConstants.SOCKET):new TCP(TCPConstants.SOCKET))[owner_symbol]=this);const n=s.secureContext||s.credentials||tls.createSecureContext(s),r=t._externalStream;assert("object"==typeof r,"handle must be a LibuvStreamWrap"),assert(n.context instanceof NativeSecureContext,"context.context must be a NativeSecureContext");const o=tls_wrap.wrap(r,n.context,!!s.isServer);return o._parent=t,o._parentWrap=e,o._secureContext=n,o.reading=t.reading,this[kRes]=o,defineHandleReading(this,t),this.on("close",onSocketCloseDestroySSL),o},TLSSocket.prototype._destroySSL=function(){this.ssl&&(this.ssl.destroySSL(),this.ssl._secureContext.singleUse&&(this.ssl._secureContext.context.close(),this.ssl._secureContext.context=null),this.ssl=null)},TLSSocket.prototype._init=function(e,t){var s=this._tlsOptions,n=this._handle;this.server=s.server;const r=!!s.requestCert||!s.isServer,o=!!s.rejectUnauthorized;this._requestCert=r,this._rejectUnauthorized=o,(r||o)&&n.setVerifyMode(r,o),s.isServer?(n.onhandshakestart=onhandshakestart,n.onhandshakedone=onhandshakedone,n.onclienthello=loadSession,n.oncertcb=loadSNI,n.onnewsession=onnewsession,n.lastHandshakeTime=0,n.handshakes=0,this.server&&((this.server.listenerCount("resumeSession")>0||this.server.listenerCount("newSession")>0)&&n.enableSessionCallbacks(),this.server.listenerCount("OCSPRequest")>0&&n.enableCertCb())):(n.onhandshakestart=noop,n.onhandshakedone=this._finishInit.bind(this),n.onocspresponse=onocspresponse,s.session&&n.setSession(s.session)),n.onerror=onerror,s.isServer&&s.SNICallback&&(s.SNICallback!==SNICallback||s.server&&s.server._contexts.length)&&(assert("function"==typeof s.SNICallback),this._SNICallback=s.SNICallback,n.enableCertCb()),s.ALPNProtocols&&(n._secureContext.alpnBuffer=s.ALPNProtocols,n.setALPNProtocols(n._secureContext.alpnBuffer)),s.handshakeTimeout>0&&this.setTimeout(s.handshakeTimeout,this._handleTimeout),e instanceof net.Socket&&(this._parent=e,this.connecting=e.connecting||!e._handle,e.once("connect",()=>{this.connecting=!1,this.emit("connect")})),t?t.on("error",e=>this._emitTLSError(e)):(assert(!e),this.connecting=!0)},TLSSocket.prototype.renegotiate=function(e,t){if(this.destroyed)return;let s=!!this._requestCert,n=!!this._rejectUnauthorized;return void 0!==e.requestCert&&(s=!!e.requestCert),void 0!==e.rejectUnauthorized&&(n=!!e.rejectUnauthorized),s===this._requestCert&&n===this._rejectUnauthorized||(this._handle.setVerifyMode(s,n),this._requestCert=s,this._rejectUnauthorized=n),this._handle.renegotiate()?(this.write(""),t&&this.once("secure",()=>t(null)),!0):(t&&process.nextTick(t,new ERR_TLS_RENEGOTIATE),!1)},TLSSocket.prototype.setMaxSendFragment=function(e){return 1===this._handle.setMaxSendFragment(e)},TLSSocket.prototype.getTLSTicket=function(){return this._handle.getTLSTicket()},TLSSocket.prototype._handleTimeout=function(){this._emitTLSError(new ERR_TLS_HANDSHAKE_TIMEOUT)},TLSSocket.prototype._emitTLSError=function(e){var t=this._tlsError(e);t&&this.emit("error",t)},TLSSocket.prototype._tlsError=function(e){return this.emit("_tlsError",e),this._controlReleased?e:null},TLSSocket.prototype._releaseControl=function(){return!this._controlReleased&&(this._controlReleased=!0,this.removeListener("error",this._tlsError),!0)},TLSSocket.prototype._finishInit=function(){debug("secure established"),this.alpnProtocol=this._handle.getALPNNegotiatedProtocol(),this.servername=this._handle.getServername(),this._secureEstablished=!0,this._tlsOptions.handshakeTimeout>0&&this.setTimeout(0,this._handleTimeout),this.emit("secure")},TLSSocket.prototype._start=function(){this.connecting?this.once("connect",this._start):this._handle&&(debug("start"),this._tlsOptions.requestOCSP&&this._handle.requestOCSP(),this._handle.start())},TLSSocket.prototype.setServername=function(e){if(validateString(e,"name"),this._tlsOptions.isServer)throw new ERR_TLS_SNI_FROM_SERVER;this._handle.setServername(e)},TLSSocket.prototype.setSession=function(e){"string"==typeof e&&(e=Buffer.from(e,"latin1")),this._handle.setSession(e)},TLSSocket.prototype.getPeerCertificate=function(e){return this._handle?common.translatePeerCertificate(this._handle.getPeerCertificate(e)):null},TLSSocket.prototype.getFinished=function(){if(this._handle)return this._handle.getFinished()},TLSSocket.prototype.getPeerFinished=function(){if(this._handle)return this._handle.getPeerFinished()},TLSSocket.prototype.getSession=function(){return this._handle?this._handle.getSession():null},TLSSocket.prototype.isSessionReused=function(){return this._handle?this._handle.isSessionReused():null},TLSSocket.prototype.getCipher=function(e){return this._handle?this._handle.getCurrentCipher():null},TLSSocket.prototype.getEphemeralKeyInfo=function(){return this._handle?this._handle.getEphemeralKeyInfo():null},TLSSocket.prototype.getProtocol=function(){return this._handle?this._handle.getProtocol():null},util.inherits(Server,net.Server),exports.Server=Server,exports.createServer=function(e,t){return new Server(e,t)},Server.prototype._getServerData=function(){return{ticketKeys:this.getTicketKeys().toString("hex")}},Server.prototype._setServerData=function(e){this.setTicketKeys(Buffer.from(e.ticketKeys,"hex"))},Server.prototype.getTicketKeys=function(e){return this._sharedCreds.context.getTicketKeys(e)},Server.prototype.setTicketKeys=function(e){this._sharedCreds.context.setTicketKeys(e)},Server.prototype.setOptions=function(e){this.requestCert=!0===e.requestCert,this.rejectUnauthorized=!1!==e.rejectUnauthorized,e.pfx&&(this.pfx=e.pfx),e.key&&(this.key=e.key),e.passphrase&&(this.passphrase=e.passphrase),e.cert&&(this.cert=e.cert),e.clientCertEngine&&(this.clientCertEngine=e.clientCertEngine),e.ca&&(this.ca=e.ca),e.secureProtocol&&(this.secureProtocol=e.secureProtocol),e.crl&&(this.crl=e.crl),e.ciphers&&(this.ciphers=e.ciphers),void 0!==e.ecdhCurve&&(this.ecdhCurve=e.ecdhCurve),e.dhparam&&(this.dhparam=e.dhparam),e.sessionTimeout&&(this.sessionTimeout=e.sessionTimeout),e.ticketKeys&&(this.ticketKeys=e.ticketKeys);var t=e.secureOptions||0;void 0!==e.honorCipherOrder?this.honorCipherOrder=!!e.honorCipherOrder:this.honorCipherOrder=!0,t&&(this.secureOptions=t),e.ALPNProtocols&&tls.convertALPNProtocols(e.ALPNProtocols,this),e.sessionIdContext?this.sessionIdContext=e.sessionIdContext:this.sessionIdContext=crypto.createHash("sha1").update(process.argv.join(" ")).digest("hex").slice(0,32)},Server.prototype.addContext=function(e,t){if(!e)throw new ERR_TLS_REQUIRED_SERVER_NAME;var s=new RegExp("^"+e.replace(/([.^$+?\-\\[\]{}])/g,"\\$1").replace(/\*/g,"[^.]*")+"$");this._contexts.push([s,tls.createSecureContext(t).context])},exports.connect=function(...e){var t=(e=normalizeConnectArgs(e))[0],s=e[1],n={rejectUnauthorized:"0"!==process.env.NODE_TLS_REJECT_UNAUTHORIZED,ciphers:tls.DEFAULT_CIPHERS,checkServerIdentity:tls.checkServerIdentity,minDHSize:1024};(t=util._extend(n,t||{})).keepAlive||(t.singleUse=!0),assert("function"==typeof t.checkServerIdentity),assert("number"==typeof t.minDHSize,"options.minDHSize is not a number: "+t.minDHSize),assert(t.minDHSize>0,"options.minDHSize is not a positive number: "+t.minDHSize);const r=t.secureContext||tls.createSecureContext(t);var o=new TLSSocket(t.socket,{pipe:!!t.path,secureContext:r,isServer:!1,requestCert:!0,rejectUnauthorized:!1!==t.rejectUnauthorized,session:t.session,ALPNProtocols:t.ALPNProtocols,requestOCSP:t.requestOCSP});if(o[kConnectOptions]=t,s&&o.once("secureConnect",s),!t.socket){const e={path:t.path,port:t.port,host:t.host,family:t.family,localAddress:t.localAddress,lookup:t.lookup};o.connect(e,o._start)}return o._releaseControl(),t.session&&o.setSession(t.session),t.servername&&o.setServername(t.servername),t.socket&&o._start(),o.on("secure",onConnectSecure),o.once("end",onConnectEnd),o};"use strict";const{Buffer}=require("buffer"),{codes:{ERR_AMBIGUOUS_ARGUMENT,ERR_INVALID_ARG_TYPE,ERR_INVALID_RETURN_VALUE}}=require("internal/errors"),{AssertionError}=require("internal/assert"),{openSync,closeSync,readSync}=require("fs"),{inspect,types:{isPromise,isRegExp}}=require("util"),{EOL}=require("internal/constants"),{NativeModule}=require("internal/bootstrap/loaders"),errorCache=new Map;let isDeepEqual,isDeepStrictEqual,parseExpressionAt,findNodeAround,decoder,columnOffset=0;function lazyLoadComparison(){const e=require("internal/util/comparisons");isDeepEqual=e.isDeepEqual,isDeepStrictEqual=e.isDeepStrictEqual}const escapeSequencesRegExp=/[\x00-\x08\x0b\x0c\x0e-\x1f]/g,meta=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","","","\\u000b","\\f","","\\u000e","\\u000f","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001a","\\u001b","\\u001c","\\u001d","\\u001e","\\u001f"],escapeFn=e=>meta[e.charCodeAt(0)];let warned=!1;const assert=module.exports=ok,NO_EXCEPTION_SENTINEL={};function innerFail(e){if(e.message instanceof Error)throw e.message;throw new AssertionError(e)}function fail(e,t,r,s,n){const o=arguments.length;let a;if(0===o?a="Failed":1===o?(r=e,e=void 0):(!1===warned&&(warned=!0,process.emitWarning("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")),2===o&&(s="!=")),r instanceof Error)throw r;const i={actual:e,expected:t,operator:void 0===s?"fail":s,stackStartFn:n||fail};void 0!==r&&(i.message=r);const c=new AssertionError(i);throw a&&(c.message=a,c.generatedMessage=!0),c}function findColumn(e,t,r){if(r.length>t+100)try{return parseCode(r,t)}catch{if(r.length-t>2500)throw null}const s=t-r.length+2500,n=Buffer.allocUnsafe(s),o=readSync(e,n,0,s);return r+=decoder.write(n.slice(0,o)),o<s?parseCode(r,t):findColumn(e,t,r)}function getCode(e,t,r){let s=0;if(0===t)return findColumn(e,r,"");let n=0,o=64;let a=Buffer.allocUnsafe(8192);for(;0!=o--;){a=n<t?a:Buffer.allocUnsafe(8192),s=readSync(e,a,0,8192);for(var i=0;i<s;i++)if(10===a[i]&&++n===t){if(s<8192)return parseCode(a.toString("utf8",i+1,s),r);return findColumn(e,r,decoder.write(a.slice(i+1,s)))}}}function parseCode(e,t){let r;void 0===parseExpressionAt&&(({parseExpressionAt}=require("internal/deps/acorn/dist/acorn")),({findNodeAround}=require("internal/deps/acorn/dist/walk")));let s=0;do{try{s=(r=parseExpressionAt(e,s)).end+1||s,r=findNodeAround(r,t,"CallExpression")}catch(e){if((s+=e.raisedAt||1)>t)throw null}}while(void 0===r||r.node.end<t);return[r.node.start,e.slice(r.node.start,r.node.end).replace(escapeSequencesRegExp,escapeFn)]}function getErrMessage(e,t){const r=Error.stackTraceLimit;Error.stackTraceLimit=1;const s={};Error.captureStackTrace(s,t),Error.stackTraceLimit=r;const n=Error.prepareStackTrace;Error.prepareStackTrace=((e,t)=>t);const o=s.stack[0];Error.prepareStackTrace=n;const a=o.getFileName();if(!a)return e;const i=o.getLineNumber()-1;let c=o.getColumnNumber()-1;if(0===i){if(0===columnOffset){const{wrapper:e}=require("internal/modules/cjs/loader");columnOffset=e[0].length}c-=columnOffset}const u=`${a}${i}${c}`;if(errorCache.has(u))return errorCache.get(u);if(a.endsWith(".js")&&NativeModule.exists(a.slice(0,-3)))return void errorCache.set(u,void 0);let l;try{if(Error.stackTraceLimit=0,void 0===decoder){const{StringDecoder:e}=require("string_decoder");decoder=new e("utf8")}if(l=openSync(a,"r",438),[c,e]=getCode(l,i,c),decoder.end(),-1!==e.indexOf("\n")){"\r\n"===EOL&&(e=e.replace(/\r\n/g,"\n"));const t=e.split("\n");e=t.shift();for(const r of t){let t=0;for(;t<c&&(" "===r[t]||"\t"===r[t]);)t++;e+=`\n  ${r.slice(t)}`}}return e=`The expression evaluated to a falsy value:\n\n  ${e}\n`,errorCache.set(u,e),e}catch{errorCache.set(u,void 0)}finally{Error.stackTraceLimit=r,void 0!==l&&closeSync(l)}}function innerOk(e,t,r,s){if(!r){let n=!1;if(0===t)n=!0,s="No value argument passed to `assert.ok()`";else if(null==s)n=!0,s=getErrMessage(s,e);else if(s instanceof Error)throw s;const o=new AssertionError({actual:r,expected:!0,message:s,operator:"==",stackStartFn:e});throw o.generatedMessage=n,o}}function ok(...e){innerOk(ok,e.length,...e)}function notDeepStrictEqual(e,t,r){void 0===isDeepEqual&&lazyLoadComparison(),isDeepStrictEqual(e,t)&&innerFail({actual:e,expected:t,message:r,operator:"notDeepStrictEqual",stackStartFn:notDeepStrictEqual})}assert.fail=fail,assert.AssertionError=AssertionError,assert.ok=ok,assert.equal=function e(t,r,s){t!=r&&innerFail({actual:t,expected:r,message:s,operator:"==",stackStartFn:e})},assert.notEqual=function e(t,r,s){t==r&&innerFail({actual:t,expected:r,message:s,operator:"!=",stackStartFn:e})},assert.deepEqual=function e(t,r,s){void 0===isDeepEqual&&lazyLoadComparison(),isDeepEqual(t,r)||innerFail({actual:t,expected:r,message:s,operator:"deepEqual",stackStartFn:e})},assert.notDeepEqual=function e(t,r,s){void 0===isDeepEqual&&lazyLoadComparison(),isDeepEqual(t,r)&&innerFail({actual:t,expected:r,message:s,operator:"notDeepEqual",stackStartFn:e})},assert.deepStrictEqual=function e(t,r,s){void 0===isDeepEqual&&lazyLoadComparison(),isDeepStrictEqual(t,r)||innerFail({actual:t,expected:r,message:s,operator:"deepStrictEqual",stackStartFn:e})},assert.notDeepStrictEqual=notDeepStrictEqual,assert.strictEqual=function e(t,r,s){Object.is(t,r)||innerFail({actual:t,expected:r,message:s,operator:"strictEqual",stackStartFn:e})},assert.notStrictEqual=function e(t,r,s){Object.is(t,r)&&innerFail({actual:t,expected:r,message:s,operator:"notStrictEqual",stackStartFn:e})};class Comparison{constructor(e,t,r){for(const s of t)s in e&&(void 0!==r&&"string"==typeof r[s]&&isRegExp(e[s])&&e[s].test(r[s])?this[s]=r[s]:this[s]=e[s])}}function compareExceptionKey(e,t,r,s,n){if(!(r in e&&isDeepStrictEqual(e[r],t[r]))){if(!s){const r=new Comparison(e,n),s=new Comparison(t,n,e),o=new AssertionError({actual:r,expected:s,operator:"deepStrictEqual",stackStartFn:assert.throws});throw o.actual=e,o.expected=t,o.operator="throws",o}innerFail({actual:e,expected:t,message:s,operator:"throws",stackStartFn:assert.throws})}}function expectedException(e,t,r){if("function"!=typeof t){if(isRegExp(t))return t.test(e);if(2===arguments.length)throw new ERR_INVALID_ARG_TYPE("expected",["Function","RegExp"],t);if("object"!=typeof t)return!0;if("object"!=typeof e||null===e){const s=new AssertionError({actual:e,expected:t,message:r,operator:"deepStrictEqual",stackStartFn:assert.throws});throw s.operator="throws",s}const s=Object.keys(t);t instanceof Error&&s.push("name","message"),void 0===isDeepEqual&&lazyLoadComparison();for(const n of s)"string"==typeof e[n]&&isRegExp(t[n])&&t[n].test(e[n])||compareExceptionKey(e,t,n,r,s);return!0}return void 0!==t.prototype&&e instanceof t||!Error.isPrototypeOf(t)&&!0===t.call({},e)}function getActual(e){if("function"!=typeof e)throw new ERR_INVALID_ARG_TYPE("fn","Function",e);try{e()}catch(e){return e}return NO_EXCEPTION_SENTINEL}function checkIsPromise(e){return isPromise(e)||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch}async function waitForActual(e){let t;if("function"==typeof e){if(!checkIsPromise(t=e()))throw new ERR_INVALID_RETURN_VALUE("instance of Promise","promiseFn",t)}else{if(!checkIsPromise(e))throw new ERR_INVALID_ARG_TYPE("promiseFn",["Function","Promise"],e);t=e}try{await t}catch(e){return e}return NO_EXCEPTION_SENTINEL}function expectsError(e,t,r,s){if("string"==typeof r){if(4===arguments.length)throw new ERR_INVALID_ARG_TYPE("error",["Object","Error","Function","RegExp"],r);if("object"==typeof t&&null!==t){if(t.message===r)throw new ERR_AMBIGUOUS_ARGUMENT("error/message",`The error message "${t.message}" is identical to the message.`)}else if(t===r)throw new ERR_AMBIGUOUS_ARGUMENT("error/message",`The error "${t}" is identical to the message.`);s=r,r=void 0}if(t===NO_EXCEPTION_SENTINEL){let t="";r&&r.name&&(t+=` (${r.name})`),t+=s?`: ${s}`:".";const n="rejects"===e.name?"rejection":"exception";innerFail({actual:void 0,expected:r,operator:e.name,message:`Missing expected ${n}${t}`,stackStartFn:e})}if(r&&!1===expectedException(t,r,s))throw t}function expectsNoError(e,t,r,s){if(t!==NO_EXCEPTION_SENTINEL){if("string"==typeof r&&(s=r,r=void 0),!r||expectedException(t,r)){const n=s?`: ${s}`:".",o="doesNotReject"===e.name?"rejection":"exception";innerFail({actual:t,expected:r,operator:e.name,message:`Got unwanted ${o}${n}\n`+`Actual message: "${t&&t.message}"`,stackStartFn:e})}throw t}}function strict(...e){innerOk(strict,e.length,...e)}assert.throws=function e(t,...r){expectsError(e,getActual(t),...r)},assert.rejects=async function e(t,...r){expectsError(e,await waitForActual(t),...r)},assert.doesNotThrow=function e(t,...r){expectsNoError(e,getActual(t),...r)},assert.doesNotReject=async function e(t,...r){expectsNoError(e,await waitForActual(t),...r)},assert.ifError=function e(t){if(null!=t){let s="ifError got unwanted exception: ";"object"==typeof t&&"string"==typeof t.message?0===t.message.length&&t.constructor?s+=t.constructor.name:s+=t.message:s+=inspect(t);const n=new AssertionError({actual:t,expected:null,operator:"ifError",message:s,stackStartFn:e}),o=t.stack;if("string"==typeof o){const e=o.split("\n");e.shift();let t=n.stack.split("\n");for(var r=0;r<e.length;r++){const s=t.indexOf(e[r]);if(-1!==s){t=t.slice(0,s);break}}n.stack=`${t.join("\n")}\n${e.join("\n")}`}throw n}},assert.strict=Object.assign(strict,assert,{equal:assert.strictEqual,deepEqual:assert.deepStrictEqual,notEqual:assert.notStrictEqual,notDeepEqual:assert.notDeepStrictEqual}),assert.strict.strict=assert.strict;"use strict";const{ERR_ASYNC_CALLBACK,ERR_INVALID_ASYNC_ID}=require("internal/errors").codes,{validateString}=require("internal/validators"),internal_async_hooks=require("internal/async_hooks"),{registerDestroyHook}=internal_async_hooks,{executionAsyncId,triggerAsyncId,getHookArrays,enableHooks,disableHooks,newAsyncId,getDefaultTriggerAsyncId,emitInit,emitBefore,emitAfter,emitDestroy}=internal_async_hooks,{async_id_symbol,trigger_async_id_symbol,init_symbol,before_symbol,after_symbol,destroy_symbol,promise_resolve_symbol}=internal_async_hooks.symbols,{kInit,kBefore,kAfter,kDestroy,kTotals,kPromiseResolve}=internal_async_hooks.constants;class AsyncHook{constructor({init:e,before:s,after:t,destroy:o,promiseResolve:r}){if(void 0!==e&&"function"!=typeof e)throw new ERR_ASYNC_CALLBACK("hook.init");if(void 0!==s&&"function"!=typeof s)throw new ERR_ASYNC_CALLBACK("hook.before");if(void 0!==t&&"function"!=typeof t)throw new ERR_ASYNC_CALLBACK("hook.after");if(void 0!==o&&"function"!=typeof o)throw new ERR_ASYNC_CALLBACK("hook.destroy");if(void 0!==r&&"function"!=typeof r)throw new ERR_ASYNC_CALLBACK("hook.promiseResolve");this[init_symbol]=e,this[before_symbol]=s,this[after_symbol]=t,this[destroy_symbol]=o,this[promise_resolve_symbol]=r}enable(){const[e,s]=getHookArrays();if(e.includes(this))return this;const t=s[kTotals];return s[kTotals]=s[kInit]+=+!!this[init_symbol],s[kTotals]+=s[kBefore]+=+!!this[before_symbol],s[kTotals]+=s[kAfter]+=+!!this[after_symbol],s[kTotals]+=s[kDestroy]+=+!!this[destroy_symbol],s[kTotals]+=s[kPromiseResolve]+=+!!this[promise_resolve_symbol],e.push(this),0===t&&s[kTotals]>0&&enableHooks(),this}disable(){const[e,s]=getHookArrays(),t=e.indexOf(this);if(-1===t)return this;const o=s[kTotals];return s[kTotals]=s[kInit]-=+!!this[init_symbol],s[kTotals]+=s[kBefore]-=+!!this[before_symbol],s[kTotals]+=s[kAfter]-=+!!this[after_symbol],s[kTotals]+=s[kDestroy]-=+!!this[destroy_symbol],s[kTotals]+=s[kPromiseResolve]-=+!!this[promise_resolve_symbol],e.splice(t,1),o>0&&0===s[kTotals]&&disableHooks(),this}}function createHook(e){return new AsyncHook(e)}const destroyedSymbol=Symbol("destroyed");let emitBeforeAfterWarning=!0;function showEmitBeforeAfterWarning(){emitBeforeAfterWarning&&(process.emitWarning("asyncResource.emitBefore and emitAfter are deprecated. Please use asyncResource.runInAsyncScope instead","DeprecationWarning","DEP0098"),emitBeforeAfterWarning=!1)}class AsyncResource{constructor(e,s={}){validateString(e,"type"),"number"==typeof s?s={triggerAsyncId:s,requireManualDestroy:!1}:void 0===s.triggerAsyncId&&(s.triggerAsyncId=getDefaultTriggerAsyncId());const t=s.triggerAsyncId;if(!Number.isSafeInteger(t)||t<-1)throw new ERR_INVALID_ASYNC_ID("triggerAsyncId",t);this[async_id_symbol]=newAsyncId(),this[trigger_async_id_symbol]=t,this[destroyedSymbol]={destroyed:!1},emitInit(this[async_id_symbol],e,this[trigger_async_id_symbol],this),s.requireManualDestroy||registerDestroyHook(this,this[async_id_symbol],this[destroyedSymbol])}emitBefore(){return showEmitBeforeAfterWarning(),emitBefore(this[async_id_symbol],this[trigger_async_id_symbol]),this}emitAfter(){return showEmitBeforeAfterWarning(),emitAfter(this[async_id_symbol]),this}runInAsyncScope(e,s,...t){let o;emitBefore(this[async_id_symbol],this[trigger_async_id_symbol]);try{o=Reflect.apply(e,s,t)}finally{emitAfter(this[async_id_symbol])}return o}emitDestroy(){return this[destroyedSymbol].destroyed=!0,emitDestroy(this[async_id_symbol]),this}asyncId(){return this[async_id_symbol]}triggerAsyncId(){return this[trigger_async_id_symbol]}}module.exports={createHook,executionAsyncId,triggerAsyncId,AsyncResource};"use strict";const{byteLengthUtf8,copy:_copy,compare:_compare,compareOffset,createFromString,fill:bindingFill,indexOfBuffer,indexOfNumber,indexOfString,swap16:_swap16,swap32:_swap32,swap64:_swap64,kMaxLength,kStringMaxLength}=process.binding("buffer");let isAnyArrayBuffer;try{isAnyArrayBuffer=internalBinding("types").isAnyArrayBuffer}catch{isAnyArrayBuffer=require("util").types.isAnyArrayBuffer}const{customInspectSymbol,isInsideNodeModules,normalizeEncoding,kIsEncodingSymbol}=require("internal/util"),{isArrayBufferView,isUint8Array}=require("internal/util/types"),{pendingDeprecation}=process.binding("config"),{ERR_BUFFER_OUT_OF_BOUNDS,ERR_INDEX_OUT_OF_RANGE,ERR_INVALID_ARG_TYPE,ERR_INVALID_ARG_VALUE,ERR_INVALID_BUFFER_SIZE,ERR_INVALID_OPT_VALUE,ERR_NO_LONGER_SUPPORTED,ERR_UNKNOWN_ENCODING}=require("internal/errors").codes,{validateString}=require("internal/validators"),internalBuffer=require("internal/buffer"),{setupBufferJS}=internalBuffer,bindingObj={};class FastBuffer extends Uint8Array{}FastBuffer.prototype.constructor=Buffer,internalBuffer.FastBuffer=FastBuffer,Buffer.prototype=FastBuffer.prototype;for(const[e,r]of Object.entries(internalBuffer.readWrites))Buffer.prototype[e]=r;const constants=Object.defineProperties({},{MAX_LENGTH:{value:kMaxLength,writable:!1,enumerable:!0},MAX_STRING_LENGTH:{value:kStringMaxLength,writable:!1,enumerable:!0}});var poolSize,poolOffset,allocPool;Buffer.poolSize=8192,setupBufferJS(Buffer.prototype,bindingObj);const zeroFill=bindingObj.zeroFill||[0];function createUnsafeBuffer(e){return new FastBuffer(createUnsafeArrayBuffer(e))}function createUnsafeArrayBuffer(e){zeroFill[0]=0;try{return new ArrayBuffer(e)}finally{zeroFill[0]=1}}function createPool(){poolSize=Buffer.poolSize,allocPool=createUnsafeArrayBuffer(poolSize),poolOffset=0}function alignPool(){7&poolOffset&&(poolOffset|=7,poolOffset++)}createPool();let bufferWarningAlreadyEmitted=!1,nodeModulesCheckCounter=0;const bufferWarning="Buffer() is deprecated due to security and usability issues. Please use the Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods instead.";function showFlaggedDeprecation(){bufferWarningAlreadyEmitted||++nodeModulesCheckCounter>1e4||!pendingDeprecation&&isInsideNodeModules()||(process.emitWarning(bufferWarning,"DeprecationWarning","DEP0005"),bufferWarningAlreadyEmitted=!0)}function Buffer(e,r,t){if(showFlaggedDeprecation(),"number"==typeof e){if("string"==typeof r)throw new ERR_INVALID_ARG_TYPE("string","string",e);return Buffer.alloc(e)}return Buffer.from(e,r,t)}Object.defineProperty(Buffer,Symbol.species,{enumerable:!1,configurable:!0,get:()=>FastBuffer}),Buffer.from=function(e,r,t){if("string"==typeof e)return fromString(e,r);if(isAnyArrayBuffer(e))return fromArrayBuffer(e,r,t);if(null==e)throw new ERR_INVALID_ARG_TYPE("first argument",["string","Buffer","ArrayBuffer","Array","Array-like Object"],e);if("number"==typeof e)throw new ERR_INVALID_ARG_TYPE("value","not number",e);const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return Buffer.from(n,r,t);var f=fromObject(e);if(f)return f;if("function"==typeof e[Symbol.toPrimitive])return Buffer.from(e[Symbol.toPrimitive]("string"),r,t);throw new ERR_INVALID_ARG_TYPE("first argument",["string","Buffer","ArrayBuffer","Array","Array-like Object"],e)};const of=(...e)=>{const r=createUnsafeBuffer(e.length);for(var t=0;t<e.length;t++)r[t]=e[t];return r};function assertSize(e){let r=null;if("number"!=typeof e?r=new ERR_INVALID_ARG_TYPE("size","number",e):(e<0||e>kMaxLength)&&(r=new ERR_INVALID_OPT_VALUE.RangeError("size",e)),null!==r)throw Error.captureStackTrace(r,assertSize),r}function SlowBuffer(e){return+e!=e&&(e=0),assertSize(+e),createUnsafeBuffer(+e)}function allocate(e){if(e<=0)return new FastBuffer;if(e<Buffer.poolSize>>>1){e>poolSize-poolOffset&&createPool();var r=new FastBuffer(allocPool,poolOffset,e);return poolOffset+=e,alignPool(),r}return createUnsafeBuffer(e)}function fromString(e,r){var t;if("string"!=typeof r||0===r.length){if(0===e.length)return new FastBuffer;r="utf8",t=byteLengthUtf8(e)}else{if(-1===(t=byteLength(e,r,!0)))throw new ERR_UNKNOWN_ENCODING(r);if(0===e.length)return new FastBuffer}if(t>=Buffer.poolSize>>>1)return createFromString(e,r);t>poolSize-poolOffset&&createPool();var n=new FastBuffer(allocPool,poolOffset,t);const f=n.write(e,r);return f!==t&&(n=new FastBuffer(allocPool,poolOffset,f)),poolOffset+=f,alignPool(),n}function fromArrayLike(e){const r=e.length,t=allocate(r);for(var n=0;n<r;n++)t[n]=e[n];return t}function fromArrayBuffer(e,r,t){void 0===r?r=0:(r=+r,Number.isNaN(r)&&(r=0));const n=e.byteLength-r;if(n<0)throw new ERR_BUFFER_OUT_OF_BOUNDS("offset");if(void 0===t)t=n;else if((t=+t)>0){if(t>n)throw new ERR_BUFFER_OUT_OF_BOUNDS("length")}else t=0;return new FastBuffer(e,r,t)}function fromObject(e){if(isUint8Array(e)){const r=allocate(e.length);return 0===r.length?r:(_copy(e,r,0,0,e.length),r)}return void 0!==e.length||isAnyArrayBuffer(e.buffer)?"number"!=typeof e.length?new FastBuffer:fromArrayLike(e):"Buffer"===e.type&&Array.isArray(e.data)?fromArrayLike(e.data):void 0}function base64ByteLength(e,r){return 61===e.charCodeAt(r-1)&&r--,r>1&&61===e.charCodeAt(r-1)&&r--,3*r>>>2}function byteLength(e,r){if("string"!=typeof e){if(isArrayBufferView(e)||isAnyArrayBuffer(e))return e.byteLength;throw new ERR_INVALID_ARG_TYPE("string",["string","Buffer","ArrayBuffer"],e)}const t=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===t)return 0;if(!r)return n?-1:byteLengthUtf8(e);switch((r+="").length){case 4:if("utf8"===r)return byteLengthUtf8(e);if("ucs2"===r)return 2*t;if("utf8"===(r=r.toLowerCase()))return byteLengthUtf8(e);if("ucs2"===r)return 2*t;break;case 5:if("utf-8"===r)return byteLengthUtf8(e);if("ascii"===r)return t;if("ucs-2"===r)return 2*t;if("utf-8"===(r=r.toLowerCase()))return byteLengthUtf8(e);if("ascii"===r)return t;if("ucs-2"===r)return 2*t;break;case 7:if("utf16le"===r||"utf16le"===r.toLowerCase())return 2*t;break;case 8:if("utf-16le"===r||"utf-16le"===r.toLowerCase())return 2*t;break;case 6:if("latin1"===r||"binary"===r)return t;if("base64"===r)return base64ByteLength(e,t);if("latin1"===(r=r.toLowerCase())||"binary"===r)return t;if("base64"===r)return base64ByteLength(e,t);break;case 3:if("hex"===r||"hex"===r.toLowerCase())return t>>>1}return n?-1:byteLengthUtf8(e)}function stringSlice(e,r,t,n){if(void 0===r)return e.utf8Slice(t,n);switch((r+="").length){case 4:if("utf8"===r)return e.utf8Slice(t,n);if("ucs2"===r)return e.ucs2Slice(t,n);if("utf8"===(r=r.toLowerCase()))return e.utf8Slice(t,n);if("ucs2"===r)return e.ucs2Slice(t,n);break;case 5:if("utf-8"===r)return e.utf8Slice(t,n);if("ascii"===r)return e.asciiSlice(t,n);if("ucs-2"===r)return e.ucs2Slice(t,n);if("utf-8"===(r=r.toLowerCase()))return e.utf8Slice(t,n);if("ascii"===r)return e.asciiSlice(t,n);if("ucs-2"===r)return e.ucs2Slice(t,n);break;case 6:if("latin1"===r||"binary"===r)return e.latin1Slice(t,n);if("base64"===r)return e.base64Slice(t,n);if("latin1"===(r=r.toLowerCase())||"binary"===r)return e.latin1Slice(t,n);if("base64"===r)return e.base64Slice(t,n);break;case 3:if("hex"===r||"hex"===r.toLowerCase())return e.hexSlice(t,n);break;case 7:if("utf16le"===r||"utf16le"===r.toLowerCase())return e.ucs2Slice(t,n);break;case 8:if("utf-16le"===r||"utf-16le"===r.toLowerCase())return e.ucs2Slice(t,n)}throw new ERR_UNKNOWN_ENCODING(r)}function bidirectionalIndexOf(e,r,t,n,f){if("string"==typeof t?(n=t,t=void 0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,Number.isNaN(t)&&(t=f?0:e.length),f=!!f,"string"==typeof r)return void 0===n?indexOfString(e,r,t,n,f):slowIndexOf(e,r,t,n,f);if(isUint8Array(r))return indexOfBuffer(e,r,t,n,f);if("number"==typeof r)return indexOfNumber(e,r>>>0,t,f);throw new ERR_INVALID_ARG_TYPE("value",["string","Buffer","Uint8Array"],r)}function slowIndexOf(e,r,t,n,f){for(var i=!1;;)switch(n){case"utf8":case"utf-8":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"latin1":case"binary":return indexOfString(e,r,t,n,f);case"base64":case"ascii":case"hex":return indexOfBuffer(e,Buffer.from(r,n),t,n,f);default:if(i)throw new ERR_UNKNOWN_ENCODING(n);n=(""+n).toLowerCase(),i=!0}}function _fill(e,r,t,n,f){if("string"==typeof r){void 0===t||"string"==typeof t?(f=t,t=0,n=e.length):"string"==typeof n&&(f=n,n=e.length);const i=normalizeEncoding(f);if(void 0===i)throw validateString(f,"encoding"),new ERR_UNKNOWN_ENCODING(f);if(0===r.length)r=0;else if(1===r.length)if("utf8"===i){const e=r.charCodeAt(0);e<128&&(r=e)}else"latin1"===i&&(r=r.charCodeAt(0))}else f=void 0;if(void 0===t)t=0,n=e.length;else{if(void 0===n){if(t<0)throw new ERR_INDEX_OUT_OF_RANGE;n=e.length}else{if(t<0||n>e.length||n<0)throw new ERR_INDEX_OUT_OF_RANGE;n>>>=0}if((t>>>=0)>=n)return e}const i=bindingFill(e,r,t,n,f);if(i<0){if(-1===i)throw new ERR_INVALID_ARG_VALUE("value",r);throw new ERR_INDEX_OUT_OF_RANGE}return e}function adjustOffset(e,r){return 0===(e=Math.trunc(e))?0:e<0?(e+=r)>0?e:0:e<r?e:Number.isNaN(e)?0:r}function swap(e,r,t){const n=e[r];e[r]=e[t],e[t]=n}let transcode;if(Buffer.of=of,Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(e,r,t){if(assertSize(e),void 0!==r&&0!==r&&e>0){const n=createUnsafeBuffer(e);return _fill(n,r,0,n.length,t)}return new FastBuffer(e)},Buffer.allocUnsafe=function(e){return assertSize(e),allocate(e)},Buffer.allocUnsafeSlow=function(e){return assertSize(e),createUnsafeBuffer(e)},Object.setPrototypeOf(SlowBuffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(SlowBuffer,Uint8Array),Buffer.isBuffer=function(e){return e instanceof Buffer},Buffer.compare=function(e,r){if(!isUint8Array(e))throw new ERR_INVALID_ARG_TYPE("buf1",["Buffer","Uint8Array"],e);if(!isUint8Array(r))throw new ERR_INVALID_ARG_TYPE("buf2",["Buffer","Uint8Array"],r);return e===r?0:_compare(e,r)},Buffer.isEncoding=function(e){return"string"==typeof e&&0!==e.length&&void 0!==normalizeEncoding(e)},Buffer[kIsEncodingSymbol]=Buffer.isEncoding,Buffer.concat=function(e,r){var t;if(!Array.isArray(e))throw new ERR_INVALID_ARG_TYPE("list",["Array","Buffer","Uint8Array"],e);if(0===e.length)return new FastBuffer;if(void 0===r)for(r=0,t=0;t<e.length;t++)r+=e[t].length;else r>>>=0;var n=Buffer.allocUnsafe(r),f=0;for(t=0;t<e.length;t++){var i=e[t];if(!isUint8Array(i))throw new ERR_INVALID_ARG_TYPE(`list[${t}]`,["Array","Buffer","Uint8Array"],e[t]);_copy(i,n,f),f+=i.length}return f<r&&n.fill(0,f,r),n},Buffer.byteLength=byteLength,Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get(){if(this instanceof Buffer)return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get(){if(this instanceof Buffer)return this.byteOffset}}),Buffer.prototype.copy=function(e,r,t,n){return _copy(this,e,r,t,n)},Buffer.prototype.toString=function(e,r,t){if(0===arguments.length)return this.utf8Slice(0,this.length);const n=this.length;if(0===n)return"";if(!r||r<0)r=0;else if(r>=n)return"";if(void 0===t||t>n)t=n;else if(t<=0)return"";return(t|=0)<=(r|=0)?"":stringSlice(this,e,r,t)},Buffer.prototype.equals=function(e){if(!isUint8Array(e))throw new ERR_INVALID_ARG_TYPE("otherBuffer",["Buffer","Uint8Array"],e);return this===e||0===_compare(this,e)},Buffer.prototype[customInspectSymbol]=function(){var e="",r=exports.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),`<${this.constructor.name} ${e}>`},Buffer.prototype.inspect=Buffer.prototype[customInspectSymbol],Buffer.prototype.compare=function(e,r,t,n,f){if(!isUint8Array(e))throw new ERR_INVALID_ARG_TYPE("target",["Buffer","Uint8Array"],e);if(1===arguments.length)return _compare(this,e);if(void 0===r)r=0;else{if(r<0)throw new ERR_INDEX_OUT_OF_RANGE;r>>>=0}if(void 0===t)t=e.length;else{if(t>e.length)throw new ERR_INDEX_OUT_OF_RANGE;t>>>=0}if(void 0===n)n=0;else{if(n<0)throw new ERR_INDEX_OUT_OF_RANGE;n>>>=0}if(void 0===f)f=this.length;else{if(f>this.length)throw new ERR_INDEX_OUT_OF_RANGE;f>>>=0}return n>=f?r>=t?0:-1:r>=t?1:compareOffset(this,e,r,n,t,f)},Buffer.prototype.indexOf=function(e,r,t){return bidirectionalIndexOf(this,e,r,t,!0)},Buffer.prototype.lastIndexOf=function(e,r,t){return bidirectionalIndexOf(this,e,r,t,!1)},Buffer.prototype.includes=function(e,r,t){return-1!==this.indexOf(e,r,t)},Buffer.prototype.fill=function(e,r,t,n){return _fill(this,e,r,t,n)},Buffer.prototype.write=function(e,r,t,n){if(void 0===r)return this.utf8Write(e,0,this.length);if(void 0===t&&"string"==typeof r)n=r,t=this.length,r=0;else{if(!isFinite(r))throw new ERR_NO_LONGER_SUPPORTED("Buffer.write(string, encoding, offset[, length])");r>>>=0,isFinite(t)?t>>>=0:(n=t,t=void 0);var f=this.length-r;if((void 0===t||t>f)&&(t=f),e.length>0&&(t<0||r<0))throw new ERR_BUFFER_OUT_OF_BOUNDS}if(!n)return this.utf8Write(e,r,t);switch((n+="").length){case 4:if("utf8"===n)return this.utf8Write(e,r,t);if("ucs2"===n)return this.ucs2Write(e,r,t);if("utf8"===(n=n.toLowerCase()))return this.utf8Write(e,r,t);if("ucs2"===n)return this.ucs2Write(e,r,t);break;case 5:if("utf-8"===n)return this.utf8Write(e,r,t);if("ascii"===n)return this.asciiWrite(e,r,t);if("ucs-2"===n)return this.ucs2Write(e,r,t);if("utf-8"===(n=n.toLowerCase()))return this.utf8Write(e,r,t);if("ascii"===n)return this.asciiWrite(e,r,t);if("ucs-2"===n)return this.ucs2Write(e,r,t);break;case 7:if("utf16le"===n||"utf16le"===n.toLowerCase())return this.ucs2Write(e,r,t);break;case 8:if("utf-16le"===n||"utf-16le"===n.toLowerCase())return this.ucs2Write(e,r,t);break;case 6:if("latin1"===n||"binary"===n)return this.latin1Write(e,r,t);if("base64"===n)return this.base64Write(e,r,t);if("latin1"===(n=n.toLowerCase())||"binary"===n)return this.latin1Write(e,r,t);if("base64"===n)return this.base64Write(e,r,t);break;case 3:if("hex"===n||"hex"===n.toLowerCase())return this.hexWrite(e,r,t)}throw new ERR_UNKNOWN_ENCODING(n)},Buffer.prototype.toJSON=function(){if(this.length>0){const r=new Array(this.length);for(var e=0;e<this.length;++e)r[e]=this[e];return{type:"Buffer",data:r}}return{type:"Buffer",data:[]}},Buffer.prototype.slice=function(e,r){const t=this.length;e=adjustOffset(e,t);const n=(r=void 0!==r?adjustOffset(r,t):t)>e?r-e:0;return new FastBuffer(this.buffer,this.byteOffset+e,n)},Buffer.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new ERR_INVALID_BUFFER_SIZE("16-bits");if(e<128){for(var r=0;r<e;r+=2)swap(this,r,r+1);return this}return _swap16(this)},Buffer.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new ERR_INVALID_BUFFER_SIZE("32-bits");if(e<192){for(var r=0;r<e;r+=4)swap(this,r,r+3),swap(this,r+1,r+2);return this}return _swap32(this)},Buffer.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new ERR_INVALID_BUFFER_SIZE("64-bits");if(e<192){for(var r=0;r<e;r+=8)swap(this,r,r+7),swap(this,r+1,r+6),swap(this,r+2,r+5),swap(this,r+3,r+4);return this}return _swap64(this)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,process.binding("config").hasIntl){const{icuErrName:e,transcode:r}=process.binding("icu");transcode=function(t,n,f){if(!isUint8Array(t))throw new ERR_INVALID_ARG_TYPE("source",["Buffer","Uint8Array"],t);if(0===t.length)return Buffer.alloc(0);n=normalizeEncoding(n)||n,f=normalizeEncoding(f)||f;const i=r(t,n,f);if("number"!=typeof i)return i;const o=e(i),u=new Error(`Unable to transcode Buffer [${o}]`);throw u.code=o,u.errno=i,u}}module.exports=exports={Buffer,SlowBuffer,transcode,INSPECT_MAX_BYTES:50,kMaxLength,kStringMaxLength},Object.defineProperty(exports,"constants",{configurable:!1,enumerable:!0,value:constants});"use strict";const util=require("util"),{deprecate,convertToValidSignal,getSystemErrorName}=require("internal/util"),{isArrayBufferView}=require("internal/util/types"),debug=util.debuglog("child_process"),{Buffer}=require("buffer"),{Pipe,constants:PipeConstants}=internalBinding("pipe_wrap"),{ERR_INVALID_ARG_VALUE,ERR_CHILD_PROCESS_IPC_REQUIRED,ERR_CHILD_PROCESS_STDIO_MAXBUFFER,ERR_INVALID_ARG_TYPE,ERR_INVALID_OPT_VALUE,ERR_OUT_OF_RANGE}=require("internal/errors").codes,{validateString,isInt32}=require("internal/validators"),child_process=require("internal/child_process"),{_validateStdio,setupChannel,ChildProcess}=child_process;function stdioStringToArray(e){switch(e){case"ignore":case"pipe":case"inherit":return[e,e,e,"ipc"];default:throw new ERR_INVALID_OPT_VALUE("stdio",e)}}function normalizeExecArgs(e,t,n){return"function"==typeof t&&(n=t,t=void 0),(t=Object.assign({},t)).shell="string"!=typeof t.shell||t.shell,{file:e,options:t,callback:n}}exports.ChildProcess=ChildProcess,exports.fork=function(e){var t,n={},i=[],r=1;if(r<arguments.length&&Array.isArray(arguments[r])&&(i=arguments[r++]),r<arguments.length&&(void 0===arguments[r]||null===arguments[r])&&r++,r<arguments.length&&null!=arguments[r]){if("object"!=typeof arguments[r])throw new ERR_INVALID_ARG_VALUE(`arguments[${r}]`,arguments[r]);n=util._extend({},arguments[r++])}if((t=n.execArgv||process.execArgv)===process.execArgv&&null!=process._eval){const e=t.lastIndexOf(process._eval);e>0&&(t=t.slice()).splice(e-1,2)}if(i=t.concat([e],i),"string"==typeof n.stdio)n.stdio=stdioStringToArray(n.stdio);else if(Array.isArray(n.stdio)){if(-1===n.stdio.indexOf("ipc"))throw new ERR_CHILD_PROCESS_IPC_REQUIRED("options.stdio")}else n.stdio=n.silent?stdioStringToArray("pipe"):stdioStringToArray("inherit");return n.execPath=n.execPath||process.execPath,n.shell=!1,spawn(n.execPath,i,n)},exports._forkChild=function(e){var t=new Pipe(PipeConstants.IPC);t.open(e),t.unref();const n=setupChannel(process,t);process.on("newListener",function(e){"message"!==e&&"disconnect"!==e||n.ref()}),process.on("removeListener",function(e){"message"!==e&&"disconnect"!==e||n.unref()})},exports.exec=function(){const e=normalizeExecArgs.apply(null,arguments);return exports.execFile(e.file,e.options,e.callback)};const customPromiseExecFunction=e=>(...t)=>new Promise((n,i)=>{e(...t,(e,t,r)=>{null!==e?(e.stdout=t,e.stderr=r,i(e)):n({stdout:t,stderr:r})})});Object.defineProperty(exports.exec,util.promisify.custom,{enumerable:!1,value:customPromiseExecFunction(exports.exec)}),exports.execFile=function(e){var t,n=[],i={encoding:"utf8",timeout:0,maxBuffer:204800,killSignal:"SIGTERM",cwd:null,env:null,shell:!1},r=1;if(r<arguments.length&&Array.isArray(arguments[r])?n=arguments[r++]:r<arguments.length&&null==arguments[r]&&r++,r<arguments.length&&"object"==typeof arguments[r]?util._extend(i,arguments[r++]):r<arguments.length&&null==arguments[r]&&r++,r<arguments.length&&"function"==typeof arguments[r]&&(t=arguments[r++]),!t&&r<arguments.length&&null!=arguments[r])throw new ERR_INVALID_ARG_VALUE("args",arguments[r]);validateTimeout(i.timeout),validateMaxBuffer(i.maxBuffer),i.killSignal=sanitizeKillSignal(i.killSignal);var o,s=spawn(e,n,{cwd:i.cwd,env:i.env,gid:i.gid,uid:i.uid,shell:i.shell,windowsHide:!!i.windowsHide,windowsVerbatimArguments:!!i.windowsVerbatimArguments}),l=[],a=[];o="buffer"!==i.encoding&&Buffer.isEncoding(i.encoding)?i.encoding:null;var d,c=0,u=0,p=!1,f=!1,_=null,g=e;function w(e,i){var r,c;f||(f=!0,d&&(clearTimeout(d),d=null),t&&(r=o||s.stdout&&s.stdout._readableState&&s.stdout._readableState.encoding?l.join(""):Buffer.concat(l),c=o||s.stderr&&s.stderr._readableState&&s.stderr._readableState.encoding?a.join(""):Buffer.concat(a),_||0!==e||null!==i?(0!==n.length&&(g+=` ${n.join(" ")}`),_||((_=new Error("Command failed: "+g+"\n"+c)).killed=s.killed||p,_.code=e<0?getSystemErrorName(e):e,_.signal=i),_.cmd=g,t(_,r,c)):t(null,r,c)))}function R(){s.stdout&&s.stdout.destroy(),s.stderr&&s.stderr.destroy(),p=!0;try{s.kill(i.killSignal)}catch(e){_=e,w()}}return i.timeout>0&&(d=setTimeout(function(){R(),d=null},i.timeout)),s.stdout&&(o&&s.stdout.setEncoding(o),s.stdout.on("data",function(e){var t=s.stdout._readableState.encoding;(c+=t?Buffer.byteLength(e,t):e.length)>i.maxBuffer?(_=new ERR_CHILD_PROCESS_STDIO_MAXBUFFER("stdout"),R()):l.push(e)})),s.stderr&&(o&&s.stderr.setEncoding(o),s.stderr.on("data",function(e){var t=s.stderr._readableState.encoding;(u+=t?Buffer.byteLength(e,t):e.length)>i.maxBuffer?(_=new ERR_CHILD_PROCESS_STDIO_MAXBUFFER("stderr"),R()):a.push(e)})),s.addListener("close",w),s.addListener("error",function(e){_=e,s.stdout&&s.stdout.destroy(),s.stderr&&s.stderr.destroy(),w()}),s},Object.defineProperty(exports.execFile,util.promisify.custom,{enumerable:!1,value:customPromiseExecFunction(exports.execFile)});const _deprecatedCustomFds=deprecate(function(e){e.stdio=e.customFds.map(function(e){return-1===e?"pipe":e})},"child_process: options.customFds option is deprecated. Use options.stdio instead.","DEP0006");function _convertCustomFds(e){e.customFds&&!e.stdio&&_deprecatedCustomFds(e)}function normalizeSpawnArguments(e,t,n){if(validateString(e,"file"),0===e.length)throw new ERR_INVALID_ARG_VALUE("file",e,"cannot be empty");if(Array.isArray(t))t=t.slice(0);else{if(void 0!==t&&(null===t||"object"!=typeof t))throw new ERR_INVALID_ARG_TYPE("args","object",t);n=t,t=[]}if(void 0===n)n={};else if(null===n||"object"!=typeof n)throw new ERR_INVALID_ARG_TYPE("options","object",n);if(null!=n.cwd&&"string"!=typeof n.cwd)throw new ERR_INVALID_ARG_TYPE("options.cwd","string",n.cwd);if(null!=n.detached&&"boolean"!=typeof n.detached)throw new ERR_INVALID_ARG_TYPE("options.detached","boolean",n.detached);if(null!=n.uid&&!isInt32(n.uid))throw new ERR_INVALID_ARG_TYPE("options.uid","int32",n.uid);if(null!=n.gid&&!isInt32(n.gid))throw new ERR_INVALID_ARG_TYPE("options.gid","int32",n.gid);if(null!=n.shell&&"boolean"!=typeof n.shell&&"string"!=typeof n.shell)throw new ERR_INVALID_ARG_TYPE("options.shell",["boolean","string"],n.shell);if(null!=n.argv0&&"string"!=typeof n.argv0)throw new ERR_INVALID_ARG_TYPE("options.argv0","string",n.argv0);if(null!=n.windowsHide&&"boolean"!=typeof n.windowsHide)throw new ERR_INVALID_ARG_TYPE("options.windowsHide","boolean",n.windowsHide);if(null!=n.windowsVerbatimArguments&&"boolean"!=typeof n.windowsVerbatimArguments)throw new ERR_INVALID_ARG_TYPE("options.windowsVerbatimArguments","boolean",n.windowsVerbatimArguments);if((n=Object.assign({},n)).shell){const i=[e].concat(t).join(" ");"win32"===process.platform?(e="string"==typeof n.shell?n.shell:process.env.comspec||"cmd.exe",t=["/d","/s","/c",`"${i}"`],n.windowsVerbatimArguments=!0):(e="string"==typeof n.shell?n.shell:"android"===process.platform?"/system/bin/sh":"/bin/sh",t=["-c",i])}"string"==typeof n.argv0?t.unshift(n.argv0):t.unshift(e);var i=n.env||process.env,r=[];for(var o in process.env.NODE_V8_COVERAGE&&!Object.prototype.hasOwnProperty.call(n.env||{},"NODE_V8_COVERAGE")&&(i.NODE_V8_COVERAGE=process.env.NODE_V8_COVERAGE),i){const e=i[o];void 0!==e&&r.push(`${o}=${e}`)}return _convertCustomFds(n),{file:e,args:t,options:n,envPairs:r}}var spawn=exports.spawn=function(){var e=normalizeSpawnArguments.apply(null,arguments),t=e.options,n=new ChildProcess;return debug("spawn",e.args,t),n.spawn({file:e.file,args:e.args,cwd:t.cwd,windowsHide:!!t.windowsHide,windowsVerbatimArguments:!!t.windowsVerbatimArguments,detached:!!t.detached,envPairs:e.envPairs,stdio:t.stdio,uid:t.uid,gid:t.gid}),n};function spawnSync(){var e=normalizeSpawnArguments.apply(null,arguments),t=e.options;(debug("spawnSync",e.args,t),validateTimeout(t.timeout),validateMaxBuffer(t.maxBuffer),t.file=e.file,t.args=e.args,t.envPairs=e.envPairs,t.killSignal=sanitizeKillSignal(t.killSignal),t.stdio=_validateStdio(t.stdio||"pipe",!0).stdio,t.input)&&((t.stdio[0]=util._extend({},t.stdio[0])).input=t.input);for(var n=0;n<t.stdio.length;n++){var i=t.stdio[n]&&t.stdio[n].input;if(null!=i){var r=t.stdio[n]=util._extend({},t.stdio[n]);if(isArrayBufferView(i))r.input=i;else{if("string"!=typeof i)throw new ERR_INVALID_ARG_TYPE(`options.stdio[${n}]`,["Buffer","TypedArray","DataView","string"],i);r.input=Buffer.from(i,t.encoding)}}}return child_process.spawnSync(e)}function checkExecSyncError(e,t,n){var i;if(e.error)i=e.error;else if(0!==e.status){var r="Command failed: ";r+=n||t.join(" "),e.stderr&&e.stderr.length>0&&(r+=`\n${e.stderr.toString()}`),i=new Error(r)}return i&&Object.assign(i,e),i}function execFileSync(){var e=normalizeSpawnArguments.apply(null,arguments),t=!e.options.stdio,n=spawnSync(e.file,e.args.slice(1),e.options);t&&n.stderr&&process.stderr.write(n.stderr);var i=checkExecSyncError(n,e.args,void 0);if(i)throw i;return n.stdout}function execSync(e){var t=normalizeExecArgs.apply(null,arguments),n=!t.options.stdio,i=spawnSync(t.file,t.options);n&&i.stderr&&process.stderr.write(i.stderr);var r=checkExecSyncError(i,t.args,e);if(r)throw r;return i.stdout}function validateTimeout(e){if(null!=e&&!(Number.isInteger(e)&&e>=0))throw new ERR_OUT_OF_RANGE("timeout","an unsigned integer",e)}function validateMaxBuffer(e){if(null!=e&&!("number"==typeof e&&e>=0))throw new ERR_OUT_OF_RANGE("options.maxBuffer","a positive number",e)}function sanitizeKillSignal(e){if("string"==typeof e||"number"==typeof e)return convertToValidSignal(e);if(null!=e)throw new ERR_INVALID_ARG_TYPE("options.killSignal",["string","number"],e)}exports.spawnSync=spawnSync,exports.execFileSync=execFileSync,exports.execSync=execSync;"use strict";const childOrMaster="NODE_UNIQUE_ID"in process.env?"child":"master";module.exports=require(`internal/cluster/${childOrMaster}`);"use strict";const{isStackOverflowError,codes:{ERR_CONSOLE_WRITABLE_STREAM,ERR_INVALID_ARG_TYPE,ERR_INVALID_ARG_VALUE}}=require("internal/errors"),{previewEntries}=internalBinding("util"),{Buffer:{isBuffer}}=require("buffer"),util=require("util"),{isTypedArray,isSet,isMap,isSetIterator,isMapIterator}=util.types,kCounts=Symbol("counts"),{keys:ObjectKeys,values:ObjectValues}=Object,hasOwnProperty=Function.call.bind(Object.prototype.hasOwnProperty),{isArray:ArrayIsArray,from:ArrayFrom}=Array;let cliTable;const kGroupIndent=Symbol("kGroupIndent"),kFormatForStderr=Symbol("kFormatForStderr"),kFormatForStdout=Symbol("kFormatForStdout"),kGetInspectOptions=Symbol("kGetInspectOptions"),kColorMode=Symbol("kColorMode");function Console(t){if(!(this instanceof Console))return new Console(...arguments);t&&"function"!=typeof t.write||(t={stdout:t,stderr:arguments[1],ignoreErrors:arguments[2]});const{stdout:e,stderr:o=e,ignoreErrors:r=!0,colorMode:s="auto"}=t;if(!e||"function"!=typeof e.write)throw new ERR_CONSOLE_WRITABLE_STREAM("stdout");if(!o||"function"!=typeof o.write)throw new ERR_CONSOLE_WRITABLE_STREAM("stderr");var n={writable:!0,enumerable:!1,configurable:!0};if(n.value=e,Object.defineProperty(this,"_stdout",n),n.value=o,Object.defineProperty(this,"_stderr",n),n.value=Boolean(r),Object.defineProperty(this,"_ignoreErrors",n),n.value=new Map,Object.defineProperty(this,"_times",n),n.value=createWriteErrorHandler(e),Object.defineProperty(this,"_stdoutErrorHandler",n),n.value=createWriteErrorHandler(o),Object.defineProperty(this,"_stderrErrorHandler",n),"boolean"!=typeof s&&"auto"!==s)throw new ERR_INVALID_ARG_VALUE("colorMode",s);this[kCounts]=new Map,this[kColorMode]=s,Object.defineProperty(this,kGroupIndent,{writable:!0}),this[kGroupIndent]="";for(var i=Object.keys(Console.prototype),l=0;l<i.length;l++){var p=i[l];this[p]=this[p].bind(this)}}function createWriteErrorHandler(t){return e=>{null===e||t._writableState.errorEmitted||0===t.listenerCount("error")&&t.on("error",noop)}}function write(t,e,o,r,s){if(0!==s.length&&(-1!==o.indexOf("\n")&&(o=o.replace(/\n/g,`\n${s}`)),o=s+o),o+="\n",!1===t)return e.write(o);try{e.once("error",noop),e.write(o,r)}catch(t){if(isStackOverflowError(t))throw t}finally{e.removeListener("error",noop)}}const kColorInspectOptions={colors:!0},kNoColorInspectOptions={};function timeLogImpl(t,e,o="default",r){const s=t._times.get(o);if(!s)return process.emitWarning(`No such label '${o}' for console.${e}()`),!0;const n=process.hrtime(s),i=1e3*n[0]+n[1]/1e6;return void 0===r?t.log("%s: %sms",o,i.toFixed(3)):t.log("%s: %sms",o,i.toFixed(3),...r),!1}Console.prototype[kGetInspectOptions]=function(t){let e=this[kColorMode];return"auto"===e&&(e=t.isTTY&&("function"!=typeof t.getColorDepth||t.getColorDepth()>2)),e?kColorInspectOptions:kNoColorInspectOptions},Console.prototype[kFormatForStdout]=function(t){const e=this[kGetInspectOptions](this._stdout);return util.formatWithOptions(e,...t)},Console.prototype[kFormatForStderr]=function(t){const e=this[kGetInspectOptions](this._stderr);return util.formatWithOptions(e,...t)},Console.prototype.log=function(...t){write(this._ignoreErrors,this._stdout,this[kFormatForStdout](t),this._stdoutErrorHandler,this[kGroupIndent])},Console.prototype.debug=Console.prototype.log,Console.prototype.info=Console.prototype.log,Console.prototype.dirxml=Console.prototype.log,Console.prototype.warn=function(...t){write(this._ignoreErrors,this._stderr,this[kFormatForStderr](t),this._stderrErrorHandler,this[kGroupIndent])},Console.prototype.error=Console.prototype.warn,Console.prototype.dir=function(t,e){e=Object.assign({customInspect:!1},this[kGetInspectOptions](this._stdout),e),write(this._ignoreErrors,this._stdout,util.inspect(t,e),this._stdoutErrorHandler,this[kGroupIndent])},Console.prototype.time=function(t="default"){t=`${t}`,this._times.set(t,process.hrtime())},Console.prototype.timeEnd=function(t="default"){timeLogImpl(this,"timeEnd",t=`${t}`)||this._times.delete(t)},Console.prototype.timeLog=function(t,...e){timeLogImpl(this,"timeLog",t=`${t}`,e)},Console.prototype.trace=function t(...e){const o={name:"Trace",message:this[kFormatForStderr](e)};Error.captureStackTrace(o,t),this.error(o.stack)},Console.prototype.assert=function(t,...e){t||(e[0]=`Assertion failed${0===e.length?"":`: ${e[0]}`}`,this.warn(this[kFormatForStderr](e)))},Console.prototype.clear=function(){if(this._stdout.isTTY){const{cursorTo:t,clearScreenDown:e}=require("readline");t(this._stdout,0,0),e(this._stdout)}},Console.prototype.count=function(t="default"){t=`${t}`;const e=this[kCounts];let o=e.get(t);void 0===o?o=1:o++,e.set(t,o),this.log(`${t}: ${o}`)},Console.prototype.countReset=function(t="default"){this[kCounts].delete(`${t}`)},Console.prototype.group=function(...t){t.length>0&&this.log(...t),this[kGroupIndent]+="  "},Console.prototype.groupCollapsed=Console.prototype.group,Console.prototype.groupEnd=function(){this[kGroupIndent]=this[kGroupIndent].slice(0,this[kGroupIndent].length-2)};const keyKey="Key",valuesKey="Values",indexKey="(index)",iterKey="(iteration index)",isArray=t=>ArrayIsArray(t)||isTypedArray(t)||isBuffer(t);function noop(){}Console.prototype.table=function(t,e){if(void 0!==e&&!ArrayIsArray(e))throw new ERR_INVALID_ARG_TYPE("properties","Array",e);if(null===t||"object"!=typeof t)return this.log(t);void 0===cliTable&&(cliTable=require("internal/cli_table"));const o=(t,e)=>this.log(cliTable(t,e)),r=t=>{const e={depth:0,maxArrayLength:3};return null!==t&&"object"==typeof t&&!isArray(t)&&ObjectKeys(t).length>2&&(e.depth=-1),Object.assign(e,this[kGetInspectOptions](this._stdout)),util.inspect(t,e)},s=t=>ArrayFrom({length:t},(t,e)=>r(e)),n=isMapIterator(t);let i=!1,l=0;if(n){const e=previewEntries(t,!0);t=e[0],i=e[1]}if(i||isMap(t)){const e=[],i=[];let p=0;if(n)for(;l<t.length/2;++l)e.push(r(t[2*l])),i.push(r(t[2*l+1])),p++;else for(const[o,s]of t)e.push(r(o)),i.push(r(s)),p++;return o([iterKey,"Key","Values"],[s(p),e,i])}const p=isSetIterator(t);p&&(t=previewEntries(t));const u=p||n&&!i||isSet(t);if(u){const e=[];let n=0;for(const o of t)e.push(r(o)),n++;return o([u?iterKey:indexKey,"Values"],[s(n),e])}const c={};let a=!1;const d=[],f=ObjectKeys(t);for(;l<f.length;l++){const o=t[f[l]],s=null===o||"function"!=typeof o&&"object"!=typeof o;if(void 0===e&&s)a=!0,d[l]=r(o);else{const t=e||ObjectKeys(o);for(const n of t)void 0===c[n]&&(c[n]=[]),s&&e||!hasOwnProperty(o,n)?c[n][l]="":c[n][l]=null==o?o:r(o[n])}}const h=ObjectKeys(c),y=ObjectValues(c);return a&&(h.push("Values"),y.push(d)),h.unshift(indexKey),y.unshift(f),o(h,y)},module.exports=new Console({stdout:process.stdout,stderr:process.stderr}),module.exports.Console=Console;"use strict";const constants=process.binding("constants");Object.assign(exports,constants.os.dlopen,constants.os.errno,constants.os.priority,constants.os.signals,constants.fs,constants.crypto);"use strict";const{assertCrypto,deprecate}=require("internal/util");assertCrypto();const{ERR_CRYPTO_FIPS_FORCED,ERR_CRYPTO_FIPS_UNAVAILABLE}=require("internal/errors").codes,constants=internalBinding("constants").crypto,{fipsMode,fipsForced}=process.binding("config"),{getFipsCrypto,setFipsCrypto}=process.binding("crypto"),{randomBytes,randomFill,randomFillSync}=require("internal/crypto/random"),{pbkdf2,pbkdf2Sync}=require("internal/crypto/pbkdf2"),{scrypt,scryptSync}=require("internal/crypto/scrypt"),{generateKeyPair,generateKeyPairSync}=require("internal/crypto/keygen"),{DiffieHellman,DiffieHellmanGroup,ECDH}=require("internal/crypto/diffiehellman"),{Cipher,Cipheriv,Decipher,Decipheriv,privateDecrypt,privateEncrypt,publicDecrypt,publicEncrypt}=require("internal/crypto/cipher"),{Sign,Verify}=require("internal/crypto/sig"),{Hash,Hmac}=require("internal/crypto/hash"),{getCiphers,getCurves,getDefaultEncoding,getHashes,setDefaultEncoding,setEngine,timingSafeEqual,toBuf}=require("internal/crypto/util"),Certificate=require("internal/crypto/certificate");function createHash(e,r){return new Hash(e,r)}function createCipher(e,r,t){return new Cipher(e,r,t)}function createCipheriv(e,r,t,i){return new Cipheriv(e,r,t,i)}function createDecipher(e,r,t){return new Decipher(e,r,t)}function createDecipheriv(e,r,t,i){return new Decipheriv(e,r,t,i)}function createDiffieHellman(e,r,t,i){return new DiffieHellman(e,r,t,i)}function createDiffieHellmanGroup(e){return new DiffieHellmanGroup(e)}function createECDH(e){return new ECDH(e)}function createHmac(e,r,t){return new Hmac(e,r,t)}function createSign(e,r){return new Sign(e,r)}function createVerify(e,r){return new Verify(e,r)}function setFipsDisabled(){throw new ERR_CRYPTO_FIPS_UNAVAILABLE}function setFipsForced(e){if(!e)throw new ERR_CRYPTO_FIPS_FORCED}function getFipsDisabled(){return 0}function getFipsForced(){return 1}module.exports=exports={_toBuf:toBuf,createCipher,createCipheriv,createDecipher,createDecipheriv,createDiffieHellman,createDiffieHellmanGroup,createECDH,createHash,createHmac,createSign,createVerify,getCiphers,getCurves,getDiffieHellman:createDiffieHellmanGroup,getHashes,pbkdf2,pbkdf2Sync,generateKeyPair,generateKeyPairSync,privateDecrypt,privateEncrypt,prng:randomBytes,pseudoRandomBytes:randomBytes,publicDecrypt,publicEncrypt,randomBytes,randomFill,randomFillSync,rng:randomBytes,scrypt,scryptSync,setEngine,timingSafeEqual,getFips:fipsMode?fipsForced?getFipsForced:getFipsCrypto:getFipsDisabled,setFips:fipsMode?fipsForced?setFipsForced:setFipsCrypto:setFipsDisabled,Certificate,Cipher,Cipheriv,Decipher,Decipheriv,DiffieHellman,DiffieHellmanGroup,ECDH,Hash,Hmac,Sign,Verify},Object.defineProperties(exports,{fips:{get:fipsMode?fipsForced?getFipsForced:getFipsCrypto:getFipsDisabled,set:fipsMode?fipsForced?setFipsForced:setFipsCrypto:setFipsDisabled},DEFAULT_ENCODING:{enumerable:!0,configurable:!0,get:deprecate(getDefaultEncoding,"crypto.DEFAULT_ENCODING is deprecated.","DEP0091"),set:deprecate(setDefaultEncoding,"crypto.DEFAULT_ENCODING is deprecated.","DEP0091")},constants:{configurable:!1,enumerable:!0,value:constants},createCredentials:{configurable:!0,enumerable:!0,get:deprecate(()=>require("tls").createSecureContext,"crypto.createCredentials is deprecated. Use tls.createSecureContext instead.","DEP0010")},Credentials:{configurable:!0,enumerable:!0,get:deprecate(function(){return require("tls").SecureContext},"crypto.Credentials is deprecated. Use tls.SecureContext instead.","DEP0011")}});"use strict";const errors=require("internal/errors"),{kStateSymbol,_createSocketHandle,newHandle}=require("internal/dgram"),{ERR_INVALID_ARG_TYPE,ERR_MISSING_ARGS,ERR_SOCKET_ALREADY_BOUND,ERR_SOCKET_BAD_BUFFER_SIZE,ERR_SOCKET_BAD_PORT,ERR_SOCKET_BUFFER_SIZE,ERR_SOCKET_CANNOT_SEND,ERR_SOCKET_DGRAM_NOT_RUNNING}=errors.codes,{validateString,validateNumber}=require("internal/validators"),{Buffer}=require("buffer"),util=require("util"),{isUint8Array}=require("internal/util/types"),EventEmitter=require("events"),{defaultTriggerAsyncIdScope,symbols:{async_id_symbol,owner_symbol}}=require("internal/async_hooks"),{UV_UDP_REUSEADDR}=process.binding("constants").os,{UDP,SendWrap}=process.binding("udp_wrap"),BIND_STATE_UNBOUND=0,BIND_STATE_BINDING=1,BIND_STATE_BOUND=2,RECV_BUFFER=!0,SEND_BUFFER=!1;var cluster=null;const errnoException=errors.errnoException,exceptionWithHostPort=errors.exceptionWithHostPort;function Socket(e,t){var r;let n,i;if(EventEmitter.call(this),null!==e&&"object"==typeof e){var o=e;e=o.type,r=o.lookup,n=o.recvBufferSize,i=o.sendBufferSize}var s=newHandle(e,r);s[owner_symbol]=this,this[async_id_symbol]=s.getAsyncId(),this.type=e,this.fd=null,"function"==typeof t&&this.on("message",t),this[kStateSymbol]={handle:s,receiving:!1,bindState:BIND_STATE_UNBOUND,queue:void 0,reuseAddr:o&&o.reuseAddr,recvBufferSize:n,sendBufferSize:i}}function createSocket(e,t){return new Socket(e,t)}function startListening(e){const t=e[kStateSymbol];t.handle.onmessage=onMessage,t.handle.recvStart(),t.receiving=!0,t.bindState=BIND_STATE_BOUND,e.fd=-42,t.recvBufferSize&&bufferSize(e,t.recvBufferSize,RECV_BUFFER),t.sendBufferSize&&bufferSize(e,t.sendBufferSize,SEND_BUFFER),e.emit("listening")}function replaceHandle(e,t){const r=e[kStateSymbol],n=r.handle;t.lookup=n.lookup,t.bind=n.bind,t.send=n.send,t[owner_symbol]=e,n.close(),r.handle=t}function bufferSize(e,t,r){if(t>>>0!==t)throw new ERR_SOCKET_BAD_BUFFER_SIZE;const n={},i=e[kStateSymbol].handle.bufferSize(t,r,n);if(void 0===i)throw new ERR_SOCKET_BUFFER_SIZE(n);return i}function sliceBuffer(e,t,r){if("string"==typeof e)e=Buffer.from(e);else if(!isUint8Array(e))throw new ERR_INVALID_ARG_TYPE("buffer",["Buffer","Uint8Array","string"],e);return t>>>=0,r>>>=0,e.slice(t,t+r)}function fixBufferList(e){const t=new Array(e.length);for(var r=0,n=e.length;r<n;r++){var i=e[r];if("string"==typeof i)t[r]=Buffer.from(i);else{if(!isUint8Array(i))return null;t[r]=i}}return t}function enqueue(e,t){const r=e[kStateSymbol];void 0===r.queue&&(r.queue=[],e.once("error",onListenError),e.once("listening",onListenSuccess)),r.queue.push(t)}function onListenSuccess(){this.removeListener("error",onListenError),clearQueue.call(this)}function onListenError(e){this.removeListener("listening",onListenSuccess),this[kStateSymbol].queue=void 0,this.emit("error",new ERR_SOCKET_CANNOT_SEND)}function clearQueue(){const e=this[kStateSymbol],t=e.queue;e.queue=void 0;for(var r=0;r<t.length;r++)t[r]()}function doSend(e,t,r,n,i,o,s){const c=t[kStateSymbol];if(e)return"function"==typeof s?void process.nextTick(s,e):void process.nextTick(()=>t.emit("error",e));if(c.handle){var a=new SendWrap;a.list=n,a.address=i,a.port=o,s&&(a.callback=s,a.oncomplete=afterSend);var l=c.handle.send(a,n,n.length,o,r,!!s);if(l&&s){const e=exceptionWithHostPort(l,"send",i,o);process.nextTick(s,e)}}}function afterSend(e,t){e=e?exceptionWithHostPort(e,"send",this.address,this.port):null,this.callback(e,t)}function socketCloseNT(e){e.emit("close")}function healthCheck(e){if(!e[kStateSymbol].handle)throw new ERR_SOCKET_DGRAM_NOT_RUNNING}function stopReceiving(e){const t=e[kStateSymbol];t.receiving&&(t.handle.recvStop(),t.receiving=!1,e.fd=null)}function onMessage(e,t,r,n){var i=t[owner_symbol];if(e<0)return i.emit("error",errnoException(e,"recvmsg"));n.size=r.length,i.emit("message",r,n)}util.inherits(Socket,EventEmitter),Socket.prototype.bind=function(e,t){let r=e;healthCheck(this);const n=this[kStateSymbol];if(n.bindState!==BIND_STATE_UNBOUND)throw new ERR_SOCKET_ALREADY_BOUND;return n.bindState=1,arguments.length&&"function"==typeof arguments[arguments.length-1]&&this.once("listening",arguments[arguments.length-1]),r instanceof UDP?(replaceHandle(this,r),startListening(this),this):(null!==r&&"object"==typeof r?(i=r.address||"",o=!!r.exclusive,r=r.port):(i="function"==typeof t?"":t,o=!1),i||(i="udp4"===this.type?"0.0.0.0":"::"),n.handle.lookup(i,(e,t)=>{if(e)return n.bindState=BIND_STATE_UNBOUND,void this.emit("error",e);cluster||(cluster=require("cluster"));var i=0;if(n.reuseAddr&&(i|=UV_UDP_REUSEADDR),cluster.isWorker&&!o){const e=(e,i)=>{if(e){var o=exceptionWithHostPort(e,"bind",t,r);return this.emit("error",o),void(n.bindState=BIND_STATE_UNBOUND)}if(!n.handle)return i.close();replaceHandle(this,i),startListening(this)};cluster._getServer(this,{address:t,port:r,addressType:this.type,fd:-1,flags:i},e)}else{if(!n.handle)return;const e=n.handle.bind(t,r||0,i);if(e){var s=exceptionWithHostPort(e,"bind",t,r);return this.emit("error",s),void(n.bindState=BIND_STATE_UNBOUND)}startListening(this)}}),this);var i,o},Socket.prototype.sendto=function(e,t,r,n,i,o){validateNumber(t,"offset"),validateNumber(r,"length"),validateNumber(n,"port"),validateString(i,"address"),this.send(e,t,r,n,i,o)},Socket.prototype.send=function(e,t,r,n,i,o){let s;if(i||n&&"function"!=typeof n?e=sliceBuffer(e,t,r):(o=n,n=t,i=r),Array.isArray(e)){if(!(s=fixBufferList(e)))throw new ERR_INVALID_ARG_TYPE("buffer list arguments",["Buffer","string"],e)}else if("string"==typeof e)s=[Buffer.from(e)];else{if(!isUint8Array(e))throw new ERR_INVALID_ARG_TYPE("buffer",["Buffer","Uint8Array","string"],e);s=[e]}if(0===(n>>>=0)||n>65535)throw new ERR_SOCKET_BAD_PORT(n);if("function"!=typeof o&&(o=void 0),"function"==typeof i)o=i,i=void 0;else if(i&&"string"!=typeof i)throw new ERR_INVALID_ARG_TYPE("address",["string","falsy"],i);healthCheck(this);const c=this[kStateSymbol];if(c.bindState===BIND_STATE_UNBOUND&&this.bind({port:0,exclusive:!0},null),0===s.length&&s.push(Buffer.alloc(0)),c.bindState!==BIND_STATE_BOUND)return void enqueue(this,this.send.bind(this,s,n,i,o));c.handle.lookup(i,(e,t)=>{defaultTriggerAsyncIdScope(this[async_id_symbol],doSend,e,this,t,s,i,n,o)})},Socket.prototype.close=function(e){const t=this[kStateSymbol],r=t.queue;return"function"==typeof e&&this.on("close",e),void 0!==r?(r.push(this.close.bind(this)),this):(healthCheck(this),stopReceiving(this),t.handle.close(),t.handle=null,defaultTriggerAsyncIdScope(this[async_id_symbol],process.nextTick,socketCloseNT,this),this)},Socket.prototype.address=function(){healthCheck(this);var e={},t=this[kStateSymbol].handle.getsockname(e);if(t)throw errnoException(t,"getsockname");return e},Socket.prototype.setBroadcast=function(e){var t=this[kStateSymbol].handle.setBroadcast(e?1:0);if(t)throw errnoException(t,"setBroadcast")},Socket.prototype.setTTL=function(e){validateNumber(e,"ttl");var t=this[kStateSymbol].handle.setTTL(e);if(t)throw errnoException(t,"setTTL");return e},Socket.prototype.setMulticastTTL=function(e){validateNumber(e,"ttl");var t=this[kStateSymbol].handle.setMulticastTTL(e);if(t)throw errnoException(t,"setMulticastTTL");return e},Socket.prototype.setMulticastLoopback=function(e){var t=this[kStateSymbol].handle.setMulticastLoopback(e?1:0);if(t)throw errnoException(t,"setMulticastLoopback");return e},Socket.prototype.setMulticastInterface=function(e){healthCheck(this),validateString(e,"interfaceAddress");const t=this[kStateSymbol].handle.setMulticastInterface(e);if(t)throw errnoException(t,"setMulticastInterface")},Socket.prototype.addMembership=function(e,t){if(healthCheck(this),!e)throw new ERR_MISSING_ARGS("multicastAddress");const{handle:r}=this[kStateSymbol];var n=r.addMembership(e,t);if(n)throw errnoException(n,"addMembership")},Socket.prototype.dropMembership=function(e,t){if(healthCheck(this),!e)throw new ERR_MISSING_ARGS("multicastAddress");const{handle:r}=this[kStateSymbol];var n=r.dropMembership(e,t);if(n)throw errnoException(n,"dropMembership")},Socket.prototype.ref=function(){const e=this[kStateSymbol].handle;return e&&e.ref(),this},Socket.prototype.unref=function(){const e=this[kStateSymbol].handle;return e&&e.unref(),this},Socket.prototype.setRecvBufferSize=function(e){bufferSize(this,e,RECV_BUFFER)},Socket.prototype.setSendBufferSize=function(e){bufferSize(this,e,SEND_BUFFER)},Socket.prototype.getRecvBufferSize=function(){return bufferSize(this,0,RECV_BUFFER)},Socket.prototype.getSendBufferSize=function(){return bufferSize(this,0,SEND_BUFFER)},Object.defineProperty(Socket.prototype,"_handle",{get(){return this[kStateSymbol].handle},set(e){this[kStateSymbol].handle=e}}),Object.defineProperty(Socket.prototype,"_receiving",{get(){return this[kStateSymbol].receiving},set(e){this[kStateSymbol].receiving=e}}),Object.defineProperty(Socket.prototype,"_bindState",{get(){return this[kStateSymbol].bindState},set(e){this[kStateSymbol].bindState=e}}),Object.defineProperty(Socket.prototype,"_queue",{get(){return this[kStateSymbol].queue},set(e){this[kStateSymbol].queue=e}}),Object.defineProperty(Socket.prototype,"_reuseAddr",{get(){return this[kStateSymbol].reuseAddr},set(e){this[kStateSymbol].reuseAddr=e}}),Socket.prototype._healthCheck=function(){healthCheck(this)},Socket.prototype._stopReceiving=function(){stopReceiving(this)},Object.defineProperty(UDP.prototype,"owner",{get(){return this[owner_symbol]},set(e){return this[owner_symbol]=e}}),module.exports={_createSocketHandle,createSocket,Socket};"use strict";const cares=internalBinding("cares_wrap"),{isIP,isIPv4,isLegalPort}=require("internal/net"),{customPromisifyArgs}=require("internal/util"),errors=require("internal/errors"),{bindDefaultResolver,getDefaultResolver,setDefaultResolver,Resolver,validateHints}=require("internal/dns/utils"),{ERR_INVALID_ARG_TYPE,ERR_INVALID_CALLBACK,ERR_INVALID_OPT_VALUE,ERR_MISSING_ARGS,ERR_SOCKET_BAD_PORT}=errors.codes,{validateString}=require("internal/validators"),{GetAddrInfoReqWrap,GetNameInfoReqWrap,QueryReqWrap}=cares,dnsException=errors.dnsException;let promises,promisesWarn=!0;function onlookup(e,r){if(e)return this.callback(dnsException(e,"getaddrinfo",this.hostname));this.family?this.callback(null,r[0],this.family):this.callback(null,r[0],isIPv4(r[0])?4:6)}function onlookupall(e,r){if(e)return this.callback(dnsException(e,"getaddrinfo",this.hostname));for(var o=this.family,t=0;t<r.length;t++){const e=r[t];r[t]={address:e,family:o||(isIPv4(e)?4:6)}}this.callback(null,r)}function lookup(e,r,o){var t=0,s=-1,l=!1,n=!1;if(e&&"string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("hostname",["string","falsy"],e);if("function"==typeof r)o=r,s=0;else{if("function"!=typeof o)throw new ERR_INVALID_CALLBACK;null!==r&&"object"==typeof r?(t=r.hints>>>0,s=r.family>>>0,l=!0===r.all,n=!0===r.verbatim,validateHints(t)):s=r>>>0}if(0!==s&&4!==s&&6!==s)throw new ERR_INVALID_OPT_VALUE("family",s);if(!e)return l?process.nextTick(o,null,[]):process.nextTick(o,null,null,6===s?6:4),{};var i=isIP(e);if(i)return l?process.nextTick(o,null,[{address:e,family:i}]):process.nextTick(o,null,e,i),{};var a=new GetAddrInfoReqWrap;a.callback=o,a.family=s,a.hostname=e,a.oncomplete=l?onlookupall:onlookup;var p=cares.getaddrinfo(a,e,s,t,n);return p?(process.nextTick(o,dnsException(p,"getaddrinfo",e)),{}):a}function onlookupservice(e,r,o){if(e)return this.callback(dnsException(e,"getnameinfo",this.hostname));this.callback(null,r,o)}function lookupService(e,r,o){if(3!==arguments.length)throw new ERR_MISSING_ARGS("hostname","port","callback");if(0===isIP(e))throw new ERR_INVALID_OPT_VALUE("hostname",e);if(!isLegalPort(r))throw new ERR_SOCKET_BAD_PORT(r);if("function"!=typeof o)throw new ERR_INVALID_CALLBACK;r=+r;var t=new GetNameInfoReqWrap;t.callback=o,t.hostname=e,t.port=r,t.oncomplete=onlookupservice;var s=cares.getnameinfo(t,e,r);if(s)throw dnsException(s,"getnameinfo",e);return t}function onresolve(e,r,o){o&&this.ttl&&(r=r.map((e,r)=>({address:e,ttl:o[r]}))),e?this.callback(dnsException(e,this.bindingName,this.hostname)):this.callback(null,r)}function resolver(e){function r(r,o){var t;if(arguments.length>2&&(t=o,o=arguments[2]),validateString(r,"name"),"function"!=typeof o)throw new ERR_INVALID_CALLBACK;var s=new QueryReqWrap;s.bindingName=e,s.callback=o,s.hostname=r,s.oncomplete=onresolve,s.ttl=!(!t||!t.ttl);var l=this._handle[e](s,r);if(l)throw dnsException(l,e,r);return s}return Object.defineProperty(r,"name",{value:e}),r}Object.defineProperty(lookup,customPromisifyArgs,{value:["address","family"],enumerable:!1}),Object.defineProperty(lookupService,customPromisifyArgs,{value:["hostname","service"],enumerable:!1});var resolveMap=Object.create(null);function resolve(e,r,o){var t;if("string"==typeof r)t=resolveMap[r];else{if("function"!=typeof r)throw new ERR_INVALID_ARG_TYPE("rrtype","string",r);t=resolveMap.A,o=r}if("function"==typeof t)return t.call(this,e,o);throw new ERR_INVALID_OPT_VALUE("rrtype",r)}function defaultResolverSetServers(e){const r=new Resolver;r.setServers(e),setDefaultResolver(r),bindDefaultResolver(module.exports,Resolver.prototype),void 0!==promises&&bindDefaultResolver(promises,promises.Resolver.prototype)}Resolver.prototype.resolveAny=resolveMap.ANY=resolver("queryAny"),Resolver.prototype.resolve4=resolveMap.A=resolver("queryA"),Resolver.prototype.resolve6=resolveMap.AAAA=resolver("queryAaaa"),Resolver.prototype.resolveCname=resolveMap.CNAME=resolver("queryCname"),Resolver.prototype.resolveMx=resolveMap.MX=resolver("queryMx"),Resolver.prototype.resolveNs=resolveMap.NS=resolver("queryNs"),Resolver.prototype.resolveTxt=resolveMap.TXT=resolver("queryTxt"),Resolver.prototype.resolveSrv=resolveMap.SRV=resolver("querySrv"),Resolver.prototype.resolvePtr=resolveMap.PTR=resolver("queryPtr"),Resolver.prototype.resolveNaptr=resolveMap.NAPTR=resolver("queryNaptr"),Resolver.prototype.resolveSoa=resolveMap.SOA=resolver("querySoa"),Resolver.prototype.reverse=resolver("getHostByAddr"),Resolver.prototype.resolve=resolve,module.exports={lookup,lookupService,Resolver,setServers:defaultResolverSetServers,ADDRCONFIG:cares.AI_ADDRCONFIG,V4MAPPED:cares.AI_V4MAPPED,NODATA:"ENODATA",FORMERR:"EFORMERR",SERVFAIL:"ESERVFAIL",NOTFOUND:"ENOTFOUND",NOTIMP:"ENOTIMP",REFUSED:"EREFUSED",BADQUERY:"EBADQUERY",BADNAME:"EBADNAME",BADFAMILY:"EBADFAMILY",BADRESP:"EBADRESP",CONNREFUSED:"ECONNREFUSED",TIMEOUT:"ETIMEOUT",EOF:"EOF",FILE:"EFILE",NOMEM:"ENOMEM",DESTRUCTION:"EDESTRUCTION",BADSTR:"EBADSTR",BADFLAGS:"EBADFLAGS",NONAME:"ENONAME",BADHINTS:"EBADHINTS",NOTINITIALIZED:"ENOTINITIALIZED",LOADIPHLPAPI:"ELOADIPHLPAPI",ADDRGETNETWORKPARAMS:"EADDRGETNETWORKPARAMS",CANCELLED:"ECANCELLED"},bindDefaultResolver(module.exports,getDefaultResolver()),Object.defineProperties(module.exports,{promises:{configurable:!0,enumerable:!1,get:()=>(promisesWarn&&((promises=require("internal/dns/promises")).setServers=defaultResolverSetServers,promisesWarn=!1,process.emitWarning("The dns.promises API is experimental","ExperimentalWarning")),promises)}});"use strict";const util=require("util"),EventEmitter=require("events"),{ERR_DOMAIN_CALLBACK_NOT_AVAILABLE,ERR_DOMAIN_CANNOT_SET_UNCAUGHT_EXCEPTION_CAPTURE,ERR_UNHANDLED_ERROR}=require("internal/errors").codes,{createHook}=require("async_hooks");var _domain=[null];Object.defineProperty(process,"domain",{enumerable:!0,get:function(){return _domain[0]},set:function(e){return _domain[0]=e}});const pairing=new Map,asyncHook=createHook({init(e,t,n,i){null!==process.domain&&void 0!==process.domain&&(pairing.set(e,process.domain),i.domain=process.domain,void 0!==i.promise&&i.promise instanceof Promise&&(i.promise.domain=process.domain))},before(e){const t=pairing.get(e);void 0!==t&&t.enter()},after(e){const t=pairing.get(e);void 0!==t&&t.exit()},destroy(e){pairing.delete(e)}});if(process.hasUncaughtExceptionCaptureCallback())throw new ERR_DOMAIN_CALLBACK_NOT_AVAILABLE;const domainRequireStack=new Error("require(`domain`) at this point").stack,{setUncaughtExceptionCaptureCallback}=process;process.setUncaughtExceptionCaptureCallback=function(e){const t=new ERR_DOMAIN_CANNOT_SET_UNCAUGHT_EXCEPTION_CAPTURE;throw t.stack=t.stack+"\n"+"-".repeat(40)+"\n"+domainRequireStack,t};let sendMakeCallbackDeprecation=!1;function emitMakeCallbackDeprecation(){sendMakeCallbackDeprecation||(process.emitWarning("Using a domain property in MakeCallback is deprecated. Use the async_context variant of MakeCallback or the AsyncResource class instead.","DeprecationWarning","DEP0097"),sendMakeCallbackDeprecation=!0)}function topLevelDomainCallback(e,...t){const n=this.domain;exports.active&&n&&emitMakeCallbackDeprecation(),n&&n.enter();const i=Reflect.apply(e,this,t);return n&&n.exit(),i}const stack=[];function updateExceptionCapture(){stack.every(e=>0===e.listenerCount("error"))?setUncaughtExceptionCaptureCallback(null):(setUncaughtExceptionCaptureCallback(null),setUncaughtExceptionCaptureCallback(e=>process.domain._errorHandler(e)))}function domainUncaughtExceptionClear(){stack.length=0,exports.active=process.domain=null,updateExceptionCapture()}exports._stack=stack,internalBinding("domain").enable(topLevelDomainCallback),process.on("newListener",(e,t)=>{"uncaughtException"===e&&t!==domainUncaughtExceptionClear&&(process.removeListener(e,domainUncaughtExceptionClear),process.prependListener(e,domainUncaughtExceptionClear))}),process.on("removeListener",(e,t)=>{if("uncaughtException"===e&&t!==domainUncaughtExceptionClear){const t=process.listeners("uncaughtException");1===t.length&&t[0]===domainUncaughtExceptionClear&&process.removeListener(e,domainUncaughtExceptionClear)}});class Domain extends EventEmitter{constructor(){super(),this.members=[],asyncHook.enable(),this.on("removeListener",updateExceptionCapture),this.on("newListener",updateExceptionCapture)}}function intercepted(e,t,n,i){if(i[0]&&i[0]instanceof Error){var o=i[0];return util._extend(o,{domainBound:n,domainThrown:!1,domain:t}),void t.emit("error",o)}var r,a,s=[];if(t.enter(),i.length>1){for(r=1;r<i.length;r++)s.push(i[r]);a=n.apply(e,s)}else a=n.call(e);return t.exit(),a}function bound(e,t,n,i){var o;return t.enter(),o=i.length>0?n.apply(e,i):n.call(e),t.exit(),o}exports.Domain=Domain,exports.create=exports.createDomain=function(){return new Domain},exports.active=null,Domain.prototype.members=void 0,Domain.prototype._errorHandler=function(e){var t=!1;if(util.isPrimitive(e)||(e.domain=this,e.domainThrown=!0),1===stack.length){if(EventEmitter.listenerCount(this,"error")>0){setUncaughtExceptionCaptureCallback(null);try{t=this.emit("error",e)}finally{updateExceptionCapture()}}}else try{t=this.emit("error",e)}catch(e){if(this===exports.active&&stack.pop(),updateExceptionCapture(),!stack.length)throw e;exports.active=process.domain=stack[stack.length-1],t=process.domain._errorHandler(e)}return domainUncaughtExceptionClear(),t},Domain.prototype.enter=function(){exports.active=process.domain=this,stack.push(this),updateExceptionCapture()},Domain.prototype.exit=function(){var e=stack.lastIndexOf(this);-1!==e&&(stack.splice(e),exports.active=stack[stack.length-1],process.domain=exports.active,updateExceptionCapture())},Domain.prototype.add=function(e){if(e.domain!==this){if(e.domain&&e.domain.remove(e),this.domain&&e instanceof Domain)for(var t=this.domain;t;t=t.domain)if(e===t)return;e.domain=this,this.members.push(e)}},Domain.prototype.remove=function(e){e.domain=null;var t=this.members.indexOf(e);-1!==t&&this.members.splice(t,1)},Domain.prototype.run=function(e){var t;if(this.enter(),arguments.length>=2){for(var n=arguments.length,i=new Array(n-1),o=1;o<n;o++)i[o-1]=arguments[o];t=e.apply(this,i)}else t=e.call(this);return this.exit(),t},Domain.prototype.intercept=function(e){var t=this;return function(){return intercepted(this,t,e,arguments)}},Domain.prototype.bind=function(e){var t=this;function n(){return bound(this,t,e,arguments)}return n.domain=this,n},EventEmitter.usingDomains=!0;const eventInit=EventEmitter.init;EventEmitter.init=function(){return this.domain=null,!exports.active||this instanceof exports.Domain||(this.domain=exports.active),eventInit.call(this)};const eventEmit=EventEmitter.prototype.emit;EventEmitter.prototype.emit=function(...e){const t=this.domain,n=e[0];if("error"===n&&this.listenerCount(n)>0||null==t||this===process)return Reflect.apply(eventEmit,this,e);if("error"===n){const n=e.length>1&&e[1]?e[1]:new ERR_UNHANDLED_ERROR;return"object"==typeof n&&(n.domainEmitter=this,n.domain=t,n.domainThrown=!1),t.emit("error",n),!1}t.enter();const i=Reflect.apply(eventEmit,this,e);return t.exit(),i};"use strict";var spliceOne;function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.usingDomains=!1,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var errors,defaultMaxListeners=10;function lazyErrors(){return void 0===errors&&(errors=require("internal/errors").codes),errors}function $getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function longestSeqContainedIn(e,t){for(var n=e.length;n>=3;--n)for(var r=0;r<e.length-n;++r)for(var i=0;i<t.length-n;++i){let o=!0;for(var s=0;s<n;++s)if(e[r+s]!==t[i+s]){o=!1;break}if(o)return[n,r,i]}return[0,0,0]}function enhanceStackTrace(e,t){const n=e.stack.split("\n").slice(1),r=t.stack.split("\n").slice(1),[i,s]=longestSeqContainedIn(r,n);i>0&&r.splice(s+1,i-1,"    [... lines matching original stack trace ...]"),e.stack=e.stack+"\nEmitted 'error' event at:\n"+r.join("\n")}function _addListener(e,t,n,r){var i,s,o;if("function"!=typeof n){throw new(lazyErrors().ERR_INVALID_ARG_TYPE)("listener","Function",n)}if(void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),void 0===o)o=s[t]=n,++e._eventsCount;else if("function"==typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=$getMaxListeners(e))>0&&o.length>i&&!o.warned){o.warned=!0;const n=new Error("Possible EventEmitter memory leak detected. "+`${o.length} ${String(t)} listeners `+"added. Use emitter.setMaxListeners() to increase limit");n.name="MaxListenersExceededWarning",n.emitter=e,n.type=t,n.count=o.length,process.emitWarning(n)}return e}function onceWrapper(...e){this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,Reflect.apply(this.listener,this.target,e))}function _onceWrap(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=onceWrapper.bind(r);return i.listener=n,r.wrapFn=i,i}function _listeners(e,t,n){const r=e._events;if(void 0===r)return[];const i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?unwrapListeners(i):arrayClone(i,i.length)}function listenerCount(e){const t=this._events;if(void 0!==t){const n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function arrayClone(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function unwrapListeners(e){const t=new Array(e.length);for(var n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e)){throw new(lazyErrors().ERR_OUT_OF_RANGE)("defaultMaxListeners","a non-negative number",e)}defaultMaxListeners=e}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||Number.isNaN(e)){throw new(lazyErrors().ERR_OUT_OF_RANGE)("n","a non-negative number",e)}return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function(){return $getMaxListeners(this)},EventEmitter.prototype.emit=function(e,...t){let n="error"===e;const r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){let e;if(t.length>0&&(e=t[0]),e instanceof Error){try{const{kExpandStackSymbol:t}=require("internal/util"),n={};Error.captureStackTrace(n,EventEmitter.prototype.emit),Object.defineProperty(e,t,{value:enhanceStackTrace.bind(null,e,n),configurable:!0})}catch{}throw e}const n=new(lazyErrors().ERR_UNHANDLED_ERROR)(e);throw n.context=e,n}const i=r[e];if(void 0===i)return!1;if("function"==typeof i)Reflect.apply(i,this,t);else{const e=i.length,n=arrayClone(i,e);for(var s=0;s<e;++s)Reflect.apply(n[s],this,t)}return!0},EventEmitter.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function(e,t){if("function"!=typeof t){throw new(lazyErrors().ERR_INVALID_ARG_TYPE)("listener","Function",t)}return this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function(e,t){if("function"!=typeof t){throw new(lazyErrors().ERR_INVALID_ARG_TYPE)("listener","Function",t)}return this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function(e,t){var n,r,i,s,o;if("function"!=typeof t){throw new(lazyErrors().ERR_INVALID_ARG_TYPE)("listener","Function",t)}if(void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():(void 0===spliceOne&&(spliceOne=require("internal/util").spliceOne),spliceOne(n,i)),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},EventEmitter.prototype.listeners=function(e){return _listeners(this,e,!0)},EventEmitter.prototype.rawListeners=function(e){return _listeners(this,e,!1)},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};"use strict";const{fs:constants}=process.binding("constants"),{S_IFIFO,S_IFLNK,S_IFMT,S_IFREG,S_IFSOCK,F_OK,R_OK,W_OK,X_OK,O_WRONLY,O_SYMLINK}=constants,{_extend}=require("util"),pathModule=require("path"),{isArrayBufferView}=require("internal/util/types"),binding=process.binding("fs"),{Buffer,kMaxLength}=require("buffer"),errors=require("internal/errors"),{ERR_FS_FILE_TOO_LARGE,ERR_INVALID_ARG_TYPE,ERR_INVALID_CALLBACK}=errors.codes,{FSReqWrap,statValues}=binding,{ReadStream,WriteStream}=require("internal/fs/streams"),internalFS=require("internal/fs/utils"),{toPathIfFileURL}=require("internal/url"),internalUtil=require("internal/util"),{copyObject,Dirent,getDirents,getOptions,nullCheck,preprocessSymlinkDestination,Stats,getStatsFromBinding,realpathCacheKey,stringToFlags,stringToSymlinkType,toUnixTimestamp,validateBuffer,validateOffsetLengthRead,validateOffsetLengthWrite,validatePath}=internalFS,{CHAR_FORWARD_SLASH,CHAR_BACKWARD_SLASH}=require("internal/constants"),{isUint32,validateMode,validateInteger,validateInt32,validateUint32}=require("internal/validators");let fs,promises,watchers,ReadFileContext,promisesWarn=!0,truncateWarn=!0;const isWindows="win32"===process.platform;function showTruncateDeprecation(){truncateWarn&&(process.emitWarning("Using fs.truncate with a file descriptor is deprecated. Please use fs.ftruncate with a file descriptor instead.","DeprecationWarning","DEP0081"),truncateWarn=!1)}function handleErrorFromBinding(e){if(void 0!==e.errno){const t=errors.uvException(e);throw Error.captureStackTrace(t,handleErrorFromBinding),t}if(void 0!==e.error)throw Error.captureStackTrace(e.error,handleErrorFromBinding),e.error}function maybeCallback(e){if("function"==typeof e)return e;throw new ERR_INVALID_CALLBACK}function makeCallback(e){if("function"!=typeof e)throw new ERR_INVALID_CALLBACK;return function(...t){return Reflect.apply(e,void 0,t)}}function makeStatsCallback(e){if("function"!=typeof e)throw new ERR_INVALID_CALLBACK;return function(t,n){if(t)return e(t);e(t,getStatsFromBinding(n))}}const isFd=isUint32;function isFileType(e,t){return(e[1]&S_IFMT)===t}function access(e,t,n){"function"==typeof t&&(n=t,t=F_OK),e=toPathIfFileURL(e),validatePath(e),t|=0;const i=new FSReqWrap;i.oncomplete=makeCallback(n),binding.access(pathModule.toNamespacedPath(e),t,i)}function accessSync(e,t){e=toPathIfFileURL(e),validatePath(e),void 0===t?t=F_OK:t|=0;const n={path:e};binding.access(pathModule.toNamespacedPath(e),t,void 0,n),handleErrorFromBinding(n)}function exists(e,t){maybeCallback(t);try{fs.access(e,F_OK,function(e){t(!e)})}catch{return t(!1)}}function existsSync(e){try{e=toPathIfFileURL(e),validatePath(e)}catch{return!1}const t={path:e};return binding.access(pathModule.toNamespacedPath(e),F_OK,void 0,t),void 0===t.errno}function readFileAfterOpen(e,t){const n=this.context;if(e)return void n.callback(e);n.fd=t;const i=new FSReqWrap;i.oncomplete=readFileAfterStat,i.context=n,binding.fstat(t,!1,i)}function readFileAfterStat(e,t){const n=this.context;if(e)return n.close(e);const i=n.size=isFileType(t,S_IFREG)?t[8]:0;if(0===i)return n.buffers=[],void n.read();if(i>kMaxLength)return e=new ERR_FS_FILE_TOO_LARGE(i),n.close(e);try{n.buffer=Buffer.allocUnsafeSlow(i)}catch(e){return n.close(e)}n.read()}function readFile(e,t,n){n=maybeCallback(n||t),t=getOptions(t,{flag:"r"}),ReadFileContext||(ReadFileContext=require("internal/fs/read_file_context"));const i=new ReadFileContext(n,t.encoding);i.isUserFd=isFd(e);const a=new FSReqWrap;a.context=i,a.oncomplete=readFileAfterOpen,i.isUserFd?process.nextTick(function(){a.oncomplete(null,e)}):(e=toPathIfFileURL(e),validatePath(e),binding.open(pathModule.toNamespacedPath(e),stringToFlags(t.flag||"r"),438,a))}function tryStatSync(e,t){const n={},i=binding.fstat(e,!1,void 0,n);if(void 0!==n.errno&&!t)throw fs.closeSync(e),errors.uvException(n);return i}function tryCreateBuffer(e,t,n){let i,a=!0;try{if(e>kMaxLength)throw new ERR_FS_FILE_TOO_LARGE(e);i=Buffer.allocUnsafe(e),a=!1}finally{a&&!n&&fs.closeSync(t)}return i}function tryReadSync(e,t,n,i,a){let o,r=!0;try{o=fs.readSync(e,n,i,a),r=!1}finally{r&&!t&&fs.closeSync(e)}return o}function readFileSync(e,t){t=getOptions(t,{flag:"r"});const n=isFd(e),i=n?e:fs.openSync(e,t.flag||"r",438),a=tryStatSync(i,n),o=isFileType(a,S_IFREG)?a[8]:0;let r,c,l,d=0;if(0===o?c=[]:r=tryCreateBuffer(o,i,n),0!==o)do{d+=l=tryReadSync(i,n,r,d,o-d)}while(0!==l&&d<o);else do{0!==(l=tryReadSync(i,n,r=Buffer.allocUnsafe(8192),0,8192))&&c.push(r.slice(0,l)),d+=l}while(0!==l);return n||fs.closeSync(i),0===o?r=Buffer.concat(c,d):d<o&&(r=r.slice(0,d)),t.encoding&&(r=r.toString(t.encoding)),r}function close(e,t){validateUint32(e,"fd");const n=new FSReqWrap;n.oncomplete=makeCallback(t),binding.close(e,n)}function closeSync(e){validateUint32(e,"fd");const t={};binding.close(e,void 0,t),handleErrorFromBinding(t)}function open(e,t,n,i){e=toPathIfFileURL(e),validatePath(e);const a=stringToFlags(t);"function"==typeof n?(i=makeCallback(n),n=438):(n=validateMode(n,"mode",438),i=makeCallback(i));const o=new FSReqWrap;o.oncomplete=i,binding.open(pathModule.toNamespacedPath(e),a,n,o)}function openSync(e,t,n){e=toPathIfFileURL(e),validatePath(e);const i=stringToFlags(t);n=validateMode(n,"mode",438);const a={path:e},o=binding.open(pathModule.toNamespacedPath(e),i,n,void 0,a);return handleErrorFromBinding(a),o}function read(e,t,n,i,a,o){if(validateUint32(e,"fd"),validateBuffer(t),n|=0,0===(i|=0))return process.nextTick(function(){o&&o(null,0,t)});validateOffsetLengthRead(n,i,t.byteLength),Number.isSafeInteger(a)||(a=-1);const r=new FSReqWrap;r.oncomplete=function(e,n){o&&o(e,n||0,t)},binding.read(e,t,n,i,a,r)}function readSync(e,t,n,i,a){if(validateUint32(e,"fd"),validateBuffer(t),0===(i|=0))return 0;validateOffsetLengthRead(n|=0,i,t.byteLength),Number.isSafeInteger(a)||(a=-1);const o={},r=binding.read(e,t,n,i,a,void 0,o);return handleErrorFromBinding(o),r}function write(e,t,n,i,a,o){validateUint32(e,"fd");const r=new FSReqWrap;return r.oncomplete=function(e,n){o(e,n||0,t)},isArrayBufferView(t)?(o=maybeCallback(o||a||i||n),"number"!=typeof n&&(n=0),"number"!=typeof i&&(i=t.length-n),"number"!=typeof a&&(a=null),validateOffsetLengthWrite(n,i,t.byteLength),binding.writeBuffer(e,t,n,i,a,r)):("string"!=typeof t&&(t+=""),"function"!=typeof a&&("function"==typeof n?(a=n,n=null):a=i,i="utf8"),o=maybeCallback(a),binding.writeString(e,t,n,i,r))}function writeSync(e,t,n,i,a){validateUint32(e,"fd");const o={};let r;return isArrayBufferView(t)?(void 0===a&&(a=null),"number"!=typeof n&&(n=0),"number"!=typeof i&&(i=t.byteLength-n),validateOffsetLengthWrite(n,i,t.byteLength),r=binding.writeBuffer(e,t,n,i,a,void 0,o)):("string"!=typeof t&&(t+=""),void 0===n&&(n=null),r=binding.writeString(e,t,n,i,void 0,o)),handleErrorFromBinding(o),r}function rename(e,t,n){n=makeCallback(n),e=toPathIfFileURL(e),validatePath(e,"oldPath"),t=toPathIfFileURL(t),validatePath(t,"newPath");const i=new FSReqWrap;i.oncomplete=n,binding.rename(pathModule.toNamespacedPath(e),pathModule.toNamespacedPath(t),i)}function renameSync(e,t){e=toPathIfFileURL(e),validatePath(e,"oldPath"),t=toPathIfFileURL(t),validatePath(t,"newPath");const n={path:e,dest:t};binding.rename(pathModule.toNamespacedPath(e),pathModule.toNamespacedPath(t),void 0,n),handleErrorFromBinding(n)}function truncate(e,t,n){if("number"==typeof e)return showTruncateDeprecation(),fs.ftruncate(e,t,n);"function"==typeof t?(n=t,t=0):void 0===t&&(t=0),validateInteger(t,"len"),n=maybeCallback(n),fs.open(e,"r+",function(e,i){if(e)return n(e);const a=new FSReqWrap;a.oncomplete=function(e){fs.close(i,function(t){n(e||t)})},binding.ftruncate(i,t,a)})}function truncateSync(e,t){if("number"==typeof e)return showTruncateDeprecation(),fs.ftruncateSync(e,t);void 0===t&&(t=0);const n=fs.openSync(e,"r+");let i;try{i=fs.ftruncateSync(n,t)}finally{fs.closeSync(n)}return i}function ftruncate(e,t=0,n){"function"==typeof t&&(n=t,t=0),validateUint32(e,"fd"),validateInteger(t,"len"),t=Math.max(0,t);const i=new FSReqWrap;i.oncomplete=makeCallback(n),binding.ftruncate(e,t,i)}function ftruncateSync(e,t=0){validateUint32(e,"fd"),validateInteger(t,"len"),t=Math.max(0,t);const n={};binding.ftruncate(e,t,void 0,n),handleErrorFromBinding(n)}function rmdir(e,t){t=makeCallback(t),e=toPathIfFileURL(e),validatePath(e);const n=new FSReqWrap;n.oncomplete=t,binding.rmdir(pathModule.toNamespacedPath(e),n)}function rmdirSync(e){e=toPathIfFileURL(e),validatePath(e);const t={path:e};binding.rmdir(pathModule.toNamespacedPath(e),void 0,t),handleErrorFromBinding(t)}function fdatasync(e,t){validateUint32(e,"fd");const n=new FSReqWrap;n.oncomplete=makeCallback(t),binding.fdatasync(e,n)}function fdatasyncSync(e){validateUint32(e,"fd");const t={};binding.fdatasync(e,void 0,t),handleErrorFromBinding(t)}function fsync(e,t){validateUint32(e,"fd");const n=new FSReqWrap;n.oncomplete=makeCallback(t),binding.fsync(e,n)}function fsyncSync(e){validateUint32(e,"fd");const t={};binding.fsync(e,void 0,t),handleErrorFromBinding(t)}function mkdir(e,t,n){"function"==typeof t?(n=t,t={}):"number"!=typeof t&&"string"!=typeof t||(t={mode:t});const{recursive:i=!1,mode:a=511}=t||{};if(n=makeCallback(n),e=toPathIfFileURL(e),validatePath(e),"boolean"!=typeof i)throw new ERR_INVALID_ARG_TYPE("recursive","boolean",i);const o=new FSReqWrap;o.oncomplete=n,binding.mkdir(pathModule.toNamespacedPath(e),validateMode(a,"mode",511),i,o)}function mkdirSync(e,t){"number"!=typeof t&&"string"!=typeof t||(t={mode:t}),e=toPathIfFileURL(e);const{recursive:n=!1,mode:i=511}=t||{};if(validatePath(e),"boolean"!=typeof n)throw new ERR_INVALID_ARG_TYPE("recursive","boolean",n);const a={path:e};binding.mkdir(pathModule.toNamespacedPath(e),validateMode(i,"mode",511),n,void 0,a),handleErrorFromBinding(a)}function readdir(e,t,n){n=makeCallback("function"==typeof t?t:n),t=getOptions(t,{}),e=toPathIfFileURL(e),validatePath(e);const i=new FSReqWrap;t.withFileTypes?i.oncomplete=((t,i)=>{t?n(t):getDirents(e,i,n)}):i.oncomplete=n,binding.readdir(pathModule.toNamespacedPath(e),t.encoding,!!t.withFileTypes,i)}function readdirSync(e,t){t=getOptions(t,{}),e=toPathIfFileURL(e),validatePath(e);const n={path:e},i=binding.readdir(pathModule.toNamespacedPath(e),t.encoding,!!t.withFileTypes,void 0,n);return handleErrorFromBinding(n),t.withFileTypes?getDirents(e,i):i}function fstat(e,t,n){"function"==typeof t&&(n=t,t={}),validateUint32(e,"fd");const i=new FSReqWrap(t.bigint);i.oncomplete=makeStatsCallback(n),binding.fstat(e,t.bigint,i)}function lstat(e,t,n){"function"==typeof t&&(n=t,t={}),n=makeStatsCallback(n),e=toPathIfFileURL(e),validatePath(e);const i=new FSReqWrap(t.bigint);i.oncomplete=n,binding.lstat(pathModule.toNamespacedPath(e),t.bigint,i)}function stat(e,t,n){"function"==typeof t&&(n=t,t={}),n=makeStatsCallback(n),e=toPathIfFileURL(e),validatePath(e);const i=new FSReqWrap(t.bigint);i.oncomplete=n,binding.stat(pathModule.toNamespacedPath(e),t.bigint,i)}function fstatSync(e,t={}){validateUint32(e,"fd");const n={fd:e},i=binding.fstat(e,t.bigint,void 0,n);return handleErrorFromBinding(n),getStatsFromBinding(i)}function lstatSync(e,t={}){e=toPathIfFileURL(e),validatePath(e);const n={path:e},i=binding.lstat(pathModule.toNamespacedPath(e),t.bigint,void 0,n);return handleErrorFromBinding(n),getStatsFromBinding(i)}function statSync(e,t={}){e=toPathIfFileURL(e),validatePath(e);const n={path:e},i=binding.stat(pathModule.toNamespacedPath(e),t.bigint,void 0,n);return handleErrorFromBinding(n),getStatsFromBinding(i)}function readlink(e,t,n){n=makeCallback("function"==typeof t?t:n),t=getOptions(t,{}),e=toPathIfFileURL(e),validatePath(e,"oldPath");const i=new FSReqWrap;i.oncomplete=n,binding.readlink(pathModule.toNamespacedPath(e),t.encoding,i)}function readlinkSync(e,t){t=getOptions(t,{}),e=toPathIfFileURL(e),validatePath(e,"oldPath");const n={path:e},i=binding.readlink(pathModule.toNamespacedPath(e),t.encoding,void 0,n);return handleErrorFromBinding(n),i}function symlink(e,t,n,i){const a="string"==typeof n?n:null,o=makeCallback(arguments[arguments.length-1]);e=toPathIfFileURL(e),t=toPathIfFileURL(t),validatePath(e,"target"),validatePath(t);const r=stringToSymlinkType(a),c=new FSReqWrap;c.oncomplete=o,binding.symlink(preprocessSymlinkDestination(e,a,t),pathModule.toNamespacedPath(t),r,c)}function symlinkSync(e,t,n){n="string"==typeof n?n:null,e=toPathIfFileURL(e),t=toPathIfFileURL(t),validatePath(e,"target"),validatePath(t);const i=stringToSymlinkType(n),a={path:e,dest:t};binding.symlink(preprocessSymlinkDestination(e,n,t),pathModule.toNamespacedPath(t),i,void 0,a),handleErrorFromBinding(a)}function link(e,t,n){n=makeCallback(n),e=toPathIfFileURL(e),t=toPathIfFileURL(t),validatePath(e,"existingPath"),validatePath(t,"newPath");const i=new FSReqWrap;i.oncomplete=n,binding.link(pathModule.toNamespacedPath(e),pathModule.toNamespacedPath(t),i)}function linkSync(e,t){e=toPathIfFileURL(e),t=toPathIfFileURL(t),validatePath(e,"existingPath"),validatePath(t,"newPath");const n={path:e,dest:t},i=binding.link(pathModule.toNamespacedPath(e),pathModule.toNamespacedPath(t),void 0,n);return handleErrorFromBinding(n),i}function unlink(e,t){t=makeCallback(t),e=toPathIfFileURL(e),validatePath(e);const n=new FSReqWrap;n.oncomplete=t,binding.unlink(pathModule.toNamespacedPath(e),n)}function unlinkSync(e){e=toPathIfFileURL(e),validatePath(e);const t={path:e};binding.unlink(pathModule.toNamespacedPath(e),void 0,t),handleErrorFromBinding(t)}function fchmod(e,t,n){validateInt32(e,"fd",0),t=validateMode(t,"mode"),n=makeCallback(n);const i=new FSReqWrap;i.oncomplete=n,binding.fchmod(e,t,i)}function fchmodSync(e,t){validateInt32(e,"fd",0),t=validateMode(t,"mode");const n={};binding.fchmod(e,t,void 0,n),handleErrorFromBinding(n)}function lchmod(e,t,n){n=maybeCallback(n),fs.open(e,O_WRONLY|O_SYMLINK,function(e,i){e?n(e):fs.fchmod(i,t,function(e){fs.close(i,function(t){n(e||t)})})})}function lchmodSync(e,t){const n=fs.openSync(e,O_WRONLY|O_SYMLINK);let i;try{i=fs.fchmodSync(n,t)}finally{fs.closeSync(n)}return i}function chmod(e,t,n){e=toPathIfFileURL(e),validatePath(e),t=validateMode(t,"mode"),n=makeCallback(n);const i=new FSReqWrap;i.oncomplete=n,binding.chmod(pathModule.toNamespacedPath(e),t,i)}function chmodSync(e,t){e=toPathIfFileURL(e),validatePath(e),t=validateMode(t,"mode");const n={path:e};binding.chmod(pathModule.toNamespacedPath(e),t,void 0,n),handleErrorFromBinding(n)}function lchown(e,t,n,i){i=makeCallback(i),e=toPathIfFileURL(e),validatePath(e),validateUint32(t,"uid"),validateUint32(n,"gid");const a=new FSReqWrap;a.oncomplete=i,binding.lchown(pathModule.toNamespacedPath(e),t,n,a)}function lchownSync(e,t,n){e=toPathIfFileURL(e),validatePath(e),validateUint32(t,"uid"),validateUint32(n,"gid");const i={path:e};binding.lchown(pathModule.toNamespacedPath(e),t,n,void 0,i),handleErrorFromBinding(i)}function fchown(e,t,n,i){validateUint32(e,"fd"),validateUint32(t,"uid"),validateUint32(n,"gid");const a=new FSReqWrap;a.oncomplete=makeCallback(i),binding.fchown(e,t,n,a)}function fchownSync(e,t,n){validateUint32(e,"fd"),validateUint32(t,"uid"),validateUint32(n,"gid");const i={};binding.fchown(e,t,n,void 0,i),handleErrorFromBinding(i)}function chown(e,t,n,i){i=makeCallback(i),e=toPathIfFileURL(e),validatePath(e),validateUint32(t,"uid"),validateUint32(n,"gid");const a=new FSReqWrap;a.oncomplete=i,binding.chown(pathModule.toNamespacedPath(e),t,n,a)}function chownSync(e,t,n){e=toPathIfFileURL(e),validatePath(e),validateUint32(t,"uid"),validateUint32(n,"gid");const i={path:e};binding.chown(pathModule.toNamespacedPath(e),t,n,void 0,i),handleErrorFromBinding(i)}function utimes(e,t,n,i){i=makeCallback(i),e=toPathIfFileURL(e),validatePath(e);const a=new FSReqWrap;a.oncomplete=i,binding.utimes(pathModule.toNamespacedPath(e),toUnixTimestamp(t),toUnixTimestamp(n),a)}function utimesSync(e,t,n){e=toPathIfFileURL(e),validatePath(e);const i={path:e};binding.utimes(pathModule.toNamespacedPath(e),toUnixTimestamp(t),toUnixTimestamp(n),void 0,i),handleErrorFromBinding(i)}function futimes(e,t,n,i){validateUint32(e,"fd"),t=toUnixTimestamp(t,"atime"),n=toUnixTimestamp(n,"mtime");const a=new FSReqWrap;a.oncomplete=makeCallback(i),binding.futimes(e,t,n,a)}function futimesSync(e,t,n){validateUint32(e,"fd"),t=toUnixTimestamp(t,"atime"),n=toUnixTimestamp(n,"mtime");const i={};binding.futimes(e,t,n,void 0,i),handleErrorFromBinding(i)}function writeAll(e,t,n,i,a,o,r){fs.write(e,n,i,a,o,function(c,l){c?t?r(c):fs.close(e,function(){r(c)}):l===a?t?r(null):fs.close(e,r):(null!==o&&(o+=l),writeAll(e,t,n,i+=l,a-=l,o,r))})}function writeFile(e,t,n,i){i=maybeCallback(i||n);const a=(n=getOptions(n,{encoding:"utf8",mode:438,flag:"w"})).flag||"w";function o(e,o){const r=isArrayBufferView(t)?t:Buffer.from(""+t,n.encoding||"utf8"),c=/a/.test(a)?null:0;writeAll(e,o,r,0,r.byteLength,c,i)}isFd(e)?o(e,!0):fs.open(e,a,n.mode,function(e,t){e?i(e):o(t,!1)})}function writeFileSync(e,t,n){const i=(n=getOptions(n,{encoding:"utf8",mode:438,flag:"w"})).flag||"w",a=isFd(e),o=a?e:fs.openSync(e,i,n.mode);isArrayBufferView(t)||(t=Buffer.from(""+t,n.encoding||"utf8"));let r=0,c=t.byteLength,l=/a/.test(i)?null:0;try{for(;c>0;){const e=fs.writeSync(o,t,r,c,l);r+=e,c-=e,null!==l&&(l+=e)}}finally{a||fs.closeSync(o)}}function appendFile(e,t,n,i){i=maybeCallback(i||n),n=getOptions(n,{encoding:"utf8",mode:438,flag:"a"}),(n=copyObject(n)).flag&&!isFd(e)||(n.flag="a"),fs.writeFile(e,t,n,i)}function appendFileSync(e,t,n){n=getOptions(n,{encoding:"utf8",mode:438,flag:"a"}),(n=copyObject(n)).flag&&!isFd(e)||(n.flag="a"),fs.writeFileSync(e,t,n)}function watch(e,t,n){"function"==typeof t&&(n=t),t=getOptions(t,{}),void 0===(t=copyObject(t)).persistent&&(t.persistent=!0),void 0===t.recursive&&(t.recursive=!1),watchers||(watchers=require("internal/fs/watchers"));const i=new watchers.FSWatcher;return i.start(e,t.persistent,t.recursive,t.encoding),n&&i.addListener("change",n),i}Object.defineProperty(exists,internalUtil.promisify.custom,{value:e=>new Promise(t=>fs.exists(e,t))}),Object.defineProperty(read,internalUtil.customPromisifyArgs,{value:["bytesRead","buffer"],enumerable:!1}),Object.defineProperty(write,internalUtil.customPromisifyArgs,{value:["bytesWritten","buffer"],enumerable:!1});const statWatchers=new Map;function watchFile(e,t,n){let i;e=toPathIfFileURL(e),validatePath(e),e=pathModule.resolve(e);const a={interval:5007,persistent:!0};if(null!==t&&"object"==typeof t?t=_extend(a,t):(n=t,t=a),"function"!=typeof n)throw new ERR_INVALID_ARG_TYPE("listener","Function",n);return void 0===(i=statWatchers.get(e))&&(watchers||(watchers=require("internal/fs/watchers")),(i=new watchers.StatWatcher(t.bigint)).start(e,t.persistent,t.interval),statWatchers.set(e,i)),i.addListener("change",n),i}function unwatchFile(e,t){e=toPathIfFileURL(e),validatePath(e),e=pathModule.resolve(e);const n=statWatchers.get(e);void 0!==n&&("function"==typeof t?n.removeListener("change",t):n.removeAllListeners("change"),0===n.listenerCount("change")&&(n.stop(),statWatchers.delete(e)))}let splitRoot,nextPart;if(isWindows){const e=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;splitRoot=function(t){return e.exec(t)[0]}}else splitRoot=function(e){for(var t=0;t<e.length;++t)if(e.charCodeAt(t)!==CHAR_FORWARD_SLASH)return e.slice(0,t);return e};function encodeRealpathResult(e,t){if(!t||!t.encoding||"utf8"===t.encoding)return e;const n=Buffer.from(e);return"buffer"===t.encoding?n:n.toString(t.encoding)}nextPart=isWindows?function(e,t){for(;t<e.length;++t){const n=e.charCodeAt(t);if(n===CHAR_BACKWARD_SLASH||n===CHAR_FORWARD_SLASH)return t}return-1}:function(e,t){return e.indexOf("/",t)};const emptyObj=Object.create(null);function realpathSync(e,t){t=t?getOptions(t,emptyObj):emptyObj,"string"!=typeof(e=toPathIfFileURL(e))&&(e+=""),validatePath(e),e=pathModule.resolve(e);const n=t[realpathCacheKey],i=n&&n.get(e);if(i)return i;const a=Object.create(null),o=Object.create(null),r=e;let c,l,d,s;if(c=(l=d=splitRoot(e)).length,isWindows&&!o[d]){const e={path:d};binding.lstat(pathModule.toNamespacedPath(d),!1,void 0,e),handleErrorFromBinding(e),o[d]=!0}for(;c<e.length;){const t=nextPart(e,c);if(s=l,-1===t){const t=e.slice(c);l+=t,d=s+t,c=e.length}else l+=e.slice(c,t+1),d=s+e.slice(c,t),c=t+1;if(o[d]||n&&n.get(d)===d){if(isFileType(statValues,S_IFIFO)||isFileType(statValues,S_IFSOCK))break;continue}let i;const r=n&&n.get(d);if(r)i=r;else{const e=pathModule.toNamespacedPath(d),t={path:d},r=binding.lstat(e,!1,void 0,t);if(handleErrorFromBinding(t),!isFileType(r,S_IFLNK)){o[d]=!0,n&&n.set(d,d);continue}let c,l=null;if(!isWindows){a[c=`${r[0].toString(32)}:${r[7].toString(32)}`]&&(l=a[c])}if(null===l){const t={path:d};binding.stat(e,!1,void 0,t),handleErrorFromBinding(t),l=binding.readlink(e,void 0,void 0,t),handleErrorFromBinding(t)}i=pathModule.resolve(s,l),n&&n.set(d,i),isWindows||(a[c]=l)}if(e=pathModule.resolve(i,e.slice(c)),c=(l=d=splitRoot(e)).length,isWindows&&!o[d]){const e={path:d};binding.lstat(pathModule.toNamespacedPath(d),!1,void 0,e),handleErrorFromBinding(e),o[d]=!0}}return n&&n.set(r,e),encodeRealpathResult(e,t)}function realpath(e,t,n){n=maybeCallback("function"==typeof t?t:n),t=t?getOptions(t,emptyObj):emptyObj,"string"!=typeof(e=toPathIfFileURL(e))&&(e+=""),validatePath(e),e=pathModule.resolve(e);const i=Object.create(null),a=Object.create(null);let o,r,c,l;function d(){if(o>=e.length)return n(null,encodeRealpathResult(e,t));const i=nextPart(e,o);if(l=r,-1===i){const t=e.slice(o);r+=t,c=l+t,o=e.length}else r+=e.slice(o,i+1),c=l+e.slice(o,i),o=i+1;return a[c]?isFileType(statValues,S_IFIFO)||isFileType(statValues,S_IFSOCK)?n(null,encodeRealpathResult(e,t)):process.nextTick(d):fs.lstat(c,s)}function s(e,t){if(e)return n(e);if(!t.isSymbolicLink())return a[c]=!0,process.nextTick(d);let o;if(!isWindows){const e=t.dev.toString(32),n=t.ino.toString(32);if(i[o=`${e}:${n}`])return f(null,i[o],c)}fs.stat(c,function(e){if(e)return n(e);fs.readlink(c,function(e,t){isWindows||(i[o]=t),f(e,t)})})}function f(e,t,i){if(e)return n(e);u(pathModule.resolve(l,t))}function u(t){e=pathModule.resolve(t,e.slice(o)),r=c=splitRoot(e),o=r.length,isWindows&&!a[c]?fs.lstat(c,function(e){if(e)return n(e);a[c]=!0,d()}):process.nextTick(d)}r=c=splitRoot(e),o=r.length,isWindows&&!a[c]?fs.lstat(c,function(e,t){if(e)return n(e);a[c]=!0,d()}):process.nextTick(d)}function mkdtemp(e,t,n){if(n=makeCallback("function"==typeof t?t:n),t=getOptions(t,{}),!e||"string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("prefix","string",e);nullCheck(e,"prefix");const i=new FSReqWrap;i.oncomplete=n,binding.mkdtemp(`${e}XXXXXX`,t.encoding,i)}function mkdtempSync(e,t){if(t=getOptions(t,{}),!e||"string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("prefix","string",e);nullCheck(e,"prefix");const n=`${e}XXXXXX`,i={path:n},a=binding.mkdtemp(n,t.encoding,void 0,i);return handleErrorFromBinding(i),a}function copyFile(e,t,n,i){if("function"==typeof n)i=n,n=0;else if("function"!=typeof i)throw new ERR_INVALID_CALLBACK;e=toPathIfFileURL(e),t=toPathIfFileURL(t),validatePath(e,"src"),validatePath(t,"dest"),e=pathModule._makeLong(e),t=pathModule._makeLong(t),n|=0;const a=new FSReqWrap;a.oncomplete=makeCallback(i),binding.copyFile(e,t,n,a)}function copyFileSync(e,t,n){e=toPathIfFileURL(e),t=toPathIfFileURL(t),validatePath(e,"src"),validatePath(t,"dest");const i={path:e,dest:t};e=pathModule._makeLong(e),t=pathModule._makeLong(t),n|=0,binding.copyFile(e,t,n,void 0,i),handleErrorFromBinding(i)}function createReadStream(e,t){return new ReadStream(e,t)}function createWriteStream(e,t){return new WriteStream(e,t)}realpathSync.native=function(e,t){t=getOptions(t,{}),e=toPathIfFileURL(e),validatePath(e);const n={path:e},i=binding.realpath(e,t.encoding,void 0,n);return handleErrorFromBinding(n),i},realpath.native=function(e,t,n){n=makeCallback(n||t),t=getOptions(t,{}),e=toPathIfFileURL(e),validatePath(e);const i=new FSReqWrap;return i.oncomplete=n,binding.realpath(e,t.encoding,i)},module.exports=fs={appendFile,appendFileSync,access,accessSync,chown,chownSync,chmod,chmodSync,close,closeSync,copyFile,copyFileSync,createReadStream,createWriteStream,exists,existsSync,fchown,fchownSync,fchmod,fchmodSync,fdatasync,fdatasyncSync,fstat,fstatSync,fsync,fsyncSync,ftruncate,ftruncateSync,futimes,futimesSync,lchown,lchownSync,lchmod:void 0!==constants.O_SYMLINK?lchmod:void 0,lchmodSync:void 0!==constants.O_SYMLINK?lchmodSync:void 0,link,linkSync,lstat,lstatSync,mkdir,mkdirSync,mkdtemp,mkdtempSync,open,openSync,readdir,readdirSync,read,readSync,readFile,readFileSync,readlink,readlinkSync,realpath,realpathSync,rename,renameSync,rmdir,rmdirSync,stat,statSync,symlink,symlinkSync,truncate,truncateSync,unwatchFile,unlink,unlinkSync,utimes,utimesSync,watch,watchFile,writeFile,writeFileSync,write,writeSync,Dirent,Stats,ReadStream,WriteStream,FileReadStream:ReadStream,FileWriteStream:WriteStream,_toUnixTimestamp:toUnixTimestamp},Object.defineProperties(fs,{F_OK:{enumerable:!0,value:F_OK||0},R_OK:{enumerable:!0,value:R_OK||0},W_OK:{enumerable:!0,value:W_OK||0},X_OK:{enumerable:!0,value:X_OK||0},constants:{configurable:!1,enumerable:!0,value:constants},promises:{configurable:!0,enumerable:!1,get:()=>(promisesWarn&&(promises=require("internal/fs/promises"),promisesWarn=!1,process.emitWarning("The fs.promises API is experimental","ExperimentalWarning")),promises)}});var SyncWriteStream=internalFS.SyncWriteStream;Object.defineProperty(fs,"SyncWriteStream",{configurable:!0,get:internalUtil.deprecate(()=>SyncWriteStream,"fs.SyncWriteStream is deprecated.","DEP0061"),set:internalUtil.deprecate(e=>{SyncWriteStream=e},"fs.SyncWriteStream is deprecated.","DEP0061")});"use strict";const{Agent,globalAgent}=require("_http_agent"),{ClientRequest}=require("_http_client"),{methods}=require("_http_common"),{IncomingMessage}=require("_http_incoming"),{OutgoingMessage}=require("_http_outgoing"),{_connectionListener,STATUS_CODES,Server,ServerResponse}=require("_http_server");let maxHeaderSize;function createServer(e,t){return new Server(e,t)}function request(e,t,r){return new ClientRequest(e,t,r)}function get(e,t,r){var n=request(e,t,r);return n.end(),n}module.exports={_connectionListener,METHODS:methods.slice().sort(),STATUS_CODES,Agent,ClientRequest,globalAgent,IncomingMessage,OutgoingMessage,Server,ServerResponse,createServer,get,request},Object.defineProperty(module.exports,"maxHeaderSize",{configurable:!0,enumerable:!0,get(){if(void 0===maxHeaderSize){const{getOptionValue:e}=require("internal/options");maxHeaderSize=e("--max-http-header-size")}return maxHeaderSize}});"use strict";const{constants,getDefaultSettings,getPackedSettings,getUnpackedSettings,createServer,createSecureServer,connect,Http2ServerRequest,Http2ServerResponse}=require("internal/http2/core");module.exports={constants,getDefaultSettings,getPackedSettings,getUnpackedSettings,createServer,createSecureServer,connect,Http2ServerResponse,Http2ServerRequest};"use strict";require("internal/util").assertCrypto();const tls=require("tls"),url=require("url"),util=require("util"),{Agent:HttpAgent}=require("_http_agent"),{Server:HttpServer,_connectionListener,kServerResponse}=require("_http_server"),{ClientRequest}=require("_http_client"),{inherits}=util,debug=util.debuglog("https"),{urlToOptions,searchParamsSymbol}=require("internal/url"),{ERR_INVALID_DOMAIN_NAME}=require("internal/errors").codes,{IncomingMessage,ServerResponse}=require("http"),{kIncomingMessage}=require("_http_common");function Server(e,t){if(!(this instanceof Server))return new Server(e,t);"function"==typeof e&&(t=e,e=void 0),(e=util._extend({},e)).ALPNProtocols||(e.ALPNProtocols=["http/1.1"]),this[kIncomingMessage]=e.IncomingMessage||IncomingMessage,this[kServerResponse]=e.ServerResponse||ServerResponse,tls.Server.call(this,e,_connectionListener),this.httpAllowHalfOpen=!1,t&&this.addListener("request",t),this.addListener("tlsClientError",function(e,t){this.emit("clientError",e,t)||t.destroy(e)}),this.timeout=12e4,this.keepAliveTimeout=5e3,this.maxHeadersCount=null,this.headersTimeout=4e4}function createServer(e,t){return new Server(e,t)}function createConnection(e,t,s){if(null!==e&&"object"==typeof e?s=e:null!==t&&"object"==typeof t?s=t:null!==s&&"object"==typeof s||(s={}),"number"==typeof e&&(s.port=e),"string"==typeof t&&(s.host=t),debug("createConnection",s),s._agentKey){const e=this._getSession(s._agentKey);e&&(debug("reuse session for %j",s._agentKey),s=util._extend({session:e},s))}const n=tls.connect(s,()=>{s._agentKey&&this._cacheSession(s._agentKey,n.getSession())});return n.once("close",e=>{e&&this._evictSession(s._agentKey)}),n}function Agent(e){if(!(this instanceof Agent))return new Agent(e);HttpAgent.call(this,e),this.defaultPort=443,this.protocol="https:",this.maxCachedSessions=this.options.maxCachedSessions,void 0===this.maxCachedSessions&&(this.maxCachedSessions=100),this._sessionCache={map:{},list:[]}}inherits(Server,tls.Server),Server.prototype.setTimeout=HttpServer.prototype.setTimeout,inherits(Agent,HttpAgent),Agent.prototype.createConnection=createConnection,Agent.prototype.getName=function(e){var t=HttpAgent.prototype.getName.call(this,e);return t+=":",e.ca&&(t+=e.ca),t+=":",e.cert&&(t+=e.cert),t+=":",e.clientCertEngine&&(t+=e.clientCertEngine),t+=":",e.ciphers&&(t+=e.ciphers),t+=":",e.key&&(t+=e.key),t+=":",e.pfx&&(t+=e.pfx),t+=":",void 0!==e.rejectUnauthorized&&(t+=e.rejectUnauthorized),t+=":",e.servername&&e.servername!==e.host&&(t+=e.servername),t+=":",e.secureProtocol&&(t+=e.secureProtocol),t+=":",e.crl&&(t+=e.crl),t+=":",void 0!==e.honorCipherOrder&&(t+=e.honorCipherOrder),t+=":",e.ecdhCurve&&(t+=e.ecdhCurve),t+=":",e.dhparam&&(t+=e.dhparam),t+=":",void 0!==e.secureOptions&&(t+=e.secureOptions),t+=":",e.sessionIdContext&&(t+=e.sessionIdContext),t},Agent.prototype._getSession=function(e){return this._sessionCache.map[e]},Agent.prototype._cacheSession=function(e,t){if(0!==this.maxCachedSessions)if(this._sessionCache.map[e])this._sessionCache.map[e]=t;else{if(this._sessionCache.list.length>=this.maxCachedSessions){const e=this._sessionCache.list.shift();debug("evicting %j",e),delete this._sessionCache.map[e]}this._sessionCache.list.push(e),this._sessionCache.map[e]=t}},Agent.prototype._evictSession=function(e){const t=this._sessionCache.list.indexOf(e);-1!==t&&(this._sessionCache.list.splice(t,1),delete this._sessionCache.map[e])};const globalAgent=new Agent;function request(...e){let t={};if("string"==typeof e[0]){const s=e.shift();if(!(t=url.parse(s)).hostname)throw new ERR_INVALID_DOMAIN_NAME}else e[0]&&e[0][searchParamsSymbol]&&e[0][searchParamsSymbol][searchParamsSymbol]&&(t=urlToOptions(e.shift()));return e[0]&&"function"!=typeof e[0]&&(t=util._extend(t,e.shift())),t._defaultAgent=globalAgent,e.unshift(t),new ClientRequest(...e)}function get(e,t,s){const n=request(e,t,s);return n.end(),n}module.exports={Agent,globalAgent,Server,createServer,get,request};"use strict";const EventEmitter=require("events"),{ERR_INSPECTOR_ALREADY_CONNECTED,ERR_INSPECTOR_CLOSED,ERR_INSPECTOR_NOT_AVAILABLE,ERR_INSPECTOR_NOT_CONNECTED,ERR_INVALID_ARG_TYPE,ERR_INVALID_CALLBACK}=require("internal/errors").codes,{validateString}=require("internal/validators"),util=require("util"),{Connection,open,url}=process.binding("inspector"),{originalConsole}=require("internal/process/per_thread");if(!Connection)throw new ERR_INSPECTOR_NOT_AVAILABLE;const connectionSymbol=Symbol("connectionProperty"),messageCallbacksSymbol=Symbol("messageCallbacks"),nextIdSymbol=Symbol("nextId"),onMessageSymbol=Symbol("onMessage");class Session extends EventEmitter{constructor(){super(),this[connectionSymbol]=null,this[nextIdSymbol]=1,this[messageCallbacksSymbol]=new Map}connect(){if(this[connectionSymbol])throw new ERR_INSPECTOR_ALREADY_CONNECTED("The inspector session");const e=new Connection(e=>this[onMessageSymbol](e));if(e.sessionAttached)throw new ERR_INSPECTOR_ALREADY_CONNECTED("Another inspector session");this[connectionSymbol]=e}[onMessageSymbol](e){const o=JSON.parse(e);try{if(o.id){const e=this[messageCallbacksSymbol].get(o.id);this[messageCallbacksSymbol].delete(o.id),e&&e(o.error||null,o.result||null)}else this.emit(o.method,o),this.emit("inspectorNotification",o)}catch(e){process.emitWarning(e)}}post(e,o,n){if(validateString(e,"method"),!n&&util.isFunction(o)&&(n=o,o=null),o&&"object"!=typeof o)throw new ERR_INVALID_ARG_TYPE("params","Object",o);if(n&&"function"!=typeof n)throw new ERR_INVALID_CALLBACK;if(!this[connectionSymbol])throw new ERR_INSPECTOR_NOT_CONNECTED;const s=this[nextIdSymbol]++,t={id:s,method:e};o&&(t.params=o),n&&this[messageCallbacksSymbol].set(s,n),this[connectionSymbol].dispatch(JSON.stringify(t))}disconnect(){if(!this[connectionSymbol])return;this[connectionSymbol].disconnect(),this[connectionSymbol]=null;const e=this[messageCallbacksSymbol].values();for(const o of e)process.nextTick(o,new ERR_INSPECTOR_CLOSED);this[messageCallbacksSymbol].clear(),this[nextIdSymbol]=1}}module.exports={open:(e,o,n)=>open(e,o,!!n),close:process._debugEnd,url,console:originalConsole,Session};"use strict";const{inspect}=require("util"),{codes:{ERR_INVALID_ARG_TYPE}}=require("internal/errors");let blue="",green="",red="",white="";const READABLE_OPERATOR={deepStrictEqual:"Input A expected to strictly deep-equal input B",notDeepStrictEqual:"Input A expected to strictly not deep-equal input B",strictEqual:"Input A expected to strictly equal input B",notStrictEqual:"Input A expected to strictly not equal input B"};function copyError(e){const t=Object.keys(e),n=Object.create(Object.getPrototypeOf(e));for(const r of t)n[r]=e[r];return Object.defineProperty(n,"message",{value:e.message}),n}function inspectValue(e){return inspect(e,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0}).split("\n")}function createErrDiff(e,t,n){var r="",i="",o=0,s="",c=!1;const l=inspectValue(e),u=inspectValue(t),p=READABLE_OPERATOR[n]+`:\n${green}+ expected${white} ${red}- actual${white}`,$=` ${blue}...${white} Lines skipped`;for(var a=l[l.length-1],h=u[u.length-1],E=0;a===h&&(E++<2?s=`\n  ${a}${s}`:r=a,l.pop(),u.pop(),0!==l.length&&0!==u.length);)a=l[l.length-1],h=u[u.length-1];E>3&&(s=`\n${blue}...${white}${s}`,c=!0),""!==r&&(s=`\n  ${r}${s}`,r="");const d=Math.max(l.length,u.length);var g=0,f=0;for(E=0;E<d;E++){const e=E-o;if(l.length<E+1?(e>1&&E>2&&(e>4?(i+=`\n${blue}...${white}`,c=!0):e>3&&(i+=`\n  ${u[E-2]}`,g++),i+=`\n  ${u[E-1]}`,g++),o=E,r+=`\n${green}+${white} ${u[E]}`,g++):u.length<E+1?(e>1&&E>2&&(e>4?(i+=`\n${blue}...${white}`,c=!0):e>3&&(i+=`\n  ${l[E-2]}`,g++),i+=`\n  ${l[E-1]}`,g++),o=E,i+=`\n${red}-${white} ${l[E]}`,g++):l[E]!==u[E]?(e>1&&E>2&&(e>4?(i+=`\n${blue}...${white}`,c=!0):e>3&&(i+=`\n  ${l[E-2]}`,g++),i+=`\n  ${l[E-1]}`,g++),o=E,i+=`\n${red}-${white} ${l[E]}`,r+=`\n${green}+${white} ${u[E]}`,g+=2):(i+=r,r="",1!==e&&0!==E||(i+=`\n  ${l[E]}`,g++),f++),g>20&&E<d-2)return`${p}${$}\n${i}\n${blue}...${white}${r}\n`+`${blue}...${white}`}if(f===d){const t="strictEqual"===n?"Input objects identical but not reference equal:":"Input objects not identical:",r=inspectValue(e);if(r.length>30)for(r[26]=`${blue}...${white}`;r.length>27;)r.pop();return`${t}\n\n${r.join("\n")}\n`}return`${p}${c?$:""}\n${i}${r}${s}`}class AssertionError extends Error{constructor(e){if("object"!=typeof e||null===e)throw new ERR_INVALID_ARG_TYPE("options","Object",e);var{actual:t,expected:n,message:r,operator:i,stackStartFn:o}=e;if(null!=r)super(String(r));else if(process.stdout.isTTY&&(1!==process.stdout.getColorDepth()?(blue="[34m",green="[32m",white="[39m",red="[31m"):(blue="",green="",white="",red="")),"object"==typeof t&&null!==t&&"object"==typeof n&&null!==n&&"stack"in t&&t instanceof Error&&"stack"in n&&n instanceof Error&&(t=copyError(t),n=copyError(n)),"deepStrictEqual"===i||"strictEqual"===i)super(createErrDiff(t,n,i));else if("notDeepStrictEqual"===i||"notStrictEqual"===i){const e=inspectValue(t),n=`Identical input passed to ${i}:`;if(e.length>30)for(e[26]=`${blue}...${white}`;e.length>27;)e.pop();1===e.length?super(`${n} ${e[0]}`):super(`${n}\n\n${e.join("\n")}\n`)}else{let e=inspect(t),r=inspect(n);e.length>128&&(e=`${e.slice(0,125)}...`),r.length>128&&(r=`${r.slice(0,125)}...`),super(`${e} ${i} ${r}`)}this.generatedMessage=!r,this.name="AssertionError [ERR_ASSERTION]",this.code="ERR_ASSERTION",this.actual=t,this.expected=n,this.operator=i,Error.captureStackTrace(this,o)}}module.exports={AssertionError};"use strict";const{ERR_ASYNC_TYPE,ERR_INVALID_ASYNC_ID}=require("internal/errors").codes,async_wrap=internalBinding("async_wrap"),{async_hook_fields,async_id_fields,owner_symbol}=async_wrap,{pushAsyncIds:pushAsyncIds_,popAsyncIds:popAsyncIds_}=async_wrap,{enablePromiseHook,disablePromiseHook}=async_wrap,active_hooks={array:[],call_depth:0,tmp_array:null,tmp_fields:null},{registerDestroyHook}=async_wrap,{kInit,kBefore,kAfter,kDestroy,kTotals,kPromiseResolve,kCheck,kExecutionAsyncId,kAsyncIdCounter,kTriggerAsyncId,kDefaultTriggerAsyncId,kStackLength}=async_wrap.constants,async_id_symbol=Symbol("asyncId"),trigger_async_id_symbol=Symbol("triggerAsyncId"),init_symbol=Symbol("init"),before_symbol=Symbol("before"),after_symbol=Symbol("after"),destroy_symbol=Symbol("destroy"),promise_resolve_symbol=Symbol("promiseResolve"),emitBeforeNative=emitHookFactory(before_symbol,"emitBeforeNative"),emitAfterNative=emitHookFactory(after_symbol,"emitAfterNative"),emitDestroyNative=emitHookFactory(destroy_symbol,"emitDestroyNative"),emitPromiseResolveNative=emitHookFactory(promise_resolve_symbol,"emitPromiseResolveNative");function fatalError(e){if("string"==typeof e.stack)process._rawDebug(e.stack);else{const s={message:e};Error.captureStackTrace(s,fatalError),process._rawDebug(s.stack)}process.binding("config").shouldAbortOnUncaughtException&&process.abort(),process.exit(1)}function validateAsyncId(e,s){async_hook_fields[kCheck]<=0||(!Number.isSafeInteger(e)||e<-1)&&fatalError(new ERR_INVALID_ASYNC_ID(s,e))}function emitInitNative(e,s,o,t){active_hooks.call_depth+=1;try{for(var i=0;i<active_hooks.array.length;i++)"function"==typeof active_hooks.array[i][init_symbol]&&active_hooks.array[i][init_symbol](e,s,o,t)}catch(e){fatalError(e)}finally{active_hooks.call_depth-=1}0===active_hooks.call_depth&&null!==active_hooks.tmp_array&&restoreActiveHooks()}function emitHookFactory(e,s){const o=function(s){active_hooks.call_depth+=1;try{for(var o=0;o<active_hooks.array.length;o++)"function"==typeof active_hooks.array[o][e]&&active_hooks.array[o][e](s)}catch(e){fatalError(e)}finally{active_hooks.call_depth-=1}0===active_hooks.call_depth&&null!==active_hooks.tmp_array&&restoreActiveHooks()};return Object.defineProperty(o,"name",{value:s}),o}function getHookArrays(){return 0===active_hooks.call_depth?[active_hooks.array,async_hook_fields]:(null===active_hooks.tmp_array&&storeActiveHooks(),[active_hooks.tmp_array,active_hooks.tmp_fields])}function storeActiveHooks(){active_hooks.tmp_array=active_hooks.array.slice(),active_hooks.tmp_fields=[],copyHooks(active_hooks.tmp_fields,async_hook_fields)}function copyHooks(e,s){e[kInit]=s[kInit],e[kBefore]=s[kBefore],e[kAfter]=s[kAfter],e[kDestroy]=s[kDestroy],e[kPromiseResolve]=s[kPromiseResolve]}function restoreActiveHooks(){active_hooks.array=active_hooks.tmp_array,copyHooks(async_hook_fields,active_hooks.tmp_fields),active_hooks.tmp_array=null,active_hooks.tmp_fields=null}function enableHooks(){enablePromiseHook(),async_hook_fields[kCheck]+=1}function disableHooks(){disablePromiseHook(),async_hook_fields[kCheck]-=1}function newAsyncId(){return++async_id_fields[kAsyncIdCounter]}function getOrSetAsyncId(e){return e.hasOwnProperty(async_id_symbol)?e[async_id_symbol]:e[async_id_symbol]=newAsyncId()}function getDefaultTriggerAsyncId(){let e=async_id_fields[kDefaultTriggerAsyncId];return e<0&&(e=async_id_fields[kExecutionAsyncId]),e}function clearDefaultTriggerAsyncId(){async_id_fields[kDefaultTriggerAsyncId]=-1}function defaultTriggerAsyncIdScope(e,s,...o){if(void 0===e)return Reflect.apply(s,null,o);const t=async_id_fields[kDefaultTriggerAsyncId];let i;async_id_fields[kDefaultTriggerAsyncId]=e;try{i=Reflect.apply(s,null,o)}finally{async_id_fields[kDefaultTriggerAsyncId]=t}return i}function initHooksExist(){return async_hook_fields[kInit]>0}function afterHooksExist(){return async_hook_fields[kAfter]>0}function destroyHooksExist(){return async_hook_fields[kDestroy]>0}function emitInitScript(e,s,o,t){if(validateAsyncId(e,"asyncId"),null!==o&&validateAsyncId(o,"triggerAsyncId"),async_hook_fields[kCheck]>0&&("string"!=typeof s||s.length<=0))throw new ERR_ASYNC_TYPE(s);0!==async_hook_fields[kInit]&&(null===o&&(o=getDefaultTriggerAsyncId()),emitInitNative(e,s,o,t))}function emitBeforeScript(e,s){validateAsyncId(e,"asyncId"),validateAsyncId(s,"triggerAsyncId"),pushAsyncIds(e,s),async_hook_fields[kBefore]>0&&emitBeforeNative(e)}function emitAfterScript(e){validateAsyncId(e,"asyncId"),async_hook_fields[kAfter]>0&&emitAfterNative(e),popAsyncIds(e)}function emitDestroyScript(e){validateAsyncId(e,"asyncId"),0===async_hook_fields[kDestroy]||e<=0||async_wrap.queueDestroyAsyncId(e)}function clearAsyncIdStack(){async_id_fields[kExecutionAsyncId]=0,async_id_fields[kTriggerAsyncId]=0,async_hook_fields[kStackLength]=0}function hasAsyncIdStack(){return async_hook_fields[kStackLength]>0}function pushAsyncIds(e,s){const o=async_hook_fields[kStackLength];if(2*o>=async_wrap.async_ids_stack.length)return pushAsyncIds_(e,s);async_wrap.async_ids_stack[2*o]=async_id_fields[kExecutionAsyncId],async_wrap.async_ids_stack[2*o+1]=async_id_fields[kTriggerAsyncId],async_hook_fields[kStackLength]++,async_id_fields[kExecutionAsyncId]=e,async_id_fields[kTriggerAsyncId]=s}function popAsyncIds(e){if(0===async_hook_fields[kStackLength])return!1;const s=async_hook_fields[kStackLength];if(async_hook_fields[kCheck]>0&&async_id_fields[kExecutionAsyncId]!==e)return popAsyncIds_(e);const o=s-1;return async_id_fields[kExecutionAsyncId]=async_wrap.async_ids_stack[2*o],async_id_fields[kTriggerAsyncId]=async_wrap.async_ids_stack[2*o+1],async_hook_fields[kStackLength]=o,o>0}function executionAsyncId(){return async_id_fields[kExecutionAsyncId]}function triggerAsyncId(){return async_id_fields[kTriggerAsyncId]}async_wrap.setupHooks({init:emitInitNative,before:emitBeforeNative,after:emitAfterNative,destroy:emitDestroyNative,promise_resolve:emitPromiseResolveNative}),module.exports={executionAsyncId,triggerAsyncId,getHookArrays,symbols:{async_id_symbol,trigger_async_id_symbol,init_symbol,before_symbol,after_symbol,destroy_symbol,promise_resolve_symbol,owner_symbol},constants:{kInit,kBefore,kAfter,kDestroy,kTotals,kPromiseResolve},enableHooks,disableHooks,clearDefaultTriggerAsyncId,clearAsyncIdStack,hasAsyncIdStack,newAsyncId,getOrSetAsyncId,getDefaultTriggerAsyncId,defaultTriggerAsyncIdScope,initHooksExist,afterHooksExist,destroyHooksExist,emitInit:emitInitScript,emitBefore:emitBeforeScript,emitAfter:emitAfterScript,emitDestroy:emitDestroyScript,registerDestroyHook};"use strict";const{options,aliases}=require("internal/options");function print(n){const o=[...options.keys(),...aliases.keys()];n.write(`_node_complete() {\n  local cur_word options\n  cur_word="\${COMP_WORDS[COMP_CWORD]}"\n  if [[ "\${cur_word}" == -* ]] ; then\n    COMPREPLY=( $(compgen -W '${o.join(" ")}' -- "\${cur_word}") )\n    return 0\n  else\n    COMPREPLY=( $(compgen -f "\${cur_word}") )\n    return 0\n  fi\n}\ncomplete -F _node_complete node node_g`)}module.exports={print};"use strict";const{NativeModule}=require("internal/bootstrap/loaders"),{hasTracing}=process.binding("config");function getCodeCache(e){const t=NativeModule.getCached(e);return t&&(t.loaded||t.loading)?t.script.createCachedData():(NativeModule.require(e),getCodeCache(e))}const depsModule=Object.keys(NativeModule._source).filter(e=>NativeModule.isDepsModule(e)||e.startsWith("internal/deps")),cannotUseCache=["config","sys","internal/v8_prof_polyfill","internal/v8_prof_processor","internal/per_context","internal/test/binding","internal/bootstrap/loaders","internal/bootstrap/node"].concat(depsModule);1!==process.config.variables.v8_enable_inspector&&(cannotUseCache.push("inspector"),cannotUseCache.push("internal/util/inspector")),hasTracing||cannotUseCache.push("trace_events"),process.versions.openssl||(cannotUseCache.push("crypto"),cannotUseCache.push("https"),cannotUseCache.push("http2"),cannotUseCache.push("tls"),cannotUseCache.push("_tls_common"),cannotUseCache.push("_tls_wrap"),cannotUseCache.push("internal/crypto/certificate"),cannotUseCache.push("internal/crypto/cipher"),cannotUseCache.push("internal/crypto/diffiehellman"),cannotUseCache.push("internal/crypto/hash"),cannotUseCache.push("internal/crypto/keygen"),cannotUseCache.push("internal/crypto/pbkdf2"),cannotUseCache.push("internal/crypto/random"),cannotUseCache.push("internal/crypto/scrypt"),cannotUseCache.push("internal/crypto/sig"),cannotUseCache.push("internal/crypto/util"),cannotUseCache.push("internal/http2/core"),cannotUseCache.push("internal/http2/compat"),cannotUseCache.push("internal/streams/lazy_transform")),module.exports={cachableBuiltins:Object.keys(NativeModule._source).filter(e=>!cannotUseCache.includes(e)),builtinSource:Object.assign({},NativeModule._source),getCodeCache,getSource:NativeModule.getSource,codeCache:internalBinding("code_cache"),compiledWithoutCache:NativeModule.compiledWithoutCache,compiledWithCache:NativeModule.compiledWithCache,nativeModuleWrap:e=>NativeModule.wrap(e),cannotUseCache};"use strict";"use strict";"use strict";const binding=process.binding("buffer"),{ERR_BUFFER_OUT_OF_BOUNDS,ERR_OUT_OF_RANGE}=require("internal/errors").codes,{validateNumber}=require("internal/validators"),{setupBufferJS}=binding;delete binding.setupBufferJS;const float32Array=new Float32Array(1),uInt8Float32Array=new Uint8Array(float32Array.buffer),float64Array=new Float64Array(1),uInt8Float64Array=new Uint8Array(float64Array.buffer);float32Array[0]=-1;const bigEndian=0===uInt8Float32Array[3];function checkBounds(t,r,n){checkNumberType(r),void 0!==t[r]&&void 0!==t[r+n]||boundsError(r,t.length-(n+1))}function checkInt(t,r,n,e,i,o){if(t>n||t<r)throw new ERR_OUT_OF_RANGE("value",`>= ${r} and <= ${n}`,t);checkBounds(e,i,o)}function checkNumberType(t,r){validateNumber(t,r||"offset")}function boundsError(t,r,n){if(Math.floor(t)!==t)throw checkNumberType(t,n),new ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(r<0)throw new ERR_BUFFER_OUT_OF_BOUNDS;throw new ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${r}`,t)}function readUIntLE(t,r){return 6===r?readUInt48LE(this,t):5===r?readUInt40LE(this,t):3===r?readUInt24LE(this,t):4===r?this.readUInt32LE(t):2===r?this.readUInt16LE(t):1===r||void 0===r?this.readUInt8(t):void boundsError(r,6,"byteLength")}function readUInt48LE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+5];return void 0!==n&&void 0!==e||boundsError(r,t.length-6),n+256*t[++r]+65536*t[++r]+t[++r]*2**24+(t[++r]+256*e)*2**32}function readUInt40LE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+4];return void 0!==n&&void 0!==e||boundsError(r,t.length-5),n+256*t[++r]+65536*t[++r]+t[++r]*2**24+e*2**32}function readUInt32LE(t=0){checkNumberType(t);const r=this[t],n=this[t+3];return void 0!==r&&void 0!==n||boundsError(t,this.length-4),r+256*this[++t]+65536*this[++t]+n*2**24}function readUInt24LE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+2];return void 0!==n&&void 0!==e||boundsError(r,t.length-3),n+256*t[++r]+65536*e}function readUInt16LE(t=0){checkNumberType(t);const r=this[t],n=this[t+1];return void 0!==r&&void 0!==n||boundsError(t,this.length-2),r+256*n}function readUInt8(t=0){checkNumberType(t);const r=this[t];return void 0===r&&boundsError(t,this.length-1),r}function readUIntBE(t,r){return 6===r?readUInt48BE(this,t):5===r?readUInt40BE(this,t):3===r?readUInt24BE(this,t):4===r?this.readUInt32BE(t):2===r?this.readUInt16BE(t):1===r||void 0===r?this.readUInt8(t):void boundsError(r,6,"byteLength")}function readUInt48BE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+5];return void 0!==n&&void 0!==e||boundsError(r,t.length-6),(256*n+t[++r])*2**32+t[++r]*2**24+65536*t[++r]+256*t[++r]+e}function readUInt40BE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+4];return void 0!==n&&void 0!==e||boundsError(r,t.length-5),n*2**32+t[++r]*2**24+65536*t[++r]+256*t[++r]+e}function readUInt32BE(t=0){checkNumberType(t);const r=this[t],n=this[t+3];return void 0!==r&&void 0!==n||boundsError(t,this.length-4),r*2**24+65536*this[++t]+256*this[++t]+n}function readUInt24BE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+2];return void 0!==n&&void 0!==e||boundsError(r,t.length-3),65536*n+256*t[++r]+e}function readUInt16BE(t=0){checkNumberType(t);const r=this[t],n=this[t+1];return void 0!==r&&void 0!==n||boundsError(t,this.length-2),256*r+n}function readIntLE(t,r){return 6===r?readInt48LE(this,t):5===r?readInt40LE(this,t):3===r?readInt24LE(this,t):4===r?this.readInt32LE(t):2===r?this.readInt16LE(t):1===r||void 0===r?this.readInt8(t):void boundsError(r,6,"byteLength")}function readInt48LE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+5];void 0!==n&&void 0!==e||boundsError(r,t.length-6);const i=t[r+4]+256*e;return(i|131070*(32768&i))*2**32+n+256*t[++r]+65536*t[++r]+t[++r]*2**24}function readInt40LE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+4];return void 0!==n&&void 0!==e||boundsError(r,t.length-5),(e|33554430*(128&e))*2**32+n+256*t[++r]+65536*t[++r]+t[++r]*2**24}function readInt32LE(t=0){checkNumberType(t);const r=this[t],n=this[t+3];return void 0!==r&&void 0!==n||boundsError(t,this.length-4),r+256*this[++t]+65536*this[++t]+(n<<24)}function readInt24LE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+2];void 0!==n&&void 0!==e||boundsError(r,t.length-3);const i=n+256*t[++r]+65536*e;return i|510*(i&2**23)}function readInt16LE(t=0){checkNumberType(t);const r=this[t],n=this[t+1];void 0!==r&&void 0!==n||boundsError(t,this.length-2);const e=r+256*n;return e|131070*(32768&e)}function readInt8(t=0){checkNumberType(t);const r=this[t];return void 0===r&&boundsError(t,this.length-1),r|33554430*(128&r)}function readIntBE(t,r){return 6===r?readInt48BE(this,t):5===r?readInt40BE(this,t):3===r?readInt24BE(this,t):4===r?this.readInt32BE(t):2===r?this.readInt16BE(t):1===r||void 0===r?this.readInt8(t):void boundsError(r,6,"byteLength")}function readInt48BE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+5];void 0!==n&&void 0!==e||boundsError(r,t.length-6);const i=t[++r]+256*n;return(i|131070*(32768&i))*2**32+t[++r]*2**24+65536*t[++r]+256*t[++r]+e}function readInt40BE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+4];return void 0!==n&&void 0!==e||boundsError(r,t.length-5),(n|33554430*(128&n))*2**32+t[++r]*2**24+65536*t[++r]+256*t[++r]+e}function readInt32BE(t=0){checkNumberType(t);const r=this[t],n=this[t+3];return void 0!==r&&void 0!==n||boundsError(t,this.length-4),(r<<24)+65536*this[++t]+256*this[++t]+n}function readInt24BE(t,r=0){checkNumberType(r);const n=t[r],e=t[r+2];void 0!==n&&void 0!==e||boundsError(r,t.length-3);const i=65536*n+256*t[++r]+e;return i|510*(i&2**23)}function readInt16BE(t=0){checkNumberType(t);const r=this[t],n=this[t+1];void 0!==r&&void 0!==n||boundsError(t,this.length-2);const e=256*r+n;return e|131070*(32768&e)}function readFloatBackwards(t=0){checkNumberType(t);const r=this[t],n=this[t+3];return void 0!==r&&void 0!==n||boundsError(t,this.length-4),uInt8Float32Array[3]=r,uInt8Float32Array[2]=this[++t],uInt8Float32Array[1]=this[++t],uInt8Float32Array[0]=n,float32Array[0]}function readFloatForwards(t=0){checkNumberType(t);const r=this[t],n=this[t+3];return void 0!==r&&void 0!==n||boundsError(t,this.length-4),uInt8Float32Array[0]=r,uInt8Float32Array[1]=this[++t],uInt8Float32Array[2]=this[++t],uInt8Float32Array[3]=n,float32Array[0]}function readDoubleBackwards(t=0){checkNumberType(t);const r=this[t],n=this[t+7];return void 0!==r&&void 0!==n||boundsError(t,this.length-8),uInt8Float64Array[7]=r,uInt8Float64Array[6]=this[++t],uInt8Float64Array[5]=this[++t],uInt8Float64Array[4]=this[++t],uInt8Float64Array[3]=this[++t],uInt8Float64Array[2]=this[++t],uInt8Float64Array[1]=this[++t],uInt8Float64Array[0]=n,float64Array[0]}function readDoubleForwards(t=0){checkNumberType(t);const r=this[t],n=this[t+7];return void 0!==r&&void 0!==n||boundsError(t,this.length-8),uInt8Float64Array[0]=r,uInt8Float64Array[1]=this[++t],uInt8Float64Array[2]=this[++t],uInt8Float64Array[3]=this[++t],uInt8Float64Array[4]=this[++t],uInt8Float64Array[5]=this[++t],uInt8Float64Array[6]=this[++t],uInt8Float64Array[7]=n,float64Array[0]}function writeUIntLE(t,r=0,n){return 6===n?writeU_Int48LE(this,t,r,0,0xffffffffffff):5===n?writeU_Int40LE(this,t,r,0,0xffffffffff):3===n?writeU_Int24LE(this,t,r,0,16777215):4===n?writeU_Int32LE(this,t,r,0,4294967295):2===n?writeU_Int16LE(this,t,r,0,65535):1===n||void 0===n?writeU_Int8(this,t,r,0,255):void boundsError(n,6,"byteLength")}function writeU_Int48LE(t,r,n,e,i){checkInt(r=+r,e,i,t,n,5);const o=Math.floor(r*2**-32);return t[n++]=r,r>>>=8,t[n++]=r,r>>>=8,t[n++]=r,r>>>=8,t[n++]=r,t[n++]=o,t[n++]=o>>>8,n}function writeU_Int40LE(t,r,n,e,i){checkInt(r=+r,e,i,t,n,4);const o=r;return t[n++]=r,r>>>=8,t[n++]=r,r>>>=8,t[n++]=r,r>>>=8,t[n++]=r,t[n++]=Math.floor(o*2**-32),n}function writeU_Int32LE(t,r,n,e,i){return checkInt(r=+r,e,i,t,n,3),t[n++]=r,r>>>=8,t[n++]=r,r>>>=8,t[n++]=r,r>>>=8,t[n++]=r,n}function writeUInt32LE(t,r=0){return writeU_Int32LE(this,t,r,0,4294967295)}function writeU_Int24LE(t,r,n,e,i){return checkInt(r=+r,e,i,t,n,2),t[n++]=r,r>>>=8,t[n++]=r,r>>>=8,t[n++]=r,n}function writeU_Int16LE(t,r,n,e,i){return checkInt(r=+r,e,i,t,n,1),t[n++]=r,t[n++]=r>>>8,n}function writeUInt16LE(t,r=0){return writeU_Int16LE(this,t,r,0,65535)}function writeU_Int8(t,r,n,e,i){if(r=+r,checkNumberType(n),r>i||r<e)throw new ERR_OUT_OF_RANGE("value",`>= ${e} and <= ${i}`,r);return void 0===t[n]&&boundsError(n,t.length-1),t[n]=r,n+1}function writeUInt8(t,r=0){return writeU_Int8(this,t,r,0,255)}function writeUIntBE(t,r=0,n){return 6===n?writeU_Int48BE(this,t,r,0,72057594037927940):5===n?writeU_Int40BE(this,t,r,0,0xffffffffff):3===n?writeU_Int24BE(this,t,r,0,16777215):4===n?writeU_Int32BE(this,t,r,0,4294967295):2===n?writeU_Int16BE(this,t,r,0,65535):1===n||void 0===n?writeU_Int8(this,t,r,0,255):void boundsError(n,6,"byteLength")}function writeU_Int48BE(t,r,n,e,i){checkInt(r=+r,e,i,t,n,5);const o=Math.floor(r*2**-32);return t[n++]=o>>>8,t[n++]=o,t[n+3]=r,r>>>=8,t[n+2]=r,r>>>=8,t[n+1]=r,r>>>=8,t[n]=r,n+4}function writeU_Int40BE(t,r,n,e,i){return checkInt(r=+r,e,i,t,n,4),t[n++]=Math.floor(r*2**-32),t[n+3]=r,r>>>=8,t[n+2]=r,r>>>=8,t[n+1]=r,r>>>=8,t[n]=r,n+4}function writeU_Int32BE(t,r,n,e,i){return checkInt(r=+r,e,i,t,n,3),t[n+3]=r,r>>>=8,t[n+2]=r,r>>>=8,t[n+1]=r,r>>>=8,t[n]=r,n+4}function writeUInt32BE(t,r=0){return writeU_Int32BE(this,t,r,0,4294967295)}function writeU_Int24BE(t,r,n,e,i){return checkInt(r=+r,e,i,t,n,2),t[n+2]=r,r>>>=8,t[n+1]=r,r>>>=8,t[n]=r,n+3}function writeU_Int16BE(t,r,n,e,i){return checkInt(r=+r,e,i,t,n,1),t[n++]=r>>>8,t[n++]=r,n}function writeUInt16BE(t,r=0){return writeU_Int16BE(this,t,r,0,4294967295)}function writeIntLE(t,r=0,n){return 6===n?writeU_Int48LE(this,t,r,-0x800000000000,0x7fffffffffff):5===n?writeU_Int40LE(this,t,r,-549755813888,549755813887):3===n?writeU_Int24LE(this,t,r,-8388608,8388607):4===n?writeU_Int32LE(this,t,r,-2147483648,2147483647):2===n?writeU_Int16LE(this,t,r,-32768,32767):1===n||void 0===n?writeU_Int8(this,t,r,-128,127):void boundsError(n,6,"byteLength")}function writeInt32LE(t,r=0){return writeU_Int32LE(this,t,r,-2147483648,2147483647)}function writeInt16LE(t,r=0){return writeU_Int16LE(this,t,r,-32768,32767)}function writeInt8(t,r=0){return writeU_Int8(this,t,r,-128,127)}function writeIntBE(t,r=0,n){return 6===n?writeU_Int48BE(this,t,r,-0x800000000000,0x7fffffffffff):5===n?writeU_Int40BE(this,t,r,-549755813888,549755813887):3===n?writeU_Int24BE(this,t,r,-8388608,8388607):4===n?writeU_Int32BE(this,t,r,-2147483648,2147483647):2===n?writeU_Int16BE(this,t,r,-32768,32767):1===n||void 0===n?writeU_Int8(this,t,r,-128,127):void boundsError(n,6,"byteLength")}function writeInt32BE(t,r=0){return writeU_Int32BE(this,t,r,-2147483648,2147483647)}function writeInt16BE(t,r=0){return writeU_Int16BE(this,t,r,-32768,32767)}function writeDoubleForwards(t,r=0){return t=+t,checkBounds(this,r,7),float64Array[0]=t,this[r++]=uInt8Float64Array[0],this[r++]=uInt8Float64Array[1],this[r++]=uInt8Float64Array[2],this[r++]=uInt8Float64Array[3],this[r++]=uInt8Float64Array[4],this[r++]=uInt8Float64Array[5],this[r++]=uInt8Float64Array[6],this[r++]=uInt8Float64Array[7],r}function writeDoubleBackwards(t,r=0){return t=+t,checkBounds(this,r,7),float64Array[0]=t,this[r++]=uInt8Float64Array[7],this[r++]=uInt8Float64Array[6],this[r++]=uInt8Float64Array[5],this[r++]=uInt8Float64Array[4],this[r++]=uInt8Float64Array[3],this[r++]=uInt8Float64Array[2],this[r++]=uInt8Float64Array[1],this[r++]=uInt8Float64Array[0],r}function writeFloatForwards(t,r=0){return t=+t,checkBounds(this,r,3),float32Array[0]=t,this[r++]=uInt8Float32Array[0],this[r++]=uInt8Float32Array[1],this[r++]=uInt8Float32Array[2],this[r++]=uInt8Float32Array[3],r}function writeFloatBackwards(t,r=0){return t=+t,checkBounds(this,r,3),float32Array[0]=t,this[r++]=uInt8Float32Array[3],this[r++]=uInt8Float32Array[2],this[r++]=uInt8Float32Array[1],this[r++]=uInt8Float32Array[0],r}module.exports={setupBufferJS,readWrites:{readUIntLE,readUInt32LE,readUInt16LE,readUInt8,readUIntBE,readUInt32BE,readUInt16BE,readIntLE,readInt32LE,readInt16LE,readInt8,readIntBE,readInt32BE,readInt16BE,writeUIntLE,writeUInt32LE,writeUInt16LE,writeUInt8,writeUIntBE,writeUInt32BE,writeUInt16BE,writeIntLE,writeInt32LE,writeInt16LE,writeInt8,writeIntBE,writeInt32BE,writeInt16BE,readFloatLE:bigEndian?readFloatBackwards:readFloatForwards,readFloatBE:bigEndian?readFloatForwards:readFloatBackwards,readDoubleLE:bigEndian?readDoubleBackwards:readDoubleForwards,readDoubleBE:bigEndian?readDoubleForwards:readDoubleBackwards,writeFloatLE:bigEndian?writeFloatBackwards:writeFloatForwards,writeFloatBE:bigEndian?writeFloatForwards:writeFloatBackwards,writeDoubleLE:bigEndian?writeDoubleBackwards:writeDoubleForwards,writeDoubleBE:bigEndian?writeDoubleForwards:writeDoubleBackwards}};"use strict";const{errnoException,codes:{ERR_INVALID_ARG_TYPE,ERR_INVALID_HANDLE_TYPE,ERR_INVALID_OPT_VALUE,ERR_INVALID_SYNC_FORK_INPUT,ERR_IPC_CHANNEL_CLOSED,ERR_IPC_DISCONNECTED,ERR_IPC_ONE_PIPE,ERR_IPC_SYNC_FORK,ERR_MISSING_ARGS}}=require("internal/errors"),{validateString}=require("internal/validators"),EventEmitter=require("events"),net=require("net"),dgram=require("dgram"),util=require("util"),assert=require("assert"),{Process}=internalBinding("process_wrap"),{WriteWrap}=internalBinding("stream_wrap"),{Pipe,constants:PipeConstants}=internalBinding("pipe_wrap"),{TCP}=internalBinding("tcp_wrap"),{TTY}=internalBinding("tty_wrap"),{UDP}=internalBinding("udp_wrap"),SocketList=require("internal/socket_list"),{owner_symbol}=require("internal/async_hooks").symbols,{convertToValidSignal}=require("internal/util"),{isArrayBufferView}=require("internal/util/types"),spawn_sync=process.binding("spawn_sync"),{HTTPParser}=process.binding("http_parser"),{freeParser}=require("_http_common"),{kStateSymbol}=require("internal/dgram"),{UV_EACCES,UV_EAGAIN,UV_EINVAL,UV_EMFILE,UV_ENFILE,UV_ENOENT,UV_ENOSYS,UV_ESRCH}=process.binding("uv"),{SocketListSend,SocketListReceive}=SocketList;let StringDecoder;const MAX_HANDLE_RETRANSMISSIONS=3,handleConversion={"net.Native":{simultaneousAccepts:!0,send:function(e,n,t){return n},got:function(e,n,t){t(n)}},"net.Server":{simultaneousAccepts:!0,send:function(e,n,t){return n._handle},got:function(e,n,t){var i=new net.Server;i.listen(n,function(){t(i)})}},"net.Socket":{send:function(e,n,t){if(n._handle){if(n.server){e.key=n.server._connectionKey;var i=!this.channel.sockets.send[e.key],s=getSocketList("send",this,e.key);i&&n.server._setupWorker(s),t.keepOpen||n.server._connections--}var r=n._handle;return t.keepOpen||(r.onread=nop,n._handle=null,n.setTimeout(0),n.parser&&n.parser instanceof HTTPParser&&(freeParser(n.parser,null,n),n._httpMessage&&n._httpMessage.detachSocket(n))),r}},postSend:function(e,n,t,i,s){n&&!t.keepOpen&&(s?(assert(!s._pendingMessage),s._pendingMessage={callback:i,message:e,handle:n,options:t,retransmissions:0}):n.close())},got:function(e,n,t){var i=new net.Socket({handle:n,readable:!0,writable:!0});e.key&&getSocketList("got",this,e.key).add({socket:i});t(i)}},"dgram.Native":{simultaneousAccepts:!1,send:function(e,n,t){return n},got:function(e,n,t){t(n)}},"dgram.Socket":{simultaneousAccepts:!1,send:function(e,n,t){return e.dgramType=n.type,n[kStateSymbol].handle},got:function(e,n,t){var i=new dgram.Socket(e.dgramType);i.bind(n,function(){t(i)})}}};function ChildProcess(){EventEmitter.call(this),this._closesNeeded=1,this._closesGot=0,this.connected=!1,this.signalCode=null,this.exitCode=null,this.killed=!1,this.spawnfile=null,this._handle=new Process,this._handle[owner_symbol]=this,this._handle.onexit=((e,n)=>{if(n?this.signalCode=n:this.exitCode=e,this.stdin&&this.stdin.destroy(),this._handle.close(),this._handle=null,e<0){var t=this.spawnfile?"spawn "+this.spawnfile:"spawn";const n=errnoException(e,t);this.spawnfile&&(n.path=this.spawnfile),n.spawnargs=this.spawnargs.slice(1),this.emit("error",n)}else this.emit("exit",this.exitCode,this.signalCode);process.nextTick(flushStdio,this),maybeClose(this)})}function flushStdio(e){const n=e.stdio;if(null!=n)for(var t=0;t<n.length;t++){const e=n[t];e&&e.readable&&!e._readableState.readableListening&&e.resume()}}function createSocket(e,n){return net.Socket({handle:e,readable:n,writable:!n})}function getHandleWrapType(e){return e instanceof Pipe?"pipe":e instanceof TTY?"tty":e instanceof TCP?"tcp":e instanceof UDP&&"udp"}function closePendingHandle(e){e._pendingMessage.handle.close(),e._pendingMessage=null}function onErrorNT(e,n){e._handle.onexit(n)}util.inherits(ChildProcess,EventEmitter),ChildProcess.prototype.spawn=function(e){var n,t,i;if(null===e||"object"!=typeof e)throw new ERR_INVALID_ARG_TYPE("options","Object",e);var s=e.stdio||"pipe";if(n=(s=_validateStdio(s,!1)).ipc,t=s.ipcFd,s=e.stdio=s.stdio,void 0!==n){if(void 0===e.envPairs)e.envPairs=[];else if(!Array.isArray(e.envPairs))throw new ERR_INVALID_ARG_TYPE("options.envPairs","Array",e.envPairs);e.envPairs.push("NODE_CHANNEL_FD="+t)}if(validateString(e.file,"options.file"),this.spawnfile=e.file,Array.isArray(e.args))this.spawnargs=e.args;else{if(void 0!==e.args)throw new ERR_INVALID_ARG_TYPE("options.args","Array",e.args);this.spawnargs=[]}var r=this._handle.spawn(e);if(r===UV_EACCES||r===UV_EAGAIN||r===UV_EMFILE||r===UV_ENFILE||r===UV_ENOENT){if(process.nextTick(onErrorNT,this,r),r!==UV_ENOENT)return r}else if(r){for(i=0;i<s.length;i++){const e=s[i];"pipe"===e.type&&e.handle.close()}throw this._handle.close(),this._handle=null,errnoException(r,"spawn")}for(this.pid=this._handle.pid,i=0;i<s.length;i++){const e=s[i];"ignore"!==e.type&&(e.ipc?this._closesNeeded++:e.handle&&(e.socket=createSocket(0!==this.pid?e.handle:null,i>0),i>0&&0!==this.pid&&(this._closesNeeded++,e.socket.on("close",()=>{maybeClose(this)}))))}for(this.stdin=s.length>=1&&void 0!==s[0].socket?s[0].socket:null,this.stdout=s.length>=2&&void 0!==s[1].socket?s[1].socket:null,this.stderr=s.length>=3&&void 0!==s[2].socket?s[2].socket:null,this.stdio=[],i=0;i<s.length;i++)this.stdio.push(void 0===s[i].socket?null:s[i].socket);return void 0!==n&&setupChannel(this,n),r},ChildProcess.prototype.kill=function(e){const n=0===e?e:convertToValidSignal(void 0===e?"SIGTERM":e);if(this._handle){var t=this._handle.kill(n);if(0===t)return this.killed=!0,!0;if(t===UV_ESRCH);else{if(t===UV_EINVAL||t===UV_ENOSYS)throw errnoException(t,"kill");this.emit("error",errnoException(t,"kill"))}}return!1},ChildProcess.prototype.ref=function(){this._handle&&this._handle.ref()},ChildProcess.prototype.unref=function(){this._handle&&this._handle.unref()};class Control extends EventEmitter{constructor(e){super(),this.channel=e,this.refs=0}ref(){1==++this.refs&&this.channel.ref()}unref(){0==--this.refs&&(this.channel.unref(),this.emit("unref"))}}function setupChannel(e,n){e.channel=n,Object.defineProperty(e,"_channel",{get:()=>e.channel,set(n){e.channel=n},enumerable:!0}),e._handleQueue=null,e._pendingMessage=null;const t=new Control(n);void 0===StringDecoder&&(StringDecoder=require("string_decoder").StringDecoder);var i=new StringDecoder("utf8"),s="",r=null;function o(n,t,i){e.emit(n,t,i)}function a(n,t,i){if(e.channel){var s=i?"internalMessage":"message";process.nextTick(o,s,n,t)}}return n.buffering=!1,n.pendingHandle=null,n.onread=function(t,o){const l=n.pendingHandle;if(n.pendingHandle=null,o){l&&(r=l);var c=i.write(o).split("\n"),d=c.length-1,p=c[d];if(0===d)return s+=p,void(this.buffering=0!==s.length);c[0]=s+c[0];for(var u=0;u<d;u++){var h=JSON.parse(c[u]);isInternal(h)?"NODE_HANDLE"===h.cmd?(a(h,r,!0),r=null):a(h,void 0,!0):a(h,void 0,!1)}s=p,this.buffering=0!==s.length}else this.buffering=!1,e.disconnect(),n.onread=nop,n.close(),e.channel=null,maybeClose(e)},n.sockets={got:{},send:{}},e.on("internalMessage",function(n,t){if("NODE_HANDLE_ACK"!==n.cmd&&"NODE_HANDLE_NACK"!==n.cmd){if("NODE_HANDLE"===n.cmd){if(!t)return e._send({cmd:"NODE_HANDLE_NACK"},null,!0);e._send({cmd:"NODE_HANDLE_ACK"},null,!0);var i=handleConversion[n.type];"win32"===process.platform&&(t._simultaneousAccepts=!1,net._setSimultaneousAccepts(t)),i.got.call(this,n,t,function(e){a(n.msg,e,isInternal(n.msg))})}}else{e._pendingMessage&&("NODE_HANDLE_ACK"===n.cmd?closePendingHandle(e):e._pendingMessage.retransmissions++===MAX_HANDLE_RETRANSMISSIONS&&(closePendingHandle(e),process.emitWarning("Handle did not reach the receiving process correctly","SentHandleNotReceivedWarning"))),assert(Array.isArray(e._handleQueue));var s=e._handleQueue;e._handleQueue=null,e._pendingMessage&&e._send(e._pendingMessage.message,e._pendingMessage.handle,e._pendingMessage.options,e._pendingMessage.callback);for(var r=0;r<s.length;r++){var o=s[r];e._send(o.message,o.handle,o.options,o.callback)}e.connected||!e.channel||e._handleQueue||e._disconnect()}}),e.send=function(e,n,t,i){if("function"==typeof n)i=n,n=void 0,t=void 0;else if("function"==typeof t)i=t,t=void 0;else if(void 0!==t&&(null===t||"object"!=typeof t))throw new ERR_INVALID_ARG_TYPE("options","Object",t);if(t=Object.assign({swallowErrors:!1},t),this.connected)return this._send(e,n,t,i);const s=new ERR_IPC_CHANNEL_CLOSED;return"function"==typeof i?process.nextTick(i,s):process.nextTick(()=>this.emit("error",s)),!1},e._send=function(i,s,r,o){if(assert(this.connected||this.channel),void 0===i)throw new ERR_MISSING_ARGS("message");if("boolean"==typeof r&&(r={swallowErrors:r}),s){if(i={cmd:"NODE_HANDLE",type:null,msg:i},s instanceof net.Socket)i.type="net.Socket";else if(s instanceof net.Server)i.type="net.Server";else if(s instanceof TCP||s instanceof Pipe)i.type="net.Native";else if(s instanceof dgram.Socket)i.type="dgram.Socket";else{if(!(s instanceof UDP))throw new ERR_INVALID_HANDLE_TYPE;i.type="dgram.Native"}if(this._handleQueue)return this._handleQueue.push({callback:o,handle:s,options:r,message:i.msg}),1===this._handleQueue.length;var a=handleConversion[i.type];(s=handleConversion[i.type].send.call(e,i,s,r))||(i=i.msg),a.simultaneousAccepts&&net._setSimultaneousAccepts(s)}else if(this._handleQueue&&(!i||"NODE_HANDLE_ACK"!==i.cmd&&"NODE_HANDLE_NACK"!==i.cmd))return this._handleQueue.push({callback:o,handle:null,options:r,message:i}),1===this._handleQueue.length;var l=new WriteWrap;l.async=!1;var c=JSON.stringify(i)+"\n",d=n.writeUtf8String(l,c,s);if(0===d)s&&(this._handleQueue||(this._handleQueue=[]),a&&a.postSend&&a.postSend(i,s,r,o,e)),l.async?(l.oncomplete=function(){t.unref(),"function"==typeof o&&o(null)},t.ref()):"function"==typeof o&&process.nextTick(o,null);else if(a&&a.postSend&&a.postSend(i,s,r,o),!r.swallowErrors){const e=errnoException(d,"write");"function"==typeof o?process.nextTick(o,e):process.nextTick(()=>this.emit("error",e))}return n.writeQueueSize<131072},e.connected=!0,e.disconnect=function(){this.connected?(this.connected=!1,this._handleQueue||this._disconnect()):this.emit("error",new ERR_IPC_DISCONNECTED)},e._disconnect=function(){assert(this.channel),this.channel=null,this._pendingMessage&&closePendingHandle(this);var t=!1;function i(){t||(t=!0,n.close(),e.emit("disconnect"))}if(n.buffering)return this.once("message",i),void this.once("internalMessage",i);process.nextTick(i)},n.readStart(),t}const INTERNAL_PREFIX="NODE_";function isInternal(e){return null!==e&&"object"==typeof e&&"string"==typeof e.cmd&&e.cmd.length>INTERNAL_PREFIX.length&&e.cmd.slice(0,INTERNAL_PREFIX.length)===INTERNAL_PREFIX}function nop(){}function _validateStdio(e,n){var t,i;if("string"==typeof e)switch(e){case"ignore":e=["ignore","ignore","ignore"];break;case"pipe":e=["pipe","pipe","pipe"];break;case"inherit":e=[0,1,2];break;default:throw new ERR_INVALID_OPT_VALUE("stdio",e)}else if(!Array.isArray(e))throw new ERR_INVALID_OPT_VALUE("stdio",util.inspect(e));for(;e.length<3;)e.push(void 0);return{stdio:e=e.reduce(function(e,s,r){function o(){for(var n=0;n<e.length;n++)"pipe"!==e[n].type&&"ipc"!==e[n].type||!e[n].handle||e[n].handle.close()}if(null==s&&(s=r<3?"pipe":"ignore"),"ignore"===s)e.push({type:"ignore"});else if("pipe"===s||"number"==typeof s&&s<0){var a={type:"pipe",readable:0===r,writable:0!==r};n||(a.handle=new Pipe(PipeConstants.SOCKET)),e.push(a)}else if("ipc"===s){if(n||void 0!==t)throw o(),n?new ERR_IPC_SYNC_FORK:new ERR_IPC_ONE_PIPE;t=new Pipe(PipeConstants.IPC),i=r,e.push({type:"pipe",handle:t,ipc:!0})}else if("inherit"===s)e.push({type:"inherit",fd:r});else if("number"==typeof s||"number"==typeof s.fd)e.push({type:"fd",fd:"number"==typeof s?s:s.fd});else if(getHandleWrapType(s)||getHandleWrapType(s.handle)||getHandleWrapType(s._handle)){var l=getHandleWrapType(s)?s:getHandleWrapType(s.handle)?s.handle:s._handle;e.push({type:"wrap",wrapType:getHandleWrapType(l),handle:l})}else{if(!isArrayBufferView(s)&&"string"!=typeof s)throw o(),new ERR_INVALID_OPT_VALUE("stdio",util.inspect(s));if(!n)throw o(),new ERR_INVALID_SYNC_FORK_INPUT(util.inspect(s))}return e},[]),ipc:t,ipcFd:i}}function getSocketList(e,n,t){var i=n.channel.sockets[e],s=i[t];if(!s){var r="send"===e?SocketListSend:SocketListReceive;s=i[t]=new r(n,t)}return s}function maybeClose(e){e._closesGot++,e._closesGot===e._closesNeeded&&e.emit("close",e.exitCode,e.signalCode)}function spawnSync(e){var n=e.options,t=spawn_sync.spawn(n);if(t.output&&n.encoding&&"buffer"!==n.encoding)for(var i=0;i<t.output.length;i++)t.output[i]&&(t.output[i]=t.output[i].toString(n.encoding));return t.stdout=t.output&&t.output[1],t.stderr=t.output&&t.output[2],t.error&&(t.error=errnoException(t.error,"spawnSync "+e.file),t.error.path=e.file,t.error.spawnargs=e.args.slice(1)),t}module.exports={ChildProcess,setupChannel,_validateStdio,spawnSync};"use strict";const{Buffer}=require("buffer"),{removeColors}=require("internal/util"),HasOwnProperty=Function.call.bind(Object.prototype.hasOwnProperty),tableChars={middleMiddle:"─",rowMiddle:"┼",topRight:"┐",topLeft:"┌",leftMiddle:"├",topMiddle:"┬",bottomRight:"┘",bottomLeft:"└",bottomMiddle:"┴",rightMiddle:"┤",left:"│ ",right:" │",middle:" │ "},countSymbols=t=>{const e=removeColors(t).normalize("NFC");return Buffer.from(e,"UCS-2").byteLength/2},renderRow=(t,e)=>{let r=tableChars.left;for(var o=0;o<t.length;o++){const l=t[o],a=countSymbols(l),d=(e[o]-a)/2;r+=`${" ".repeat(d)}${l}${" ".repeat(Math.ceil(d))}`,o!==t.length-1&&(r+=tableChars.middle)}return r+=tableChars.right},table=(t,e)=>{const r=[],o=t.map(t=>countSymbols(t)),l=e.reduce((t,e)=>Math.max(t,e.length),0);for(var a=0;a<t.length;a++){const t=e[a];for(var d=0;d<l;d++){void 0===r[d]&&(r[d]=[]);const e=r[d][a]=HasOwnProperty(t,d)?t[d]:"",l=o[a]||0,n=countSymbols(e);o[a]=Math.max(l,n)}}const n=o.map(t=>tableChars.middleMiddle.repeat(t+2));let i=`${tableChars.topLeft}${n.join(tableChars.topMiddle)}`+`${tableChars.topRight}\n${renderRow(t,o)}\n`+`${tableChars.leftMiddle}${n.join(tableChars.rowMiddle)}`+`${tableChars.rightMiddle}\n`;for(const t of r)i+=`${renderRow(t,o)}\n`;return i+=`${tableChars.bottomLeft}${n.join(tableChars.bottomMiddle)}`+tableChars.bottomRight};module.exports=table;"use strict";const assert=require("assert"),util=require("util"),path=require("path"),EventEmitter=require("events"),{owner_symbol}=require("internal/async_hooks").symbols,Worker=require("internal/cluster/worker"),{internal,sendHelper}=require("internal/cluster/utils"),cluster=new EventEmitter,handles=new Map,indexes=new Map,noop=()=>{};function shared(e,n,t,s){const r=e.key,o=n.close;n.close=function(){return send({act:"close",key:r}),handles.delete(r),indexes.delete(t),o.apply(this,arguments)}.bind(n),assert(!1===handles.has(r)),handles.set(r,n),s(e.errno,n)}function rr(e,n,t){if(e.errno)return t(e.errno,null);var s=e.key;const r={close:function(){void 0!==s&&(send({act:"close",key:s}),handles.delete(s),indexes.delete(n),s=void 0)},listen:function(e){return 0},ref:noop,unref:noop};e.sockname&&(r.getsockname=function(n){return s&&util._extend(n,e.sockname),0}),assert(!1===handles.has(s)),handles.set(s,r),t(0,r)}function onconnection(e,n){const t=e.key,s=handles.get(t),r=void 0!==s;send({ack:e.seq,accepted:r}),r&&s.onconnection(0,n)}function send(e,n){return sendHelper(process,e,null,n)}function _disconnect(e){this.exitedAfterDisconnect=!0;let n=1;function t(){0===--n&&(e?process.disconnect():send({act:"exitedAfterDisconnect"},()=>process.disconnect()))}handles.forEach(e=>{n++,e[owner_symbol]?e[owner_symbol].close(t):e.close(t)}),handles.clear(),t()}module.exports=cluster,cluster.isWorker=!0,cluster.isMaster=!1,cluster.worker=null,cluster.Worker=Worker,cluster._setupWorker=function(){const e=new Worker({id:0|+process.env.NODE_UNIQUE_ID,process,state:"online"});cluster.worker=e,process.once("disconnect",()=>{e.emit("disconnect"),e.exitedAfterDisconnect||process.exit(0)}),process.on("internalMessage",internal(e,function(n,t){"newconn"===n.act?onconnection(n,t):"disconnect"===n.act&&_disconnect.call(e,!0)})),send({act:"online"})},cluster._getServer=function(e,n,t){let s=n.address;n.port<0&&"string"==typeof s&&"win32"!==process.platform&&(s=path.resolve(s));const r=[s,n.port,n.addressType,n.fd].join(":");let o=indexes.get(r);void 0===o?o=0:o++,indexes.set(r,o);const c=util._extend({act:"queryServer",index:o,data:null},n);c.address=s,e._getServerData&&(c.data=e._getServerData()),send(c,(n,s)=>{"function"==typeof e._setServerData&&e._setServerData(n.data),s?shared(n,s,r,t):rr(n,r,t)}),e.once("listening",()=>{cluster.worker.state="listening";const t=e.address();c.act="listening",c.port=t&&t.port||n.port,send(c)})},Worker.prototype.disconnect=function(){return _disconnect.call(this),this},Worker.prototype.destroy=function(){this.exitedAfterDisconnect=!0,this.isConnected()?(send({act:"exitedAfterDisconnect"},()=>process.disconnect()),process.once("disconnect",()=>process.exit(0))):process.exit(0)};"use strict";const assert=require("assert"),{fork}=require("child_process"),util=require("util"),path=require("path"),EventEmitter=require("events"),RoundRobinHandle=require("internal/cluster/round_robin_handle"),SharedHandle=require("internal/cluster/shared_handle"),Worker=require("internal/cluster/worker"),{internal,sendHelper}=require("internal/cluster/utils"),{ERR_SOCKET_BAD_PORT}=require("internal/errors").codes,keys=Object.keys,cluster=new EventEmitter,intercom=new EventEmitter,SCHED_NONE=1,SCHED_RR=2,{isLegalPort}=require("internal/net"),[minPort,maxPort]=[1024,65535];module.exports=cluster;const handles=new Map;cluster.isWorker=!1,cluster.isMaster=!0,cluster.Worker=Worker,cluster.workers={},cluster.settings={},cluster.SCHED_NONE=1,cluster.SCHED_RR=SCHED_RR;var ids=0,debugPortOffset=1,initialized=!1,schedulingPolicy={none:1,rr:SCHED_RR}[process.env.NODE_CLUSTER_SCHED_POLICY];function setupSettingsNT(e){cluster.emit("setup",e)}function createWorkerProcess(e,t){const s=util._extend({},process.env),r=cluster.settings.execArgv.slice(),n=/--inspect(?:-brk|-port)?|--debug-port/,i=process.env.NODE_OPTIONS?process.env.NODE_OPTIONS:"";if(util._extend(s,t),s.NODE_UNIQUE_ID=""+e,r.some(e=>e.match(n))||i.match(n)){let e;if("inspectPort"in cluster.settings){if(e="function"==typeof cluster.settings.inspectPort?cluster.settings.inspectPort():cluster.settings.inspectPort,!isLegalPort(e))throw new ERR_SOCKET_BAD_PORT(e)}else(e=process.debugPort+debugPortOffset)>maxPort&&(e=e-maxPort+minPort-1),debugPortOffset++;r.push(`--inspect-port=${e}`)}return fork(cluster.settings.exec,cluster.settings.args,{cwd:cluster.settings.cwd,env:s,silent:cluster.settings.silent,windowsHide:cluster.settings.windowsHide,execArgv:r,stdio:cluster.settings.stdio,gid:cluster.settings.gid,uid:cluster.settings.uid})}function removeWorker(e){assert(e),delete cluster.workers[e.id],0===keys(cluster.workers).length&&(assert(0===handles.size,"Resource leak detected."),intercom.emit("disconnect"))}function removeHandlesForWorker(e){assert(e),handles.forEach((t,s)=>{t.remove(e)&&handles.delete(s)})}function emitForkNT(e){cluster.emit("fork",e)}function onmessage(e,t){"online"===e.act?online(this):"queryServer"===e.act?queryServer(this,e):"listening"===e.act?listening(this,e):"exitedAfterDisconnect"===e.act?exitedAfterDisconnect(this,e):"close"===e.act&&close(this,e)}function online(e){e.state="online",e.emit("online"),cluster.emit("online",e)}function exitedAfterDisconnect(e,t){e.exitedAfterDisconnect=!0,send(e,{ack:t.seq})}function queryServer(e,t){if(e.exitedAfterDisconnect)return;const s=`${t.address}:${t.port}:${t.addressType}:`+`${t.fd}:${t.index}`;var r=handles.get(s);if(void 0===r){let e=t.address;t.port<0&&"string"==typeof e&&"win32"!==process.platform&&(e=path.relative(process.cwd(),e),t.address.length<e.length&&(e=t.address));var n=RoundRobinHandle;schedulingPolicy===SCHED_RR&&"udp4"!==t.addressType&&"udp6"!==t.addressType||(n=SharedHandle),r=new n(s,e,t.port,t.addressType,t.fd,t.flags),handles.set(s,r)}r.data||(r.data=t.data),r.add(e,(r,n,i)=>{n=util._extend({errno:r,key:s,ack:t.seq,data:handles.get(s).data},n),r&&handles.delete(s),send(e,n,i)})}function listening(e,t){const s={addressType:t.addressType,address:t.address,port:t.port,fd:t.fd};e.state="listening",e.emit("listening",s),cluster.emit("listening",e,s)}function close(e,t){const s=t.key,r=handles.get(s);r&&r.remove(e)&&handles.delete(s)}function send(e,t,s,r){return sendHelper(e.process,t,s,r)}void 0===schedulingPolicy&&(schedulingPolicy="win32"===process.platform?1:SCHED_RR),cluster.schedulingPolicy=schedulingPolicy,cluster.setupMaster=function(e){var t={args:process.argv.slice(2),exec:process.argv[1],execArgv:process.execArgv,silent:!1};if(util._extend(t,cluster.settings),util._extend(t,e||{}),t.execArgv.some(e=>e.startsWith("--prof"))&&!t.execArgv.some(e=>e.startsWith("--logfile="))&&(t.execArgv=t.execArgv.concat(["--logfile=v8-%p.log"])),cluster.settings=t,!0===initialized)return process.nextTick(setupSettingsNT,t);initialized=!0,schedulingPolicy=cluster.schedulingPolicy,assert(1===schedulingPolicy||schedulingPolicy===SCHED_RR,`Bad cluster.schedulingPolicy: ${schedulingPolicy}`),process.nextTick(setupSettingsNT,t),process.on("internalMessage",e=>{var t;if("NODE_DEBUG_ENABLED"===e.cmd)for(t in cluster.workers){const e=cluster.workers[t];"online"===e.state||"listening"===e.state?process._debugProcess(e.process.pid):e.once("online",function(){process._debugProcess(this.process.pid)})}})},cluster.fork=function(e){cluster.setupMaster();const t=++ids,s=createWorkerProcess(t,e),r=new Worker({id:t,process:s});return r.on("message",function(e,t){cluster.emit("message",this,e,t)}),r.process.once("exit",(e,t)=>{r.isConnected()||(removeHandlesForWorker(r),removeWorker(r)),r.exitedAfterDisconnect=!!r.exitedAfterDisconnect,r.state="dead",r.emit("exit",e,t),cluster.emit("exit",r,e,t)}),r.process.once("disconnect",()=>{removeHandlesForWorker(r),r.isDead()&&removeWorker(r),r.exitedAfterDisconnect=!!r.exitedAfterDisconnect,r.state="disconnected",r.emit("disconnect"),cluster.emit("disconnect",r)}),r.process.on("internalMessage",internal(r,onmessage)),process.nextTick(emitForkNT,r),cluster.workers[r.id]=r,r},cluster.disconnect=function(e){const t=keys(cluster.workers);if(0===t.length)process.nextTick(()=>intercom.emit("disconnect"));else for(var s in t)s=t[s],cluster.workers[s].isConnected()&&cluster.workers[s].disconnect();"function"==typeof e&&intercom.once("disconnect",e)},Worker.prototype.disconnect=function(){return this.exitedAfterDisconnect=!0,send(this,{act:"disconnect"}),removeHandlesForWorker(this),removeWorker(this),this},Worker.prototype.destroy=function(e){const t=this.process;if(e=e||"SIGTERM",this.isConnected())return this.once("disconnect",()=>t.kill(e)),void this.disconnect();t.kill(e)};"use strict";const assert=require("assert"),net=require("net"),{sendHelper}=require("internal/cluster/utils"),uv=internalBinding("uv");function RoundRobinHandle(e,s,n,t,i){this.key=e,this.all=new Map,this.free=[],this.handles=[],this.handle=null,this.server=net.createServer(assert.fail),i>=0?this.server.listen({fd:i}):n>=0?this.server.listen(n,s):this.server.listen(s),this.server.once("listening",()=>{this.handle=this.server._handle,this.handle.onconnection=((e,s)=>this.distribute(e,s)),this.server._handle=null,this.server=null})}module.exports=RoundRobinHandle,RoundRobinHandle.prototype.add=function(e,s){assert(!1===this.all.has(e.id)),this.all.set(e.id,e);const n=()=>{if(this.handle.getsockname){const e={};this.handle.getsockname(e),s(null,{sockname:e},null)}else s(null,null,null);this.handoff(e)};if(null===this.server)return n();this.server.once("listening",n),this.server.once("error",e=>{s(uv[`UV_${e.errno}`],null)})},RoundRobinHandle.prototype.remove=function(e){if(!this.all.delete(e.id))return!1;const s=this.free.indexOf(e);if(-1!==s&&this.free.splice(s,1),0!==this.all.size)return!1;for(var n;n=this.handles.shift();n.close());return this.handle.close(),this.handle=null,!0},RoundRobinHandle.prototype.distribute=function(e,s){this.handles.push(s);const n=this.free.shift();n&&this.handoff(n)},RoundRobinHandle.prototype.handoff=function(e){if(!1===this.all.has(e.id))return;const s=this.handles.shift();if(void 0===s)return void this.free.push(e);const n={act:"newconn",key:this.key};sendHelper(e.process,n,s,n=>{n.accepted?s.close():this.distribute(0,s),this.handoff(e)})};"use strict";const assert=require("assert"),dgram=require("internal/dgram"),net=require("net");function SharedHandle(e,r,t,n,s,a){var h;this.key=e,this.workers=[],this.handle=null,this.errno=0,"number"==typeof(h="udp4"===n||"udp6"===n?dgram._createSocketHandle(r,t,n,s,a):net._createServerHandle(r,t,n,s))?this.errno=h:this.handle=h}module.exports=SharedHandle,SharedHandle.prototype.add=function(e,r){assert(-1===this.workers.indexOf(e)),this.workers.push(e),r(this.errno,null,this.handle)},SharedHandle.prototype.remove=function(e){const r=this.workers.indexOf(e);return-1!==r&&(this.workers.splice(r,1),0===this.workers.length&&(this.handle.close(),this.handle=null,!0))};"use strict";const util=require("util");module.exports={sendHelper,internal};const callbacks=new Map;var seq=0;function sendHelper(e,n,t,c){return!!e.connected&&(n=util._extend({cmd:"NODE_CLUSTER"},n),"function"==typeof c&&callbacks.set(seq,c),n.seq=seq,seq+=1,e.send(n,t))}function internal(e,n){return function(t,c){if("NODE_CLUSTER"===t.cmd){var l=n;if(void 0!==t.ack){const e=callbacks.get(t.ack);void 0!==e&&(l=e,callbacks.delete(t.ack))}l.apply(e,arguments)}}}"use strict";const EventEmitter=require("events"),util=require("util");function Worker(e){if(!(this instanceof Worker))return new Worker(e);EventEmitter.call(this),null!==e&&"object"==typeof e||(e={}),this.exitedAfterDisconnect=void 0,this.state=e.state||"none",this.id=0|e.id,e.process&&(this.process=e.process,this.process.on("error",(e,t)=>this.emit("error",e,t)),this.process.on("message",(e,t)=>this.emit("message",e,t)))}module.exports=Worker,util.inherits(Worker,EventEmitter),Worker.prototype.kill=function(){this.destroy.apply(this,arguments)},Worker.prototype.send=function(){return this.process.send.apply(this.process,arguments)},Worker.prototype.isDead=function(){return null!=this.process.exitCode||null!=this.process.signalCode},Worker.prototype.isConnected=function(){return this.process.connected};"use strict";const isWindows="win32"===process.platform;module.exports={CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_DOT:46,CHAR_FORWARD_SLASH:47,CHAR_BACKWARD_SLASH:92,CHAR_VERTICAL_LINE:124,CHAR_COLON:58,CHAR_QUESTION_MARK:63,CHAR_UNDERSCORE:95,CHAR_LINE_FEED:10,CHAR_CARRIAGE_RETURN:13,CHAR_TAB:9,CHAR_FORM_FEED:12,CHAR_EXCLAMATION_MARK:33,CHAR_HASH:35,CHAR_SPACE:32,CHAR_NO_BREAK_SPACE:160,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_LEFT_CURLY_BRACKET:123,CHAR_RIGHT_CURLY_BRACKET:125,CHAR_HYPHEN_MINUS:45,CHAR_PLUS:43,CHAR_DOUBLE_QUOTE:34,CHAR_SINGLE_QUOTE:39,CHAR_PERCENT:37,CHAR_SEMICOLON:59,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_GRAVE_ACCENT:96,CHAR_AT:64,CHAR_AMPERSAND:38,CHAR_EQUAL:61,CHAR_0:48,CHAR_9:57,EOL:isWindows?"\r\n":"\n"};"use strict";const{certExportChallenge,certExportPublicKey,certVerifySpkac}=process.binding("crypto"),{ERR_INVALID_ARG_TYPE}=require("internal/errors").codes,{isArrayBufferView}=require("internal/util/types"),{toBuf}=require("internal/crypto/util");function verifySpkac(e){if(!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("spkac",["Buffer","TypedArray","DataView"],e);return certVerifySpkac(e)}function exportPublicKey(e,r){if(e=toBuf(e,r),!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("spkac",["string","Buffer","TypedArray","DataView"],e);return certExportPublicKey(e)}function exportChallenge(e,r){if(e=toBuf(e,r),!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("spkac",["string","Buffer","TypedArray","DataView"],e);return certExportChallenge(e)}function Certificate(){if(!(this instanceof Certificate))return new Certificate}Certificate.prototype.verifySpkac=verifySpkac,Certificate.prototype.exportPublicKey=exportPublicKey,Certificate.prototype.exportChallenge=exportChallenge,Certificate.exportChallenge=exportChallenge,Certificate.exportPublicKey=exportPublicKey,Certificate.verifySpkac=verifySpkac,module.exports=Certificate;"use strict";const{RSA_PKCS1_OAEP_PADDING,RSA_PKCS1_PADDING}=process.binding("constants").crypto,{ERR_CRYPTO_INVALID_STATE,ERR_INVALID_ARG_TYPE,ERR_INVALID_OPT_VALUE}=require("internal/errors").codes,{validateString}=require("internal/validators"),{getDefaultEncoding,toBuf}=require("internal/crypto/util"),{isArrayBufferView}=require("internal/util/types"),{CipherBase,privateDecrypt:_privateDecrypt,privateEncrypt:_privateEncrypt,publicDecrypt:_publicDecrypt,publicEncrypt:_publicEncrypt}=process.binding("crypto"),assert=require("assert"),LazyTransform=require("internal/streams/lazy_transform"),{inherits}=require("util"),{deprecate,normalizeEncoding}=require("internal/util");let StringDecoder;function rsaFunctionFor(e,t){return function(r,i){const n=r.key||r,p=r.padding||t,o=r.passphrase||null;return e(toBuf(n),i,p,o)}}const publicEncrypt=rsaFunctionFor(_publicEncrypt,RSA_PKCS1_OAEP_PADDING),publicDecrypt=rsaFunctionFor(_publicDecrypt,RSA_PKCS1_PADDING),privateEncrypt=rsaFunctionFor(_privateEncrypt,RSA_PKCS1_PADDING),privateDecrypt=rsaFunctionFor(_privateDecrypt,RSA_PKCS1_OAEP_PADDING);function getDecoder(e,t){return t=normalizeEncoding(t),void 0===StringDecoder&&(StringDecoder=require("string_decoder").StringDecoder),e=e||new StringDecoder(t),assert(e.encoding===t,"Cannot change encoding"),e}function getUIntOption(e,t){let r;if(e&&null!=(r=e[t])){if(r>>>0!==r)throw new ERR_INVALID_OPT_VALUE(t,r);return r}return-1}function createCipherBase(e,t,r,i,n){const p=getUIntOption(r,"authTagLength");this._handle=new CipherBase(i),void 0===n?this._handle.init(e,t,p):this._handle.initiv(e,t,n,p),this._decoder=null,LazyTransform.call(this,r)}function invalidArrayBufferView(e,t){return new ERR_INVALID_ARG_TYPE(e,["string","Buffer","TypedArray","DataView"],t)}function createCipher(e,t,r,i){if(validateString(e,"cipher"),t=toBuf(t),!isArrayBufferView(t))throw invalidArrayBufferView("password",t);createCipherBase.call(this,e,t,r,i)}function createCipherWithIV(e,t,r,i,n){if(validateString(e,"cipher"),t=toBuf(t),!isArrayBufferView(t))throw invalidArrayBufferView("key",t);if(null!==(n=toBuf(n))&&!isArrayBufferView(n))throw invalidArrayBufferView("iv",n);createCipherBase.call(this,e,t,r,i,n)}function Cipher(e,t,r){if(!(this instanceof Cipher))return new Cipher(e,t,r);createCipher.call(this,e,t,r,!0)}function Cipheriv(e,t,r,i){if(!(this instanceof Cipheriv))return new Cipheriv(e,t,r,i);createCipherWithIV.call(this,e,t,i,!0,r)}function addCipherPrototypeFunctions(e){e.prototype._transform=Cipher.prototype._transform,e.prototype._flush=Cipher.prototype._flush,e.prototype.update=Cipher.prototype.update,e.prototype.final=Cipher.prototype.final,e.prototype.setAutoPadding=Cipher.prototype.setAutoPadding,e.prototype.getAuthTag=Cipher.prototype.getAuthTag,e.prototype.setAuthTag=Cipher.prototype.setAuthTag,e.prototype.setAAD=Cipher.prototype.setAAD}inherits(Cipher,LazyTransform),Cipher.prototype._transform=function(e,t,r){this.push(this._handle.update(e,t)),r()},Cipher.prototype._flush=function(e){try{this.push(this._handle.final())}catch(t){return void e(t)}e()},Cipher.prototype.update=function(e,t,r){const i=getDefaultEncoding();if(t=t||i,r=r||i,"string"!=typeof e&&!isArrayBufferView(e))throw invalidArrayBufferView("data",e);const n=this._handle.update(e,t);return r&&"buffer"!==r?(this._decoder=getDecoder(this._decoder,r),this._decoder.write(n)):n},Cipher.prototype.final=function(e){e=e||getDefaultEncoding();const t=this._handle.final();return e&&"buffer"!==e?(this._decoder=getDecoder(this._decoder,e),this._decoder.end(t)):t},Cipher.prototype.setAutoPadding=function(e){if(!this._handle.setAutoPadding(!!e))throw new ERR_CRYPTO_INVALID_STATE("setAutoPadding");return this},Cipher.prototype.getAuthTag=function(){const e=this._handle.getAuthTag();if(void 0===e)throw new ERR_CRYPTO_INVALID_STATE("getAuthTag");return e},Cipher.prototype.setAuthTag=function(e){if(!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("buffer",["Buffer","TypedArray","DataView"],e);if(!this._handle.setAuthTag(e))throw new ERR_CRYPTO_INVALID_STATE("setAuthTag");return this},Cipher.prototype.setAAD=function(e,t){if(!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("buffer",["Buffer","TypedArray","DataView"],e);const r=getUIntOption(t,"plaintextLength");if(!this._handle.setAAD(e,r))throw new ERR_CRYPTO_INVALID_STATE("setAAD");return this},inherits(Cipheriv,LazyTransform),addCipherPrototypeFunctions(Cipheriv);const finaltol=deprecate(Cipher.prototype.final,"crypto.Decipher.finaltol is deprecated. Use crypto.Decipher.final instead.","DEP0105");function Decipher(e,t,r){if(!(this instanceof Decipher))return new Decipher(e,t,r);createCipher.call(this,e,t,r,!1)}function Decipheriv(e,t,r,i){if(!(this instanceof Decipheriv))return new Decipheriv(e,t,r,i);createCipherWithIV.call(this,e,t,i,!1,r)}inherits(Decipher,LazyTransform),addCipherPrototypeFunctions(Decipher),Decipher.prototype.finaltol=finaltol,inherits(Decipheriv,LazyTransform),addCipherPrototypeFunctions(Decipheriv),Decipheriv.prototype.finaltol=finaltol,module.exports={Cipher,Cipheriv,Decipher,Decipheriv,privateDecrypt,privateEncrypt,publicDecrypt,publicEncrypt};"use strict";const{Buffer}=require("buffer"),{ERR_CRYPTO_ECDH_INVALID_FORMAT,ERR_CRYPTO_ECDH_INVALID_PUBLIC_KEY,ERR_INVALID_ARG_TYPE}=require("internal/errors").codes,{validateString}=require("internal/validators"),{isArrayBufferView}=require("internal/util/types"),{getDefaultEncoding,toBuf}=require("internal/crypto/util"),{DiffieHellman:_DiffieHellman,DiffieHellmanGroup:_DiffieHellmanGroup,ECDH:_ECDH,ECDHConvertKey:_ECDHConvertKey}=process.binding("crypto"),{POINT_CONVERSION_COMPRESSED,POINT_CONVERSION_HYBRID,POINT_CONVERSION_UNCOMPRESSED}=process.binding("constants").crypto,DH_GENERATOR=2;function DiffieHellman(e,t,r,i){if(!(this instanceof DiffieHellman))return new DiffieHellman(e,t,r,i);if("number"!=typeof e&&"string"!=typeof e&&!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("sizeOrKey",["number","string","Buffer","TypedArray","DataView"],e);t&&!Buffer.isEncoding(t)&&"buffer"!==t&&(i=r,r=t,t=!1);const n=getDefaultEncoding();t=t||n,i=i||n,"number"!=typeof e&&(e=toBuf(e,t)),r?"number"!=typeof r&&(r=toBuf(r,i)):r=DH_GENERATOR,this._handle=new _DiffieHellman(e,r),Object.defineProperty(this,"verifyError",{enumerable:!0,value:this._handle.verifyError,writable:!1})}function DiffieHellmanGroup(e){if(!(this instanceof DiffieHellmanGroup))return new DiffieHellmanGroup(e);this._handle=new _DiffieHellmanGroup(e),Object.defineProperty(this,"verifyError",{enumerable:!0,value:this._handle.verifyError,writable:!1})}function dhGenerateKeys(e){return encode(this._handle.generateKeys(),e=e||getDefaultEncoding())}function dhComputeSecret(e,t,r){const i=getDefaultEncoding();t=t||i,r=r||i;const n=this._handle.computeSecret(toBuf(e,t));if("string"==typeof n)throw new ERR_CRYPTO_ECDH_INVALID_PUBLIC_KEY;return encode(n,r)}function dhGetPrime(e){return encode(this._handle.getPrime(),e=e||getDefaultEncoding())}function dhGetGenerator(e){return encode(this._handle.getGenerator(),e=e||getDefaultEncoding())}function dhGetPublicKey(e){return encode(this._handle.getPublicKey(),e=e||getDefaultEncoding())}function dhGetPrivateKey(e){return encode(this._handle.getPrivateKey(),e=e||getDefaultEncoding())}function ECDH(e){if(!(this instanceof ECDH))return new ECDH(e);validateString(e,"curve"),this._handle=new _ECDH(e)}function encode(e,t){return t&&"buffer"!==t&&(e=e.toString(t)),e}function getFormat(e){if(e){if("compressed"===e)return POINT_CONVERSION_COMPRESSED;if("hybrid"===e)return POINT_CONVERSION_HYBRID;if("uncompressed"!==e)throw new ERR_CRYPTO_ECDH_INVALID_FORMAT(e)}return POINT_CONVERSION_UNCOMPRESSED}DiffieHellmanGroup.prototype.generateKeys=DiffieHellman.prototype.generateKeys=dhGenerateKeys,DiffieHellmanGroup.prototype.computeSecret=DiffieHellman.prototype.computeSecret=dhComputeSecret,DiffieHellmanGroup.prototype.getPrime=DiffieHellman.prototype.getPrime=dhGetPrime,DiffieHellmanGroup.prototype.getGenerator=DiffieHellman.prototype.getGenerator=dhGetGenerator,DiffieHellmanGroup.prototype.getPublicKey=DiffieHellman.prototype.getPublicKey=dhGetPublicKey,DiffieHellmanGroup.prototype.getPrivateKey=DiffieHellman.prototype.getPrivateKey=dhGetPrivateKey,DiffieHellman.prototype.setPublicKey=function(e,t){return t=t||getDefaultEncoding(),this._handle.setPublicKey(toBuf(e,t)),this},DiffieHellman.prototype.setPrivateKey=function(e,t){return t=t||getDefaultEncoding(),this._handle.setPrivateKey(toBuf(e,t)),this},ECDH.prototype.computeSecret=DiffieHellman.prototype.computeSecret,ECDH.prototype.setPrivateKey=DiffieHellman.prototype.setPrivateKey,ECDH.prototype.setPublicKey=DiffieHellman.prototype.setPublicKey,ECDH.prototype.getPrivateKey=DiffieHellman.prototype.getPrivateKey,ECDH.prototype.generateKeys=function(e,t){return this._handle.generateKeys(),this.getPublicKey(e,t)},ECDH.prototype.getPublicKey=function(e,t){const r=getFormat(t);return encode(this._handle.getPublicKey(r),e=e||getDefaultEncoding())},ECDH.convertKey=function(e,t,r,i,n){if("string"!=typeof e&&!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("key",["string","Buffer","TypedArray","DataView"],e);validateString(t,"curve");const o=getDefaultEncoding();r=r||o,i=i||o;const f=getFormat(n);return encode(_ECDHConvertKey(toBuf(e,r),t,f),i)},module.exports={DiffieHellman,DiffieHellmanGroup,ECDH};"use strict";const{Hash:_Hash,Hmac:_Hmac}=process.binding("crypto"),{getDefaultEncoding,toBuf}=require("internal/crypto/util"),{Buffer}=require("buffer"),{ERR_CRYPTO_HASH_DIGEST_NO_UTF16,ERR_CRYPTO_HASH_FINALIZED,ERR_CRYPTO_HASH_UPDATE_FAILED,ERR_INVALID_ARG_TYPE}=require("internal/errors").codes,{validateString}=require("internal/validators"),{inherits}=require("util"),{normalizeEncoding}=require("internal/util"),{isArrayBufferView}=require("internal/util/types"),LazyTransform=require("internal/streams/lazy_transform"),kState=Symbol("kState"),kFinalized=Symbol("kFinalized");function Hash(t,e){if(!(this instanceof Hash))return new Hash(t,e);validateString(t,"algorithm"),this._handle=new _Hash(t),this[kState]={[kFinalized]:!1},LazyTransform.call(this,e)}function Hmac(t,e,i){if(!(this instanceof Hmac))return new Hmac(t,e,i);if(validateString(t,"hmac"),"string"!=typeof e&&!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("key",["string","TypedArray","DataView"],e);this._handle=new _Hmac,this._handle.init(t,toBuf(e)),this[kState]={[kFinalized]:!1},LazyTransform.call(this,i)}inherits(Hash,LazyTransform),Hash.prototype._transform=function(t,e,i){this._handle.update(t,e),i()},Hash.prototype._flush=function(t){this.push(this._handle.digest()),t()},Hash.prototype.update=function(t,e){if(this[kState][kFinalized])throw new ERR_CRYPTO_HASH_FINALIZED;if("string"!=typeof t&&!isArrayBufferView(t))throw new ERR_INVALID_ARG_TYPE("data",["string","TypedArray","DataView"],t);if(!this._handle.update(t,e||getDefaultEncoding()))throw new ERR_CRYPTO_HASH_UPDATE_FAILED;return this},Hash.prototype.digest=function(t){const e=this[kState];if(e[kFinalized])throw new ERR_CRYPTO_HASH_FINALIZED;if(t=t||getDefaultEncoding(),"utf16le"===normalizeEncoding(t))throw new ERR_CRYPTO_HASH_DIGEST_NO_UTF16;const i=this._handle.digest(`${t}`);return e[kFinalized]=!0,i},inherits(Hmac,LazyTransform),Hmac.prototype.update=Hash.prototype.update,Hmac.prototype.digest=function(t){const e=this[kState];if(t=t||getDefaultEncoding(),"utf16le"===normalizeEncoding(t))throw new ERR_CRYPTO_HASH_DIGEST_NO_UTF16;if(e[kFinalized]){const e=Buffer.from("");return"buffer"===t?e:e.toString(t)}const i=this._handle.digest(`${t}`);return e[kFinalized]=!0,i},Hmac.prototype._flush=Hash.prototype._flush,Hmac.prototype._transform=Hash.prototype._transform,module.exports={Hash,Hmac};"use strict";const{AsyncWrap,Providers}=internalBinding("async_wrap"),{generateKeyPairRSA,generateKeyPairDSA,generateKeyPairEC,OPENSSL_EC_NAMED_CURVE,OPENSSL_EC_EXPLICIT_CURVE,PK_ENCODING_PKCS1,PK_ENCODING_PKCS8,PK_ENCODING_SPKI,PK_ENCODING_SEC1,PK_FORMAT_DER,PK_FORMAT_PEM}=process.binding("crypto"),{customPromisifyArgs}=require("internal/util"),{isUint32}=require("internal/validators"),{ERR_CRYPTO_INCOMPATIBLE_KEY_OPTIONS,ERR_INVALID_ARG_TYPE,ERR_INVALID_ARG_VALUE,ERR_INVALID_CALLBACK,ERR_INVALID_OPT_VALUE}=require("internal/errors").codes;function generateKeyPair(e,r,n){"function"==typeof r&&(n=r,r=void 0);const _=check(e,r);if("function"!=typeof n)throw new ERR_INVALID_CALLBACK;const i=new AsyncWrap(Providers.KEYPAIRGENREQUEST);i.ondone=((e,r,_)=>{if(e)return n.call(i,e);n.call(i,null,r,_)}),handleError(_,i)}function generateKeyPairSync(e,r){return handleError(check(e,r))}function handleError(e,r){const n=e(r);if(void 0===n)return;const[_,i,t]=n;if(void 0!==_)throw _;return{publicKey:i,privateKey:t}}function parseKeyEncoding(e,r){const{publicKeyEncoding:n,privateKeyEncoding:_}=r;if(null==n||"object"!=typeof n)throw new ERR_INVALID_OPT_VALUE("publicKeyEncoding",n);const{format:i,type:t}=n;let E,o;if("pkcs1"===t){if("rsa"!==e)throw new ERR_CRYPTO_INCOMPATIBLE_KEY_OPTIONS(t,"can only be used for RSA keys");E=PK_ENCODING_PKCS1}else{if("spki"!==t)throw new ERR_INVALID_OPT_VALUE("publicKeyEncoding.type",t);E=PK_ENCODING_SPKI}if("der"===i)o=PK_FORMAT_DER;else{if("pem"!==i)throw new ERR_INVALID_OPT_VALUE("publicKeyEncoding.format",i);o=PK_FORMAT_PEM}if(null==_||"object"!=typeof _)throw new ERR_INVALID_OPT_VALUE("privateKeyEncoding",_);const{cipher:P,passphrase:R,format:a,type:s}=_;let I,c;if("pkcs1"===s){if("rsa"!==e)throw new ERR_CRYPTO_INCOMPATIBLE_KEY_OPTIONS(s,"can only be used for RSA keys");I=PK_ENCODING_PKCS1}else if("pkcs8"===s)I=PK_ENCODING_PKCS8;else{if("sec1"!==s)throw new ERR_INVALID_OPT_VALUE("privateKeyEncoding.type",s);if("ec"!==e)throw new ERR_CRYPTO_INCOMPATIBLE_KEY_OPTIONS(s,"can only be used for EC keys");I=PK_ENCODING_SEC1}if("der"===a)c=PK_FORMAT_DER;else{if("pem"!==a)throw new ERR_INVALID_OPT_VALUE("privateKeyEncoding.format",a);c=PK_FORMAT_PEM}if(null!=P){if("string"!=typeof P)throw new ERR_INVALID_OPT_VALUE("privateKeyEncoding.cipher",P);if(c===PK_FORMAT_DER&&(I===PK_ENCODING_PKCS1||I===PK_ENCODING_SEC1))throw new ERR_CRYPTO_INCOMPATIBLE_KEY_OPTIONS(s,"does not support encryption");if("string"!=typeof R)throw new ERR_INVALID_OPT_VALUE("privateKeyEncoding.passphrase",R)}return{cipher:P,passphrase:R,publicType:E,publicFormat:o,privateType:I,privateFormat:c}}function check(e,r,n){if("string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("type","string",e);if(null==r||"object"!=typeof r)throw new ERR_INVALID_ARG_TYPE("options","object",r);let _,i,t,E,o,P,R;switch(e){case"rsa":{const{modulusLength:e}=r;if(!isUint32(e))throw new ERR_INVALID_OPT_VALUE("modulusLength",e);let{publicExponent:n}=r;if(null==n)n=65537;else if(!isUint32(n))throw new ERR_INVALID_OPT_VALUE("publicExponent",n);R=(r=>generateKeyPairRSA(e,n,t,E,o,P,_,i,r))}break;case"dsa":{const{modulusLength:e}=r;if(!isUint32(e))throw new ERR_INVALID_OPT_VALUE("modulusLength",e);let{divisorLength:n}=r;if(null==n)n=-1;else if(!isUint32(n))throw new ERR_INVALID_OPT_VALUE("divisorLength",n);R=(r=>generateKeyPairDSA(e,n,t,E,o,P,_,i,r))}break;case"ec":{const{namedCurve:e}=r;if("string"!=typeof e)throw new ERR_INVALID_OPT_VALUE("namedCurve",e);let{paramEncoding:n}=r;if(null==n||"named"===n)n=OPENSSL_EC_NAMED_CURVE;else{if("explicit"!==n)throw new ERR_INVALID_OPT_VALUE("paramEncoding",n);n=OPENSSL_EC_EXPLICIT_CURVE}R=(r=>generateKeyPairEC(e,n,t,E,o,P,_,i,r))}break;default:throw new ERR_INVALID_ARG_VALUE("type",e,"must be one of 'rsa', 'dsa', 'ec'")}return({cipher:_,passphrase:i,publicType:t,publicFormat:E,privateType:o,privateFormat:P}=parseKeyEncoding(e,r)),R}Object.defineProperty(generateKeyPair,customPromisifyArgs,{value:["publicKey","privateKey"],enumerable:!1}),module.exports={generateKeyPair,generateKeyPairSync};"use strict";const{AsyncWrap,Providers}=internalBinding("async_wrap"),{Buffer}=require("buffer"),{pbkdf2:_pbkdf2}=process.binding("crypto"),{validateUint32}=require("internal/validators"),{ERR_CRYPTO_INVALID_DIGEST,ERR_CRYPTO_PBKDF2_ERROR,ERR_INVALID_ARG_TYPE,ERR_INVALID_CALLBACK}=require("internal/errors").codes,{getDefaultEncoding,validateArrayBufferView}=require("internal/crypto/util");function pbkdf2(e,r,n,t,i,a){if("function"==typeof i&&(a=i,i=void 0),({password:e,salt:r,iterations:n,keylen:t,digest:i}=check(e,r,n,t,i)),"function"!=typeof a)throw new ERR_INVALID_CALLBACK;const o=getDefaultEncoding(),f=Buffer.alloc(t),R=new AsyncWrap(Providers.PBKDF2REQUEST);R.ondone=(e=>e?"buffer"===o?a.call(R,null,f):void a.call(R,null,f.toString(o)):a.call(R,new ERR_CRYPTO_PBKDF2_ERROR)),handleError(f,e,r,n,i,R)}function pbkdf2Sync(e,r,n,t,i){({password:e,salt:r,iterations:n,keylen:t,digest:i}=check(e,r,n,t,i));const a=Buffer.alloc(t);handleError(a,e,r,n,i);const o=getDefaultEncoding();return"buffer"===o?a:a.toString(o)}function check(e,r,n,t,i){if("string"!=typeof i){if(null!==i)throw new ERR_INVALID_ARG_TYPE("digest",["string","null"],i);i="sha1"}return{password:e=validateArrayBufferView(e,"password"),salt:r=validateArrayBufferView(r,"salt"),iterations:n=validateUint32(n,"iterations",0),keylen:t=validateUint32(t,"keylen",0),digest:i}}function handleError(e,r,n,t,i,a){const o=_pbkdf2(e,r,n,t,i,a);if(-1===o)throw new ERR_CRYPTO_INVALID_DIGEST(i);if(!1===o)throw new ERR_CRYPTO_PBKDF2_ERROR}module.exports={pbkdf2,pbkdf2Sync};"use strict";const{AsyncWrap,Providers}=internalBinding("async_wrap"),{Buffer,kMaxLength}=require("buffer"),{randomBytes:_randomBytes}=process.binding("crypto"),{ERR_INVALID_ARG_TYPE,ERR_INVALID_CALLBACK,ERR_OUT_OF_RANGE}=require("internal/errors").codes,{validateNumber}=require("internal/validators"),{isArrayBufferView}=require("internal/util/types"),kMaxUint32=2**32-1,kMaxPossibleLength=Math.min(kMaxLength,2**32-1);function assertOffset(e,r,n){validateNumber(e,"offset"),e*=r;const t=Math.min(n,kMaxPossibleLength);if(Number.isNaN(e)||e>t||e<0)throw new ERR_OUT_OF_RANGE("offset",`>= 0 && <= ${t}`,e);return e>>>0}function assertSize(e,r,n,t){if(validateNumber(e,"size"),e*=r,Number.isNaN(e)||e>kMaxPossibleLength||e<0)throw new ERR_OUT_OF_RANGE("size",`>= 0 && <= ${kMaxPossibleLength}`,e);if(e+n>t)throw new ERR_OUT_OF_RANGE("size + offset",`<= ${t}`,e+n);return e>>>0}function randomBytes(e,r){if(e=assertSize(e,1,0,1/0),void 0!==r&&"function"!=typeof r)throw new ERR_INVALID_CALLBACK;const n=Buffer.alloc(e);if(!r)return handleError(n,0,e);const t=new AsyncWrap(Providers.RANDOMBYTESREQUEST);t.ondone=(e=>{if(e)return r.call(t,e);r.call(t,null,n)}),_randomBytes(n,0,e,t)}function randomFillSync(e,r=0,n){if(!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("buf","ArrayBufferView",e);const t=e.BYTES_PER_ELEMENT||1;return handleError(e,r=assertOffset(r,t,e.byteLength),n=void 0===n?e.byteLength-r:assertSize(n,t,r,e.byteLength))}function randomFill(e,r,n,t){if(!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("buf","ArrayBufferView",e);const i=e.BYTES_PER_ELEMENT||1;if("function"==typeof r)t=r,r=0,n=e.bytesLength;else if("function"==typeof n)t=n,n=e.byteLength-r;else if("function"!=typeof t)throw new ERR_INVALID_CALLBACK;r=assertOffset(r,i,e.byteLength),n=void 0===n?e.byteLength-r:assertSize(n,i,r,e.byteLength);const s=new AsyncWrap(Providers.RANDOMBYTESREQUEST);s.ondone=(r=>{if(r)return t.call(s,r);t.call(s,null,e)}),_randomBytes(e,r,n,s)}function handleError(e,r,n){const t=_randomBytes(e,r,n);if(t)throw t;return e}module.exports={randomBytes,randomFill,randomFillSync};"use strict";const{AsyncWrap,Providers}=internalBinding("async_wrap"),{Buffer}=require("buffer"),{scrypt:_scrypt}=process.binding("crypto"),{validateUint32}=require("internal/validators"),{ERR_CRYPTO_SCRYPT_INVALID_PARAMETER,ERR_CRYPTO_SCRYPT_NOT_SUPPORTED,ERR_INVALID_CALLBACK}=require("internal/errors").codes,{getDefaultEncoding,validateArrayBufferView}=require("internal/crypto/util"),defaults={N:16384,r:8,p:1,maxmem:32<<20};function scrypt(e,t,r,a,i=defaults){i===defaults&&(i=a,a=defaults),a=check(e,t,r,a);const{N:n,r:l,p:o,maxmem:R}=a;if(({password:e,salt:t,keylen:r}=a),"function"!=typeof i)throw new ERR_INVALID_CALLBACK;const s=getDefaultEncoding(),c=Buffer.alloc(r),d=new AsyncWrap(Providers.SCRYPTREQUEST);d.ondone=(e=>e?i.call(d,e):"buffer"===s?i.call(d,null,c):void i.call(d,null,c.toString(s))),handleError(c,e,t,n,l,o,R,d)}function scryptSync(e,t,r,a=defaults){a=check(e,t,r,a);const{N:i,r:n,p:l,maxmem:o}=a;({password:e,salt:t,keylen:r}=a);const R=Buffer.alloc(r);handleError(R,e,t,i,n,l,o);const s=getDefaultEncoding();return"buffer"===s?R:R.toString(s)}function handleError(e,t,r,a,i,n,l,o){const R=_scrypt(e,t,r,a,i,n,l,o);if(void 0!==R){if(null===R)throw new ERR_CRYPTO_SCRYPT_INVALID_PARAMETER;throw R}}function check(e,t,r,a){if(void 0===_scrypt)throw new ERR_CRYPTO_SCRYPT_NOT_SUPPORTED;e=validateArrayBufferView(e,"password"),t=validateArrayBufferView(t,"salt"),r=validateUint32(r,"keylen");let{N:i,r:n,p:l,maxmem:o}=defaults;if(a&&a!==defaults){let e,t,r;if((e=void 0!==a.N)&&(i=validateUint32(a.N,"N")),void 0!==a.cost){if(e)throw new ERR_CRYPTO_SCRYPT_INVALID_PARAMETER;i=validateUint32(a.cost,"cost")}if((t=void 0!==a.r)&&(n=validateUint32(a.r,"r")),void 0!==a.blockSize){if(t)throw new ERR_CRYPTO_SCRYPT_INVALID_PARAMETER;n=validateUint32(a.blockSize,"blockSize")}if((r=void 0!==a.p)&&(l=validateUint32(a.p,"p")),void 0!==a.parallelization){if(r)throw new ERR_CRYPTO_SCRYPT_INVALID_PARAMETER;l=validateUint32(a.parallelization,"parallelization")}void 0!==a.maxmem&&(o=validateUint32(a.maxmem,"maxmem")),0===i&&(i=defaults.N),0===n&&(n=defaults.r),0===l&&(l=defaults.p),0===o&&(o=defaults.maxmem)}return{password:e,salt:t,keylen:r,N:i,r:n,p:l,maxmem:o}}module.exports={scrypt,scryptSync};"use strict";const{ERR_CRYPTO_SIGN_KEY_REQUIRED,ERR_INVALID_OPT_VALUE}=require("internal/errors").codes,{validateString}=require("internal/validators"),{Sign:_Sign,Verify:_Verify}=internalBinding("crypto"),{RSA_PSS_SALTLEN_AUTO,RSA_PKCS1_PADDING}=process.binding("constants").crypto,{getDefaultEncoding,toBuf,validateArrayBufferView}=require("internal/crypto/util"),{Writable}=require("stream"),{inherits}=require("util");function Sign(t,e){if(!(this instanceof Sign))return new Sign(t,e);validateString(t,"algorithm"),this._handle=new _Sign,this._handle.init(t),Writable.call(this,e)}function getPadding(t){return getIntOption("padding",RSA_PKCS1_PADDING,t)}function getSaltLength(t){return getIntOption("saltLength",RSA_PSS_SALTLEN_AUTO,t)}function getIntOption(t,e,i){if(i.hasOwnProperty(t)){const e=i[t];if(e===e>>0)return e;throw new ERR_INVALID_OPT_VALUE(t,e)}return e}function Verify(t,e){if(!(this instanceof Verify))return new Verify(t,e);validateString(t,"algorithm"),this._handle=new _Verify,this._handle.init(t),Writable.call(this,e)}inherits(Sign,Writable),Sign.prototype._write=function(t,e,i){this.update(t,e),i()},Sign.prototype.update=function(t,e){return e=e||getDefaultEncoding(),t=validateArrayBufferView(toBuf(t,e),"data"),this._handle.update(t),this},Sign.prototype.sign=function(t,e){if(!t)throw new ERR_CRYPTO_SIGN_KEY_REQUIRED;var i=t.key||t,n=t.passphrase||null,r=getPadding(t),a=getSaltLength(t);i=validateArrayBufferView(i,"key");var o=this._handle.sign(i,n,r,a);return(e=e||getDefaultEncoding())&&"buffer"!==e&&(o=o.toString(e)),o},inherits(Verify,Writable),Verify.prototype._write=Sign.prototype._write,Verify.prototype.update=Sign.prototype.update,Verify.prototype.verify=function(t,e,i){var n=t.key||t;i=i||getDefaultEncoding();var r=getPadding(t),a=getSaltLength(t);return n=validateArrayBufferView(n,"key"),e=validateArrayBufferView(toBuf(e,i),"signature"),this._handle.verify(n,e,r,a)},module.exports={Sign,Verify};"use strict";const{getCiphers:_getCiphers,getCurves:_getCurves,getHashes:_getHashes,setEngine:_setEngine,timingSafeEqual:_timingSafeEqual}=process.binding("crypto"),{ENGINE_METHOD_ALL}=process.binding("constants").crypto,{ERR_CRYPTO_ENGINE_UNKNOWN,ERR_CRYPTO_TIMING_SAFE_EQUAL_LENGTH,ERR_INVALID_ARG_TYPE}=require("internal/errors").codes,{validateString}=require("internal/validators"),{Buffer}=require("buffer"),{cachedResult,filterDuplicateStrings}=require("internal/util"),{isArrayBufferView}=require("internal/util/types");var defaultEncoding="buffer";function setDefaultEncoding(e){defaultEncoding=e}function getDefaultEncoding(){return defaultEncoding}function toBuf(e,t){return"string"==typeof e?("buffer"!==t&&t||(t="utf8"),Buffer.from(e,t)):e}const getCiphers=cachedResult(()=>filterDuplicateStrings(_getCiphers())),getHashes=cachedResult(()=>filterDuplicateStrings(_getHashes())),getCurves=cachedResult(()=>filterDuplicateStrings(_getCurves()));function setEngine(e,t){if(validateString(e,"id"),t&&"number"!=typeof t)throw new ERR_INVALID_ARG_TYPE("flags","number",t);if(0===(t>>>=0)&&(t=ENGINE_METHOD_ALL),!_setEngine(e,t))throw new ERR_CRYPTO_ENGINE_UNKNOWN(e)}function timingSafeEqual(e,t){if(!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("buf1",["Buffer","TypedArray","DataView"],e);if(!isArrayBufferView(t))throw new ERR_INVALID_ARG_TYPE("buf2",["Buffer","TypedArray","DataView"],t);if(e.length!==t.length)throw new ERR_CRYPTO_TIMING_SAFE_EQUAL_LENGTH;return _timingSafeEqual(e,t)}function validateArrayBufferView(e,t){if(e=toBuf(e),!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE(t,["string","Buffer","TypedArray","DataView"],e);return e}module.exports={validateArrayBufferView,getCiphers,getCurves,getDefaultEncoding,getHashes,setDefaultEncoding,setEngine,timingSafeEqual,toBuf};"use strict";const assert=require("assert"),{codes}=require("internal/errors"),{UDP}=internalBinding("udp_wrap"),{ERR_INVALID_ARG_TYPE,ERR_SOCKET_BAD_TYPE}=codes,kStateSymbol=Symbol("state symbol");let dns;function lookup4(e,n,o){return e(n||"127.0.0.1",4,o)}function lookup6(e,n,o){return e(n||"::1",6,o)}function newHandle(e,n){if(void 0===n)void 0===dns&&(dns=require("dns")),n=dns.lookup;else if("function"!=typeof n)throw new ERR_INVALID_ARG_TYPE("lookup","Function",n);if("udp4"===e){const e=new UDP;return e.lookup=lookup4.bind(e,n),e}if("udp6"===e){const e=new UDP;return e.lookup=lookup6.bind(e,n),e.bind=e.bind6,e.send=e.send6,e}throw new ERR_SOCKET_BAD_TYPE}function _createSocketHandle(e,n,o,t,r){assert("number"!=typeof t||t<0);const d=newHandle(o);if(n||e){const o=d.bind(e,n||0,r);if(o)return d.close(),o}return d}module.exports={kStateSymbol,_createSocketHandle,newHandle};"use strict";const{bindDefaultResolver,Resolver:CallbackResolver,validateHints}=require("internal/dns/utils"),{codes,dnsException}=require("internal/errors"),{isIP,isIPv4,isLegalPort}=require("internal/net"),{getaddrinfo,getnameinfo,ChannelWrap,GetAddrInfoReqWrap,GetNameInfoReqWrap,QueryReqWrap}=process.binding("cares_wrap"),{ERR_INVALID_ARG_TYPE,ERR_INVALID_OPT_VALUE,ERR_MISSING_ARGS,ERR_SOCKET_BAD_PORT}=codes;function onlookup(e,o){if(e)return void this.reject(dnsException(e,"getaddrinfo",this.hostname));const r=this.family?this.family:isIPv4(o[0])?4:6;this.resolve({address:o[0],family:r})}function onlookupall(e,o){if(e)return void this.reject(dnsException(e,"getaddrinfo",this.hostname));const r=this.family;for(var t=0;t<o.length;t++){const e=o[t];o[t]={address:e,family:r||(isIPv4(o[t])?4:6)}}this.resolve(o)}function createLookupPromise(e,o,r,t,s){return new Promise((n,l)=>{if(!o)return void n(r?[]:{address:null,family:6===e?6:4});const i=isIP(o);if(0!==i){const e={address:o,family:i};return void n(r?[e]:e)}const a=new GetAddrInfoReqWrap;a.family=e,a.hostname=o,a.oncomplete=r?onlookupall:onlookup,a.resolve=n,a.reject=l;const v=getaddrinfo(a,o,e,t,s);v&&l(dnsException(v,"getaddrinfo",o))})}function lookup(e,o){var r=0,t=-1,s=!1,n=!1;if(e&&"string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("hostname",["string","falsy"],e);if(null!==o&&"object"==typeof o?(r=o.hints>>>0,t=o.family>>>0,s=!0===o.all,n=!0===o.verbatim,validateHints(r)):t=o>>>0,0!==t&&4!==t&&6!==t)throw new ERR_INVALID_OPT_VALUE("family",t);return createLookupPromise(t,e,s,r,n)}function onlookupservice(e,o,r){e?this.reject(dnsException(e,"getnameinfo",this.host)):this.resolve({hostname:o,service:r})}function createLookupServicePromise(e,o){return new Promise((r,t)=>{const s=new GetNameInfoReqWrap;s.hostname=e,s.port=o,s.oncomplete=onlookupservice,s.resolve=r,s.reject=t;const n=getnameinfo(s,e,o);n&&t(dnsException(n,"getnameinfo",e))})}function lookupService(e,o){if(2!==arguments.length)throw new ERR_MISSING_ARGS("hostname","port");if(0===isIP(e))throw new ERR_INVALID_OPT_VALUE("hostname",e);if(!isLegalPort(o))throw new ERR_SOCKET_BAD_PORT(o);return createLookupServicePromise(e,+o)}function onresolve(e,o,r){e?this.reject(dnsException(e,this.bindingName,this.hostname)):(r&&this.ttl&&(o=o.map((e,o)=>({address:e,ttl:r[o]}))),this.resolve(o))}function createResolverPromise(e,o,r,t){return new Promise((s,n)=>{const l=new QueryReqWrap;l.bindingName=o,l.hostname=r,l.oncomplete=onresolve,l.resolve=s,l.reject=n,l.ttl=t;const i=e._handle[o](l,r);i&&n(dnsException(i,o,r))})}function resolver(e){function o(o,r){if("string"!=typeof o)throw new ERR_INVALID_ARG_TYPE("name","string",o);const t=!(!r||!r.ttl);return createResolverPromise(this,e,o,t)}return Object.defineProperty(o,"name",{value:e}),o}const resolveMap=Object.create(null);class Resolver{constructor(){this._handle=new ChannelWrap}}Resolver.prototype.getServers=CallbackResolver.prototype.getServers,Resolver.prototype.setServers=CallbackResolver.prototype.setServers,Resolver.prototype.resolveAny=resolveMap.ANY=resolver("queryAny"),Resolver.prototype.resolve4=resolveMap.A=resolver("queryA"),Resolver.prototype.resolve6=resolveMap.AAAA=resolver("queryAaaa"),Resolver.prototype.resolveCname=resolveMap.CNAME=resolver("queryCname"),Resolver.prototype.resolveMx=resolveMap.MX=resolver("queryMx"),Resolver.prototype.resolveNs=resolveMap.NS=resolver("queryNs"),Resolver.prototype.resolveTxt=resolveMap.TXT=resolver("queryTxt"),Resolver.prototype.resolveSrv=resolveMap.SRV=resolver("querySrv"),Resolver.prototype.resolvePtr=resolveMap.PTR=resolver("queryPtr"),Resolver.prototype.resolveNaptr=resolveMap.NAPTR=resolver("queryNaptr"),Resolver.prototype.resolveSoa=resolveMap.SOA=resolver("querySoa"),Resolver.prototype.reverse=resolver("getHostByAddr"),Resolver.prototype.resolve=function(e,o){var r;if("string"==typeof o){if("function"!=typeof(r=resolveMap[o]))throw new ERR_INVALID_OPT_VALUE("rrtype",o)}else{if(void 0!==o)throw new ERR_INVALID_ARG_TYPE("rrtype","string",o);r=resolveMap.A}return r.call(this,e)},module.exports={lookup,lookupService,Resolver},bindDefaultResolver(module.exports,Resolver.prototype);"use strict";const errors=require("internal/errors"),{isIP}=require("internal/net"),{ChannelWrap,strerror,AI_ADDRCONFIG,AI_V4MAPPED}=process.binding("cares_wrap"),IANA_DNS_PORT=53,IPv6RE=/^\[([^[\]]*)\]/,addrSplitRE=/(^.+?)(?::(\d+))?$/,{ERR_DNS_SET_SERVERS_FAILED,ERR_INVALID_IP_ADDRESS,ERR_INVALID_OPT_VALUE}=errors.codes;class Resolver{constructor(){this._handle=new ChannelWrap}cancel(){this._handle.cancel()}getServers(){return this._handle.getServers().map(e=>{if(!e[1]||e[1]===IANA_DNS_PORT)return e[0];return`${6===isIP(e[0])?`[${e[0]}]`:e[0]}:${e[1]}`})}setServers(e){const r=this._handle.getServers(),s=[];e.forEach(e=>{var r=isIP(e);if(0!==r)return s.push([r,e,IANA_DNS_PORT]);const t=e.match(IPv6RE);if(t&&0!==(r=isIP(t[1]))){const l=parseInt(e.replace(addrSplitRE,"$2"))||IANA_DNS_PORT;return s.push([r,t[1],l])}const l=e.match(addrSplitRE);if(l){const e=l[1],t=l[2]||IANA_DNS_PORT;if(0!==(r=isIP(e)))return s.push([r,e,parseInt(t)])}throw new ERR_INVALID_IP_ADDRESS(e)});const t=this._handle.setServers(s);if(0!==t){this._handle.setServers(r.join(","));const s=strerror(t);throw new ERR_DNS_SET_SERVERS_FAILED(s,e)}}}let defaultResolver=new Resolver;const resolverKeys=["getServers","resolve","resolveAny","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","resolvePtr","resolveNaptr","resolveSoa","reverse"];function getDefaultResolver(){return defaultResolver}function setDefaultResolver(e){defaultResolver=e}function bindDefaultResolver(e,r){resolverKeys.forEach(s=>{e[s]=r[s].bind(defaultResolver)})}function validateHints(e){if(0!==e&&e!==AI_ADDRCONFIG&&e!==AI_V4MAPPED&&e!==(AI_ADDRCONFIG|AI_V4MAPPED))throw new ERR_INVALID_OPT_VALUE("hints",e)}module.exports={bindDefaultResolver,getDefaultResolver,setDefaultResolver,validateHints,Resolver};"use strict";const{registerDOMException}=internalBinding("messaging"),{ERR_INVALID_THIS}=require("internal/errors").codes,internalsMap=new WeakMap,nameToCodeMap=new Map;class DOMException extends Error{constructor(r="",e="Error"){super(),internalsMap.set(this,{message:`${r}`,name:`${e}`})}get name(){const r=internalsMap.get(this);if(void 0===r)throw new ERR_INVALID_THIS("DOMException");return r.name}get message(){const r=internalsMap.get(this);if(void 0===r)throw new ERR_INVALID_THIS("DOMException");return r.message}get code(){const r=internalsMap.get(this);if(void 0===r)throw new ERR_INVALID_THIS("DOMException");const e=nameToCodeMap.get(r.name);return void 0===e?0:e}}Object.defineProperties(DOMException.prototype,{[Symbol.toStringTag]:{configurable:!0,value:"DOMException"},name:{enumerable:!0,configurable:!0},message:{enumerable:!0,configurable:!0},code:{enumerable:!0,configurable:!0}});for(const[r,e,o]of[["IndexSizeError","INDEX_SIZE_ERR",1],["DOMStringSizeError","DOMSTRING_SIZE_ERR",2],["HierarchyRequestError","HIERARCHY_REQUEST_ERR",3],["WrongDocumentError","WRONG_DOCUMENT_ERR",4],["InvalidCharacterError","INVALID_CHARACTER_ERR",5],["NoDataAllowedError","NO_DATA_ALLOWED_ERR",6],["NoModificationAllowedError","NO_MODIFICATION_ALLOWED_ERR",7],["NotFoundError","NOT_FOUND_ERR",8],["NotSupportedError","NOT_SUPPORTED_ERR",9],["InUseAttributeError","INUSE_ATTRIBUTE_ERR",10],["InvalidStateError","INVALID_STATE_ERR",11],["SyntaxError","SYNTAX_ERR",12],["InvalidModificationError","INVALID_MODIFICATION_ERR",13],["NamespaceError","NAMESPACE_ERR",14],["InvalidAccessError","INVALID_ACCESS_ERR",15],["ValidationError","VALIDATION_ERR",16],["TypeMismatchError","TYPE_MISMATCH_ERR",17],["SecurityError","SECURITY_ERR",18],["NetworkError","NETWORK_ERR",19],["AbortError","ABORT_ERR",20],["URLMismatchError","URL_MISMATCH_ERR",21],["QuotaExceededError","QUOTA_EXCEEDED_ERR",22],["TimeoutError","TIMEOUT_ERR",23],["InvalidNodeTypeError","INVALID_NODE_TYPE_ERR",24],["DataCloneError","DATA_CLONE_ERR",25]]){const E={enumerable:!0,value:o};Object.defineProperty(DOMException,e,E),Object.defineProperty(DOMException.prototype,e,E),nameToCodeMap.set(r,o)}module.exports=DOMException,registerDOMException(DOMException);"use strict";const{ERR_ENCODING_INVALID_ENCODED_DATA,ERR_ENCODING_NOT_SUPPORTED,ERR_INVALID_ARG_TYPE,ERR_INVALID_THIS,ERR_NO_ICU}=require("internal/errors").codes,kHandle=Symbol("handle"),kFlags=Symbol("flags"),kEncoding=Symbol("encoding"),kDecoder=Symbol("decoder"),kEncoder=Symbol("encoder"),{getConstructorOf,customInspectSymbol:inspect}=require("internal/util"),{isArrayBufferView}=require("internal/util/types"),{isArrayBuffer}=internalBinding("types"),{encodeUtf8String}=process.binding("buffer");var Buffer;function lazyBuffer(){return void 0===Buffer&&(Buffer=require("buffer").Buffer),Buffer}function validateEncoder(i){if(null==i||!0!==i[kEncoder])throw new ERR_INVALID_THIS("TextEncoder")}function validateDecoder(i){if(null==i||!0!==i[kDecoder])throw new ERR_INVALID_THIS("TextDecoder")}function validateArgument(i,o,s,e){if(typeof i!==o)throw new ERR_INVALID_ARG_TYPE(s,e,i)}const CONVERTER_FLAGS_FLUSH=1,CONVERTER_FLAGS_FATAL=2,CONVERTER_FLAGS_IGNORE_BOM=4,empty=new Uint8Array(0),encodings=new Map([["unicode-1-1-utf-8","utf-8"],["utf8","utf-8"],["utf-8","utf-8"],["866","ibm866"],["cp866","ibm866"],["csibm866","ibm866"],["ibm866","ibm866"],["csisolatin2","iso-8859-2"],["iso-8859-2","iso-8859-2"],["iso-ir-101","iso-8859-2"],["iso8859-2","iso-8859-2"],["iso88592","iso-8859-2"],["iso_8859-2","iso-8859-2"],["iso_8859-2:1987","iso-8859-2"],["l2","iso-8859-2"],["latin2","iso-8859-2"],["csisolatin3","iso-8859-3"],["iso-8859-3","iso-8859-3"],["iso-ir-109","iso-8859-3"],["iso8859-3","iso-8859-3"],["iso88593","iso-8859-3"],["iso_8859-3","iso-8859-3"],["iso_8859-3:1988","iso-8859-3"],["l3","iso-8859-3"],["latin3","iso-8859-3"],["csisolatin4","iso-8859-4"],["iso-8859-4","iso-8859-4"],["iso-ir-110","iso-8859-4"],["iso8859-4","iso-8859-4"],["iso88594","iso-8859-4"],["iso_8859-4","iso-8859-4"],["iso_8859-4:1988","iso-8859-4"],["l4","iso-8859-4"],["latin4","iso-8859-4"],["csisolatincyrillic","iso-8859-5"],["cyrillic","iso-8859-5"],["iso-8859-5","iso-8859-5"],["iso-ir-144","iso-8859-5"],["iso8859-5","iso-8859-5"],["iso88595","iso-8859-5"],["iso_8859-5","iso-8859-5"],["iso_8859-5:1988","iso-8859-5"],["arabic","iso-8859-6"],["asmo-708","iso-8859-6"],["csiso88596e","iso-8859-6"],["csiso88596i","iso-8859-6"],["csisolatinarabic","iso-8859-6"],["ecma-114","iso-8859-6"],["iso-8859-6","iso-8859-6"],["iso-8859-6-e","iso-8859-6"],["iso-8859-6-i","iso-8859-6"],["iso-ir-127","iso-8859-6"],["iso8859-6","iso-8859-6"],["iso88596","iso-8859-6"],["iso_8859-6","iso-8859-6"],["iso_8859-6:1987","iso-8859-6"],["csisolatingreek","iso-8859-7"],["ecma-118","iso-8859-7"],["elot_928","iso-8859-7"],["greek","iso-8859-7"],["greek8","iso-8859-7"],["iso-8859-7","iso-8859-7"],["iso-ir-126","iso-8859-7"],["iso8859-7","iso-8859-7"],["iso88597","iso-8859-7"],["iso_8859-7","iso-8859-7"],["iso_8859-7:1987","iso-8859-7"],["sun_eu_greek","iso-8859-7"],["csiso88598e","iso-8859-8"],["csisolatinhebrew","iso-8859-8"],["hebrew","iso-8859-8"],["iso-8859-8","iso-8859-8"],["iso-8859-8-e","iso-8859-8"],["iso-ir-138","iso-8859-8"],["iso8859-8","iso-8859-8"],["iso88598","iso-8859-8"],["iso_8859-8","iso-8859-8"],["iso_8859-8:1988","iso-8859-8"],["visual","iso-8859-8"],["csiso88598i","iso-8859-8-i"],["iso-8859-8-i","iso-8859-8-i"],["logical","iso-8859-8-i"],["csisolatin6","iso-8859-10"],["iso-8859-10","iso-8859-10"],["iso-ir-157","iso-8859-10"],["iso8859-10","iso-8859-10"],["iso885910","iso-8859-10"],["l6","iso-8859-10"],["latin6","iso-8859-10"],["iso-8859-13","iso-8859-13"],["iso8859-13","iso-8859-13"],["iso885913","iso-8859-13"],["iso-8859-14","iso-8859-14"],["iso8859-14","iso-8859-14"],["iso885914","iso-8859-14"],["csisolatin9","iso-8859-15"],["iso-8859-15","iso-8859-15"],["iso8859-15","iso-8859-15"],["iso885915","iso-8859-15"],["iso_8859-15","iso-8859-15"],["l9","iso-8859-15"],["cskoi8r","koi8-r"],["koi","koi8-r"],["koi8","koi8-r"],["koi8-r","koi8-r"],["koi8_r","koi8-r"],["koi8-ru","koi8-u"],["koi8-u","koi8-u"],["csmacintosh","macintosh"],["mac","macintosh"],["macintosh","macintosh"],["x-mac-roman","macintosh"],["dos-874","windows-874"],["iso-8859-11","windows-874"],["iso8859-11","windows-874"],["iso885911","windows-874"],["tis-620","windows-874"],["windows-874","windows-874"],["cp1250","windows-1250"],["windows-1250","windows-1250"],["x-cp1250","windows-1250"],["cp1251","windows-1251"],["windows-1251","windows-1251"],["x-cp1251","windows-1251"],["ansi_x3.4-1968","windows-1252"],["ascii","windows-1252"],["cp1252","windows-1252"],["cp819","windows-1252"],["csisolatin1","windows-1252"],["ibm819","windows-1252"],["iso-8859-1","windows-1252"],["iso-ir-100","windows-1252"],["iso8859-1","windows-1252"],["iso88591","windows-1252"],["iso_8859-1","windows-1252"],["iso_8859-1:1987","windows-1252"],["l1","windows-1252"],["latin1","windows-1252"],["us-ascii","windows-1252"],["windows-1252","windows-1252"],["x-cp1252","windows-1252"],["cp1253","windows-1253"],["windows-1253","windows-1253"],["x-cp1253","windows-1253"],["cp1254","windows-1254"],["csisolatin5","windows-1254"],["iso-8859-9","windows-1254"],["iso-ir-148","windows-1254"],["iso8859-9","windows-1254"],["iso88599","windows-1254"],["iso_8859-9","windows-1254"],["iso_8859-9:1989","windows-1254"],["l5","windows-1254"],["latin5","windows-1254"],["windows-1254","windows-1254"],["x-cp1254","windows-1254"],["cp1255","windows-1255"],["windows-1255","windows-1255"],["x-cp1255","windows-1255"],["cp1256","windows-1256"],["windows-1256","windows-1256"],["x-cp1256","windows-1256"],["cp1257","windows-1257"],["windows-1257","windows-1257"],["x-cp1257","windows-1257"],["cp1258","windows-1258"],["windows-1258","windows-1258"],["x-cp1258","windows-1258"],["x-mac-cyrillic","x-mac-cyrillic"],["x-mac-ukrainian","x-mac-cyrillic"],["chinese","gbk"],["csgb2312","gbk"],["csiso58gb231280","gbk"],["gb2312","gbk"],["gb_2312","gbk"],["gb_2312-80","gbk"],["gbk","gbk"],["iso-ir-58","gbk"],["x-gbk","gbk"],["gb18030","gb18030"],["big5","big5"],["big5-hkscs","big5"],["cn-big5","big5"],["csbig5","big5"],["x-x-big5","big5"],["cseucpkdfmtjapanese","euc-jp"],["euc-jp","euc-jp"],["x-euc-jp","euc-jp"],["csiso2022jp","iso-2022-jp"],["iso-2022-jp","iso-2022-jp"],["csshiftjis","shift_jis"],["ms932","shift_jis"],["ms_kanji","shift_jis"],["shift-jis","shift_jis"],["shift_jis","shift_jis"],["sjis","shift_jis"],["windows-31j","shift_jis"],["x-sjis","shift_jis"],["cseuckr","euc-kr"],["csksc56011987","euc-kr"],["euc-kr","euc-kr"],["iso-ir-149","euc-kr"],["korean","euc-kr"],["ks_c_5601-1987","euc-kr"],["ks_c_5601-1989","euc-kr"],["ksc5601","euc-kr"],["ksc_5601","euc-kr"],["windows-949","euc-kr"],["utf-16be","utf-16be"],["utf-16le","utf-16le"],["utf-16","utf-16le"]]);function trimAsciiWhitespace(i){for(var o=0,s=i.length;o<s&&("\t"===i[o]||"\n"===i[o]||"\f"===i[o]||"\r"===i[o]||" "===i[o]);)o++;for(;s>o&&("\t"===i[s-1]||"\n"===i[s-1]||"\f"===i[s-1]||"\r"===i[s-1]||" "===i[s-1]);)s--;return i.slice(o,s)}function getEncodingFromLabel(i){const o=encodings.get(i);return void 0!==o?o:encodings.get(trimAsciiWhitespace(i.toLowerCase()))}class TextEncoder{constructor(){this[kEncoder]=!0}get encoding(){return validateEncoder(this),"utf-8"}encode(i=""){return validateEncoder(this),encodeUtf8String(`${i}`)}[inspect](i,o){if(validateEncoder(this),"number"==typeof i&&i<0)return o.stylize("[Object]","special");var s=getConstructorOf(this),e=Object.create({constructor:null===s?TextEncoder:s});return e.encoding=this.encoding,require("util").inspect(e,o)}}Object.defineProperties(TextEncoder.prototype,{encode:{enumerable:!0},encoding:{enumerable:!0},[Symbol.toStringTag]:{configurable:!0,value:"TextEncoder"}});const{hasConverter,TextDecoder}=process.binding("config").hasIntl?makeTextDecoderICU():makeTextDecoderJS();function hasTextDecoder(i="utf-8"){return validateArgument(i,"string","encoding","string"),hasConverter(getEncodingFromLabel(i))}function makeTextDecoderICU(){const{decode:i,getConverter:o,hasConverter:s}=process.binding("icu");return{hasConverter:s,TextDecoder:class{constructor(i="utf-8",s={}){i=`${i}`,validateArgument(s,"object","options","Object");const e=getEncodingFromLabel(i);if(void 0===e)throw new ERR_ENCODING_NOT_SUPPORTED(i);var t=0;null!==s&&(t|=s.fatal?CONVERTER_FLAGS_FATAL:0,t|=s.ignoreBOM?CONVERTER_FLAGS_IGNORE_BOM:0);const n=o(e,t);if(void 0===n)throw new ERR_ENCODING_NOT_SUPPORTED(i);this[kDecoder]=!0,this[kHandle]=n,this[kFlags]=t,this[kEncoding]=e}decode(o=empty,s={}){if(validateDecoder(this),isArrayBuffer(o))o=lazyBuffer().from(o);else if(!isArrayBufferView(o))throw new ERR_INVALID_ARG_TYPE("input",["ArrayBuffer","ArrayBufferView"],o);validateArgument(s,"object","options","Object");var e=0;null!==s&&(e|=s.stream?0:CONVERTER_FLAGS_FLUSH);const t=i(this[kHandle],o,e);if("number"==typeof t){const i=new ERR_ENCODING_INVALID_ENCODED_DATA(this.encoding);throw i.errno=t,i}return t.toString("ucs2")}}}}function makeTextDecoderJS(){var i;const o=Symbol("BOM seen");function s(i){return"utf-8"===i||"utf-16le"===i}return{hasConverter:s,TextDecoder:class{constructor(e="utf-8",t={}){e=`${e}`,validateArgument(t,"object","options","Object");const n=getEncodingFromLabel(e);if(void 0===n||!s(n))throw new ERR_ENCODING_NOT_SUPPORTED(e);var r=0;if(null!==t){if(t.fatal)throw new ERR_NO_ICU('"fatal" option');r|=t.ignoreBOM?CONVERTER_FLAGS_IGNORE_BOM:0}this[kDecoder]=!0,this[kHandle]=new(void 0===i&&({StringDecoder:i}=require("string_decoder")),i)(n),this[kFlags]=r,this[kEncoding]=n,this[o]=!1}decode(i=empty,s={}){if(validateDecoder(this),isArrayBuffer(i))i=lazyBuffer().from(i);else{if(!isArrayBufferView(i))throw new ERR_INVALID_ARG_TYPE("input",["ArrayBuffer","ArrayBufferView"],i);i=lazyBuffer().from(i.buffer,i.byteOffset,i.byteLength)}return validateArgument(s,"object","options","Object"),this[kFlags]&CONVERTER_FLAGS_FLUSH&&(this[o]=!1),null!==s&&s.stream?this[kFlags]&=~CONVERTER_FLAGS_FLUSH:this[kFlags]|=CONVERTER_FLAGS_FLUSH,this[o]||this[kFlags]&CONVERTER_FLAGS_IGNORE_BOM||("utf-8"===this[kEncoding]?i.length>=3&&239===i[0]&&187===i[1]&&191===i[2]&&(i=i.slice(3)):"utf-16le"===this[kEncoding]&&i.length>=2&&255===i[0]&&254===i[1]&&(i=i.slice(2)),this[o]=!0),this[kFlags]&CONVERTER_FLAGS_FLUSH?this[kHandle].end(i):this[kHandle].write(i)}}}}Object.defineProperties(TextDecoder.prototype,Object.getOwnPropertyDescriptors({get encoding(){return validateDecoder(this),this[kEncoding]},get fatal(){return validateDecoder(this),(this[kFlags]&CONVERTER_FLAGS_FATAL)===CONVERTER_FLAGS_FATAL},get ignoreBOM(){return validateDecoder(this),(this[kFlags]&CONVERTER_FLAGS_IGNORE_BOM)===CONVERTER_FLAGS_IGNORE_BOM},[inspect](i,o){if(validateDecoder(this),"number"==typeof i&&i<0)return o.stylize("[Object]","special");var s=getConstructorOf(this),e=Object.create({constructor:null===s?TextDecoder:s});return e.encoding=this.encoding,e.fatal=this.fatal,e.ignoreBOM=this.ignoreBOM,o.showHidden&&(e[kFlags]=this[kFlags],e[kHandle]=this[kHandle]),require("util").inspect(e,o)}})),Object.defineProperties(TextDecoder.prototype,{decode:{enumerable:!0},[inspect]:{enumerable:!1},[Symbol.toStringTag]:{configurable:!0,value:"TextDecoder"}}),module.exports={getEncodingFromLabel,hasTextDecoder,TextDecoder,TextEncoder};"use strict";const Buffer=require("buffer").Buffer,{serialize,deserialize}=require("v8"),{SafeSet}=require("internal/safe_globals"),kSerializedError=0,kSerializedObject=1,kInspectedError=2,GetPrototypeOf=Object.getPrototypeOf,GetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,GetOwnPropertyNames=Object.getOwnPropertyNames,DefineProperty=Object.defineProperty,Assign=Object.assign,ObjectPrototypeToString=Function.prototype.call.bind(Object.prototype.toString),ForEach=Function.prototype.call.bind(Array.prototype.forEach),Call=Function.prototype.call.bind(Function.prototype.call),errors={Error,TypeError,RangeError,URIError,SyntaxError,ReferenceError,EvalError},errorConstructorNames=new SafeSet(Object.keys(errors));function TryGetAllProperties(r,e=r){const t=Object.create(null);if(null===r)return t;Assign(t,TryGetAllProperties(GetPrototypeOf(r),e));const o=GetOwnPropertyNames(r);return ForEach(o,o=>{const n=GetOwnPropertyDescriptor(r,o),i=n.get;if(i&&"__proto__"!==o)try{n.value=Call(i,e)}catch{}"value"in n&&"function"!=typeof n.value&&(delete n.get,delete n.set,t[o]=n)}),t}function GetConstructors(r){const e=[];for(var t=r;null!==t;t=GetPrototypeOf(t)){const r=GetOwnPropertyDescriptor(t,"constructor");r&&r.value&&DefineProperty(e,e.length,{value:r.value,enumerable:!0})}return e}function GetName(r){const e=GetOwnPropertyDescriptor(r,"name");return e&&e.value}let util;function lazyUtil(){return util||(util=require("util")),util}function serializeError(r){try{if("object"==typeof r&&"[object Error]"===ObjectPrototypeToString(r)){const t=GetConstructors(r);for(var e=t.length-1;e>=0;e--){const o=GetName(t[e]);if(errorConstructorNames.has(o)){try{r.stack}catch{}const e=serialize({constructor:o,properties:TryGetAllProperties(r)});return Buffer.concat([Buffer.from([kSerializedError]),e])}}}}catch{}try{const e=serialize(r);return Buffer.concat([Buffer.from([kSerializedObject]),e])}catch{}return Buffer.concat([Buffer.from([kInspectedError]),Buffer.from(lazyUtil().inspect(r),"utf8")])}function deserializeError(r){switch(r[0]){case kSerializedError:const{constructor:e,properties:t}=deserialize(r.subarray(1)),o=errors[e];return Object.create(o.prototype,t);case kSerializedObject:return deserialize(r.subarray(1));case kInspectedError:return Buffer.from(r.buffer,r.byteOffset+1,r.byteLength-1).toString("utf8")}require("assert").fail("This should not happen")}module.exports={serializeError,deserializeError};"use strict";const kCode=Symbol("code"),kInfo=Symbol("info"),messages=new Map,codes={},{errmap,UV_EAI_MEMORY,UV_EAI_NODATA,UV_EAI_NONAME}=process.binding("uv"),{kMaxLength}=process.binding("buffer"),{defineProperty}=Object;let util,assert,buffer,internalUtil=null;function lazyInternalUtil(){return internalUtil||(internalUtil=require("internal/util")),internalUtil}function lazyBuffer(){return void 0===buffer&&(buffer=require("buffer").Buffer),buffer}class SystemError extends Error{constructor(e,r){let E=`${getMessage(e,[])}: ${r.syscall} returned `+`${r.code} (${r.message})`;void 0!==r.path&&(E+=` ${r.path}`),void 0!==r.dest&&(E+=` => ${r.dest}`),super(E),Object.defineProperty(this,kInfo,{configurable:!1,enumerable:!1,value:r}),Object.defineProperty(this,kCode,{configurable:!0,enumerable:!1,value:e,writable:!0})}get name(){return`SystemError [${this[kCode]}]`}set name(e){defineProperty(this,"name",{configurable:!0,enumerable:!0,value:e,writable:!0})}get code(){return this[kCode]}set code(e){defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}get info(){return this[kInfo]}get errno(){return this[kInfo].errno}set errno(e){this[kInfo].errno=e}get syscall(){return this[kInfo].syscall}set syscall(e){this[kInfo].syscall=e}get path(){return void 0!==this[kInfo].path?this[kInfo].path.toString():void 0}set path(e){this[kInfo].path=e?lazyBuffer().from(e.toString()):void 0}get dest(){return void 0!==this[kInfo].path?this[kInfo].dest.toString():void 0}set dest(e){this[kInfo].dest=e?lazyBuffer().from(e.toString()):void 0}}function makeSystemErrorWithCode(e){return class extends SystemError{constructor(r){super(e,r)}}}let maxStack_ErrorName,maxStack_ErrorMessage,useOriginalName=!1;function makeNodeErrorWithCode(e,r){return class extends e{constructor(...e){super(getMessage(r,e))}get name(){return useOriginalName?super.name:`${super.name} [${r}]`}set name(e){defineProperty(this,"name",{configurable:!0,enumerable:!0,value:e,writable:!0})}get code(){return r}set code(e){defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}}}function E(e,r,E,...t){messages.set(e,r),E=E===SystemError?makeSystemErrorWithCode(e):makeNodeErrorWithCode(E,e),0!==t.length&&t.forEach(r=>{E[r.name]=makeNodeErrorWithCode(r,e)}),codes[e]=E}function getMessage(e,r){const E=messages.get(e);if(void 0===util&&(util=require("util")),void 0===assert&&(assert=require("assert")),"function"==typeof E)return assert(E.length<=r.length,`Code: ${e}; The provided arguments length (${r.length}) does not `+`match the required ones (${E.length}).`),E.apply(null,r);const t=(E.match(/%[dfijoOs]/g)||[]).length;return assert(t===r.length,`Code: ${e}; The provided arguments length (${r.length}) does not `+`match the required ones (${t}).`),0===r.length?E:(r.unshift(E),util.format.apply(null,r))}function uvException(e){const[r,E]=errmap.get(e.errno);let t,o,n=`${r}: ${e.message||E}, ${e.syscall}`;e.path&&(n+=` '${t=e.path.toString()}'`),e.dest&&(n+=` -> '${o=e.dest.toString()}'`);const s=new Error(n);for(const r of Object.keys(e))"message"!==r&&"path"!==r&&"dest"!==r&&(s[r]=e[r]);return s.code=r,t&&(s.path=t),o&&(s.dest=o),Error.captureStackTrace(s,uvException),s}function uvExceptionWithHostPort(e,r,E,t,o){const[n,s]=errmap.get(e);let a="";t&&t>0?a=` ${E}:${t}`:E&&(a=` ${E}`),o&&(a+=` - Local (${o})`);const R=new Error(`${`${r} ${n}: ${s}`}${a}`);return R.code=n,R.errno=n,R.syscall=r,R.address=E,t&&(R.port=t),Error.captureStackTrace(R,uvExceptionWithHostPort),R}function errnoException(e,r,E){void 0===util&&(util=require("util"));const t=util.getSystemErrorName(e),o=new Error(E?`${r} ${t} ${E}`:`${r} ${t}`);return o.code=o.errno=t,o.syscall=r,Error.captureStackTrace(o,errnoException),o}function exceptionWithHostPort(e,r,E,t,o){void 0===util&&(util=require("util"));const n=util.getSystemErrorName(e);let s="";t&&t>0?s=` ${E}:${t}`:E&&(s=` ${E}`),o&&(s+=` - Local (${o})`);const a=new Error(`${r} ${n}${s}`);return a.code=a.errno=n,a.syscall=r,a.address=E,t&&(a.port=t),Error.captureStackTrace(a,exceptionWithHostPort),a}function dnsException(e,r,E){"number"==typeof e&&(e=e===UV_EAI_MEMORY||e===UV_EAI_NODATA||e===UV_EAI_NONAME?"ENOTFOUND":lazyInternalUtil().getSystemErrorName(e));const t=new Error(`${r} ${e}${E?` ${E}`:""}`);return t.errno=e,t.code=e,t.syscall=r,E&&(t.hostname=E),Error.captureStackTrace(t,dnsException),t}function isStackOverflowError(e){if(void 0===maxStack_ErrorMessage)try{!function e(){e()}()}catch(e){maxStack_ErrorMessage=e.message,maxStack_ErrorName=e.name}return e.name===maxStack_ErrorName&&e.message===maxStack_ErrorMessage}function oneOf(e,r){if(assert("string"==typeof r,"`thing` has to be of type string"),Array.isArray(e)){const E=e.length;return assert(E>0,"At least one expected value needs to be specified"),e=e.map(e=>String(e)),E>2?`one of ${r} ${e.slice(0,E-1).join(", ")}, or `+e[E-1]:2===E?`one of ${r} ${e[0]} or ${e[1]}`:`of ${r} ${e[0]}`}return`of ${r} ${String(e)}`}module.exports={dnsException,errnoException,exceptionWithHostPort,uvException,uvExceptionWithHostPort,isStackOverflowError,getMessage,SystemError,codes,E,get useOriginalName(){return useOriginalName},set useOriginalName(e){useOriginalName=e}},E("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),E("ERR_ARG_NOT_ITERABLE","%s must be iterable",TypeError),E("ERR_ASSERTION","%s",Error),E("ERR_ASYNC_CALLBACK","%s must be a function",TypeError),E("ERR_ASYNC_TYPE",'Invalid name for async "type": %s',TypeError),E("ERR_BUFFER_OUT_OF_BOUNDS",e=>e?`"${e}" is outside of buffer bounds`:"Attempt to write outside buffer bounds",RangeError),E("ERR_BUFFER_TOO_LARGE",`Cannot create a Buffer larger than 0x${kMaxLength.toString(16)} bytes`,RangeError),E("ERR_CANNOT_WATCH_SIGINT","Cannot watch for SIGINT signals",Error),E("ERR_CHILD_CLOSED_BEFORE_REPLY","Child closed before reply received",Error),E("ERR_CHILD_PROCESS_IPC_REQUIRED","Forked processes must have an IPC channel, missing value 'ipc' in %s",Error),E("ERR_CHILD_PROCESS_STDIO_MAXBUFFER","%s maxBuffer length exceeded",RangeError),E("ERR_CONSOLE_WRITABLE_STREAM","Console expects a writable stream instance for %s",TypeError),E("ERR_CPU_USAGE","Unable to obtain cpu usage %s",Error),E("ERR_CRYPTO_CUSTOM_ENGINE_NOT_SUPPORTED","Custom engines not supported by this OpenSSL",Error),E("ERR_CRYPTO_ECDH_INVALID_FORMAT","Invalid ECDH format: %s",TypeError),E("ERR_CRYPTO_ECDH_INVALID_PUBLIC_KEY","Public key is not valid for specified curve",Error),E("ERR_CRYPTO_ENGINE_UNKNOWN",'Engine "%s" was not found',Error),E("ERR_CRYPTO_FIPS_FORCED","Cannot set FIPS mode, it was forced with --force-fips at startup.",Error),E("ERR_CRYPTO_FIPS_UNAVAILABLE","Cannot set FIPS mode in a non-FIPS build.",Error),E("ERR_CRYPTO_HASH_DIGEST_NO_UTF16","hash.digest() does not support UTF-16",Error),E("ERR_CRYPTO_HASH_FINALIZED","Digest already called",Error),E("ERR_CRYPTO_HASH_UPDATE_FAILED","Hash update failed",Error),E("ERR_CRYPTO_INCOMPATIBLE_KEY_OPTIONS","The selected key encoding %s %s.",Error),E("ERR_CRYPTO_INVALID_DIGEST","Invalid digest: %s",TypeError),E("ERR_CRYPTO_INVALID_STATE","Invalid state for operation %s",Error),E("ERR_CRYPTO_PBKDF2_ERROR","PBKDF2 error",Error),E("ERR_CRYPTO_SCRYPT_INVALID_PARAMETER","Invalid scrypt parameter",Error),E("ERR_CRYPTO_SCRYPT_NOT_SUPPORTED","Scrypt algorithm not supported",Error),E("ERR_CRYPTO_SIGN_KEY_REQUIRED","No key provided to sign",Error),E("ERR_CRYPTO_TIMING_SAFE_EQUAL_LENGTH","Input buffers must have the same length",RangeError),E("ERR_DNS_SET_SERVERS_FAILED",'c-ares failed to set servers: "%s" [%s]',Error),E("ERR_DOMAIN_CALLBACK_NOT_AVAILABLE","A callback was registered through process.setUncaughtExceptionCaptureCallback(), which is mutually exclusive with using the `domain` module",Error),E("ERR_DOMAIN_CANNOT_SET_UNCAUGHT_EXCEPTION_CAPTURE","The `domain` module is in use, which is mutually exclusive with calling process.setUncaughtExceptionCaptureCallback()",Error),E("ERR_ENCODING_INVALID_ENCODED_DATA","The encoded data was not valid for encoding %s",TypeError),E("ERR_ENCODING_NOT_SUPPORTED",'The "%s" encoding is not supported',RangeError),E("ERR_FALSY_VALUE_REJECTION","Promise was rejected with falsy value",Error),E("ERR_FS_FILE_TOO_LARGE","File size (%s) is greater than possible Buffer: "+`${kMaxLength} bytes`,RangeError),E("ERR_FS_INVALID_SYMLINK_TYPE",'Symlink type must be one of "dir", "file", or "junction". Received "%s"',Error),E("ERR_HTTP2_ALTSVC_INVALID_ORIGIN","HTTP/2 ALTSVC frames require a valid origin",TypeError),E("ERR_HTTP2_ALTSVC_LENGTH","HTTP/2 ALTSVC frames are limited to 16382 bytes",TypeError),E("ERR_HTTP2_CONNECT_AUTHORITY",":authority header is required for CONNECT requests",Error),E("ERR_HTTP2_CONNECT_PATH","The :path header is forbidden for CONNECT requests",Error),E("ERR_HTTP2_CONNECT_SCHEME","The :scheme header is forbidden for CONNECT requests",Error),E("ERR_HTTP2_GOAWAY_SESSION","New streams cannot be created after receiving a GOAWAY",Error),E("ERR_HTTP2_HEADERS_AFTER_RESPOND","Cannot specify additional headers after response initiated",Error),E("ERR_HTTP2_HEADERS_SENT","Response has already been initiated.",Error),E("ERR_HTTP2_HEADER_SINGLE_VALUE",'Header field "%s" must only have a single value',TypeError),E("ERR_HTTP2_INFO_STATUS_NOT_ALLOWED","Informational status codes cannot be used",RangeError),E("ERR_HTTP2_INVALID_CONNECTION_HEADERS",'HTTP/1 Connection specific headers are forbidden: "%s"',TypeError),E("ERR_HTTP2_INVALID_HEADER_VALUE",'Invalid value "%s" for header "%s"',TypeError),E("ERR_HTTP2_INVALID_INFO_STATUS","Invalid informational status code: %s",RangeError),E("ERR_HTTP2_INVALID_ORIGIN","HTTP/2 ORIGIN frames require a valid origin",TypeError),E("ERR_HTTP2_INVALID_PACKED_SETTINGS_LENGTH","Packed settings length must be a multiple of six",RangeError),E("ERR_HTTP2_INVALID_PSEUDOHEADER",'"%s" is an invalid pseudoheader or is used incorrectly',TypeError),E("ERR_HTTP2_INVALID_SESSION","The session has been destroyed",Error),E("ERR_HTTP2_INVALID_SETTING_VALUE",'Invalid value for setting "%s": %s',TypeError,RangeError),E("ERR_HTTP2_INVALID_STREAM","The stream has been destroyed",Error),E("ERR_HTTP2_MAX_PENDING_SETTINGS_ACK","Maximum number of pending settings acknowledgements",Error),E("ERR_HTTP2_NESTED_PUSH","A push stream cannot initiate another push stream.",Error),E("ERR_HTTP2_NO_SOCKET_MANIPULATION","HTTP/2 sockets should not be directly manipulated (e.g. read and written)",Error),E("ERR_HTTP2_ORIGIN_LENGTH","HTTP/2 ORIGIN frames are limited to 16382 bytes",TypeError),E("ERR_HTTP2_OUT_OF_STREAMS","No stream ID is available because maximum stream ID has been reached",Error),E("ERR_HTTP2_PAYLOAD_FORBIDDEN","Responses with %s status must not have a payload",Error),E("ERR_HTTP2_PING_CANCEL","HTTP2 ping cancelled",Error),E("ERR_HTTP2_PING_LENGTH","HTTP2 ping payload must be 8 bytes",RangeError),E("ERR_HTTP2_PSEUDOHEADER_NOT_ALLOWED","Cannot set HTTP/2 pseudo-headers",TypeError),E("ERR_HTTP2_PUSH_DISABLED","HTTP/2 client has disabled push streams",Error),E("ERR_HTTP2_SEND_FILE","Directories cannot be sent",Error),E("ERR_HTTP2_SEND_FILE_NOSEEK","Offset or length can only be specified for regular files",Error),E("ERR_HTTP2_SESSION_ERROR","Session closed with error code %s",Error),E("ERR_HTTP2_SETTINGS_CANCEL","HTTP2 session settings canceled",Error),E("ERR_HTTP2_SOCKET_BOUND","The socket is already bound to an Http2Session",Error),E("ERR_HTTP2_SOCKET_UNBOUND","The socket has been disconnected from the Http2Session",Error),E("ERR_HTTP2_STATUS_101","HTTP status code 101 (Switching Protocols) is forbidden in HTTP/2",Error),E("ERR_HTTP2_STATUS_INVALID","Invalid status code: %s",RangeError),E("ERR_HTTP2_STREAM_CANCEL","The pending stream has been canceled",Error),E("ERR_HTTP2_STREAM_ERROR","Stream closed with error code %s",Error),E("ERR_HTTP2_STREAM_SELF_DEPENDENCY","A stream cannot depend on itself",Error),E("ERR_HTTP2_TRAILERS_ALREADY_SENT","Trailing headers have already been sent",Error),E("ERR_HTTP2_TRAILERS_NOT_READY","Trailing headers cannot be sent until after the wantTrailers event is emitted",Error),E("ERR_HTTP2_UNSUPPORTED_PROTOCOL",'protocol "%s" is unsupported.',Error),E("ERR_HTTP_HEADERS_SENT","Cannot %s headers after they are sent to the client",Error),E("ERR_HTTP_INVALID_HEADER_VALUE",'Invalid value "%s" for header "%s"',TypeError),E("ERR_HTTP_INVALID_STATUS_CODE","Invalid status code: %s",RangeError),E("ERR_HTTP_TRAILER_INVALID","Trailers are invalid with this transfer encoding",Error),E("ERR_INDEX_OUT_OF_RANGE","Index out of range",RangeError),E("ERR_INSPECTOR_ALREADY_CONNECTED","%s is already connected",Error),E("ERR_INSPECTOR_CLOSED","Session was closed",Error),E("ERR_INSPECTOR_NOT_AVAILABLE","Inspector is not available",Error),E("ERR_INSPECTOR_NOT_CONNECTED","Session is not connected",Error),E("ERR_INVALID_ADDRESS_FAMILY","Invalid address family: %s",RangeError),E("ERR_INVALID_ARG_TYPE",(e,r,E)=>{let t,o;if(assert("string"==typeof e,"'name' must be a string"),"string"==typeof r&&r.startsWith("not ")?(t="must not be",r=r.replace(/^not /,"")):t="must be",e.endsWith(" argument"))o=`The ${e} ${t} ${oneOf(r,"type")}`;else{const E=e.includes(".")?"property":"argument";o=`The "${e}" ${E} ${t} ${oneOf(r,"type")}`}return o+=`. Received type ${typeof E}`},TypeError),E("ERR_INVALID_ARG_VALUE",(e,r,E="is invalid")=>{let t=util.inspect(r);return t.length>128&&(t=`${t.slice(0,128)}...`),`The argument '${e}' ${E}. Received ${t}`},TypeError,RangeError),E("ERR_INVALID_ARRAY_LENGTH",(e,r,E)=>`The array "${e}" (length ${E}) must be of length ${r}.`,TypeError),E("ERR_INVALID_ASYNC_ID","Invalid %s value: %s",RangeError),E("ERR_INVALID_BUFFER_SIZE","Buffer size must be a multiple of %s",RangeError),E("ERR_INVALID_CALLBACK","Callback must be a function",TypeError),E("ERR_INVALID_CHAR",(e,r)=>{let E=`Invalid character in ${e}`;return void 0!==r&&(E+=` ["${r}"]`),E},TypeError),E("ERR_INVALID_CURSOR_POS","Cannot set cursor row without setting its column",TypeError),E("ERR_INVALID_DOMAIN_NAME","Unable to determine the domain name",TypeError),E("ERR_INVALID_FD",'"fd" must be a positive integer: %s',RangeError),E("ERR_INVALID_FD_TYPE","Unsupported fd type: %s",TypeError),E("ERR_INVALID_FILE_URL_HOST",'File URL host must be "localhost" or empty on %s',TypeError),E("ERR_INVALID_FILE_URL_PATH","File URL path %s",TypeError),E("ERR_INVALID_HANDLE_TYPE","This handle type cannot be sent",TypeError),E("ERR_INVALID_HTTP_TOKEN",'%s must be a valid HTTP token ["%s"]',TypeError),E("ERR_INVALID_IP_ADDRESS","Invalid IP address: %s",TypeError),E("ERR_INVALID_OPT_VALUE",(e,r)=>`The value "${String(r)}" is invalid for option "${e}"`,TypeError,RangeError),E("ERR_INVALID_OPT_VALUE_ENCODING",'The value "%s" is invalid for option "encoding"',TypeError),E("ERR_INVALID_PERFORMANCE_MARK",'The "%s" performance mark has not been set',Error),E("ERR_INVALID_PROTOCOL",'Protocol "%s" not supported. Expected "%s"',TypeError),E("ERR_INVALID_REPL_EVAL_CONFIG",'Cannot specify both "breakEvalOnSigint" and "eval" for REPL',TypeError),E("ERR_INVALID_RETURN_PROPERTY",(e,r,E,t)=>`Expected a valid ${e} to be returned for the "${E}" from the`+` "${r}" function but got ${t}.`,TypeError),E("ERR_INVALID_RETURN_PROPERTY_VALUE",(e,r,E,t)=>{let o;return`Expected ${e} to be returned for the "${E}" from the`+` "${r}" function but got ${o=t&&t.constructor&&t.constructor.name?`instance of ${t.constructor.name}`:`type ${typeof t}`}.`},TypeError),E("ERR_INVALID_RETURN_VALUE",(e,r,E)=>{let t;return`Expected ${e} to be returned from the "${r}"`+` function but got ${t=E&&E.constructor&&E.constructor.name?`instance of ${E.constructor.name}`:`type ${typeof E}`}.`},TypeError),E("ERR_INVALID_SYNC_FORK_INPUT","Asynchronous forks do not support Buffer, TypedArray, DataView or string input: %s",TypeError),E("ERR_INVALID_THIS",'Value of "this" must be of type %s',TypeError),E("ERR_INVALID_TUPLE","%s must be an iterable %s tuple",TypeError),E("ERR_INVALID_URI","URI malformed",URIError),E("ERR_INVALID_URL","Invalid URL: %s",TypeError),E("ERR_INVALID_URL_SCHEME",e=>`The URL must be ${oneOf(e,"scheme")}`,TypeError),E("ERR_IPC_CHANNEL_CLOSED","Channel closed",Error),E("ERR_IPC_DISCONNECTED","IPC channel is already disconnected",Error),E("ERR_IPC_ONE_PIPE","Child process can have only one IPC pipe",Error),E("ERR_IPC_SYNC_FORK","IPC cannot be used with synchronous forks",Error),E("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),E("ERR_MISSING_ARGS",(...e)=>{assert(e.length>0,"At least one arg needs to be specified");let r="The ";const E=e.length;switch(e=e.map(e=>`"${e}"`),E){case 1:r+=`${e[0]} argument`;break;case 2:r+=`${e[0]} and ${e[1]} arguments`;break;default:r+=e.slice(0,E-1).join(", "),r+=`, and ${e[E-1]} arguments`}return`${r} must be specified`},TypeError),E("ERR_MISSING_DYNAMIC_INSTANTIATE_HOOK","The ES Module loader may not return a format of 'dynamic' when no dynamicInstantiate function was provided",Error),E("ERR_MISSING_MODULE","Cannot find module %s",Error),E("ERR_MODULE_RESOLUTION_LEGACY","%s not found by import in %s. Legacy behavior in require() would have found it at %s",Error),E("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),E("ERR_NAPI_CONS_FUNCTION","Constructor must be a function",TypeError),E("ERR_NAPI_INVALID_DATAVIEW_ARGS","byte_offset + byte_length should be less than or equal to the size in bytes of the array passed in",RangeError),E("ERR_NAPI_INVALID_TYPEDARRAY_ALIGNMENT","start offset of %s should be a multiple of %s",RangeError),E("ERR_NAPI_INVALID_TYPEDARRAY_LENGTH","Invalid typed array length",RangeError),E("ERR_NO_CRYPTO","Node.js is not compiled with OpenSSL crypto support",Error),E("ERR_NO_ICU","%s is not supported on Node.js compiled without ICU",TypeError),E("ERR_NO_LONGER_SUPPORTED","%s is no longer supported",Error),E("ERR_OUT_OF_RANGE",(e,r,E)=>{let t=`The value of "${e}" is out of range.`;return void 0!==r&&(t+=` It must be ${r}.`),t+=` Received ${E}`},RangeError),E("ERR_REQUIRE_ESM","Must use import to load ES Module: %s",Error),E("ERR_SCRIPT_EXECUTION_INTERRUPTED","Script execution was interrupted by `SIGINT`.",Error),E("ERR_SERVER_ALREADY_LISTEN","Listen method has been called more than once without closing.",Error),E("ERR_SERVER_NOT_RUNNING","Server is not running.",Error),E("ERR_SOCKET_ALREADY_BOUND","Socket is already bound",Error),E("ERR_SOCKET_BAD_BUFFER_SIZE","Buffer size must be a positive integer",TypeError),E("ERR_SOCKET_BAD_PORT","Port should be >= 0 and < 65536. Received %s.",RangeError),E("ERR_SOCKET_BAD_TYPE","Bad socket type specified. Valid types are: udp4, udp6",TypeError),E("ERR_SOCKET_BUFFER_SIZE","Could not get or set buffer size",SystemError),E("ERR_SOCKET_CANNOT_SEND","Unable to send data",Error),E("ERR_SOCKET_CLOSED","Socket is closed",Error),E("ERR_SOCKET_DGRAM_NOT_RUNNING","Not running",Error),E("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),E("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),E("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),E("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),E("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),E("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),E("ERR_STREAM_WRAP","Stream has StringDecoder set or is in objectMode",Error),E("ERR_STREAM_WRITE_AFTER_END","write after end",Error),E("ERR_SYSTEM_ERROR","A system error occurred",SystemError),E("ERR_TLS_CERT_ALTNAME_INVALID","Hostname/IP does not match certificate's altnames: %s",Error),E("ERR_TLS_DH_PARAM_SIZE","DH parameter size %s is less than 2048",Error),E("ERR_TLS_HANDSHAKE_TIMEOUT","TLS handshake timeout",Error),E("ERR_TLS_RENEGOTIATE","Attempt to renegotiate TLS session failed",Error),E("ERR_TLS_RENEGOTIATION_DISABLED","TLS session renegotiation disabled for this socket",Error),E("ERR_TLS_REQUIRED_SERVER_NAME",'"servername" is required parameter for Server.addContext',Error),E("ERR_TLS_SESSION_ATTACK","TLS session renegotiation attack detected",Error),E("ERR_TLS_SNI_FROM_SERVER","Cannot issue SNI from a TLS server-side socket",Error),E("ERR_TRACE_EVENTS_CATEGORY_REQUIRED","At least one category is required",TypeError),E("ERR_TRACE_EVENTS_UNAVAILABLE","Trace events are unavailable",Error),E("ERR_TRANSFORM_ALREADY_TRANSFORMING","Calling transform done when still transforming",Error),E("ERR_TRANSFORM_WITH_LENGTH_0","Calling transform done when writableState.length != 0",Error),E("ERR_TTY_INIT_FAILED","TTY initialization failed",SystemError),E("ERR_UNCAUGHT_EXCEPTION_CAPTURE_ALREADY_SET","`process.setupUncaughtExceptionCapture()` was called while a capture callback was already active",Error),E("ERR_UNESCAPED_CHARACTERS","%s contains unescaped characters",TypeError),E("ERR_UNHANDLED_ERROR",e=>{const r="Unhandled error.";return void 0===e?r:`${r} (${e})`},Error),E("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),E("ERR_UNKNOWN_FILE_EXTENSION","Unknown file extension: %s",Error),E("ERR_UNKNOWN_MODULE_FORMAT","Unknown module format: %s",RangeError),E("ERR_UNKNOWN_SIGNAL","Unknown signal: %s",TypeError),E("ERR_UNKNOWN_STDIN_TYPE","Unknown stdin file type",Error),E("ERR_UNKNOWN_STREAM_TYPE","Unknown stream file type",Error),E("ERR_V8BREAKITERATOR","Full ICU data not installed. See https://github.com/nodejs/node/wiki/Intl",Error),E("ERR_VALID_PERFORMANCE_ENTRY_TYPE","At least one valid performance entry type is required",Error),E("ERR_VM_MODULE_ALREADY_LINKED","Module has already been linked",Error),E("ERR_VM_MODULE_DIFFERENT_CONTEXT","Linked modules must use the same context",Error),E("ERR_VM_MODULE_LINKING_ERRORED","Linking has already failed for the provided module",Error),E("ERR_VM_MODULE_NOT_LINKED","Module must be linked before it can be instantiated",Error),E("ERR_VM_MODULE_NOT_MODULE","Provided module is not an instance of Module",Error),E("ERR_VM_MODULE_STATUS","Module status %s",Error),E("ERR_WORKER_PATH","The worker script filename must be an absolute path or a relative path starting with './' or '../'. Received \"%s\"",TypeError),E("ERR_WORKER_UNSERIALIZABLE_ERROR","Serializing an uncaught exception failed",Error),E("ERR_WORKER_UNSUPPORTED_EXTENSION",'The worker script extension must be ".js" or ".mjs". Received "%s"',TypeError),E("ERR_ZLIB_INITIALIZATION_FAILED","Initialization failed",Error);"use strict";const kSize=2048,kMask=2047,FixedCircularBuffer=class{constructor(){this.bottom=0,this.top=0,this.list=new Array(2048),this.next=null}isEmpty(){return this.top===this.bottom}isFull(){return(this.top+1&2047)===this.bottom}push(t){this.list[this.top]=t,this.top=this.top+1&2047}shift(){const t=this.list[this.bottom];return void 0===t?null:(this.list[this.bottom]=void 0,this.bottom=this.bottom+1&2047,t)}};module.exports=class{constructor(){this.head=this.tail=new FixedCircularBuffer}isEmpty(){return this.head.isEmpty()}push(t){this.head.isFull()&&(this.head=this.head.next=new FixedCircularBuffer),this.head.push(t)}shift(){const{tail:t}=this,s=t.shift();return t.isEmpty()&&null!==t.next&&(this.tail=t.next),s}};"use strict";const is_reused_symbol=Symbol("isReused");class FreeList{constructor(s,t,e){this.name=s,this.ctor=e,this.max=t,this.list=[]}alloc(){let s;return this.list.length>0?(s=this.list.pop())[is_reused_symbol]=!0:(s=this.ctor.apply(this,arguments))[is_reused_symbol]=!1,s}free(s){return this.list.length<this.max&&(this.list.push(s),!0)}}module.exports={FreeList,symbols:{is_reused_symbol}};"use strict";const{F_OK,O_SYMLINK,O_WRONLY,S_IFMT,S_IFREG}=process.binding("constants").fs,binding=process.binding("fs"),{Buffer,kMaxLength}=require("buffer"),{ERR_FS_FILE_TOO_LARGE,ERR_INVALID_ARG_TYPE,ERR_METHOD_NOT_IMPLEMENTED}=require("internal/errors").codes,{toPathIfFileURL}=require("internal/url"),{isUint8Array}=require("internal/util/types"),{copyObject,getDirents,getOptions,getStatsFromBinding,nullCheck,preprocessSymlinkDestination,stringToFlags,stringToSymlinkType,toUnixTimestamp,validateBuffer,validateOffsetLengthRead,validateOffsetLengthWrite,validatePath}=require("internal/fs/utils"),{validateInteger,validateMode,validateUint32}=require("internal/validators"),pathModule=require("path"),{promisify}=require("internal/util"),kHandle=Symbol("handle"),{kUsePromises}=binding,getDirectoryEntriesPromise=promisify(getDirents);class FileHandle{constructor(e){this[kHandle]=e}getAsyncId(){return this[kHandle].getAsyncId()}get fd(){return this[kHandle].fd}appendFile(e,t){return appendFile(this,e,t)}chmod(e){return fchmod(this,e)}chown(e,t){return fchown(this,e,t)}datasync(){return fdatasync(this)}sync(){return fsync(this)}read(e,t,i,n){return read(this,e,t,i,n)}readFile(e){return readFile(this,e)}stat(e){return fstat(this,e)}truncate(e=0){return ftruncate(this,e)}utimes(e,t){return futimes(this,e,t)}write(e,t,i,n){return write(this,e,t,i,n)}writeFile(e,t){return writeFile(this,e,t)}close(){return this[kHandle].close()}}function validateFileHandle(e){if(!(e instanceof FileHandle))throw new ERR_INVALID_ARG_TYPE("filehandle","FileHandle",e)}async function writeFileHandle(e,t,i){let n=isUint8Array(t)?t:Buffer.from(""+t,i.encoding||"utf8"),a=n.length;if(0!==a)do{const{bytesWritten:t}=await write(e,n,0,Math.min(16384,n.length));a-=t,n=n.slice(t)}while(a>0)}const kReadFileMaxChunkSize=16384;async function readFileHandle(e,t){const i=await binding.fstat(e.fd,!1,kUsePromises);let n;if((n=(i[1]&S_IFMT)===S_IFREG?i[8]:0)>kMaxLength)throw new ERR_FS_FILE_TOO_LARGE(n);const a=[],s=0===n?kReadFileMaxChunkSize:Math.min(n,kReadFileMaxChunkSize);let r=!1;do{const t=Buffer.alloc(s),{bytesRead:i,buffer:n}=await read(e,t,0,s,-1);r=0===i,i>0&&a.push(n.slice(0,i))}while(!r);const o=Buffer.concat(a);return t.encoding?o.toString(t.encoding):o}async function access(e,t=F_OK){return e=toPathIfFileURL(e),validatePath(e),t|=0,binding.access(pathModule.toNamespacedPath(e),t,kUsePromises)}async function copyFile(e,t,i){return e=toPathIfFileURL(e),t=toPathIfFileURL(t),validatePath(e,"src"),validatePath(t,"dest"),i|=0,binding.copyFile(pathModule.toNamespacedPath(e),pathModule.toNamespacedPath(t),i,kUsePromises)}async function open(e,t,i){return e=toPathIfFileURL(e),validatePath(e),i=validateMode(i,"mode",438),new FileHandle(await binding.openFileHandle(pathModule.toNamespacedPath(e),stringToFlags(t),i,kUsePromises))}async function read(e,t,i,n,a){if(validateFileHandle(e),validateBuffer(t),0===(n|=0))return{bytesRead:n,buffer:t};return validateOffsetLengthRead(i|=0,n,t.length),Number.isSafeInteger(a)||(a=-1),{bytesRead:await binding.read(e.fd,t,i,n,a,kUsePromises)||0,buffer:t}}async function write(e,t,i,n,a){if(validateFileHandle(e),0===t.length)return{bytesWritten:0,buffer:t};if(isUint8Array(t)){return"number"!=typeof i&&(i=0),"number"!=typeof n&&(n=t.length-i),"number"!=typeof a&&(a=null),validateOffsetLengthWrite(i,n,t.byteLength),{bytesWritten:await binding.writeBuffer(e.fd,t,i,n,a,kUsePromises)||0,buffer:t}}return"string"!=typeof t&&(t+=""),{bytesWritten:await binding.writeString(e.fd,t,i,n,kUsePromises)||0,buffer:t}}async function rename(e,t){return e=toPathIfFileURL(e),t=toPathIfFileURL(t),validatePath(e,"oldPath"),validatePath(t,"newPath"),binding.rename(pathModule.toNamespacedPath(e),pathModule.toNamespacedPath(t),kUsePromises)}async function truncate(e,t=0){return ftruncate(await open(e,"r+"),t)}async function ftruncate(e,t=0){return validateFileHandle(e),validateInteger(t,"len"),t=Math.max(0,t),binding.ftruncate(e.fd,t,kUsePromises)}async function rmdir(e){return e=toPathIfFileURL(e),validatePath(e),binding.rmdir(pathModule.toNamespacedPath(e),kUsePromises)}async function fdatasync(e){return validateFileHandle(e),binding.fdatasync(e.fd,kUsePromises)}async function fsync(e){return validateFileHandle(e),binding.fsync(e.fd,kUsePromises)}async function mkdir(e,t){"number"!=typeof t&&"string"!=typeof t||(t={mode:t});const{recursive:i=!1,mode:n=511}=t||{};if(e=toPathIfFileURL(e),validatePath(e),"boolean"!=typeof i)throw new ERR_INVALID_ARG_TYPE("recursive","boolean",i);return binding.mkdir(pathModule.toNamespacedPath(e),validateMode(n,"mode",511),i,kUsePromises)}async function readdir(e,t){t=getOptions(t,{}),e=toPathIfFileURL(e),validatePath(e);const i=await binding.readdir(pathModule.toNamespacedPath(e),t.encoding,!!t.withFileTypes,kUsePromises);return t.withFileTypes?getDirectoryEntriesPromise(e,i):i}async function readlink(e,t){return t=getOptions(t,{}),e=toPathIfFileURL(e),validatePath(e,"oldPath"),binding.readlink(pathModule.toNamespacedPath(e),t.encoding,kUsePromises)}async function symlink(e,t,i){const n="string"==typeof i?i:null;return e=toPathIfFileURL(e),t=toPathIfFileURL(t),validatePath(e,"target"),validatePath(t),binding.symlink(preprocessSymlinkDestination(e,n,t),pathModule.toNamespacedPath(t),stringToSymlinkType(n),kUsePromises)}async function fstat(e,t={bigint:!1}){validateFileHandle(e);const i=await binding.fstat(e.fd,t.bigint,kUsePromises);return getStatsFromBinding(i)}async function lstat(e,t={bigint:!1}){e=toPathIfFileURL(e),validatePath(e);const i=await binding.lstat(pathModule.toNamespacedPath(e),t.bigint,kUsePromises);return getStatsFromBinding(i)}async function stat(e,t={bigint:!1}){e=toPathIfFileURL(e),validatePath(e);const i=await binding.stat(pathModule.toNamespacedPath(e),t.bigint,kUsePromises);return getStatsFromBinding(i)}async function link(e,t){return e=toPathIfFileURL(e),t=toPathIfFileURL(t),validatePath(e,"existingPath"),validatePath(t,"newPath"),binding.link(pathModule.toNamespacedPath(e),pathModule.toNamespacedPath(t),kUsePromises)}async function unlink(e){return e=toPathIfFileURL(e),validatePath(e),binding.unlink(pathModule.toNamespacedPath(e),kUsePromises)}async function fchmod(e,t){return validateFileHandle(e),t=validateMode(t,"mode"),binding.fchmod(e.fd,t,kUsePromises)}async function chmod(e,t){return e=toPathIfFileURL(e),validatePath(e),t=validateMode(t,"mode"),binding.chmod(pathModule.toNamespacedPath(e),t,kUsePromises)}async function lchmod(e,t){if(void 0===O_SYMLINK)throw new ERR_METHOD_NOT_IMPLEMENTED("lchmod()");const i=await open(e,O_WRONLY|O_SYMLINK);return fchmod(i,t).finally(i.close.bind(i))}async function lchown(e,t,i){return e=toPathIfFileURL(e),validatePath(e),validateUint32(t,"uid"),validateUint32(i,"gid"),binding.lchown(pathModule.toNamespacedPath(e),t,i,kUsePromises)}async function fchown(e,t,i){return validateFileHandle(e),validateUint32(t,"uid"),validateUint32(i,"gid"),binding.fchown(e.fd,t,i,kUsePromises)}async function chown(e,t,i){return e=toPathIfFileURL(e),validatePath(e),validateUint32(t,"uid"),validateUint32(i,"gid"),binding.chown(pathModule.toNamespacedPath(e),t,i,kUsePromises)}async function utimes(e,t,i){return e=toPathIfFileURL(e),validatePath(e),binding.utimes(pathModule.toNamespacedPath(e),toUnixTimestamp(t),toUnixTimestamp(i),kUsePromises)}async function futimes(e,t,i){return validateFileHandle(e),t=toUnixTimestamp(t,"atime"),i=toUnixTimestamp(i,"mtime"),binding.futimes(e.fd,t,i,kUsePromises)}async function realpath(e,t){return t=getOptions(t,{}),e=toPathIfFileURL(e),validatePath(e),binding.realpath(e,t.encoding,kUsePromises)}async function mkdtemp(e,t){if(t=getOptions(t,{}),!e||"string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("prefix","string",e);return nullCheck(e),binding.mkdtemp(`${e}XXXXXX`,t.encoding,kUsePromises)}async function writeFile(e,t,i){const n=(i=getOptions(i,{encoding:"utf8",mode:438,flag:"w"})).flag||"w";if(e instanceof FileHandle)return writeFileHandle(e,t,i);const a=await open(e,n,i.mode);return writeFileHandle(a,t,i).finally(a.close.bind(a))}async function appendFile(e,t,i){return i=getOptions(i,{encoding:"utf8",mode:438,flag:"a"}),(i=copyObject(i)).flag=i.flag||"a",writeFile(e,t,i)}async function readFile(e,t){const i=(t=getOptions(t,{flag:"r"})).flag||"r";if(e instanceof FileHandle)return readFileHandle(e,t);const n=await open(e,i,438);return readFileHandle(n,t).finally(n.close.bind(n))}module.exports={access,copyFile,open,rename,truncate,rmdir,mkdir,readdir,readlink,symlink,lstat,stat,link,unlink,chmod,lchmod,lchown,chown,utimes,realpath,mkdtemp,writeFile,appendFile,readFile};"use strict";const{Buffer}=require("buffer"),{FSReqWrap,close,read}=process.binding("fs"),kReadFileBufferLength=8192;function readFileAfterRead(e,s){const t=this.context;return e?t.close(e):0===s?t.close():(t.pos+=s,void(0!==t.size?t.pos===t.size?t.close():t.read():(t.buffers.push(t.buffer.slice(0,s)),t.read())))}function readFileAfterClose(e){const s=this.context,t=s.callback;let i=null;if(s.err||e)return t(s.err||e);try{i=0===s.size?Buffer.concat(s.buffers,s.pos):s.pos<s.size?s.buffer.slice(0,s.pos):s.buffer,s.encoding&&(i=i.toString(s.encoding))}catch(e){return t(e)}t(null,i)}class ReadFileContext{constructor(e,s){this.fd=void 0,this.isUserFd=void 0,this.size=void 0,this.callback=e,this.buffers=null,this.buffer=null,this.pos=0,this.encoding=s,this.err=null}read(){let e,s,t;0===this.size?(e=this.buffer=Buffer.allocUnsafeSlow(kReadFileBufferLength),s=0,t=kReadFileBufferLength):(e=this.buffer,s=this.pos,t=Math.min(kReadFileBufferLength,this.size-this.pos));const i=new FSReqWrap;i.oncomplete=readFileAfterRead,i.context=this,read(this.fd,e,s,t,-1,i)}close(e){const s=new FSReqWrap;s.oncomplete=readFileAfterClose,s.context=this,this.err=e,this.isUserFd?process.nextTick(function(){s.oncomplete(null)}):close(this.fd,s)}}module.exports=ReadFileContext;"use strict";const{FSReqWrap,writeBuffers}=process.binding("fs"),{ERR_INVALID_ARG_TYPE,ERR_OUT_OF_RANGE}=require("internal/errors").codes,{Buffer}=require("buffer"),{copyObject,getOptions}=require("internal/fs/utils"),{Readable,Writable}=require("stream"),{toPathIfFileURL}=require("internal/url"),util=require("util");let fs;function lazyFs(){return void 0===fs&&(fs=require("fs")),fs}const kMinPoolSpace=128;let pool;const poolFragments=[];function allocNewPool(t){(pool=poolFragments.length>0?poolFragments.pop():Buffer.allocUnsafe(t)).used=0}function ReadStream(t,e){if(!(this instanceof ReadStream))return new ReadStream(t,e);if(void 0===(e=copyObject(getOptions(e,{}))).highWaterMark&&(e.highWaterMark=65536),e.emitClose=!1,Readable.call(this,e),this.path=toPathIfFileURL(t),this.fd=void 0===e.fd?null:e.fd,this.flags=void 0===e.flags?"r":e.flags,this.mode=void 0===e.mode?438:e.mode,this.start=e.start,this.end=e.end,this.autoClose=void 0===e.autoClose||e.autoClose,this.pos=void 0,this.bytesRead=0,this.closed=!1,void 0!==this.start){if("number"!=typeof this.start||Number.isNaN(this.start))throw new ERR_INVALID_ARG_TYPE("start","number",this.start);if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end||Number.isNaN(this.end))throw new ERR_INVALID_ARG_TYPE("end","number",this.end);if(this.start>this.end){const t=`{start: ${this.start}, end: ${this.end}}`;throw new ERR_OUT_OF_RANGE("start",'<= "end"',t)}this.pos=this.start}if("number"!=typeof this.end)this.end=1/0;else if(Number.isNaN(this.end))throw new ERR_INVALID_ARG_TYPE("end","number",this.end);"number"!=typeof this.fd&&this.open(),this.on("end",function(){this.autoClose&&this.destroy()})}function closeFsStream(t,e,s){lazyFs().close(t.fd,i=>{e(i=i||s),t.closed=!0,i||t.emit("close")})}function WriteStream(t,e){if(!(this instanceof WriteStream))return new WriteStream(t,e);if((e=copyObject(getOptions(e,{}))).emitClose=!1,Writable.call(this,e),this.path=toPathIfFileURL(t),this.fd=void 0===e.fd?null:e.fd,this.flags=void 0===e.flags?"w":e.flags,this.mode=void 0===e.mode?438:e.mode,this.start=e.start,this.autoClose=void 0===e.autoClose||!!e.autoClose,this.pos=void 0,this.bytesWritten=0,this.closed=!1,void 0!==this.start){if("number"!=typeof this.start)throw new ERR_INVALID_ARG_TYPE("start","number",this.start);if(this.start<0){const t=`{start: ${this.start}}`;throw new ERR_OUT_OF_RANGE("start",">= 0",t)}this.pos=this.start}e.encoding&&this.setDefaultEncoding(e.encoding),"number"!=typeof this.fd&&this.open()}function writev(t,e,s,i){const o=new FSReqWrap;o.oncomplete=function(t,s){i(t,s||0,e)},writeBuffers(t,e,s,o)}util.inherits(ReadStream,Readable),ReadStream.prototype.open=function(){lazyFs().open(this.path,this.flags,this.mode,(t,e)=>{if(t)return this.autoClose&&this.destroy(),void this.emit("error",t);this.fd=e,this.emit("open",e),this.emit("ready"),this.read()})},ReadStream.prototype._read=function(t){if("number"!=typeof this.fd)return this.once("open",function(){this._read(t)});if(this.destroyed)return;(!pool||pool.length-pool.used<128)&&allocNewPool(this.readableHighWaterMark);const e=pool;let s=Math.min(pool.length-pool.used,t);const i=pool.used;if((s=void 0!==this.pos?Math.min(this.end-this.pos+1,s):Math.min(this.end-this.bytesRead+1,s))<=0)return this.push(null);lazyFs().read(this.fd,pool,pool.used,s,this.pos,(t,o)=>{if(t)this.autoClose&&this.destroy(),this.emit("error",t);else{let t=null;i+s===e.used&&e===pool?e.used+=o-s:s-o>128&&poolFragments.push(e.slice(i+o,i+s)),o>0&&(this.bytesRead+=o,t=e.slice(i,i+o)),this.push(t)}}),void 0!==this.pos&&(this.pos+=s),pool.used+=s},ReadStream.prototype._destroy=function(t,e){"number"!=typeof this.fd?this.once("open",closeFsStream.bind(null,this,e,t)):(closeFsStream(this,e,t),this.fd=null)},ReadStream.prototype.close=function(t){this.destroy(null,t)},util.inherits(WriteStream,Writable),WriteStream.prototype._final=function(t){this.autoClose&&this.destroy(),t()},WriteStream.prototype.open=function(){lazyFs().open(this.path,this.flags,this.mode,(t,e)=>{if(t)return this.autoClose&&this.destroy(),void this.emit("error",t);this.fd=e,this.emit("open",e),this.emit("ready")})},WriteStream.prototype._write=function(t,e,s){if(!(t instanceof Buffer)){const e=new ERR_INVALID_ARG_TYPE("data","Buffer",t);return this.emit("error",e)}if("number"!=typeof this.fd)return this.once("open",function(){this._write(t,e,s)});lazyFs().write(this.fd,t,0,t.length,this.pos,(t,e)=>{if(t)return this.autoClose&&this.destroy(),s(t);this.bytesWritten+=e,s()}),void 0!==this.pos&&(this.pos+=t.length)},WriteStream.prototype._writev=function(t,e){if("number"!=typeof this.fd)return this.once("open",function(){this._writev(t,e)});const s=this,i=t.length,o=new Array(i);let r=0;for(var n=0;n<i;n++){const e=t[n].chunk;o[n]=e,r+=e.length}writev(this.fd,o,this.pos,function(t,i){if(t)return s.destroy(),e(t);s.bytesWritten+=i,e()}),void 0!==this.pos&&(this.pos+=r)},WriteStream.prototype._destroy=ReadStream.prototype._destroy,WriteStream.prototype.close=function(t){if(t){if(this.closed)return void process.nextTick(t);this.on("close",t)}this.autoClose||this.on("finish",this.destroy.bind(this)),this.end()},WriteStream.prototype.destroySoon=WriteStream.prototype.end,module.exports={ReadStream,WriteStream};"use strict";const{Writable}=require("stream"),{inherits}=require("util"),{closeSync,writeSync}=require("fs");function SyncWriteStream(t,e){Writable.call(this),e=e||{},this.fd=t,this.readable=!1,this.autoClose=void 0===e.autoClose||e.autoClose,this.on("end",()=>this._destroy())}inherits(SyncWriteStream,Writable),SyncWriteStream.prototype._write=function(t,e,r){return writeSync(this.fd,t,0,t.length),r(),!0},SyncWriteStream.prototype._destroy=function(){if(null!==this.fd)return this.autoClose&&closeSync(this.fd),this.fd=null,!0},SyncWriteStream.prototype.destroySoon=SyncWriteStream.prototype.destroy=function(){return this._destroy(),this.emit("close"),!0},module.exports=SyncWriteStream;"use strict";const{Buffer,kMaxLength}=require("buffer"),{ERR_FS_INVALID_SYMLINK_TYPE,ERR_INVALID_ARG_TYPE,ERR_INVALID_ARG_VALUE,ERR_INVALID_OPT_VALUE,ERR_INVALID_OPT_VALUE_ENCODING,ERR_OUT_OF_RANGE}=require("internal/errors").codes,{isUint8Array,isArrayBufferView}=require("internal/util/types"),{once}=require("internal/util"),pathModule=require("path"),util=require("util"),kType=Symbol("type"),kStats=Symbol("stats"),{O_APPEND,O_CREAT,O_EXCL,O_RDONLY,O_RDWR,O_SYNC,O_TRUNC,O_WRONLY,S_IFBLK,S_IFCHR,S_IFDIR,S_IFIFO,S_IFLNK,S_IFMT,S_IFREG,S_IFSOCK,UV_FS_SYMLINK_DIR,UV_FS_SYMLINK_JUNCTION,UV_DIRENT_UNKNOWN,UV_DIRENT_FILE,UV_DIRENT_DIR,UV_DIRENT_LINK,UV_DIRENT_FIFO,UV_DIRENT_SOCKET,UV_DIRENT_CHAR,UV_DIRENT_BLOCK}=process.binding("constants").fs,isWindows="win32"===process.platform;let fs;function lazyLoadFs(){return fs||(fs=require("fs")),fs}function assertEncoding(t){if(t&&!Buffer.isEncoding(t))throw new ERR_INVALID_OPT_VALUE_ENCODING(t)}class Dirent{constructor(t,e){this.name=t,this[kType]=e}isDirectory(){return this[kType]===UV_DIRENT_DIR}isFile(){return this[kType]===UV_DIRENT_FILE}isBlockDevice(){return this[kType]===UV_DIRENT_BLOCK}isCharacterDevice(){return this[kType]===UV_DIRENT_CHAR}isSymbolicLink(){return this[kType]===UV_DIRENT_LINK}isFIFO(){return this[kType]===UV_DIRENT_FIFO}isSocket(){return this[kType]===UV_DIRENT_SOCKET}}class DirentFromStats extends Dirent{constructor(t,e){super(t,null),this[kStats]=e}}for(const t of Reflect.ownKeys(Dirent.prototype))"constructor"!==t&&(DirentFromStats.prototype[t]=function(){return this[kStats][t]()});function copyObject(t){const e={};for(const r in t)e[r]=t[r];return e}function getDirents(t,[e,r],i){let n;if("function"!=typeof i){const i=e.length;for(n=0;n<i;n++){if(r[n]===UV_DIRENT_UNKNOWN){const r=e[n],i=lazyLoadFs().lstatSync(pathModule.join(t,r));e[n]=new DirentFromStats(r,i)}else e[n]=new Dirent(e[n],r[n])}return e}{const s=e.length;let _=0;for(i=once(i),n=0;n<s;n++){if(r[n]===UV_DIRENT_UNKNOWN){const r=e[n],s=n;_++,lazyLoadFs().lstat(pathModule.join(t,r),(t,n)=>{t?i(t):(e[s]=new DirentFromStats(r,n),0==--_&&i(null,e))})}else e[n]=new Dirent(e[n],r[n])}0===_&&i(null,e)}}function getOptions(t,e){if(null==t||"function"==typeof t)return e;if("string"==typeof t)(e=util._extend({},e)).encoding=t,t=e;else if("object"!=typeof t)throw new ERR_INVALID_ARG_TYPE("options",["string","Object"],t);return"buffer"!==t.encoding&&assertEncoding(t.encoding),t}function nullCheck(t,e,r=!0){const i="string"==typeof t,n=isUint8Array(t);if(!i&&!n)return;if(i&&-1===t.indexOf("\0"))return;if(n&&-1===t.indexOf(0))return;const s=new ERR_INVALID_ARG_VALUE(e,t,"must be a string or Uint8Array without null bytes");if(r)throw Error.captureStackTrace(s,nullCheck),s;return s}function preprocessSymlinkDestination(t,e,r){return isWindows?"junction"===e?(t=pathModule.resolve(r,"..",t),pathModule.toNamespacedPath(t)):(""+t).replace(/\//g,"\\"):t}function dateFromNumeric(t){return new Date(Number(t)+.5)}function Stats(t,e,r,i,n,s,_,o,a,c,R,u,O,I){this.dev=t,this.mode=e,this.nlink=r,this.uid=i,this.gid=n,this.rdev=s,this.blksize=_,this.ino=o,this.size=a,this.blocks=c,this.atimeMs=R,this.mtimeMs=u,this.ctimeMs=O,this.birthtimeMs=I,this.atime=dateFromNumeric(R),this.mtime=dateFromNumeric(u),this.ctime=dateFromNumeric(O),this.birthtime=dateFromNumeric(I)}function getStatsFromBinding(t,e=0){return new Stats(t[0+e],t[1+e],t[2+e],t[3+e],t[4+e],t[5+e],isWindows?void 0:t[6+e],t[7+e],t[8+e],isWindows?void 0:t[9+e],t[10+e],t[11+e],t[12+e],t[13+e])}function stringToFlags(t){if("number"==typeof t)return t;switch(t){case"r":return O_RDONLY;case"rs":case"sr":return O_RDONLY|O_SYNC;case"r+":return O_RDWR;case"rs+":case"sr+":return O_RDWR|O_SYNC;case"w":return O_TRUNC|O_CREAT|O_WRONLY;case"wx":case"xw":return O_TRUNC|O_CREAT|O_WRONLY|O_EXCL;case"w+":return O_TRUNC|O_CREAT|O_RDWR;case"wx+":case"xw+":return O_TRUNC|O_CREAT|O_RDWR|O_EXCL;case"a":return O_APPEND|O_CREAT|O_WRONLY;case"ax":case"xa":return O_APPEND|O_CREAT|O_WRONLY|O_EXCL;case"as":case"sa":return O_APPEND|O_CREAT|O_WRONLY|O_SYNC;case"a+":return O_APPEND|O_CREAT|O_RDWR;case"ax+":case"xa+":return O_APPEND|O_CREAT|O_RDWR|O_EXCL;case"as+":case"sa+":return O_APPEND|O_CREAT|O_RDWR|O_SYNC}throw new ERR_INVALID_OPT_VALUE("flags",t)}function stringToSymlinkType(t){let e=0;if("string"==typeof t)switch(t){case"dir":e|=UV_FS_SYMLINK_DIR;break;case"junction":e|=UV_FS_SYMLINK_JUNCTION;break;case"file":break;default:const r=new ERR_FS_INVALID_SYMLINK_TYPE(t);throw Error.captureStackTrace(r,stringToSymlinkType),r}return e}function toUnixTimestamp(t,e="time"){if("string"==typeof t&&+t==t)return+t;if(Number.isFinite(t))return t<0?Date.now()/1e3:t;if(util.isDate(t))return t.getTime()/1e3;throw new ERR_INVALID_ARG_TYPE(e,["Date","Time in seconds"],t)}function validateBuffer(t){if(!isArrayBufferView(t)){const e=new ERR_INVALID_ARG_TYPE("buffer",["Buffer","TypedArray","DataView"],t);throw Error.captureStackTrace(e,validateBuffer),e}}function validateOffsetLengthRead(t,e,r){let i;if(t<0||t>=r?i=new ERR_OUT_OF_RANGE("offset",`>= 0 && <= ${r}`,t):(e<0||t+e>r)&&(i=new ERR_OUT_OF_RANGE("length",`>= 0 && <= ${r-t}`,e)),void 0!==i)throw Error.captureStackTrace(i,validateOffsetLengthRead),i}function validateOffsetLengthWrite(t,e,r){let i;if(t>r)i=new ERR_OUT_OF_RANGE("offset",`<= ${r}`,t);else{const n=r>kMaxLength?kMaxLength:r;e>n-t&&(i=new ERR_OUT_OF_RANGE("length",`<= ${n-t}`,e))}if(void 0!==i)throw Error.captureStackTrace(i,validateOffsetLengthWrite),i}function validatePath(t,e="path"){let r;if(void 0!==(r="string"==typeof t||isUint8Array(t)?nullCheck(t,e,!1):new ERR_INVALID_ARG_TYPE(e,["string","Buffer","URL"],t)))throw Error.captureStackTrace(r,validatePath),r}Stats.prototype._checkModeProperty=function(t){return(!isWindows||t!==S_IFIFO&&t!==S_IFBLK&&t!==S_IFSOCK)&&("bigint"==typeof this.mode?(this.mode&BigInt(S_IFMT))===BigInt(t):(this.mode&S_IFMT)===t)},Stats.prototype.isDirectory=function(){return this._checkModeProperty(S_IFDIR)},Stats.prototype.isFile=function(){return this._checkModeProperty(S_IFREG)},Stats.prototype.isBlockDevice=function(){return this._checkModeProperty(S_IFBLK)},Stats.prototype.isCharacterDevice=function(){return this._checkModeProperty(S_IFCHR)},Stats.prototype.isSymbolicLink=function(){return this._checkModeProperty(S_IFLNK)},Stats.prototype.isFIFO=function(){return this._checkModeProperty(S_IFIFO)},Stats.prototype.isSocket=function(){return this._checkModeProperty(S_IFSOCK)},module.exports={assertEncoding,copyObject,Dirent,getDirents,getOptions,nullCheck,preprocessSymlinkDestination,realpathCacheKey:Symbol("realpathCacheKey"),getStatsFromBinding,stringToFlags,stringToSymlinkType,Stats,toUnixTimestamp,validateBuffer,validateOffsetLengthRead,validateOffsetLengthWrite,validatePath};"use strict";const errors=require("internal/errors"),{kFsStatsFieldsLength,StatWatcher:_StatWatcher}=process.binding("fs"),{FSEvent}=process.binding("fs_event_wrap"),{UV_ENOSPC}=process.binding("uv"),{EventEmitter}=require("events"),{getStatsFromBinding,validatePath}=require("internal/fs/utils"),{defaultTriggerAsyncIdScope,symbols:{owner_symbol}}=require("internal/async_hooks"),{toNamespacedPath}=require("path"),{validateUint32}=require("internal/validators"),{toPathIfFileURL}=require("internal/url"),util=require("util"),assert=require("assert"),kOldStatus=Symbol("kOldStatus"),kUseBigint=Symbol("kUseBigint");function emitStop(t){t.emit("stop")}function StatWatcher(t){EventEmitter.call(this),this._handle=null,this[kOldStatus]=-1,this[kUseBigint]=t}function onchange(t,e){const n=this[owner_symbol];-1===n[kOldStatus]&&-1===t&&e[2]===e[16]||(n[kOldStatus]=t,n.emit("change",getStatsFromBinding(e),getStatsFromBinding(e,kFsStatsFieldsLength)))}function FSWatcher(){EventEmitter.call(this),this._handle=new FSEvent,this._handle[owner_symbol]=this,this._handle.onchange=((t,e,n)=>{if(t<0){null!==this._handle&&(this._handle.close(),this._handle=null);const e=errors.uvException({errno:t,syscall:"watch",path:n});e.filename=n,this.emit("error",e)}else this.emit("change",e,n)})}function emitCloseNT(t){t.emit("close")}util.inherits(StatWatcher,EventEmitter),StatWatcher.prototype.start=function(t,e,n){if(null!==this._handle)return;this._handle=new _StatWatcher(this[kUseBigint]),this._handle[owner_symbol]=this,this._handle.onchange=onchange,e||this._handle.unref(),this[kOldStatus]=-1,t=toPathIfFileURL(t),validatePath(t,"filename"),validateUint32(n,"interval");const i=this._handle.start(toNamespacedPath(t),n);if(i){const e=errors.uvException({errno:i,syscall:"watch",path:t});throw e.filename=t,e}},StatWatcher.prototype.stop=function(){null!==this._handle&&(defaultTriggerAsyncIdScope(this._handle.getAsyncId(),process.nextTick,emitStop,this),this._handle.close(),this._handle=null)},util.inherits(FSWatcher,EventEmitter),FSWatcher.prototype.start=function(t,e,n,i){if(null===this._handle)return;if(assert(this._handle instanceof FSEvent,"handle must be a FSEvent"),this._handle.initialized)return;t=toPathIfFileURL(t),validatePath(t,"filename");const s=this._handle.start(toNamespacedPath(t),e,n,i);if(s){const e=errors.uvException({errno:s,syscall:"watch",path:t,message:s===UV_ENOSPC?"System limit for number of file watchers reached":""});throw e.filename=t,e}},FSWatcher.prototype.close=function(){null!==this._handle&&(assert(this._handle instanceof FSEvent,"handle must be a FSEvent"),this._handle.initialized&&(this._handle.close(),this._handle=null,process.nextTick(emitCloseNT,this)))},Object.defineProperty(FSEvent.prototype,"owner",{get(){return this[owner_symbol]},set(t){return this[owner_symbol]=t}}),module.exports={FSWatcher,StatWatcher};"use strict";const{setUnrefTimeout}=require("internal/timers");var nowCache,utcCache;function nowDate(){return nowCache||cache(),nowCache}function utcDate(){return utcCache||cache(),utcCache}function cache(){const e=new Date;nowCache=e.valueOf(),utcCache=e.toUTCString(),setUnrefTimeout(resetCache,1e3-e.getMilliseconds())}function resetCache(){nowCache=void 0,utcCache=void 0}function ondrain(){this._httpMessage&&this._httpMessage.emit("drain")}module.exports={outHeadersKey:Symbol("outHeadersKey"),ondrain,nowDate,utcDate};"use strict";const Stream=require("stream"),Readable=Stream.Readable,binding=process.binding("http2"),constants=binding.constants,{ERR_HTTP2_HEADERS_SENT,ERR_HTTP2_INFO_STATUS_NOT_ALLOWED,ERR_HTTP2_INVALID_HEADER_VALUE,ERR_HTTP2_INVALID_STREAM,ERR_HTTP2_NO_SOCKET_MANIPULATION,ERR_HTTP2_PSEUDOHEADER_NOT_ALLOWED,ERR_HTTP2_STATUS_INVALID,ERR_INVALID_ARG_VALUE,ERR_INVALID_CALLBACK,ERR_INVALID_HTTP_TOKEN}=require("internal/errors").codes,{validateString}=require("internal/validators"),{kSocket}=require("internal/http2/util"),kBeginSend=Symbol("begin-send"),kState=Symbol("state"),kStream=Symbol("stream"),kRequest=Symbol("request"),kResponse=Symbol("response"),kHeaders=Symbol("headers"),kRawHeaders=Symbol("rawHeaders"),kTrailers=Symbol("trailers"),kRawTrailers=Symbol("rawTrailers"),kProxySocket=Symbol("proxySocket"),kSetHeader=Symbol("setHeader"),kAborted=Symbol("aborted"),{HTTP2_HEADER_AUTHORITY,HTTP2_HEADER_METHOD,HTTP2_HEADER_PATH,HTTP2_HEADER_SCHEME,HTTP2_HEADER_STATUS,HTTP_STATUS_CONTINUE,HTTP_STATUS_EXPECTATION_FAILED,HTTP_STATUS_METHOD_NOT_ALLOWED,HTTP_STATUS_OK}=constants;let statusMessageWarned=!1;function assertValidHeader(e,t){let s;if(""===e||"string"!=typeof e?s=new ERR_INVALID_HTTP_TOKEN("Header name",e):isPseudoHeader(e)?s=new ERR_HTTP2_PSEUDOHEADER_NOT_ALLOWED:null==t&&(s=new ERR_HTTP2_INVALID_HEADER_VALUE(t,e)),void 0!==s)throw Error.captureStackTrace(s,assertValidHeader),s}function isPseudoHeader(e){switch(e){case HTTP2_HEADER_STATUS:case HTTP2_HEADER_METHOD:case HTTP2_HEADER_PATH:case HTTP2_HEADER_AUTHORITY:case HTTP2_HEADER_SCHEME:return!0;default:return!1}}function statusMessageWarn(){!1===statusMessageWarned&&(process.emitWarning("Status message is not supported by HTTP/2 (RFC7540 8.1.2.4)","UnsupportedWarning"),statusMessageWarned=!0)}function onStreamData(e){const t=this[kRequest];void 0===t||t.push(e)||this.pause()}function onStreamTrailers(e,t,s){const r=this[kRequest];void 0!==r&&(Object.assign(r[kTrailers],e),r[kRawTrailers].push(...s))}function onStreamEnd(){void 0!==this[kRequest]&&this[kRequest].push(null)}function onStreamError(e){}function onRequestPause(){this[kStream].pause()}function onRequestResume(){this[kStream].resume()}function onStreamDrain(){const e=this[kResponse];void 0!==e&&e.emit("drain")}function onStreamAbortedRequest(){const e=this[kRequest];void 0!==e&&!1===e[kState].closed&&(e[kAborted]=!0,e.emit("aborted"))}function onStreamAbortedResponse(){}function resumeStream(e){e.resume()}const proxySocketHandler={get(e,t){switch(t){case"on":case"once":case"end":case"emit":case"destroy":return e[t].bind(e);case"writable":case"destroyed":return e[t];case"readable":if(e.destroyed)return!1;const s=e[kRequest];return s?s.readable:e.readable;case"setTimeout":const r=e.session;return void 0!==r?r.setTimeout.bind(r):e.setTimeout.bind(e);case"write":case"read":case"pause":case"resume":throw new ERR_HTTP2_NO_SOCKET_MANIPULATION;default:const a=void 0!==e.session?e.session[kSocket]:e,n=a[t];return"function"==typeof n?n.bind(a):n}},getPrototypeOf:e=>void 0!==e.session?Reflect.getPrototypeOf(e.session[kSocket]):Reflect.getPrototypeOf(e),set(e,t,s){switch(t){case"writable":case"readable":case"destroyed":case"on":case"once":case"end":case"emit":case"destroy":return e[t]=s,!0;case"setTimeout":const r=e.session;return void 0!==r?r.setTimeout=s:e.setTimeout=s,!0;case"write":case"read":case"pause":case"resume":throw new ERR_HTTP2_NO_SOCKET_MANIPULATION;default:return(void 0!==e.session?e.session[kSocket]:e)[t]=s,!0}}};function onStreamCloseRequest(){const e=this[kRequest];if(void 0===e)return;const t=e[kState];t.closed=!0,e.push(null),t.didRead||e._readableState.resumeScheduled||e.resume(),this[kProxySocket]=null,this[kRequest]=void 0,e.emit("close")}function onStreamTimeout(e){return function(){this[e].emit("timeout")}}class Http2ServerRequest extends Readable{constructor(e,t,s,r){super(s),this[kState]={closed:!1,didRead:!1},this[kHeaders]=t,this[kRawHeaders]=r,this[kTrailers]={},this[kRawTrailers]=[],this[kStream]=e,this[kAborted]=!1,e[kProxySocket]=null,e[kRequest]=this,e.on("trailers",onStreamTrailers),e.on("end",onStreamEnd),e.on("error",onStreamError),e.on("aborted",onStreamAbortedRequest),e.on("close",onStreamCloseRequest),e.on("timeout",onStreamTimeout(kRequest)),this.on("pause",onRequestPause),this.on("resume",onRequestResume)}get aborted(){return this[kAborted]}get complete(){return this._readableState.ended||this[kState].closed||this[kStream].destroyed}get stream(){return this[kStream]}get headers(){return this[kHeaders]}get rawHeaders(){return this[kRawHeaders]}get trailers(){return this[kTrailers]}get rawTrailers(){return this[kRawTrailers]}get httpVersionMajor(){return 2}get httpVersionMinor(){return 0}get httpVersion(){return"2.0"}get socket(){const e=this[kStream],t=e[kProxySocket];return null===t?e[kProxySocket]=new Proxy(e,proxySocketHandler):t}get connection(){return this.socket}_read(e){const t=this[kState];t.closed?this.emit("error",new ERR_HTTP2_INVALID_STREAM):t.didRead?process.nextTick(resumeStream,this[kStream]):(t.didRead=!0,this[kStream].on("data",onStreamData))}get method(){return this[kHeaders][HTTP2_HEADER_METHOD]}set method(e){if(validateString(e,"method"),""===e.trim())throw new ERR_INVALID_ARG_VALUE("method",e);this[kHeaders][HTTP2_HEADER_METHOD]=e}get authority(){return this[kHeaders][HTTP2_HEADER_AUTHORITY]}get scheme(){return this[kHeaders][HTTP2_HEADER_SCHEME]}get url(){return this[kHeaders][HTTP2_HEADER_PATH]}set url(e){this[kHeaders][HTTP2_HEADER_PATH]=e}setTimeout(e,t){this[kState].closed||this[kStream].setTimeout(e,t)}}function onStreamTrailersReady(){this.sendTrailers(this[kResponse][kTrailers])}function onStreamCloseResponse(){const e=this[kResponse];if(void 0===e)return;const t=e[kState];this.headRequest===t.headRequest&&(t.closed=!0,this[kProxySocket]=null,this.removeListener("wantTrailers",onStreamTrailersReady),this[kResponse]=void 0,e.emit("finish"),e.emit("close"))}class Http2ServerResponse extends Stream{constructor(e,t){super(t),this[kState]={closed:!1,ending:!1,headRequest:!1,sendDate:!0,statusCode:HTTP_STATUS_OK},this[kHeaders]=Object.create(null),this[kTrailers]=Object.create(null),this[kStream]=e,e[kProxySocket]=null,e[kResponse]=this,this.writable=!0,e.on("drain",onStreamDrain),e.on("aborted",onStreamAbortedResponse),e.on("close",onStreamCloseResponse),e.on("wantTrailers",onStreamTrailersReady),e.on("timeout",onStreamTimeout(kResponse))}get _header(){return this.headersSent}get finished(){const e=this[kStream];return e.destroyed||e._writableState.ended||this[kState].closed}get socket(){if(this[kState].closed)return;const e=this[kStream],t=e[kProxySocket];return null===t?e[kProxySocket]=new Proxy(e,proxySocketHandler):t}get connection(){return this.socket}get stream(){return this[kStream]}get headersSent(){return this[kStream].headersSent}get sendDate(){return this[kState].sendDate}set sendDate(e){this[kState].sendDate=Boolean(e)}get statusCode(){return this[kState].statusCode}set statusCode(e){if((e|=0)>=100&&e<200)throw new ERR_HTTP2_INFO_STATUS_NOT_ALLOWED;if(e<100||e>599)throw new ERR_HTTP2_STATUS_INVALID(e);this[kState].statusCode=e}setTrailer(e,t){validateString(e,"name"),assertValidHeader(e=e.trim().toLowerCase(),t),this[kTrailers][e]=t}addTrailers(e){const t=Object.keys(e);let s="";for(var r=0;r<t.length;r++)s=t[r],this.setTrailer(s,e[s])}getHeader(e){return validateString(e,"name"),e=e.trim().toLowerCase(),this[kHeaders][e]}getHeaderNames(){return Object.keys(this[kHeaders])}getHeaders(){return Object.assign({},this[kHeaders])}hasHeader(e){return validateString(e,"name"),e=e.trim().toLowerCase(),Object.prototype.hasOwnProperty.call(this[kHeaders],e)}removeHeader(e){if(validateString(e,"name"),this[kStream].headersSent)throw new ERR_HTTP2_HEADERS_SENT;e=e.trim().toLowerCase(),delete this[kHeaders][e]}setHeader(e,t){if(validateString(e,"name"),this[kStream].headersSent)throw new ERR_HTTP2_HEADERS_SENT;this[kSetHeader](e,t)}[kSetHeader](e,t){assertValidHeader(e=e.trim().toLowerCase(),t),this[kHeaders][e]=t}get statusMessage(){return statusMessageWarn(),""}set statusMessage(e){statusMessageWarn()}flushHeaders(){const e=this[kState];e.closed||this[kStream].headersSent||this.writeHead(e.statusCode)}writeHead(e,t,s){const r=this[kState];if(r.closed)throw new ERR_HTTP2_INVALID_STREAM;if(this[kStream].headersSent)throw new ERR_HTTP2_HEADERS_SENT;if("string"==typeof t&&statusMessageWarn(),void 0===s&&"object"==typeof t&&(s=t),"object"==typeof s){const e=Object.keys(s);let t="";for(var a=0;a<e.length;a++)t=e[a],this[kSetHeader](t,s[t])}r.statusCode=e,this[kBeginSend]()}write(e,t,s){if("function"==typeof t&&(s=t,t="utf8"),this[kState].closed){const e=new ERR_HTTP2_INVALID_STREAM;if("function"!=typeof s)throw e;return void process.nextTick(s,e)}const r=this[kStream];return r.headersSent||this.writeHead(this[kState].statusCode),r.write(e,t,s)}end(e,t,s){const r=this[kStream],a=this[kState];if((a.closed||a.ending)&&a.headRequest===r.headRequest)return!1;"function"==typeof e?(s=e,e=null):"function"==typeof t&&(s=t,t="utf8"),null!=e&&this.write(e,t);const n=this.finished;return a.headRequest=r.headRequest,a.ending=!0,"function"==typeof s&&(n?this.once("finish",s):r.once("finish",s)),r.headersSent||this.writeHead(this[kState].statusCode),n?onStreamCloseResponse.call(r):r.end(),this}destroy(e){this[kState].closed||this[kStream].destroy(e)}setTimeout(e,t){this[kState].closed||this[kStream].setTimeout(e,t)}createPushResponse(e,t){if("function"!=typeof t)throw new ERR_INVALID_CALLBACK;this[kState].closed?process.nextTick(t,new ERR_HTTP2_INVALID_STREAM):this[kStream].pushStream(e,{},(e,s,r,a)=>{e?t(e):t(null,new Http2ServerResponse(s))})}[kBeginSend](){const e=this[kState],t=this[kHeaders];t[HTTP2_HEADER_STATUS]=e.statusCode;const s={endStream:e.ending,waitForTrailers:!0};this[kStream].respond(t,s)}writeContinue(){const e=this[kStream];return!e.headersSent&&!this[kState].closed&&(e.additionalHeaders({[HTTP2_HEADER_STATUS]:HTTP_STATUS_CONTINUE}),!0)}}function onServerStream(e,t,s,r,a,n){const o=this,i=new e(s,r,void 0,n),T=new t(s);"CONNECT"!==r[HTTP2_HEADER_METHOD]?void 0===r.expect?o.emit("request",i,T):"100-continue"===r.expect?o.listenerCount("checkContinue")?o.emit("checkContinue",i,T):(T.writeContinue(),o.emit("request",i,T)):o.listenerCount("checkExpectation")?o.emit("checkExpectation",i,T):(T.statusCode=HTTP_STATUS_EXPECTATION_FAILED,T.end()):o.emit("connect",i,T)||(T.statusCode=HTTP_STATUS_METHOD_NOT_ALLOWED,T.end())}module.exports={onServerStream,Http2ServerRequest,Http2ServerResponse};"use strict";const{assertCrypto,customInspectSymbol:kInspect,promisify}=require("internal/util");assertCrypto();const assert=require("assert"),EventEmitter=require("events"),fs=require("fs"),http=require("http"),net=require("net"),{Duplex}=require("stream"),tls=require("tls"),{URL}=require("url"),util=require("util"),{kIncomingMessage}=require("_http_common"),{kServerResponse}=require("_http_server"),{StreamWrap}=require("_stream_wrap"),{defaultTriggerAsyncIdScope,symbols:{async_id_symbol,owner_symbol}}=require("internal/async_hooks"),{codes:{ERR_HTTP2_ALTSVC_INVALID_ORIGIN,ERR_HTTP2_ALTSVC_LENGTH,ERR_HTTP2_CONNECT_AUTHORITY,ERR_HTTP2_CONNECT_PATH,ERR_HTTP2_CONNECT_SCHEME,ERR_HTTP2_GOAWAY_SESSION,ERR_HTTP2_HEADERS_AFTER_RESPOND,ERR_HTTP2_HEADERS_SENT,ERR_HTTP2_INVALID_INFO_STATUS,ERR_HTTP2_INVALID_ORIGIN,ERR_HTTP2_INVALID_PACKED_SETTINGS_LENGTH,ERR_HTTP2_INVALID_SESSION,ERR_HTTP2_INVALID_SETTING_VALUE,ERR_HTTP2_INVALID_STREAM,ERR_HTTP2_MAX_PENDING_SETTINGS_ACK,ERR_HTTP2_NESTED_PUSH,ERR_HTTP2_NO_SOCKET_MANIPULATION,ERR_HTTP2_ORIGIN_LENGTH,ERR_HTTP2_OUT_OF_STREAMS,ERR_HTTP2_PAYLOAD_FORBIDDEN,ERR_HTTP2_PING_CANCEL,ERR_HTTP2_PING_LENGTH,ERR_HTTP2_PUSH_DISABLED,ERR_HTTP2_SEND_FILE,ERR_HTTP2_SEND_FILE_NOSEEK,ERR_HTTP2_SESSION_ERROR,ERR_HTTP2_SETTINGS_CANCEL,ERR_HTTP2_SOCKET_BOUND,ERR_HTTP2_SOCKET_UNBOUND,ERR_HTTP2_STATUS_101,ERR_HTTP2_STATUS_INVALID,ERR_HTTP2_STREAM_CANCEL,ERR_HTTP2_STREAM_ERROR,ERR_HTTP2_STREAM_SELF_DEPENDENCY,ERR_HTTP2_TRAILERS_ALREADY_SENT,ERR_HTTP2_TRAILERS_NOT_READY,ERR_HTTP2_UNSUPPORTED_PROTOCOL,ERR_INVALID_ARG_TYPE,ERR_INVALID_CALLBACK,ERR_INVALID_CHAR,ERR_INVALID_OPT_VALUE,ERR_OUT_OF_RANGE,ERR_SOCKET_CLOSED}}=require("internal/errors"),{validateNumber}=require("internal/validators"),{utcDate}=require("internal/http"),{onServerStream,Http2ServerRequest,Http2ServerResponse}=require("internal/http2/compat"),{assertIsObject,assertValidPseudoHeaderResponse,assertValidPseudoHeaderTrailer,assertWithinRange,getDefaultSettings,getSessionState,getSettings,getStreamState,isPayloadMeaningless,kSocket,mapToHeaders,NghttpError,sessionName,toHeaderObject,updateOptionsBuffer,updateSettingsBuffer}=require("internal/http2/util"),{createWriteWrap,writeGeneric,writevGeneric,onStreamRead,kMaybeDestroy,kUpdateTimer}=require("internal/stream_base_commons"),{kTimeout,setUnrefTimeout,validateTimerDuration}=require("internal/timers"),{isArrayBufferView}=require("internal/util/types"),{FileHandle}=process.binding("fs"),binding=process.binding("http2"),{ShutdownWrap}=process.binding("stream_wrap"),{UV_EOF}=process.binding("uv"),{StreamPipe}=internalBinding("stream_pipe"),{_connectionListener:httpConnectionListener}=http,debug=util.debuglog("http2"),kMaxFrameSize=2**24-1,kMaxInt=2**32-1,kMaxStreams=2**31-1,kQuotedString=/^[\x09\x20-\x5b\x5d-\x7e\x80-\xff]*$/,{constants,nameForErrorCode}=binding,NETServer=net.Server,TLSServer=tls.Server,kAlpnProtocol=Symbol("alpnProtocol"),kAuthority=Symbol("authority"),kEncrypted=Symbol("encrypted"),kHandle=Symbol("handle"),kID=Symbol("id"),kInit=Symbol("init"),kInfoHeaders=Symbol("sent-info-headers"),kLocalSettings=Symbol("local-settings"),kOptions=Symbol("options"),kOwner=owner_symbol,kOrigin=Symbol("origin"),kProceed=Symbol("proceed"),kProtocol=Symbol("protocol"),kProxySocket=Symbol("proxy-socket"),kRemoteSettings=Symbol("remote-settings"),kSentHeaders=Symbol("sent-headers"),kSentTrailers=Symbol("sent-trailers"),kServer=Symbol("server"),kSession=Symbol("session"),kState=Symbol("state"),kType=Symbol("type"),kWriteGeneric=Symbol("write-generic"),kDefaultSocketTimeout=12e4,{paddingBuffer,PADDING_BUF_FRAME_LENGTH,PADDING_BUF_MAX_PAYLOAD_LENGTH,PADDING_BUF_RETURN_VALUE}=binding,{NGHTTP2_CANCEL,NGHTTP2_REFUSED_STREAM,NGHTTP2_DEFAULT_WEIGHT,NGHTTP2_FLAG_END_STREAM,NGHTTP2_HCAT_PUSH_RESPONSE,NGHTTP2_HCAT_RESPONSE,NGHTTP2_INTERNAL_ERROR,NGHTTP2_NO_ERROR,NGHTTP2_SESSION_CLIENT,NGHTTP2_SESSION_SERVER,NGHTTP2_ERR_STREAM_ID_NOT_AVAILABLE,NGHTTP2_ERR_INVALID_ARGUMENT,NGHTTP2_ERR_STREAM_CLOSED,HTTP2_HEADER_AUTHORITY,HTTP2_HEADER_DATE,HTTP2_HEADER_METHOD,HTTP2_HEADER_PATH,HTTP2_HEADER_PROTOCOL,HTTP2_HEADER_SCHEME,HTTP2_HEADER_STATUS,HTTP2_HEADER_CONTENT_LENGTH,NGHTTP2_SETTINGS_HEADER_TABLE_SIZE,NGHTTP2_SETTINGS_ENABLE_PUSH,NGHTTP2_SETTINGS_MAX_CONCURRENT_STREAMS,NGHTTP2_SETTINGS_INITIAL_WINDOW_SIZE,NGHTTP2_SETTINGS_MAX_FRAME_SIZE,NGHTTP2_SETTINGS_MAX_HEADER_LIST_SIZE,HTTP2_METHOD_GET,HTTP2_METHOD_HEAD,HTTP2_METHOD_CONNECT,HTTP_STATUS_CONTINUE,HTTP_STATUS_RESET_CONTENT,HTTP_STATUS_OK,HTTP_STATUS_NO_CONTENT,HTTP_STATUS_NOT_MODIFIED,HTTP_STATUS_SWITCHING_PROTOCOLS,HTTP_STATUS_MISDIRECTED_REQUEST,STREAM_OPTION_EMPTY_PAYLOAD,STREAM_OPTION_GET_TRAILERS}=constants,STREAM_FLAGS_PENDING=0,STREAM_FLAGS_READY=1,STREAM_FLAGS_CLOSED=2,STREAM_FLAGS_HEADERS_SENT=4,STREAM_FLAGS_HEAD_REQUEST=8,STREAM_FLAGS_ABORTED=16,STREAM_FLAGS_HAS_TRAILERS=32,SESSION_FLAGS_PENDING=0,SESSION_FLAGS_READY=1,SESSION_FLAGS_CLOSED=2,SESSION_FLAGS_DESTROYED=4;function emit(e,...t){e.emit(...t)}function onSessionHeaders(e,t,s,i,n){const r=this[kOwner];if(r.destroyed)return;const o=r[kType];r[kUpdateTimer](),debug(`Http2Stream ${t} [Http2Session `+`${sessionName(o)}]: headers received`);const T=r[kState].streams,_=!!(i&NGHTTP2_FLAG_END_STREAM);let a=T.get(t);const S=toHeaderObject(n);if(void 0===a){if(r.closed)return e.rstStream(NGHTTP2_REFUSED_STREAM),void e.destroy();const s={readable:!_};o===NGHTTP2_SESSION_SERVER?(a=new ServerHttp2Stream(r,e,t,s,S),S[HTTP2_HEADER_METHOD]===HTTP2_METHOD_HEAD&&(a.end(),a[kState].flags|=STREAM_FLAGS_HEAD_REQUEST)):(a=new ClientHttp2Stream(r,e,t,s)).end(),_&&(a[kState].endAfterHeaders=!0),process.nextTick(emit,r,"stream",a,S,i,n)}else{let e;const r=S[HTTP2_HEADER_STATUS];e=s===NGHTTP2_HCAT_RESPONSE?!_&&void 0!==r&&r>=100&&r<200?"headers":"response":s===NGHTTP2_HCAT_PUSH_RESPONSE?"push":!_&&void 0!==r&&r>=200?"response":_?"trailers":"headers";const T=a.session;if(r===HTTP_STATUS_MISDIRECTED_REQUEST){(T[kState].originSet=initOriginSet(T)).delete(a[kOrigin])}debug(`Http2Stream ${t} [Http2Session `+`${sessionName(o)}]: emitting stream '${e}' event`),process.nextTick(emit,a,e,S,i,n)}_&&a.push(null)}function tryClose(e){fs.close(e,e=>assert.ifError(e))}function onStreamTrailers(){const e=this[kOwner];e[kState].trailersReady=!0,e.destroyed||e.closed||e.emit("wantTrailers")||e.sendTrailers({})}function submitRstStream(e){void 0!==this[kHandle]&&this[kHandle].rstStream(e)}function onPing(e){const t=this[kOwner];t.destroyed||(t[kUpdateTimer](),debug(`Http2Session ${sessionName(t[kType])}: new ping received`),t.emit("ping",e))}function onStreamClose(e){const t=this[kOwner];t.destroyed||(debug(`Http2Stream ${t[kID]} [Http2Session `+`${sessionName(t[kSession][kType])}]: closed with code ${e}`),t.closed||closeStream(t,e,kNoRstStream),t[kState].fd=-1,t.readable&&e===NGHTTP2_NO_ERROR?(t.on("end",t[kMaybeDestroy]),t.push(null),t[kSession][kType]!==NGHTTP2_SESSION_SERVER||t[kState].didRead||null!==t.readableFlowing?t.read(0):t.resume()):t[kMaybeDestroy](e))}function onSettings(){const e=this[kOwner];e.destroyed||(e[kUpdateTimer](),debug(`Http2Session ${sessionName(e[kType])}: new settings received`),e[kRemoteSettings]=void 0,e.emit("remoteSettings",e.remoteSettings))}function onPriority(e,t,s,i){const n=this[kOwner];if(n.destroyed)return;debug(`Http2Stream ${e} [Http2Session `+`${sessionName(n[kType])}]: priority [parent: ${t}, `+`weight: ${s}, exclusive: ${i}]`);const r=n[kState].streams.get(e)||n;r.destroyed||(r[kUpdateTimer](),r.emit("priority",e,t,s,i))}function onFrameError(e,t,s){const i=this[kOwner];if(i.destroyed)return;debug(`Http2Session ${sessionName(i[kType])}: error sending frame `+`type ${t} on stream ${e}, code: ${s}`);const n=i[kState].streams.get(e)||i;n[kUpdateTimer](),n.emit("frameError",t,s,e)}function onAltSvc(e,t,s){const i=this[kOwner];i.destroyed||(debug(`Http2Session ${sessionName(i[kType])}: altsvc received: `+`stream: ${e}, origin: ${t}, alt: ${s}`),i[kUpdateTimer](),i.emit("altsvc",s,t,e))}function initOriginSet(e){let t=e[kState].originSet;if(void 0===t){const s=e[kSocket];if(e[kState].originSet=t=new Set,null!=s.servername){let e=`https://${s.servername}`;null!=s.remotePort&&(e+=`:${s.remotePort}`),t.add(new URL(e).origin)}}return t}function onOrigin(e){const t=this[kOwner];if(t.destroyed)return;if(debug(`Http2Session ${sessionName(t[kType])}: origin received: `+`${e.join(", ")}`),t[kUpdateTimer](),!t.encrypted||t.destroyed)return;const s=initOriginSet(t);for(var i=0;i<e.length;i++)s.add(e[i]);t.emit("origin",e)}function onGoawayData(e,t,s){const i=this[kOwner];if(i.destroyed)return;debug(`Http2Session ${sessionName(i[kType])}: goaway ${e} `+`received [last stream id: ${t}]`);const n=i[kState];n.goawayCode=e,n.goawayLastStreamID=t,i.emit("goaway",e,t,s),e===NGHTTP2_NO_ERROR?i.close():i.destroy(new ERR_HTTP2_SESSION_ERROR(e),NGHTTP2_NO_ERROR)}function onSelectPadding(e){return function(){const t=paddingBuffer[PADDING_BUF_FRAME_LENGTH],s=paddingBuffer[PADDING_BUF_MAX_PAYLOAD_LENGTH];paddingBuffer[PADDING_BUF_RETURN_VALUE]=e(t,s)}}function requestOnConnect(e,t){const s=this[kSession];if(void 0===s||s.destroyed)return;if(s.closed){const e=new ERR_HTTP2_GOAWAY_SESSION;return void this.destroy(e)}debug(`Http2Session ${sessionName(s[kType])}: connected, `+"initializing request");let i=0;t.endStream&&(i|=STREAM_OPTION_EMPTY_PAYLOAD),t.waitForTrailers&&(i|=STREAM_OPTION_GET_TRAILERS);const n=s[kHandle].request(e,i,0|t.parent,0|t.weight,!!t.exclusive);if("number"!=typeof n)this[kInit](n.id(),n);else{let e;switch(n){case NGHTTP2_ERR_STREAM_ID_NOT_AVAILABLE:e=new ERR_HTTP2_OUT_OF_STREAMS,this.destroy(e);break;case NGHTTP2_ERR_INVALID_ARGUMENT:e=new ERR_HTTP2_STREAM_SELF_DEPENDENCY,this.destroy(e);break;default:s.destroy(new NghttpError(n))}}}function validatePriorityOptions(e){let t;if(void 0===e.weight?e.weight=NGHTTP2_DEFAULT_WEIGHT:"number"!=typeof e.weight&&(t=new ERR_INVALID_OPT_VALUE("weight",e.weight)),void 0===e.parent?e.parent=0:("number"!=typeof e.parent||e.parent<0)&&(t=new ERR_INVALID_OPT_VALUE("parent",e.parent)),void 0===e.exclusive?e.exclusive=!1:"boolean"!=typeof e.exclusive&&(t=new ERR_INVALID_OPT_VALUE("exclusive",e.exclusive)),void 0===e.silent?e.silent=!1:"boolean"!=typeof e.silent&&(t=new ERR_INVALID_OPT_VALUE("silent",e.silent)),t)throw Error.captureStackTrace(t,validatePriorityOptions),t}function onSessionInternalError(e){void 0!==this[kOwner]&&this[kOwner].destroy(new NghttpError(e))}function settingsCallback(e,t,s){if(this[kState].pendingAck--,this[kLocalSettings]=void 0,t){debug(`Http2Session ${sessionName(this[kType])}: settings received`);const t=this.localSettings;"function"==typeof e&&e(null,t,s),this.emit("localSettings",t)}else debug(`Http2Session ${sessionName(this[kType])}: settings canceled`),"function"==typeof e&&e(new ERR_HTTP2_SETTINGS_CANCEL)}function submitSettings(e,t){this.destroyed||(debug(`Http2Session ${sessionName(this[kType])}: submitting settings`),this[kUpdateTimer](),updateSettingsBuffer(e),this[kHandle].settings(settingsCallback.bind(this,t))||this.destroy(new ERR_HTTP2_MAX_PENDING_SETTINGS_ACK))}function submitPriority(e){this.destroyed||(this[kUpdateTimer](),e.parent!==this[kID]&&this[kHandle].priority(0|e.parent,0|e.weight,!!e.exclusive,!!e.silent))}function submitGoaway(e,t,s){this.destroyed||(debug(`Http2Session ${sessionName(this[kType])}: submitting goaway`),this[kUpdateTimer](),this[kHandle].goaway(e,t,s))}const proxySocketHandler={get(e,t){switch(t){case"setTimeout":case"ref":case"unref":return e[t].bind(e);case"destroy":case"emit":case"end":case"pause":case"read":case"resume":case"write":case"setEncoding":case"setKeepAlive":case"setNoDelay":throw new ERR_HTTP2_NO_SOCKET_MANIPULATION;default:const s=e[kSocket];if(void 0===s)throw new ERR_HTTP2_SOCKET_UNBOUND;const i=s[t];return"function"==typeof i?i.bind(s):i}},getPrototypeOf(e){const t=e[kSocket];if(void 0===t)throw new ERR_HTTP2_SOCKET_UNBOUND;return Reflect.getPrototypeOf(t)},set(e,t,s){switch(t){case"setTimeout":case"ref":case"unref":return e[t]=s,!0;case"destroy":case"emit":case"end":case"pause":case"read":case"resume":case"write":case"setEncoding":case"setKeepAlive":case"setNoDelay":throw new ERR_HTTP2_NO_SOCKET_MANIPULATION;default:const i=e[kSocket];if(void 0===i)throw new ERR_HTTP2_SOCKET_UNBOUND;return i[t]=s,!0}}};function pingCallback(e){return function(t,s,i){t?e(null,s,i):e(new ERR_HTTP2_PING_CANCEL)}}function validateSettings(e){if(e=Object.assign({},e),assertWithinRange("headerTableSize",e.headerTableSize,0,kMaxInt),assertWithinRange("initialWindowSize",e.initialWindowSize,0,kMaxInt),assertWithinRange("maxFrameSize",e.maxFrameSize,16384,kMaxFrameSize),assertWithinRange("maxConcurrentStreams",e.maxConcurrentStreams,0,kMaxStreams),assertWithinRange("maxHeaderListSize",e.maxHeaderListSize,0,kMaxInt),void 0!==e.enablePush&&"boolean"!=typeof e.enablePush){const t=new ERR_HTTP2_INVALID_SETTING_VALUE("enablePush",e.enablePush);throw t.actual=e.enablePush,Error.captureStackTrace(t,"validateSettings"),t}return e}function setupHandle(e,t,s){if(this.destroyed)return void process.nextTick(emit,this,"connect",this,e);debug(`Http2Session ${sessionName(t)}: setting up session handle`),this[kState].flags|=SESSION_FLAGS_READY,updateOptionsBuffer(s);const i=new binding.Http2Session(t);i[kOwner]=this,i.error=onSessionInternalError,i.onpriority=onPriority,i.onsettings=onSettings,i.onping=onPing,i.onheaders=onSessionHeaders,i.onframeerror=onFrameError,i.ongoawaydata=onGoawayData,i.onaltsvc=onAltSvc,i.onorigin=onOrigin,"function"==typeof s.selectPadding&&(i.ongetpadding=onSelectPadding(s.selectPadding)),assert(void 0!==e._handle,"Internal HTTP/2 Failure. The socket is not connected. Please report this as a bug in Node.js"),i.consume(e._handle._externalStream),this[kHandle]=i,e.encrypted?(this[kAlpnProtocol]=e.alpnProtocol,this[kEncrypted]=!0):(this[kAlpnProtocol]="h2c",this[kEncrypted]=!1);const n="object"==typeof s.settings?s.settings:{};this.settings(n),t===NGHTTP2_SESSION_SERVER&&Array.isArray(s.origins)&&this.origin(...s.origins),process.nextTick(emit,this,"connect",this,e)}function emitClose(e,t){t&&e.emit("error",t),e.emit("close")}function finishSessionDestroy(e,t){const s=e[kSocket];s.destroyed||s.destroy(t),e[kProxySocket]=void 0,e[kSocket]=void 0,e[kHandle]=void 0,s[kSession]=void 0,s[kServer]=void 0,process.nextTick(emitClose,e,t)}class Http2Session extends EventEmitter{constructor(e,t,s){if(super(),s._handle&&s._handle._externalStream||(s=new StreamWrap(s)),void 0!==s[kSession])throw new ERR_HTTP2_SOCKET_BOUND;s[kSession]=this,this[kState]={flags:SESSION_FLAGS_PENDING,goawayCode:null,goawayLastStreamID:null,streams:new Map,pendingStreams:new Set,pendingAck:0,writeQueueSize:0,originSet:void 0},this[kEncrypted]=void 0,this[kAlpnProtocol]=void 0,this[kType]=e,this[kProxySocket]=null,this[kSocket]=s,this[kTimeout]=null,"function"==typeof s.setNoDelay&&s.setNoDelay(),"function"==typeof s.disableRenegotiation&&s.disableRenegotiation();const i=setupHandle.bind(this,s,e,t);if(s.connecting){const e=s instanceof tls.TLSSocket?"secureConnect":"connect";s.once(e,i)}else i();debug(`Http2Session ${sessionName(e)}: created`)}get encrypted(){return this[kEncrypted]}get alpnProtocol(){return this[kAlpnProtocol]}get originSet(){if(this.encrypted&&!this.destroyed)return Array.from(initOriginSet(this))}get connecting(){return 0==(this[kState].flags&SESSION_FLAGS_READY)}get closed(){return!!(this[kState].flags&SESSION_FLAGS_CLOSED)}get destroyed(){return!!(this[kState].flags&SESSION_FLAGS_DESTROYED)}[kUpdateTimer](){this.destroyed||this[kTimeout]&&this[kTimeout].refresh()}setNextStreamID(e){if(this.destroyed)throw new ERR_HTTP2_INVALID_SESSION;if(validateNumber(e,"id"),e<=0||e>kMaxStreams)throw new ERR_OUT_OF_RANGE("id",`> 0 and <= ${kMaxStreams}`,e);this[kHandle].setNextStreamID(e)}ping(e,t){if(this.destroyed)throw new ERR_HTTP2_INVALID_SESSION;if("function"==typeof e&&(t=e,e=void 0),e&&!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("payload",["Buffer","TypedArray","DataView"],e);if(e&&8!==e.length)throw new ERR_HTTP2_PING_LENGTH;if("function"!=typeof t)throw new ERR_INVALID_CALLBACK;const s=pingCallback(t);if(!this.connecting&&!this.closed)return this[kHandle].ping(e,s);process.nextTick(s,!1,0,e)}[kInspect](e,t){const s={type:this[kType],closed:this.closed,destroyed:this.destroyed,state:this.state,localSettings:this.localSettings,remoteSettings:this.remoteSettings};return`Http2Session ${util.format(s)}`}get socket(){const e=this[kProxySocket];return null===e?this[kProxySocket]=new Proxy(this,proxySocketHandler):e}get type(){return this[kType]}get goawayCode(){return this[kState].goawayCode||NGHTTP2_NO_ERROR}get goawayLastStreamID(){return this[kState].goawayLastStreamID||0}get pendingSettingsAck(){return this[kState].pendingAck>0}get state(){return this.connecting||this.destroyed?{}:getSessionState(this[kHandle])}get localSettings(){const e=this[kLocalSettings];return void 0!==e?e:this.destroyed||this.connecting?{}:this[kLocalSettings]=getSettings(this[kHandle],!1)}get remoteSettings(){const e=this[kRemoteSettings];return void 0!==e?e:this.destroyed||this.connecting?{}:this[kRemoteSettings]=getSettings(this[kHandle],!0)}settings(e,t){if(this.destroyed)throw new ERR_HTTP2_INVALID_SESSION;if(assertIsObject(e,"settings"),e=validateSettings(e),t&&"function"!=typeof t)throw new ERR_INVALID_CALLBACK;debug(`Http2Session ${sessionName(this[kType])}: sending settings`),this[kState].pendingAck++;const s=submitSettings.bind(this,e,t);this.connecting?this.once("connect",s):s()}goaway(e=NGHTTP2_NO_ERROR,t=0,s){if(this.destroyed)throw new ERR_HTTP2_INVALID_SESSION;if(void 0!==s&&!isArrayBufferView(s))throw new ERR_INVALID_ARG_TYPE("opaqueData",["Buffer","TypedArray","DataView"],s);validateNumber(e,"code"),validateNumber(t,"lastStreamID");const i=submitGoaway.bind(this,e,t,s);this.connecting?this.once("connect",i):i()}destroy(e=NGHTTP2_NO_ERROR,t){if(this.destroyed)return;debug(`Http2Session ${sessionName(this[kType])}: destroying`),"number"==typeof e&&(e=(t=e)!==NGHTTP2_NO_ERROR?new ERR_HTTP2_SESSION_ERROR(t):void 0),void 0===t&&null!=e&&(t=NGHTTP2_INTERNAL_ERROR);const s=this[kState];s.flags|=SESSION_FLAGS_DESTROYED,this.setTimeout(0),this.removeAllListeners("timeout");const i=new ERR_HTTP2_STREAM_CANCEL;e&&(i.cause=e,"string"==typeof e.message&&(i.message+=` (caused by: ${e.message})`)),s.pendingStreams.forEach(e=>e.destroy(i)),s.streams.forEach(t=>t.destroy(e));const n=this[kSocket],r=this[kHandle];void 0!==r&&r.destroy(t,n.destroyed),n.destroyed?finishSessionDestroy(this,e):setImmediate(finishSessionDestroy,this,e)}close(e){this.closed||this.destroyed||(debug(`Http2Session ${sessionName(this[kType])}: marking session closed`),this[kState].flags|=SESSION_FLAGS_CLOSED,"function"==typeof e&&this.once("close",e),this.goaway(),this[kMaybeDestroy]())}[kMaybeDestroy](e){if(null==e){const e=this[kState];if(!this.closed||e.streams.size>0||e.pendingStreams.size>0)return}this.destroy(e)}_onTimeout(){if(!this.destroyed){if(this[kState].writeQueueSize>0){const e=this[kHandle],t=void 0!==e?e.chunksSentSinceLastWrite:null;if(null!==t&&t!==e.updateChunksSent())return void this[kUpdateTimer]()}this.emit("timeout")}}ref(){this[kSocket]&&this[kSocket].ref()}unref(){this[kSocket]&&this[kSocket].unref()}}class ServerHttp2Session extends Http2Session{constructor(e,t,s){super(NGHTTP2_SESSION_SERVER,e,t),this[kServer]=s}get server(){return this[kServer]}altsvc(e,t){if(this.destroyed)throw new ERR_HTTP2_INVALID_SESSION;let s,i=0;if("string"==typeof t){if("null"===(s=new URL(t).origin))throw new ERR_HTTP2_ALTSVC_INVALID_ORIGIN}else if("number"==typeof t){if(t>>>0!==t||0===t)throw new ERR_OUT_OF_RANGE("originOrStream",`> 0 && < ${2**32}`,t);i=t}else if(void 0!==t){if(null!==t&&"object"==typeof t&&(s=t.origin),"string"!=typeof s)throw new ERR_INVALID_ARG_TYPE("originOrStream",["string","number","URL","object"],t);if("null"===s||0===s.length)throw new ERR_HTTP2_ALTSVC_INVALID_ORIGIN}if("string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("alt","string",e);if(!kQuotedString.test(e))throw new ERR_INVALID_CHAR("alt");if(e.length+(void 0!==s?s.length:0)>16382)throw new ERR_HTTP2_ALTSVC_LENGTH;this[kHandle].altsvc(i,s||"",e)}origin(...e){if(this.destroyed)throw new ERR_HTTP2_INVALID_SESSION;if(0===e.length)return;let t="",s=0;const i=e.length;for(var n=0;n<i;n++){let i=e[n];if("string"==typeof i?i=new URL(i).origin:null!=i&&"object"==typeof i&&(i=i.origin),"string"!=typeof i)throw new ERR_INVALID_ARG_TYPE("origin","string",i);if("null"===i)throw new ERR_HTTP2_INVALID_ORIGIN;t+=`${i}\0`,s+=i.length}if(s>16382)throw new ERR_HTTP2_ORIGIN_LENGTH;this[kHandle].origin(t,i)}}class ClientHttp2Session extends Http2Session{constructor(e,t){super(NGHTTP2_SESSION_CLIENT,e,t)}request(e,t){if(debug(`Http2Session ${sessionName(this[kType])}: initiating request`),this.destroyed)throw new ERR_HTTP2_INVALID_SESSION;if(this.closed)throw new ERR_HTTP2_GOAWAY_SESSION;if(this[kUpdateTimer](),assertIsObject(e,"headers"),assertIsObject(t,"options"),e=Object.assign(Object.create(null),e),t=Object.assign({},t),void 0===e[HTTP2_HEADER_METHOD]&&(e[HTTP2_HEADER_METHOD]=HTTP2_METHOD_GET),e[HTTP2_HEADER_METHOD]===HTTP2_METHOD_CONNECT&&void 0===e[HTTP2_HEADER_PROTOCOL]){if(void 0===e[HTTP2_HEADER_AUTHORITY])throw new ERR_HTTP2_CONNECT_AUTHORITY;if(void 0!==e[HTTP2_HEADER_SCHEME])throw new ERR_HTTP2_CONNECT_SCHEME;if(void 0!==e[HTTP2_HEADER_PATH])throw new ERR_HTTP2_CONNECT_PATH}else void 0===e[HTTP2_HEADER_AUTHORITY]&&(e[HTTP2_HEADER_AUTHORITY]=this[kAuthority]),void 0===e[HTTP2_HEADER_SCHEME]&&(e[HTTP2_HEADER_SCHEME]=this[kProtocol].slice(0,-1)),void 0===e[HTTP2_HEADER_PATH]&&(e[HTTP2_HEADER_PATH]="/");if(validatePriorityOptions(t),void 0===t.endStream)t.endStream=isPayloadMeaningless(e[HTTP2_HEADER_METHOD]);else if("boolean"!=typeof t.endStream)throw new ERR_INVALID_OPT_VALUE("endStream",t.endStream);const s=mapToHeaders(e);if(!Array.isArray(s))throw s;const i=new ClientHttp2Stream(this,void 0,void 0,{});i[kSentHeaders]=e,i[kOrigin]=`${e[HTTP2_HEADER_SCHEME]}://`+`${e[HTTP2_HEADER_AUTHORITY]}`,t.endStream&&i.end(),t.waitForTrailers&&(i[kState].flags|=STREAM_FLAGS_HAS_TRAILERS);const n=requestOnConnect.bind(i,s,t);return this.connecting?this.once("connect",n):n(),i}}function trackWriteState(e,t){const s=e[kSession];e[kState].writeQueueSize+=t,s[kState].writeQueueSize+=t,s[kHandle].chunksSentSinceLastWrite=0}function afterDoStreamWrite(e,t){const s=t[kOwner],i=s[kSession];s[kUpdateTimer]();const{bytes:n}=this;s[kState].writeQueueSize-=n,void 0!==i&&(i[kState].writeQueueSize-=n),"function"==typeof this.callback&&this.callback(null)}function streamOnResume(){this.destroyed||this[kHandle].readStart()}function streamOnPause(){this.destroyed||this.pending||this[kHandle].readStop()}function afterShutdown(){this.callback();const e=this.handle[kOwner];e&&e[kMaybeDestroy]()}function finishSendTrailers(e,t){if(e.destroyed)return;e[kState].flags&=~STREAM_FLAGS_HAS_TRAILERS;const s=e[kHandle].trailers(t);s<0?e.destroy(new NghttpError(s)):e[kMaybeDestroy]()}const kNoRstStream=0,kSubmitRstStream=1,kForceRstStream=2;function closeStream(e,t,s=kSubmitRstStream){const i=e[kState];i.flags|=STREAM_FLAGS_CLOSED,i.rstCode=t,e.setTimeout(0),e.removeAllListeners("timeout");const{ending:n,finished:r}=e._writableState;if(n||(e.aborted||(i.flags|=STREAM_FLAGS_ABORTED,e.emit("aborted")),e.end()),s!==kNoRstStream){const i=finishCloseStream.bind(e,t);!n||r||t!==NGHTTP2_NO_ERROR||s===kForceRstStream?i():e.once("finish",i)}}function finishCloseStream(e){const t=submitRstStream.bind(this,e);if(this.pending)return this.push(null),void this.once("ready",t);t()}class Http2Stream extends Duplex{constructor(e,t){t.allowHalfOpen=!0,t.decodeStrings=!1,super(t),this[async_id_symbol]=-1,this.cork(),this[kSession]=e,e[kState].pendingStreams.add(this),this._readableState.readingMore=!0,this[kTimeout]=null,this[kState]={didRead:!1,flags:STREAM_FLAGS_PENDING,rstCode:NGHTTP2_NO_ERROR,writeQueueSize:0,trailersReady:!1,endAfterHeaders:!1},this.on("pause",streamOnPause)}[kUpdateTimer](){this.destroyed||(this[kTimeout]&&this[kTimeout].refresh(),this[kSession]&&this[kSession][kUpdateTimer]())}[kInit](e,t){this[kState].flags|=STREAM_FLAGS_READY;const s=this[kSession];s[kState].pendingStreams.delete(this),s[kState].streams.set(e,this),this[kID]=e,this[async_id_symbol]=t.getAsyncId(),t[kOwner]=this,this[kHandle]=t,t.ontrailers=onStreamTrailers,t.onstreamclose=onStreamClose,t.onread=onStreamRead,this.uncork(),this.emit("ready")}[kInspect](e,t){const s={id:this[kID]||"<pending>",closed:this.closed,destroyed:this.destroyed,state:this.state,readableState:this._readableState,writableState:this._writableState};return`Http2Stream ${util.format(s)}`}get endAfterHeaders(){return this[kState].endAfterHeaders}get sentHeaders(){return this[kSentHeaders]}get sentTrailers(){return this[kSentTrailers]}get sentInfoHeaders(){return this[kInfoHeaders]}get pending(){return void 0===this[kID]}get id(){return this[kID]}get session(){return this[kSession]}_onTimeout(){if(!this.destroyed){if(this[kState].writeQueueSize>0){const e=this[kSession][kHandle],t=void 0!==e?e.chunksSentSinceLastWrite:null;if(null!==t&&t!==e.updateChunksSent())return void this[kUpdateTimer]()}this.emit("timeout")}}get headersSent(){return!!(this[kState].flags&STREAM_FLAGS_HEADERS_SENT)}get aborted(){return!!(this[kState].flags&STREAM_FLAGS_ABORTED)}get headRequest(){return!!(this[kState].flags&STREAM_FLAGS_HEAD_REQUEST)}get rstCode(){return this[kState].rstCode}get state(){const e=this[kID];return this.destroyed||void 0===e?{}:getStreamState(this[kHandle],e)}[kProceed](){assert.fail(null,null,"Implementors MUST implement this. Please report this as a bug in Node.js")}[kWriteGeneric](e,t,s,i){if(this.pending)return void this.once("ready",this[kWriteGeneric].bind(this,e,t,s,i));if(this.destroyed)return;this[kUpdateTimer](),this.headersSent||this[kProceed]();const n=createWriteWrap(this[kHandle],afterDoStreamWrite);n.stream=this[kID],e?writevGeneric(this,n,t,i):writeGeneric(this,n,t,s,i),trackWriteState(this,n.bytes)}_write(e,t,s){this[kWriteGeneric](!1,e,t,s)}_writev(e,t){this[kWriteGeneric](!0,e,"",t)}_final(e){const t=this[kHandle];if(void 0===this[kID])this.once("ready",()=>this._final(e));else if(void 0!==t){debug(`Http2Stream ${this[kID]} [Http2Session `+`${sessionName(this[kSession][kType])}]: _final shutting down`);const s=new ShutdownWrap;s.oncomplete=afterShutdown,s.callback=e,s.handle=t,t.shutdown(s)}else e()}_read(e){this.destroyed?this.push(null):(this[kState].didRead||(this._readableState.readingMore=!1,this[kState].didRead=!0),this.pending?this.once("ready",streamOnResume):streamOnResume.call(this))}priority(e){if(this.destroyed)throw new ERR_HTTP2_INVALID_STREAM;assertIsObject(e,"options"),validatePriorityOptions(e=Object.assign({},e));const t=submitPriority.bind(this,e);this.pending?this.once("ready",t):t()}sendTrailers(e){if(this.destroyed||this.closed)throw new ERR_HTTP2_INVALID_STREAM;if(this[kSentTrailers])throw new ERR_HTTP2_TRAILERS_ALREADY_SENT;if(!this[kState].trailersReady)throw new ERR_HTTP2_TRAILERS_NOT_READY;assertIsObject(e,"headers"),e=Object.assign(Object.create(null),e);const t=this[kSession];debug(`Http2Stream ${this[kID]} [Http2Session `+`${sessionName(t[kType])}]: sending trailers`),this[kUpdateTimer]();const s=mapToHeaders(e,assertValidPseudoHeaderTrailer);if(!Array.isArray(s))throw s;this[kSentTrailers]=e,setImmediate(finishSendTrailers,this,s)}get closed(){return!!(this[kState].flags&STREAM_FLAGS_CLOSED)}close(e=NGHTTP2_NO_ERROR,t){if(validateNumber(e,"code"),e<0||e>kMaxInt)throw new ERR_OUT_OF_RANGE("code",`>= 0 && <= ${kMaxInt}`,e);if(void 0!==t&&"function"!=typeof t)throw new ERR_INVALID_CALLBACK;this.closed||(void 0!==t&&this.once("close",t),closeStream(this,e))}_destroy(e,t){const s=this[kSession],i=this[kHandle],n=this[kID];debug(`Http2Stream ${this[kID]||"<pending>"} [Http2Session `+`${sessionName(s[kType])}]: destroying stream`);const r=this[kState],o=null!=e?NGHTTP2_INTERNAL_ERROR:r.rstCode||NGHTTP2_NO_ERROR,T=void 0!==i;this.closed||closeStream(this,o,T?kForceRstStream:kNoRstStream),this.push(null),T?(i.destroy(),s[kState].streams.delete(n)):s[kState].pendingStreams.delete(this),s[kState].writeQueueSize-=r.writeQueueSize,r.writeQueueSize=0,null==e&&o!==NGHTTP2_NO_ERROR&&o!==NGHTTP2_CANCEL&&(e=new ERR_HTTP2_STREAM_ERROR(nameForErrorCode[o]||o)),this[kSession]=void 0,this[kHandle]=void 0,s[kMaybeDestroy](),t(e)}[kMaybeDestroy](e=NGHTTP2_NO_ERROR){if(e===NGHTTP2_NO_ERROR){if(this._writableState.finished){if(!this.readable&&this.closed)return void this.destroy();const e=this[kState];!this.headersSent||this[kSession][kType]!==NGHTTP2_SESSION_SERVER||e.flags&STREAM_FLAGS_HAS_TRAILERS||e.didRead||null!==this.readableFlowing||setImmediate(this.close.bind(this))}}else this.destroy()}}function processHeaders(e){assertIsObject(e,"headers"),null==(e=Object.assign(Object.create(null),e))[HTTP2_HEADER_STATUS]&&(e[HTTP2_HEADER_STATUS]=HTTP_STATUS_OK),e[HTTP2_HEADER_DATE]=utcDate();const t=e[HTTP2_HEADER_STATUS]|=0;if(t<200||t>599)throw new ERR_HTTP2_STATUS_INVALID(e[HTTP2_HEADER_STATUS]);return e}function onFileCloseError(e,t){e.emit(t)}function onFileUnpipe(){const e=this.sink[kOwner];e.ownsFd?this.source.close().catch(onFileCloseError.bind(e)):this.source.releaseFD()}function onPipedFileHandleRead(e){e<0&&e!==UV_EOF&&this.stream.close(NGHTTP2_INTERNAL_ERROR)}function processRespondWithFD(e,t,s,i=0,n=-1,r=0){e[kState].flags|=STREAM_FLAGS_HEADERS_SENT;const o=mapToHeaders(s,assertValidPseudoHeaderResponse);if(e[kSentHeaders]=s,!Array.isArray(o))return void e.destroy(o);e._final=null,e.end();const T=e[kHandle].respond(o,r);T<0?e.destroy(new NghttpError(T)):defaultTriggerAsyncIdScope(e[async_id_symbol],startFilePipe,e,t,i,n)}function startFilePipe(e,t,s,i){const n=new FileHandle(t,s,i);n.onread=onPipedFileHandleRead,n.stream=e;const r=new StreamPipe(n._externalStream,e[kHandle]._externalStream);r.onunpipe=onFileUnpipe,r.start(),trackWriteState(e,1)}function doSendFD(e,t,s,i,n,r,o){if(r)return void this.destroy(r);if(this.destroyed||this.closed)return void this.destroy(new ERR_HTTP2_INVALID_STREAM);const T={offset:void 0!==t.offset?t.offset:0,length:void 0!==t.length?t.length:-1};"function"==typeof t.statCheck&&!1===t.statCheck.call(this,o,i,T)||this[kState].flags&STREAM_FLAGS_HEADERS_SENT||processRespondWithFD(this,s,i,0|T.offset,0|T.length,n)}function doSendFileFD(e,t,s,i,n,r,o){const T=t.onError;if(r)return tryClose(s),void(T?T(r):this.destroy(r));if(!o.isFile()){const e=o.isDirectory();if(void 0!==t.offset||t.offset>0||void 0!==t.length||t.length>=0||e){const t=e?new ERR_HTTP2_SEND_FILE:new ERR_HTTP2_SEND_FILE_NOSEEK;return tryClose(s),void(T?T(t):this.destroy(t))}t.offset=-1,t.length=-1}if(this.destroyed||this.closed)return tryClose(s),void this.destroy(new ERR_HTTP2_INVALID_STREAM);const _={offset:void 0!==t.offset?t.offset:0,length:void 0!==t.length?t.length:-1};"function"==typeof t.statCheck&&!1===t.statCheck.call(this,o,i)||this[kState].flags&STREAM_FLAGS_HEADERS_SENT?tryClose(s):(o.isFile()&&(_.length=_.length<0?o.size-+_.offset:Math.min(o.size-+_.offset,_.length),i[HTTP2_HEADER_CONTENT_LENGTH]=_.length),processRespondWithFD(this,s,i,0|t.offset,0|_.length,n))}function afterOpen(e,t,s,i,n,r){const o=this[kState],T=t.onError;n?T?T(n):this.destroy(n):this.destroyed||this.closed?tryClose(r):(o.fd=r,fs.fstat(r,doSendFileFD.bind(this,e,t,r,s,i)))}class ServerHttp2Stream extends Http2Stream{constructor(e,t,s,i,n){super(e,i),t.owner=this,this[kInit](s,t),this[kProtocol]=n[HTTP2_HEADER_SCHEME],this[kAuthority]=n[HTTP2_HEADER_AUTHORITY]}get pushAllowed(){return!this.destroyed&&!this.closed&&!this.session.closed&&!this.session.destroyed&&this[kSession].remoteSettings.enablePush}pushStream(e,t,s){if(!this.pushAllowed)throw new ERR_HTTP2_PUSH_DISABLED;if(this[kID]%2==0)throw new ERR_HTTP2_NESTED_PUSH;const i=this[kSession];if(debug(`Http2Stream ${this[kID]} [Http2Session `+`${sessionName(i[kType])}]: initiating push stream`),this[kUpdateTimer](),"function"==typeof t&&(s=t,t=void 0),"function"!=typeof s)throw new ERR_INVALID_CALLBACK;assertIsObject(t,"options"),(t=Object.assign({},t)).endStream=!!t.endStream,assertIsObject(e,"headers"),void 0===(e=Object.assign(Object.create(null),e))[HTTP2_HEADER_METHOD]&&(e[HTTP2_HEADER_METHOD]=HTTP2_METHOD_GET),void 0===e[HTTP2_HEADER_AUTHORITY]&&(e[HTTP2_HEADER_AUTHORITY]=this[kAuthority]),void 0===e[HTTP2_HEADER_SCHEME]&&(e[HTTP2_HEADER_SCHEME]=this[kProtocol]),void 0===e[HTTP2_HEADER_PATH]&&(e[HTTP2_HEADER_PATH]="/");let n=!1;e[HTTP2_HEADER_METHOD]===HTTP2_METHOD_HEAD&&(n=t.endStream=!0),t.readable=!1;const r=mapToHeaders(e);if(!Array.isArray(r))throw r;const o=t.endStream?STREAM_OPTION_EMPTY_PAYLOAD:0,T=this[kHandle].pushPromise(r,o);let _;if("number"==typeof T){switch(T){case NGHTTP2_ERR_STREAM_ID_NOT_AVAILABLE:_=new ERR_HTTP2_OUT_OF_STREAMS;break;case NGHTTP2_ERR_STREAM_CLOSED:_=new ERR_HTTP2_INVALID_STREAM;break;default:_=new NghttpError(T)}return void process.nextTick(s,_)}const a=T.id(),S=new ServerHttp2Stream(i,T,a,t,e);S[kSentHeaders]=e,t.endStream&&S.end(),n&&(S[kState].flags|=STREAM_FLAGS_HEAD_REQUEST),process.nextTick(s,null,S,e,0)}respond(e,t){if(this.destroyed||this.closed)throw new ERR_HTTP2_INVALID_STREAM;if(this.headersSent)throw new ERR_HTTP2_HEADERS_SENT;const s=this[kState];assertIsObject(t,"options"),t=Object.assign({},t);const i=this[kSession];debug(`Http2Stream ${this[kID]} [Http2Session `+`${sessionName(i[kType])}]: initiating response`),this[kUpdateTimer](),t.endStream=!!t.endStream;let n=0;t.endStream&&(n|=STREAM_OPTION_EMPTY_PAYLOAD),t.waitForTrailers&&(n|=STREAM_OPTION_GET_TRAILERS,s.flags|=STREAM_FLAGS_HAS_TRAILERS);const r=(e=processHeaders(e))[HTTP2_HEADER_STATUS]|=0;r!==HTTP_STATUS_NO_CONTENT&&r!==HTTP_STATUS_RESET_CONTENT&&r!==HTTP_STATUS_NOT_MODIFIED&&!0!==this.headRequest||(t.endStream=!0);const o=mapToHeaders(e,assertValidPseudoHeaderResponse);if(!Array.isArray(o))throw o;this[kSentHeaders]=e,s.flags|=STREAM_FLAGS_HEADERS_SENT,t.endStream&&this.end();const T=this[kHandle].respond(o,n);T<0&&this.destroy(new NghttpError(T))}respondWithFD(e,t,s){if(this.destroyed||this.closed)throw new ERR_HTTP2_INVALID_STREAM;if(this.headersSent)throw new ERR_HTTP2_HEADERS_SENT;const i=this[kSession];if(assertIsObject(s,"options"),void 0!==(s=Object.assign({},s)).offset&&"number"!=typeof s.offset)throw new ERR_INVALID_OPT_VALUE("offset",s.offset);if(void 0!==s.length&&"number"!=typeof s.length)throw new ERR_INVALID_OPT_VALUE("length",s.length);if(void 0!==s.statCheck&&"function"!=typeof s.statCheck)throw new ERR_INVALID_OPT_VALUE("statCheck",s.statCheck);let n=0;s.waitForTrailers&&(n|=STREAM_OPTION_GET_TRAILERS,this[kState].flags|=STREAM_FLAGS_HAS_TRAILERS),validateNumber(e,"fd"),debug(`Http2Stream ${this[kID]} [Http2Session `+`${sessionName(i[kType])}]: initiating response from fd`),this[kUpdateTimer](),this.ownsFd=!1;const r=(t=processHeaders(t))[HTTP2_HEADER_STATUS]|=0;if(r===HTTP_STATUS_NO_CONTENT||r===HTTP_STATUS_RESET_CONTENT||r===HTTP_STATUS_NOT_MODIFIED)throw new ERR_HTTP2_PAYLOAD_FORBIDDEN(r);void 0===s.statCheck?processRespondWithFD(this,e,t,s.offset,s.length,n):fs.fstat(e,doSendFD.bind(this,i,s,e,t,n))}respondWithFile(e,t,s){if(this.destroyed||this.closed)throw new ERR_HTTP2_INVALID_STREAM;if(this.headersSent)throw new ERR_HTTP2_HEADERS_SENT;if(assertIsObject(s,"options"),void 0!==(s=Object.assign({},s)).offset&&"number"!=typeof s.offset)throw new ERR_INVALID_OPT_VALUE("offset",s.offset);if(void 0!==s.length&&"number"!=typeof s.length)throw new ERR_INVALID_OPT_VALUE("length",s.length);if(void 0!==s.statCheck&&"function"!=typeof s.statCheck)throw new ERR_INVALID_OPT_VALUE("statCheck",s.statCheck);let i=0;s.waitForTrailers&&(i|=STREAM_OPTION_GET_TRAILERS,this[kState].flags|=STREAM_FLAGS_HAS_TRAILERS);const n=this[kSession];debug(`Http2Stream ${this[kID]} [Http2Session `+`${sessionName(n[kType])}]: initiating response from file`),this[kUpdateTimer](),this.ownsFd=!0;const r=(t=processHeaders(t))[HTTP2_HEADER_STATUS]|=0;if(r===HTTP_STATUS_NO_CONTENT||r===HTTP_STATUS_RESET_CONTENT||r===HTTP_STATUS_NOT_MODIFIED)throw new ERR_HTTP2_PAYLOAD_FORBIDDEN(r);fs.open(e,"r",afterOpen.bind(this,n,s,t,i))}additionalHeaders(e){if(this.destroyed||this.closed)throw new ERR_HTTP2_INVALID_STREAM;if(this.headersSent)throw new ERR_HTTP2_HEADERS_AFTER_RESPOND;assertIsObject(e,"headers"),e=Object.assign(Object.create(null),e);const t=this[kSession];if(debug(`Http2Stream ${this[kID]} [Http2Session `+`${sessionName(t[kType])}]: sending additional headers`),null!=e[HTTP2_HEADER_STATUS]){const t=e[HTTP2_HEADER_STATUS]|=0;if(t===HTTP_STATUS_SWITCHING_PROTOCOLS)throw new ERR_HTTP2_STATUS_101;if(t<100||t>=200)throw new ERR_HTTP2_INVALID_INFO_STATUS(e[HTTP2_HEADER_STATUS])}this[kUpdateTimer]();const s=mapToHeaders(e,assertValidPseudoHeaderResponse);if(!Array.isArray(s))throw s;this[kInfoHeaders]?this[kInfoHeaders].push(e):this[kInfoHeaders]=[e];const i=this[kHandle].info(s);i<0&&this.destroy(new NghttpError(i))}}ServerHttp2Stream.prototype[kProceed]=ServerHttp2Stream.prototype.respond;class ClientHttp2Stream extends Http2Stream{constructor(e,t,s,i){super(e,i),this[kState].flags|=STREAM_FLAGS_HEADERS_SENT,void 0!==s&&this[kInit](s,t),this.on("headers",handleHeaderContinue)}}function handleHeaderContinue(e){e[HTTP2_HEADER_STATUS]===HTTP_STATUS_CONTINUE&&this.emit("continue")}const setTimeout={configurable:!0,enumerable:!0,writable:!0,value:function(e,t){if(!this.destroyed){if(e=validateTimerDuration(e),clearTimeout(this[kTimeout]),0===e){if(void 0!==t){if("function"!=typeof t)throw new ERR_INVALID_CALLBACK;this.removeListener("timeout",t)}}else if(this[kTimeout]=setUnrefTimeout(this._onTimeout.bind(this),e),this[kSession]&&this[kSession][kUpdateTimer](),void 0!==t){if("function"!=typeof t)throw new ERR_INVALID_CALLBACK;this.once("timeout",t)}return this}}};function socketOnError(e){const t=this[kSession];if(void 0!==t){if("ECONNRESET"===e.code&&null!==t[kState].goawayCode)return t.destroy();debug(`Http2Session ${sessionName(t[kType])}: socket error [`+`${e.message}]`),t.destroy(e)}}function sessionOnStream(e,t,s,i){void 0!==this[kServer]&&this[kServer].emit("stream",e,t,s,i)}function sessionOnPriority(e,t,s,i){void 0!==this[kServer]&&this[kServer].emit("priority",e,t,s,i)}function sessionOnError(e){this[kServer]&&this[kServer].emit("sessionError",e,this)}function sessionOnTimeout(){if(this.destroyed||this.closed)return;this[kServer].emit("timeout",this)||this.destroy()}function connectionListener(e){debug("Http2Session server: received a connection");const t=this[kOptions]||{};if(!1===e.alpnProtocol||"http/1.1"===e.alpnProtocol)return!0===t.allowHTTP1?(e.server[kIncomingMessage]=t.Http1IncomingMessage,e.server[kServerResponse]=t.Http1ServerResponse,httpConnectionListener.call(this,e)):(debug(`Unknown protocol from ${e.remoteAddress}:${e.remotePort}`),void(this.emit("unknownProtocol",e)||e.end("HTTP/1.0 403 Forbidden\r\nContent-Type: text/plain\r\n\r\nUnknown ALPN Protocol, expected `h2` to be available.\nIf this is a HTTP request: The server was not configured with the `allowHTTP1` option or a listener for the `unknownProtocol` event.\n")));e.on("error",socketOnError),e.on("close",socketOnClose);const s=new ServerHttp2Session(t,e,this);s.on("stream",sessionOnStream),s.on("priority",sessionOnPriority),s.on("error",sessionOnError),this.timeout&&s.setTimeout(this.timeout,sessionOnTimeout),e[kServer]=this,this.emit("session",s)}function initializeOptions(e){return assertIsObject(e,"options"),(e=Object.assign({},e)).allowHalfOpen=!0,assertIsObject(e.settings,"options.settings"),e.settings=Object.assign({},e.settings),e.Http1IncomingMessage=e.Http1IncomingMessage||http.IncomingMessage,e.Http1ServerResponse=e.Http1ServerResponse||http.ServerResponse,e.Http2ServerRequest=e.Http2ServerRequest||Http2ServerRequest,e.Http2ServerResponse=e.Http2ServerResponse||Http2ServerResponse,e}function initializeTLSOptions(e,t){return(e=initializeOptions(e)).ALPNProtocols=["h2"],!0===e.allowHTTP1&&e.ALPNProtocols.push("http/1.1"),void 0!==t&&void 0===e.servername&&(e.servername=t),e}function onErrorSecureServerSession(e,t){this.emit("clientError",e,t)||t.destroy(e)}Object.defineProperty(Http2Stream.prototype,"setTimeout",setTimeout),Object.defineProperty(Http2Session.prototype,"setTimeout",setTimeout);class Http2SecureServer extends TLSServer{constructor(e,t){super(e=initializeTLSOptions(e),connectionListener),this[kOptions]=e,this.timeout=kDefaultSocketTimeout,this.on("newListener",setupCompat),"function"==typeof t&&this.on("request",t),this.on("tlsClientError",onErrorSecureServerSession)}setTimeout(e,t){if(this.timeout=e,void 0!==t){if("function"!=typeof t)throw new ERR_INVALID_CALLBACK;this.on("timeout",t)}return this}}class Http2Server extends NETServer{constructor(e,t){super(connectionListener),this[kOptions]=initializeOptions(e),this.timeout=kDefaultSocketTimeout,this.on("newListener",setupCompat),"function"==typeof t&&this.on("request",t)}setTimeout(e,t){if(this.timeout=e,void 0!==t){if("function"!=typeof t)throw new ERR_INVALID_CALLBACK;this.on("timeout",t)}return this}}function setupCompat(e){"request"===e&&(this.removeListener("newListener",setupCompat),this.on("stream",onServerStream.bind(this,this[kOptions].Http2ServerRequest,this[kOptions].Http2ServerResponse)))}function socketOnClose(){const e=this[kSession];if(void 0!==e){debug(`Http2Session ${sessionName(e[kType])}: socket closed`);const t=e.connecting?new ERR_SOCKET_CLOSED:null,s=e[kState];s.streams.forEach(e=>e.close(NGHTTP2_CANCEL)),s.pendingStreams.forEach(e=>e.close(NGHTTP2_CANCEL)),e.close(),e[kMaybeDestroy](t)}}function connect(e,t,s){"function"==typeof t&&(s=t,t=void 0),assertIsObject(t,"options"),t=Object.assign({},t),"string"==typeof e&&(e=new URL(e)),assertIsObject(e,"authority",["string","Object","URL"]);const i=e.protocol||t.protocol||"https:",n=""+(""!==e.port?e.port:"http:"===e.protocol?80:443),r=e.hostname||e.host||"localhost";let o;if("function"==typeof t.createConnection)o=t.createConnection(e,t);else switch(i){case"http:":o=net.connect(n,r);break;case"https:":o=tls.connect(n,r,initializeTLSOptions(t,r));break;default:throw new ERR_HTTP2_UNSUPPORTED_PROTOCOL(i)}o.on("error",socketOnError),o.on("close",socketOnClose);const T=new ClientHttp2Session(t,o);return T[kAuthority]=`${t.servername||r}:${n}`,T[kProtocol]=i,"function"==typeof s&&T.once("connect",s),T}function createSecureServer(e,t){return assertIsObject(e,"options"),new Http2SecureServer(e,t)}function createServer(e,t){return"function"==typeof e&&(t=e,e={}),assertIsObject(e,"options"),new Http2Server(e,t)}function getPackedSettings(e){return assertIsObject(e,"settings"),updateSettingsBuffer(validateSettings(e)),binding.packSettings()}function getUnpackedSettings(e,t={}){if(!isArrayBufferView(e))throw new ERR_INVALID_ARG_TYPE("buf",["Buffer","TypedArray","DataView"],e);if(e.length%6!=0)throw new ERR_HTTP2_INVALID_PACKED_SETTINGS_LENGTH;const s={};let i=0;for(;i<e.length;){const t=e.readUInt16BE(i);i+=2;const n=e.readUInt32BE(i);switch(t){case NGHTTP2_SETTINGS_HEADER_TABLE_SIZE:s.headerTableSize=n;break;case NGHTTP2_SETTINGS_ENABLE_PUSH:s.enablePush=0!==n;break;case NGHTTP2_SETTINGS_MAX_CONCURRENT_STREAMS:s.maxConcurrentStreams=n;break;case NGHTTP2_SETTINGS_INITIAL_WINDOW_SIZE:s.initialWindowSize=n;break;case NGHTTP2_SETTINGS_MAX_FRAME_SIZE:s.maxFrameSize=n;break;case NGHTTP2_SETTINGS_MAX_HEADER_LIST_SIZE:s.maxHeaderListSize=n}i+=4}return null!=t&&t.validate&&validateSettings(s),s}Object.defineProperty(connect,promisify.custom,{value:(e,t)=>new Promise(s=>{const i=connect(e,t,()=>s(i))})}),module.exports={connect,constants,createServer,createSecureServer,getDefaultSettings,getPackedSettings,getUnpackedSettings,Http2Session,Http2Stream,Http2ServerRequest,Http2ServerResponse};"use strict";const binding=internalBinding("http2"),{ERR_HTTP2_HEADER_SINGLE_VALUE,ERR_HTTP2_INVALID_CONNECTION_HEADERS,ERR_HTTP2_INVALID_PSEUDOHEADER,ERR_HTTP2_INVALID_SETTING_VALUE,ERR_INVALID_ARG_TYPE}=require("internal/errors").codes,kSocket=Symbol("socket"),{NGHTTP2_SESSION_CLIENT,NGHTTP2_SESSION_SERVER,HTTP2_HEADER_STATUS,HTTP2_HEADER_METHOD,HTTP2_HEADER_AUTHORITY,HTTP2_HEADER_SCHEME,HTTP2_HEADER_PATH,HTTP2_HEADER_PROTOCOL,HTTP2_HEADER_ACCESS_CONTROL_ALLOW_CREDENTIALS,HTTP2_HEADER_ACCESS_CONTROL_MAX_AGE,HTTP2_HEADER_ACCESS_CONTROL_REQUEST_METHOD,HTTP2_HEADER_AGE,HTTP2_HEADER_AUTHORIZATION,HTTP2_HEADER_CONTENT_ENCODING,HTTP2_HEADER_CONTENT_LANGUAGE,HTTP2_HEADER_CONTENT_LENGTH,HTTP2_HEADER_CONTENT_LOCATION,HTTP2_HEADER_CONTENT_MD5,HTTP2_HEADER_CONTENT_RANGE,HTTP2_HEADER_CONTENT_TYPE,HTTP2_HEADER_COOKIE,HTTP2_HEADER_DATE,HTTP2_HEADER_DNT,HTTP2_HEADER_ETAG,HTTP2_HEADER_EXPIRES,HTTP2_HEADER_FROM,HTTP2_HEADER_IF_MATCH,HTTP2_HEADER_IF_NONE_MATCH,HTTP2_HEADER_IF_MODIFIED_SINCE,HTTP2_HEADER_IF_RANGE,HTTP2_HEADER_IF_UNMODIFIED_SINCE,HTTP2_HEADER_LAST_MODIFIED,HTTP2_HEADER_LOCATION,HTTP2_HEADER_MAX_FORWARDS,HTTP2_HEADER_PROXY_AUTHORIZATION,HTTP2_HEADER_RANGE,HTTP2_HEADER_REFERER,HTTP2_HEADER_RETRY_AFTER,HTTP2_HEADER_SET_COOKIE,HTTP2_HEADER_TK,HTTP2_HEADER_UPGRADE_INSECURE_REQUESTS,HTTP2_HEADER_USER_AGENT,HTTP2_HEADER_X_CONTENT_TYPE_OPTIONS,HTTP2_HEADER_CONNECTION,HTTP2_HEADER_UPGRADE,HTTP2_HEADER_HTTP2_SETTINGS,HTTP2_HEADER_TE,HTTP2_HEADER_TRANSFER_ENCODING,HTTP2_HEADER_HOST,HTTP2_HEADER_KEEP_ALIVE,HTTP2_HEADER_PROXY_CONNECTION,HTTP2_METHOD_DELETE,HTTP2_METHOD_GET,HTTP2_METHOD_HEAD}=binding.constants,kValidPseudoHeaders=new Set([HTTP2_HEADER_STATUS,HTTP2_HEADER_METHOD,HTTP2_HEADER_AUTHORITY,HTTP2_HEADER_SCHEME,HTTP2_HEADER_PATH,HTTP2_HEADER_PROTOCOL]),kSingleValueHeaders=new Set([HTTP2_HEADER_STATUS,HTTP2_HEADER_METHOD,HTTP2_HEADER_AUTHORITY,HTTP2_HEADER_SCHEME,HTTP2_HEADER_PATH,HTTP2_HEADER_PROTOCOL,HTTP2_HEADER_ACCESS_CONTROL_ALLOW_CREDENTIALS,HTTP2_HEADER_ACCESS_CONTROL_MAX_AGE,HTTP2_HEADER_ACCESS_CONTROL_REQUEST_METHOD,HTTP2_HEADER_AGE,HTTP2_HEADER_AUTHORIZATION,HTTP2_HEADER_CONTENT_ENCODING,HTTP2_HEADER_CONTENT_LANGUAGE,HTTP2_HEADER_CONTENT_LENGTH,HTTP2_HEADER_CONTENT_LOCATION,HTTP2_HEADER_CONTENT_MD5,HTTP2_HEADER_CONTENT_RANGE,HTTP2_HEADER_CONTENT_TYPE,HTTP2_HEADER_DATE,HTTP2_HEADER_DNT,HTTP2_HEADER_ETAG,HTTP2_HEADER_EXPIRES,HTTP2_HEADER_FROM,HTTP2_HEADER_IF_MATCH,HTTP2_HEADER_IF_MODIFIED_SINCE,HTTP2_HEADER_IF_NONE_MATCH,HTTP2_HEADER_IF_RANGE,HTTP2_HEADER_IF_UNMODIFIED_SINCE,HTTP2_HEADER_LAST_MODIFIED,HTTP2_HEADER_LOCATION,HTTP2_HEADER_MAX_FORWARDS,HTTP2_HEADER_PROXY_AUTHORIZATION,HTTP2_HEADER_RANGE,HTTP2_HEADER_REFERER,HTTP2_HEADER_RETRY_AFTER,HTTP2_HEADER_TK,HTTP2_HEADER_UPGRADE_INSECURE_REQUESTS,HTTP2_HEADER_USER_AGENT,HTTP2_HEADER_X_CONTENT_TYPE_OPTIONS]),kNoPayloadMethods=new Set([HTTP2_METHOD_DELETE,HTTP2_METHOD_GET,HTTP2_METHOD_HEAD]),{settingsBuffer,optionsBuffer}=binding,{sessionState,streamState}=binding,IDX_SETTINGS_HEADER_TABLE_SIZE=0,IDX_SETTINGS_ENABLE_PUSH=1,IDX_SETTINGS_INITIAL_WINDOW_SIZE=2,IDX_SETTINGS_MAX_FRAME_SIZE=3,IDX_SETTINGS_MAX_CONCURRENT_STREAMS=4,IDX_SETTINGS_MAX_HEADER_LIST_SIZE=5,IDX_SETTINGS_ENABLE_CONNECT_PROTOCOL=6,IDX_SETTINGS_FLAGS=7,IDX_SESSION_STATE_EFFECTIVE_LOCAL_WINDOW_SIZE=0,IDX_SESSION_STATE_EFFECTIVE_RECV_DATA_LENGTH=1,IDX_SESSION_STATE_NEXT_STREAM_ID=2,IDX_SESSION_STATE_LOCAL_WINDOW_SIZE=3,IDX_SESSION_STATE_LAST_PROC_STREAM_ID=4,IDX_SESSION_STATE_REMOTE_WINDOW_SIZE=5,IDX_SESSION_STATE_OUTBOUND_QUEUE_SIZE=6,IDX_SESSION_STATE_HD_DEFLATE_DYNAMIC_TABLE_SIZE=7,IDX_SESSION_STATE_HD_INFLATE_DYNAMIC_TABLE_SIZE=8,IDX_STREAM_STATE=0,IDX_STREAM_STATE_WEIGHT=1,IDX_STREAM_STATE_SUM_DEPENDENCY_WEIGHT=2,IDX_STREAM_STATE_LOCAL_CLOSE=3,IDX_STREAM_STATE_REMOTE_CLOSE=4,IDX_STREAM_STATE_LOCAL_WINDOW_SIZE=5,IDX_OPTIONS_MAX_DEFLATE_DYNAMIC_TABLE_SIZE=0,IDX_OPTIONS_MAX_RESERVED_REMOTE_STREAMS=1,IDX_OPTIONS_MAX_SEND_HEADER_BLOCK_LENGTH=2,IDX_OPTIONS_PEER_MAX_CONCURRENT_STREAMS=3,IDX_OPTIONS_PADDING_STRATEGY=4,IDX_OPTIONS_MAX_HEADER_LIST_PAIRS=5,IDX_OPTIONS_MAX_OUTSTANDING_PINGS=6,IDX_OPTIONS_MAX_OUTSTANDING_SETTINGS=7,IDX_OPTIONS_MAX_SESSION_MEMORY=8,IDX_OPTIONS_FLAGS=9;function updateOptionsBuffer(_){var E=0;"number"==typeof _.maxDeflateDynamicTableSize&&(E|=1<<IDX_OPTIONS_MAX_DEFLATE_DYNAMIC_TABLE_SIZE,optionsBuffer[IDX_OPTIONS_MAX_DEFLATE_DYNAMIC_TABLE_SIZE]=_.maxDeflateDynamicTableSize),"number"==typeof _.maxReservedRemoteStreams&&(E|=1<<IDX_OPTIONS_MAX_RESERVED_REMOTE_STREAMS,optionsBuffer[IDX_OPTIONS_MAX_RESERVED_REMOTE_STREAMS]=_.maxReservedRemoteStreams),"number"==typeof _.maxSendHeaderBlockLength&&(E|=1<<IDX_OPTIONS_MAX_SEND_HEADER_BLOCK_LENGTH,optionsBuffer[IDX_OPTIONS_MAX_SEND_HEADER_BLOCK_LENGTH]=_.maxSendHeaderBlockLength),"number"==typeof _.peerMaxConcurrentStreams&&(E|=1<<IDX_OPTIONS_PEER_MAX_CONCURRENT_STREAMS,optionsBuffer[IDX_OPTIONS_PEER_MAX_CONCURRENT_STREAMS]=_.peerMaxConcurrentStreams),"number"==typeof _.paddingStrategy&&(E|=1<<IDX_OPTIONS_PADDING_STRATEGY,optionsBuffer[IDX_OPTIONS_PADDING_STRATEGY]=_.paddingStrategy),"number"==typeof _.maxHeaderListPairs&&(E|=1<<IDX_OPTIONS_MAX_HEADER_LIST_PAIRS,optionsBuffer[IDX_OPTIONS_MAX_HEADER_LIST_PAIRS]=_.maxHeaderListPairs),"number"==typeof _.maxOutstandingPings&&(E|=1<<IDX_OPTIONS_MAX_OUTSTANDING_PINGS,optionsBuffer[IDX_OPTIONS_MAX_OUTSTANDING_PINGS]=_.maxOutstandingPings),"number"==typeof _.maxOutstandingSettings&&(E|=1<<IDX_OPTIONS_MAX_OUTSTANDING_SETTINGS,optionsBuffer[IDX_OPTIONS_MAX_OUTSTANDING_SETTINGS]=Math.max(1,_.maxOutstandingSettings)),"number"==typeof _.maxSessionMemory&&(E|=1<<IDX_OPTIONS_MAX_SESSION_MEMORY,optionsBuffer[IDX_OPTIONS_MAX_SESSION_MEMORY]=Math.max(1,_.maxSessionMemory)),optionsBuffer[IDX_OPTIONS_FLAGS]=E}function getDefaultSettings(){settingsBuffer[IDX_SETTINGS_FLAGS]=0,binding.refreshDefaultSettings();const _=Object.create(null),E=settingsBuffer[IDX_SETTINGS_FLAGS];return(E&1<<IDX_SETTINGS_HEADER_TABLE_SIZE)==1<<IDX_SETTINGS_HEADER_TABLE_SIZE&&(_.headerTableSize=settingsBuffer[IDX_SETTINGS_HEADER_TABLE_SIZE]),(E&1<<IDX_SETTINGS_ENABLE_PUSH)==1<<IDX_SETTINGS_ENABLE_PUSH&&(_.enablePush=1===settingsBuffer[IDX_SETTINGS_ENABLE_PUSH]),(E&1<<IDX_SETTINGS_INITIAL_WINDOW_SIZE)==1<<IDX_SETTINGS_INITIAL_WINDOW_SIZE&&(_.initialWindowSize=settingsBuffer[IDX_SETTINGS_INITIAL_WINDOW_SIZE]),(E&1<<IDX_SETTINGS_MAX_FRAME_SIZE)==1<<IDX_SETTINGS_MAX_FRAME_SIZE&&(_.maxFrameSize=settingsBuffer[IDX_SETTINGS_MAX_FRAME_SIZE]),(E&1<<IDX_SETTINGS_MAX_CONCURRENT_STREAMS)==1<<IDX_SETTINGS_MAX_CONCURRENT_STREAMS&&(_.maxConcurrentStreams=settingsBuffer[IDX_SETTINGS_MAX_CONCURRENT_STREAMS]),(E&1<<IDX_SETTINGS_MAX_HEADER_LIST_SIZE)==1<<IDX_SETTINGS_MAX_HEADER_LIST_SIZE&&(_.maxHeaderListSize=settingsBuffer[IDX_SETTINGS_MAX_HEADER_LIST_SIZE]),(E&1<<IDX_SETTINGS_ENABLE_CONNECT_PROTOCOL)==1<<IDX_SETTINGS_ENABLE_CONNECT_PROTOCOL&&(_.enableConnectProtocol=settingsBuffer[IDX_SETTINGS_ENABLE_CONNECT_PROTOCOL]),_}function getSettings(_,E){return E?_.remoteSettings():_.localSettings(),{headerTableSize:settingsBuffer[IDX_SETTINGS_HEADER_TABLE_SIZE],enablePush:!!settingsBuffer[IDX_SETTINGS_ENABLE_PUSH],initialWindowSize:settingsBuffer[IDX_SETTINGS_INITIAL_WINDOW_SIZE],maxFrameSize:settingsBuffer[IDX_SETTINGS_MAX_FRAME_SIZE],maxConcurrentStreams:settingsBuffer[IDX_SETTINGS_MAX_CONCURRENT_STREAMS],maxHeaderListSize:settingsBuffer[IDX_SETTINGS_MAX_HEADER_LIST_SIZE],enableConnectProtocol:settingsBuffer[IDX_SETTINGS_ENABLE_CONNECT_PROTOCOL]}}function updateSettingsBuffer(_){var E=0;"number"==typeof _.headerTableSize&&(E|=1<<IDX_SETTINGS_HEADER_TABLE_SIZE,settingsBuffer[IDX_SETTINGS_HEADER_TABLE_SIZE]=_.headerTableSize),"number"==typeof _.maxConcurrentStreams&&(E|=1<<IDX_SETTINGS_MAX_CONCURRENT_STREAMS,settingsBuffer[IDX_SETTINGS_MAX_CONCURRENT_STREAMS]=_.maxConcurrentStreams),"number"==typeof _.initialWindowSize&&(E|=1<<IDX_SETTINGS_INITIAL_WINDOW_SIZE,settingsBuffer[IDX_SETTINGS_INITIAL_WINDOW_SIZE]=_.initialWindowSize),"number"==typeof _.maxFrameSize&&(E|=1<<IDX_SETTINGS_MAX_FRAME_SIZE,settingsBuffer[IDX_SETTINGS_MAX_FRAME_SIZE]=_.maxFrameSize),"number"==typeof _.maxHeaderListSize&&(E|=1<<IDX_SETTINGS_MAX_HEADER_LIST_SIZE,settingsBuffer[IDX_SETTINGS_MAX_HEADER_LIST_SIZE]=_.maxHeaderListSize),"boolean"==typeof _.enablePush&&(E|=1<<IDX_SETTINGS_ENABLE_PUSH,settingsBuffer[IDX_SETTINGS_ENABLE_PUSH]=Number(_.enablePush)),"boolean"==typeof _.enableConnectProtocol&&(E|=1<<IDX_SETTINGS_ENABLE_CONNECT_PROTOCOL,settingsBuffer[IDX_SETTINGS_ENABLE_CONNECT_PROTOCOL]=Number(_.enableConnectProtocol)),settingsBuffer[IDX_SETTINGS_FLAGS]=E}function getSessionState(_){return _.refreshState(),{effectiveLocalWindowSize:sessionState[IDX_SESSION_STATE_EFFECTIVE_LOCAL_WINDOW_SIZE],effectiveRecvDataLength:sessionState[IDX_SESSION_STATE_EFFECTIVE_RECV_DATA_LENGTH],nextStreamID:sessionState[IDX_SESSION_STATE_NEXT_STREAM_ID],localWindowSize:sessionState[IDX_SESSION_STATE_LOCAL_WINDOW_SIZE],lastProcStreamID:sessionState[IDX_SESSION_STATE_LAST_PROC_STREAM_ID],remoteWindowSize:sessionState[IDX_SESSION_STATE_REMOTE_WINDOW_SIZE],outboundQueueSize:sessionState[IDX_SESSION_STATE_OUTBOUND_QUEUE_SIZE],deflateDynamicTableSize:sessionState[IDX_SESSION_STATE_HD_DEFLATE_DYNAMIC_TABLE_SIZE],inflateDynamicTableSize:sessionState[IDX_SESSION_STATE_HD_INFLATE_DYNAMIC_TABLE_SIZE]}}function getStreamState(_){return _.refreshState(),{state:streamState[IDX_STREAM_STATE],weight:streamState[IDX_STREAM_STATE_WEIGHT],sumDependencyWeight:streamState[IDX_STREAM_STATE_SUM_DEPENDENCY_WEIGHT],localClose:streamState[IDX_STREAM_STATE_LOCAL_CLOSE],remoteClose:streamState[IDX_STREAM_STATE_REMOTE_CLOSE],localWindowSize:streamState[IDX_STREAM_STATE_LOCAL_WINDOW_SIZE]}}function isIllegalConnectionSpecificHeader(_,E){switch(_){case HTTP2_HEADER_CONNECTION:case HTTP2_HEADER_UPGRADE:case HTTP2_HEADER_HOST:case HTTP2_HEADER_HTTP2_SETTINGS:case HTTP2_HEADER_KEEP_ALIVE:case HTTP2_HEADER_PROXY_CONNECTION:case HTTP2_HEADER_TRANSFER_ENCODING:return!0;case HTTP2_HEADER_TE:return"trailers"!==E;default:return!1}}function assertValidPseudoHeader(_){if(!kValidPseudoHeaders.has(_)){const E=new ERR_HTTP2_INVALID_PSEUDOHEADER(_);return Error.captureStackTrace(E,assertValidPseudoHeader),E}}function assertValidPseudoHeaderResponse(_){if(":status"!==_){const E=new ERR_HTTP2_INVALID_PSEUDOHEADER(_);return Error.captureStackTrace(E,assertValidPseudoHeaderResponse),E}}function assertValidPseudoHeaderTrailer(_){const E=new ERR_HTTP2_INVALID_PSEUDOHEADER(_);return Error.captureStackTrace(E,assertValidPseudoHeaderTrailer),E}function mapToHeaders(_,E=assertValidPseudoHeader){let T="",e=0;const S=Object.keys(_),A=new Set;for(var I=0;I<S.length;I++){let D=S[I],R=_[D];if(void 0===R||""===D)continue;D=D.toLowerCase();const t=kSingleValueHeaders.has(D);let N=Array.isArray(R);if(N)switch(R.length){case 0:continue;case 1:R=String(R[0]),N=!1;break;default:if(t)return new ERR_HTTP2_HEADER_SINGLE_VALUE(D)}else R=String(R);if(t){if(A.has(D))return new ERR_HTTP2_HEADER_SINGLE_VALUE(D);A.add(D)}if(":"===D[0]){const _=E(D);if(void 0!==_)return _;T=`${D}\0${R}\0${T}`,e++}else{if(isIllegalConnectionSpecificHeader(D,R))return new ERR_HTTP2_INVALID_CONNECTION_HEADERS(D);if(N){for(var H=0;H<R.length;H++){T+=`${D}\0${String(R[H])}\0`}e+=R.length}else T+=`${D}\0${R}\0`,e++}}return[T,e]}class NghttpError extends Error{constructor(_){super(binding.nghttp2ErrorString(_)),this.code="ERR_HTTP2_ERROR",this.name="Error [ERR_HTTP2_ERROR]",this.errno=_}}function assertIsObject(_,E,T="Object"){if(void 0!==_&&(null===_||"object"!=typeof _||Array.isArray(_))){const e=new ERR_INVALID_ARG_TYPE(E,T,_);throw Error.captureStackTrace(e,assertIsObject),e}}function assertWithinRange(_,E,T=0,e=1/0){if(void 0!==E&&("number"!=typeof E||E<T||E>e)){const S=new ERR_HTTP2_INVALID_SETTING_VALUE.RangeError(_,E);throw S.min=T,S.max=e,S.actual=E,Error.captureStackTrace(S,assertWithinRange),S}}function toHeaderObject(_){const E=Object.create(null);for(var T=0;T<_.length;T+=2){var e=_[T],S=_[T+1];e===HTTP2_HEADER_STATUS&&(S|=0);var A=E[e];if(void 0===A)E[e]=e===HTTP2_HEADER_SET_COOKIE?[S]:S;else if(!kSingleValueHeaders.has(e))switch(e){case HTTP2_HEADER_COOKIE:E[e]=`${A}; ${S}`;break;case HTTP2_HEADER_SET_COOKIE:A.push(S);break;default:E[e]=`${A}, ${S}`}}return E}function isPayloadMeaningless(_){return kNoPayloadMethods.has(_)}function sessionName(_){switch(_){case NGHTTP2_SESSION_CLIENT:return"client";case NGHTTP2_SESSION_SERVER:return"server";default:return"<invalid>"}}module.exports={assertIsObject,assertValidPseudoHeaderResponse,assertValidPseudoHeaderTrailer,assertWithinRange,getDefaultSettings,getSessionState,getSettings,getStreamState,isPayloadMeaningless,kSocket,mapToHeaders,NghttpError,sessionName,toHeaderObject,updateOptionsBuffer,updateSettingsBuffer};undefined"use strict";function init(e){e._idleNext=e,e._idlePrev=e}function peek(e){return e._idlePrev===e?null:e._idlePrev}function remove(e){e._idleNext&&(e._idleNext._idlePrev=e._idlePrev),e._idlePrev&&(e._idlePrev._idleNext=e._idleNext),e._idleNext=null,e._idlePrev=null}function append(e,i){(i._idleNext||i._idlePrev)&&remove(i),i._idleNext=e._idleNext,i._idlePrev=e,e._idleNext._idlePrev=i,e._idleNext=i}function isEmpty(e){return e._idleNext===e}module.exports={init,peek,remove,append,isEmpty};"use strict";const{ERR_INVALID_ARG_TYPE}=require("internal/errors").codes,{CHAR_LINE_FEED,CHAR_CARRIAGE_RETURN,CHAR_EXCLAMATION_MARK,CHAR_HASH}=require("internal/constants"),{getOptionValue}=require("internal/options");function makeRequireFunction(e){const t=e.constructor;function r(t){try{return exports.requireDepth+=1,e.require(t)}finally{exports.requireDepth-=1}}function i(r,i){if("string"!=typeof r)throw new ERR_INVALID_ARG_TYPE("request","string",r);return t._resolveFilename(r,e,!1,i)}return r.resolve=i,i.paths=function(r){if("string"!=typeof r)throw new ERR_INVALID_ARG_TYPE("request","string",r);return t._resolveLookupPaths(r,e,!0)},r.main=process.mainModule,r.extensions=t._extensions,r.cache=t._cache,r}function stripBOM(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}function stripShebang(e){var t=e.length;if(t>=2&&e.charCodeAt(0)===CHAR_HASH&&e.charCodeAt(1)===CHAR_EXCLAMATION_MARK)if(2===t)e="";else{for(var r=2;r<t;++r){var i=e.charCodeAt(r);if(i===CHAR_LINE_FEED||i===CHAR_CARRIAGE_RETURN)break}e=r===t?"":e.slice(r)}return e}const builtinLibs=["assert","async_hooks","buffer","child_process","cluster","crypto","dgram","dns","domain","events","fs","http","http2","https","net","os","path","perf_hooks","punycode","querystring","readline","repl","stream","string_decoder","tls","trace_events","tty","url","util","v8","vm","zlib"];function addBuiltinLibsToObject(e){builtinLibs.forEach(t=>{const r=r=>{delete e[t],e[t]=r};Object.defineProperty(e,t,{get:()=>{const i=require(t);return delete e[t],Object.defineProperty(e,t,{get:()=>i,set:r,configurable:!0,enumerable:!1}),i},set:r,configurable:!0,enumerable:!1})})}getOptionValue("--experimental-worker")&&(builtinLibs.push("worker_threads"),builtinLibs.sort()),"function"==typeof process.binding("inspector").open&&(builtinLibs.push("inspector"),builtinLibs.sort()),module.exports=exports={addBuiltinLibsToObject,builtinLibs,makeRequireFunction,requireDepth:0,stripBOM,stripShebang};"use strict";const{NativeModule}=require("internal/bootstrap/loaders"),util=require("util"),{pathToFileURL}=require("internal/url"),vm=require("vm"),assert=require("assert").ok,fs=require("fs"),internalFS=require("internal/fs/utils"),path=require("path"),{internalModuleReadJSON,internalModuleStat}=process.binding("fs"),{safeGetenv}=process.binding("util"),{makeRequireFunction,requireDepth,stripBOM,stripShebang}=require("internal/modules/cjs/helpers"),{getOptionValue}=require("internal/options"),preserveSymlinks=getOptionValue("--preserve-symlinks"),preserveSymlinksMain=getOptionValue("--preserve-symlinks-main"),experimentalModules=getOptionValue("--experimental-modules"),{ERR_INVALID_ARG_TYPE,ERR_INVALID_ARG_VALUE,ERR_REQUIRE_ESM}=require("internal/errors").codes;let asyncESM,ModuleJob,createDynamicModule,decorateErrorStack;function lazyLoadESM(){asyncESM=require("internal/process/esm_loader"),ModuleJob=require("internal/modules/esm/module_job"),createDynamicModule=require("internal/modules/esm/create_dynamic_module"),decorateErrorStack=require("internal/util").decorateErrorStack}module.exports=Module;const{CHAR_UPPERCASE_A,CHAR_LOWERCASE_A,CHAR_UPPERCASE_Z,CHAR_LOWERCASE_Z,CHAR_FORWARD_SLASH,CHAR_BACKWARD_SLASH,CHAR_COLON,CHAR_DOT,CHAR_UNDERSCORE,CHAR_0,CHAR_9}=require("internal/constants");function stat(e){e=path.toNamespacedPath(e);const t=stat.cache;if(null!==t){const r=t.get(e);if(void 0!==r)return r}const r=internalModuleStat(e);return null!==t&&t.set(e,r),r}function updateChildren(e,t,r){var n=e&&e.children;!n||r&&n.includes(t)||n.push(t)}function Module(e,t){this.id=e,this.exports={},this.parent=t,updateChildren(t,this,!1),this.filename=null,this.loaded=!1,this.children=[]}stat.cache=null;const builtinModules=Object.keys(NativeModule._source).filter(NativeModule.nonInternalExists);Object.freeze(builtinModules),Module.builtinModules=builtinModules,Module._cache=Object.create(null),Module._pathCache=Object.create(null),Module._extensions=Object.create(null);var modulePaths=[];Module.globalPaths=[],Module.wrap=function(e){return Module.wrapper[0]+e+Module.wrapper[1]},Module.wrapper=["(function (exports, require, module, __filename, __dirname) { ","\n});"];const debug=util.debuglog("module");Module._debug=util.deprecate(debug,"Module._debug is deprecated.","DEP0077");const packageMainCache=Object.create(null);function readPackage(e){const t=packageMainCache[e];if(t)return t;const r=path.resolve(e,"package.json"),n=internalModuleReadJSON(path.toNamespacedPath(r));if(void 0===n)return!1;try{return packageMainCache[e]=JSON.parse(n).main}catch(e){throw e.path=r,e.message="Error parsing "+r+": "+e.message,e}}function tryPackage(e,t,r){var n=readPackage(e);if(!n)return!1;var o=path.resolve(e,n);return tryFile(o,r)||tryExtensions(o,t,r)||tryExtensions(path.resolve(o,"index"),t,r)}const realpathCache=new Map;function tryFile(e,t){const r=stat(e);return preserveSymlinks&&!t?0===r&&path.resolve(e):0===r&&toRealPath(e)}function toRealPath(e){return fs.realpathSync(e,{[internalFS.realpathCacheKey]:realpathCache})}function tryExtensions(e,t,r){for(var n=0;n<t.length;n++){const o=tryFile(e+t[n],r);if(o)return o}return!1}var warned=!1;Module._findPath=function(e,t,r){if(path.isAbsolute(e))t=[""];else if(!t||0===t.length)return!1;var n,o=e+"\0"+(1===t.length?t[0]:t.join("\0")),a=Module._pathCache[o];if(a)return a;var s=e.length>0&&e.charCodeAt(e.length-1)===CHAR_FORWARD_SLASH;s||(s=/(?:^|\/)\.?\.$/.test(e));for(var l=0;l<t.length;l++){const a=t[l];if(!(a&&stat(a)<1)){var i,u=path.resolve(a,e),d=stat(u);if(s||(0===d&&(i=r?preserveSymlinksMain?path.resolve(u):toRealPath(u):preserveSymlinks?path.resolve(u):toRealPath(u)),i||(void 0===n&&(n=Object.keys(Module._extensions)),i=tryExtensions(u,n,r))),i||1!==d||(void 0===n&&(n=Object.keys(Module._extensions)),(i=tryPackage(u,n,r))||(i=tryExtensions(path.resolve(u,"index"),n,r))),i)return"."===e&&l>0&&(warned||(warned=!0,process.emitWarning("warning: require('.') resolved outside the package directory. This functionality is deprecated and will be removed soon.","DeprecationWarning","DEP0019"))),Module._pathCache[o]=i,i}}return!1};var nmChars=[115,101,108,117,100,111,109,95,101,100,111,110],nmLen=nmChars.length;"win32"===process.platform?Module._nodeModulePaths=function(e){if((e=path.resolve(e)).charCodeAt(e.length-1)===CHAR_BACKWARD_SLASH&&e.charCodeAt(e.length-2)===CHAR_COLON)return[e+"node_modules"];const t=[];for(var r=0,n=e.length,o=e.length-1;o>=0;--o){const a=e.charCodeAt(o);a===CHAR_BACKWARD_SLASH||a===CHAR_FORWARD_SLASH||a===CHAR_COLON?(r!==nmLen&&t.push(e.slice(0,n)+"\\node_modules"),n=o,r=0):-1!==r&&(nmChars[r]===a?++r:r=-1)}return t}:Module._nodeModulePaths=function(e){if("/"===(e=path.resolve(e)))return["/node_modules"];const t=[];for(var r=0,n=e.length,o=e.length-1;o>=0;--o){const a=e.charCodeAt(o);a===CHAR_FORWARD_SLASH?(r!==nmLen&&t.push(e.slice(0,n)+"/node_modules"),n=o,r=0):-1!==r&&(nmChars[r]===a?++r:r=-1)}return t.push("/node_modules"),t};var resolvedArgv,indexChars=[105,110,100,101,120,46],indexLen=indexChars.length;function tryModuleLoad(e,t){var r=!0;try{e.load(t),r=!1}finally{r&&delete Module._cache[t]}}Module._resolveLookupPaths=function(e,t,r){if(NativeModule.nonInternalExists(e))return debug("looking for %j in []",e),r?null:[e,[]];if(e.length<2||e.charCodeAt(0)!==CHAR_DOT||e.charCodeAt(1)!==CHAR_DOT&&e.charCodeAt(1)!==CHAR_FORWARD_SLASH){var n=modulePaths;return t&&(n=t.paths?t.paths.concat(n):t.paths=[]),"."===e&&(t&&t.filename?n.unshift(path.dirname(t.filename)):n.unshift(path.resolve(e))),debug("looking for %j in %j",e,n),r?n.length>0?n:null:[e,n]}if(!t||!t.id||!t.filename){var o=["."].concat(Module._nodeModulePaths("."),modulePaths);return debug("looking for %j in %j",e,o),r?o:[e,o]}const a=path.basename(t.filename);var s;if(a.length>indexLen){for(var l=0;l<indexLen&&indexChars[l]===a.charCodeAt(l);++l);if(l===indexLen){for(;l<a.length;++l){const e=a.charCodeAt(l);if(e!==CHAR_UNDERSCORE&&(e<CHAR_0||e>CHAR_9)&&(e<CHAR_UPPERCASE_A||e>CHAR_UPPERCASE_Z)&&(e<CHAR_LOWERCASE_A||e>CHAR_LOWERCASE_Z))break}s=l===a.length?t.id:path.dirname(t.id)}else s=path.dirname(t.id)}else s=path.dirname(t.id);var i=path.resolve(s,e);"."===s&&-1===i.indexOf("/")&&(i="./"+i),debug("RELATIVE: requested: %s set ID to: %s from %s",e,i,t.id);var u=[path.dirname(t.filename)];return debug("looking for %j in %j",i,u),r?u:[i,u]},Module._load=function(e,t,r){t&&debug("Module._load REQUEST %s parent: %s",e,t.id);var n=Module._resolveFilename(e,t,r),o=Module._cache[n];if(o)return updateChildren(t,o,!0),o.exports;if(NativeModule.nonInternalExists(n))return debug("load native module %s",e),NativeModule.require(n);var a=new Module(n,t);return r&&(process.mainModule=a,a.id="."),Module._cache[n]=a,tryModuleLoad(a,n),a.exports},Module._resolveFilename=function(e,t,r,n){if(NativeModule.nonInternalExists(e))return e;var o;if("object"==typeof n&&null!==n&&Array.isArray(n.paths)){const t=new Module("",null);o=[];for(var a=0;a<n.paths.length;a++){const r=n.paths[a];t.paths=Module._nodeModulePaths(r);const l=Module._resolveLookupPaths(e,t,!0);o.includes(r)||o.push(r);for(var s=0;s<l.length;s++)o.includes(l[s])||o.push(l[s])}}else o=Module._resolveLookupPaths(e,t,!0);var l=Module._findPath(e,o,r);if(!l){var i=new Error(`Cannot find module '${e}'`);throw i.code="MODULE_NOT_FOUND",i}return l},Module.prototype.load=function(e){debug("load %j for module %j",e,this.id),assert(!this.loaded),this.filename=e,this.paths=Module._nodeModulePaths(path.dirname(e));var t=path.extname(e)||".js";if(Module._extensions[t]||(t=".js"),Module._extensions[t](this,e),this.loaded=!0,experimentalModules){void 0===asyncESM&&lazyLoadESM();const t=asyncESM.ESMLoader,r=pathToFileURL(e),n=`${r}`,o=this.exports;if(!0!==t.moduleMap.has(n))t.moduleMap.set(n,new ModuleJob(t,r,async()=>{const e=createDynamicModule(["default"],r);return e.reflect.exports.default.set(o),e}));else{const e=t.moduleMap.get(n);e.reflect&&e.reflect.exports.default.set(o)}}},Module.prototype.require=function(e){if("string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("id","string",e);if(""===e)throw new ERR_INVALID_ARG_VALUE("id",e,"must be a non-empty string");return Module._load(e,this,!1)},Module.prototype._compile=function(e,t){e=stripShebang(e);var r=Module.wrap(e),n=vm.runInThisContext(r,{filename:t,lineOffset:0,displayErrors:!0}),o=null;process._breakFirstLine&&null==process._eval&&(resolvedArgv||(resolvedArgv=process.argv[1]?Module._resolveFilename(process.argv[1],null,!1):"repl"),t===resolvedArgv&&(delete process._breakFirstLine,o=process.binding("inspector").callAndPauseOnStart));var a,s=path.dirname(t),l=makeRequireFunction(this),i=requireDepth;return 0===i&&(stat.cache=new Map),a=o?o(n,this.exports,this.exports,l,this,t,s):n.call(this.exports,this.exports,l,this,t,s),0===i&&(stat.cache=null),a},Module._extensions[".js"]=function(e,t){var r=fs.readFileSync(t,"utf8");e._compile(stripBOM(r),t)},Module._extensions[".json"]=function(e,t){var r=fs.readFileSync(t,"utf8");try{e.exports=JSON.parse(stripBOM(r))}catch(e){throw e.message=t+": "+e.message,e}},Module._extensions[".node"]=function(e,t){return process.dlopen(e,path.toNamespacedPath(t))},experimentalModules&&(void 0===asyncESM&&lazyLoadESM(),Module._extensions[".mjs"]=function(e,t){throw new ERR_REQUIRE_ESM(t)}),Module.runMain=function(){experimentalModules?(void 0===asyncESM&&lazyLoadESM(),asyncESM.loaderPromise.then(e=>e.import(pathToFileURL(process.argv[1]).pathname)).catch(e=>{decorateErrorStack(e),process.exit(1)})):Module._load(process.argv[1],null,!0),process._tickCallback()},Module.createRequireFromPath=(e=>{const t=new Module(e);return t.filename=e,t.paths=Module._nodeModulePaths(path.dirname(e)),makeRequireFunction(t)}),Module._initPaths=function(){const e="win32"===process.platform;var t,r,n;e?(t=process.env.USERPROFILE,r=process.env.NODE_PATH):(t=safeGetenv("HOME"),r=safeGetenv("NODE_PATH")),n=e?path.resolve(process.execPath,".."):path.resolve(process.execPath,"..","..");var o=[path.resolve(n,"lib","node")];t&&(o.unshift(path.resolve(t,".node_libraries")),o.unshift(path.resolve(t,".node_modules"))),r&&(o=r.split(path.delimiter).filter(function(e){return!!e}).concat(o)),modulePaths=o,Module.globalPaths=modulePaths.slice(0)},Module._preloadModules=function(e){if(Array.isArray(e)){var t=new Module("internal/preload",null);try{t.paths=Module._nodeModulePaths(process.cwd())}catch(e){if("ENOENT"!==e.code)throw e}for(var r=0;r<e.length;r++)t.require(e[r])}},Module._initPaths(),Module.Module=Module;"use strict";const{ModuleWrap}=internalBinding("module_wrap"),debug=require("util").debuglog("esm"),ArrayJoin=Function.call.bind(Array.prototype.join),ArrayMap=Function.call.bind(Array.prototype.map),createDynamicModule=(e,n="",r)=>{debug(`creating ESM facade for ${n} with exports: ${ArrayJoin(e,", ")}`);const t=ArrayMap(e,e=>`${e}`),a=`\n  export let executor;\n  ${ArrayJoin(ArrayMap(t,e=>`export let $${e};`),"\n")}\n  /* This function is implicitly returned as the module's completion value */\n  (() => ({\n    setExecutor: fn => executor = fn,\n    reflect: {\n      exports: { ${ArrayJoin(ArrayMap(t,e=>`\n        ${e}: {\n          get: () => $${e},\n          set: v => $${e} = v\n        }`),", \n")}\n      }\n    }\n  }));`,o=new ModuleWrap(a,`cjs-facade:${n}`);o.instantiate();const{setExecutor:i,reflect:c}=o.evaluate(-1,!1)(),l=`\n  import {\n    executor,\n    ${ArrayMap(t,e=>`$${e}`)}\n  } from "";\n  export {\n    ${ArrayJoin(ArrayMap(t,e=>`$${e} as ${e}`),", ")}\n  }\n  if (typeof executor === "function") {\n    // add await to this later if top level await comes along\n    executor()\n  }`;"function"==typeof r&&i(()=>r(c));const u=new ModuleWrap(l,`${n}`);return u.link(async()=>o),u.instantiate(),c.namespace=u.namespace(),{module:u,reflect:c}};module.exports=createDynamicModule;"use strict";const{URL}=require("url"),CJSmodule=require("internal/modules/cjs/loader"),internalFS=require("internal/fs/utils"),{NativeModule}=require("internal/bootstrap/loaders"),{extname}=require("path"),{realpathSync}=require("fs"),{getOptionValue}=require("internal/options"),preserveSymlinks=getOptionValue("--preserve-symlinks"),preserveSymlinksMain=getOptionValue("--preserve-symlinks-main"),{ERR_MISSING_MODULE,ERR_MODULE_RESOLUTION_LEGACY,ERR_UNKNOWN_FILE_EXTENSION}=require("internal/errors").codes,{resolve:moduleWrapResolve}=internalBinding("module_wrap"),StringStartsWith=Function.call.bind(String.prototype.startsWith),{pathToFileURL,fileURLToPath}=require("internal/url"),realpathCache=new Map;function search(e,t){if(void 0===t)throw new ERR_MISSING_MODULE(e);try{return moduleWrapResolve(e,t)}catch(r){r.stack;let n=r;try{const r=new URL(t),a=new CJSmodule(r.pathname,null);a.paths=CJSmodule._nodeModulePaths(new URL("./",r).pathname);const o=CJSmodule._resolveFilename(e,a);n=new ERR_MODULE_RESOLUTION_LEGACY(e,t,o)}catch{}throw n}}const extensionFormatMap={__proto__:null,".mjs":"esm",".json":"json",".node":"addon",".js":"cjs"};function resolve(e,t){if(NativeModule.nonInternalExists(e))return{url:e,format:"builtin"};let r;try{r=search(e,t||pathToFileURL(`${process.cwd()}/`).href)}catch(e){throw"string"==typeof e.message&&StringStartsWith(e.message,"Cannot find module")&&(e.code="MODULE_NOT_FOUND"),e}const n=void 0===t;if(n?!preserveSymlinksMain:!preserveSymlinks){const e=realpathSync(fileURLToPath(r),{[internalFS.realpathCacheKey]:realpathCache}),t=r;(r=pathToFileURL(e)).search=t.search,r.hash=t.hash}const a=extname(r.pathname);let o=extensionFormatMap[a];if(!o){if(!n)throw new ERR_UNKNOWN_FILE_EXTENSION(r.pathname);o="cjs"}return{url:`${r}`,format:o}}module.exports=resolve,module.exports.search=search;"use strict";const{ERR_INVALID_ARG_TYPE,ERR_INVALID_RETURN_PROPERTY,ERR_INVALID_RETURN_PROPERTY_VALUE,ERR_INVALID_RETURN_VALUE,ERR_MISSING_DYNAMIC_INSTANTIATE_HOOK,ERR_UNKNOWN_MODULE_FORMAT}=require("internal/errors").codes,{URL}=require("url"),ModuleMap=require("internal/modules/esm/module_map"),ModuleJob=require("internal/modules/esm/module_job"),defaultResolve=require("internal/modules/esm/default_resolve"),createDynamicModule=require("internal/modules/esm/create_dynamic_module"),translators=require("internal/modules/esm/translators"),FunctionBind=Function.call.bind(Function.prototype.bind),debug=require("util").debuglog("esm");class Loader{constructor(){this.translators=translators,this.moduleMap=new ModuleMap,this._resolve=defaultResolve,this._dynamicInstantiate=void 0}async resolve(e,t){if(!(void 0===t)&&"string"!=typeof t)throw new ERR_INVALID_ARG_TYPE("parentURL","string",t);const r=await this._resolve(e,t,defaultResolve);if("object"!=typeof r)throw new ERR_INVALID_RETURN_VALUE("object","loader resolve",r);const{url:o,format:n}=r;if("string"!=typeof o)throw new ERR_INVALID_RETURN_PROPERTY_VALUE("string","loader resolve","url",o);if("string"!=typeof n)throw new ERR_INVALID_RETURN_PROPERTY_VALUE("string","loader resolve","format",n);if("builtin"===n)return{url:`node:${o}`,format:n};if(this._resolve!==defaultResolve)try{new URL(o)}catch{throw new ERR_INVALID_RETURN_PROPERTY("url","loader resolve","url",o)}if("dynamic"!==n&&!o.startsWith("file:"))throw new ERR_INVALID_RETURN_PROPERTY("file: url","loader resolve","url",o);return{url:o,format:n}}async import(e,t){const r=await this.getModuleJob(e,t);return(await r.run()).namespace()}hook({resolve:e,dynamicInstantiate:t}){void 0!==e&&(this._resolve=FunctionBind(e,null)),void 0!==t&&(this._dynamicInstantiate=FunctionBind(t,null))}async getModuleJob(e,t){const{url:r,format:o}=await this.resolve(e,t);let n,i=this.moduleMap.get(r);if(void 0!==i)return i;if("dynamic"===o){if("function"!=typeof this._dynamicInstantiate)throw new ERR_MISSING_DYNAMIC_INSTANTIATE_HOOK;n=(async e=>{debug(`Translating dynamic ${e}`);const{exports:t,execute:r}=await this._dynamicInstantiate(e);return createDynamicModule(t,e,t=>{debug(`Loading dynamic ${e}`),r(t.exports)})})}else{if(!translators.has(o))throw new ERR_UNKNOWN_MODULE_FORMAT(o);n=translators.get(o)}return i=new ModuleJob(this,r,n,void 0===t),this.moduleMap.set(r,i),i}}Object.setPrototypeOf(Loader.prototype,null),module.exports=Loader;"use strict";const{ModuleWrap}=internalBinding("module_wrap"),{SafeSet,SafePromise}=require("internal/safe_globals"),{decorateErrorStack}=require("internal/util"),assert=require("assert"),resolvedPromise=SafePromise.resolve();class ModuleJob{constructor(e,t,i,s){this.loader=e,this.isMain=s,this.modulePromise=i(t,s),this.module=void 0,this.reflect=void 0;this.linked=(async()=>{({module:this.module,reflect:this.reflect}=await this.modulePromise),assert(this.module instanceof ModuleWrap);const e=[],i=this.module.link(async i=>{const s=this.loader.getModuleJob(i,t);return e.push(s),(await(await s).modulePromise).module});return void 0!==i&&await SafePromise.all(i),SafePromise.all(e)})(),this.instantiated=void 0}async instantiate(){return this.instantiated?(await this.instantiated,this.module):this.instantiated=this._instantiate()}async _instantiate(){const e=new SafeSet,t=async i=>{if(e.has(i))return;e.add(i);const s=await i.linked;return Promise.all(s.map(t))};await t(this);try{if(this.isMain&&process._breakFirstLine){delete process._breakFirstLine,(0,process.binding("inspector").callAndPauseOnStart)(this.module.instantiate,this.module)}else this.module.instantiate()}catch(e){throw decorateErrorStack(e),e}for(const t of e)t.instantiated=resolvedPromise;return this.module}async run(){const e=await this.instantiate();return e.evaluate(-1,!1),e}}Object.setPrototypeOf(ModuleJob.prototype,null),module.exports=ModuleJob;"use strict";const ModuleJob=require("internal/modules/esm/module_job"),{SafeMap}=require("internal/safe_globals"),debug=require("util").debuglog("esm"),{ERR_INVALID_ARG_TYPE}=require("internal/errors").codes;class ModuleMap extends SafeMap{get(e){if("string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("url","string",e);return super.get(e)}set(e,r){if("string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("url","string",e);if(r instanceof ModuleJob!=!0)throw new ERR_INVALID_ARG_TYPE("job","ModuleJob",r);return debug(`Storing ${e} in ModuleMap`),super.set(e,r)}has(e){if("string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("url","string",e);return super.has(e)}}module.exports=ModuleMap;"use strict";const{NativeModule}=require("internal/bootstrap/loaders"),{ModuleWrap}=internalBinding("module_wrap"),{stripShebang,stripBOM}=require("internal/modules/cjs/helpers"),CJSModule=require("internal/modules/cjs/loader"),internalURLModule=require("internal/url"),createDynamicModule=require("internal/modules/esm/create_dynamic_module"),fs=require("fs"),{_makeLong}=require("path"),{SafeMap}=require("internal/safe_globals"),{URL}=require("url"),{debuglog,promisify}=require("util"),readFileAsync=promisify(fs.readFile),readFileSync=fs.readFileSync,StringReplace=Function.call.bind(String.prototype.replace),JsonParse=JSON.parse,debug=debuglog("esm"),translators=new SafeMap;module.exports=translators,translators.set("esm",async e=>{const t=`${await readFileAsync(new URL(e))}`;return debug(`Translating StandardModule ${e}`),{module:new ModuleWrap(stripShebang(t),e),reflect:void 0}});const isWindows="win32"===process.platform,winSepRegEx=/\//g;translators.set("cjs",async(e,t)=>{debug(`Translating CJSModule ${e}`);const a=internalURLModule.fileURLToPath(new URL(e)),r=CJSModule._cache[isWindows?StringReplace(a,winSepRegEx,"\\"):a];if(r&&r.loaded){const t=createDynamicModule(["default"],e);return t.reflect.exports.default.set(r.exports),t}return createDynamicModule(["default"],e,()=>{debug(`Loading CJSModule ${e}`),CJSModule._load(a,void 0,t)})}),translators.set("builtin",async e=>{debug(`Translating BuiltinModule ${e}`);const t=e.slice(5);NativeModule.require(t);const a=NativeModule.getCached(t);return createDynamicModule([...a.exportKeys,"default"],e,t=>{debug(`Loading BuiltinModule ${e}`),a.reflect=t;for(const e of a.exportKeys)t.exports[e].set(a.exports[e]);t.exports.default.set(a.exports)})}),translators.set("addon",async e=>(debug(`Translating NativeModule ${e}`),createDynamicModule(["default"],e,t=>{debug(`Loading NativeModule ${e}`);const a={exports:{}},r=internalURLModule.fileURLToPath(new URL(e));process.dlopen(a,_makeLong(r)),t.exports.default.set(a.exports)}))),translators.set("json",async e=>(debug(`Translating JSONModule ${e}`),createDynamicModule(["default"],e,t=>{debug(`Loading JSONModule ${e}`);const a=internalURLModule.fileURLToPath(new URL(e)),r=readFileSync(a,"utf8");try{const e=JsonParse(stripBOM(r));t.exports.default.set(e)}catch(e){throw e.message=a+": "+e.message,e}})));"use strict";const Buffer=require("buffer").Buffer,{writeBuffer}=process.binding("fs"),errors=require("internal/errors"),v4Seg="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",v4Str=`(${v4Seg}[.]){3}${v4Seg}`,IPv4Reg=new RegExp(`^${v4Str}$`),v6Seg="(?:[0-9a-fA-F]{1,4})",IPv6Reg=new RegExp("^("+`(?:${v6Seg}:){7}(?:${v6Seg}|:)|`+`(?:${v6Seg}:){6}(?:${v4Str}|:${v6Seg}|:)|`+`(?:${v6Seg}:){5}(?::${v4Str}|(:${v6Seg}){1,2}|:)|`+`(?:${v6Seg}:){4}(?:(:${v6Seg}){0,1}:${v4Str}|(:${v6Seg}){1,3}|:)|`+`(?:${v6Seg}:){3}(?:(:${v6Seg}){0,2}:${v4Str}|(:${v6Seg}){1,4}|:)|`+`(?:${v6Seg}:){2}(?:(:${v6Seg}){0,3}:${v4Str}|(:${v6Seg}){1,5}|:)|`+`(?:${v6Seg}:){1}(?:(:${v6Seg}){0,4}:${v4Str}|(:${v6Seg}){1,6}|:)|`+`(?::((?::${v6Seg}){0,5}:${v4Str}|(?::${v6Seg}){1,7}|:))`+")(%[0-9a-zA-Z]{1,})?$");function isIPv4(e){return IPv4Reg.test(e)}function isIPv6(e){return IPv6Reg.test(e)}function isIP(e){return isIPv4(e)?4:isIPv6(e)?6:0}function isLegalPort(e){return!("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===e.trim().length)&&(+e==+e>>>0&&e<=65535)}function makeSyncWrite(e){return function(r,t,v){"buffer"!==t&&(r=Buffer.from(r,t)),this._handle.bytesWritten+=r.length;const n={};if(writeBuffer(e,r,0,r.length,null,void 0,n),void 0!==n.errno){const e=errors.uvException(n);return e.errno=e.code,v(e)}v()}}module.exports={isIP,isIPv4,isIPv6,isLegalPort,makeSyncWrite,normalizedArgsSymbol:Symbol("normalizedArgs")};"use strict";const{getOptions}=internalBinding("options"),{options,aliases}=getOptions();function getOptionValue(t){const o=options.get(t);if(o)return o.value}module.exports={options,aliases,getOptionValue};"use strict";!function(e){e.Intl&&delete e.Intl.v8BreakIterator;const t=e.Atomics.wake,i=e.Reflect.apply;const n="Atomics.wake will be removed in a future version, use Atomics.notify instead.";let o=!1;e.Object.defineProperties(e.Atomics,{notify:{value:function(...e){return i(t,this,e)},writable:!0,enumerable:!1,configurable:!0},wake:{value:function(...r){return o||(o=!0,void 0!==e.process?e.process.emitWarning(n,"Atomics"):e.console.error(`Atomics: ${n}`)),i(t,this,r)},writable:!0,enumerable:!1,configurable:!0}})}(this);"use strict";const{types}=internalBinding("options"),typeLookup=[];for(const e of Object.keys(types))typeLookup[types[e]]=e;const{hasIntl,hasSmallICU,hasNodeOptions}=process.binding("config"),envVars=new Map([["NODE_DEBUG",{helpText:"','-separated list of core modules that should print debug information"}],["NODE_DEBUG_NATIVE",{helpText:"','-separated list of C++ core debug categories that should print debug output"}],["NODE_DISABLE_COLORS",{helpText:"set to 1 to disable colors in the REPL"}],["NODE_EXTRA_CA_CERTS",{helpText:"path to additional CA certificates file"}],["NODE_NO_WARNINGS",{helpText:"set to 1 to silence process warnings"}],["NODE_PATH",{helpText:`'${require("path").delimiter}'-separated list `+"of directories prefixed to the module search path"}],["NODE_PENDING_DEPRECATION",{helpText:"set to 1 to emit pending deprecation warnings"}],["NODE_PRESERVE_SYMLINKS",{helpText:"set to 1 to preserve symbolic links when resolving and caching modules"}],["NODE_REDIRECT_WARNINGS",{helpText:"write warnings to path instead of stderr"}],["NODE_REPL_HISTORY",{helpText:"path to the persistent REPL history file"}],["NODE_V8_COVERAGE",{helpText:"directory to output v8 coverage JSON to"}],["OPENSSL_CONF",{helpText:"load OpenSSL configuration from file"}]].concat(hasIntl?[["NODE_ICU_DATA",{helpText:""}]]:[]).concat(hasNodeOptions?[["NODE_OPTIONS",{helpText:"set CLI options in the environment via a space-separated list"}]]:[]));function indent(e,t){return e.replace(/^/gm," ".repeat(t))}function fold(e,t){return e.replace(new RegExp(`([^\n]{0,${t}})( |$)`,"g"),(e,t,n)=>t+(" "===n?"\n":""))}function getArgDescription(e){switch(typeLookup[e]){case"kNoOp":case"kV8Option":case"kBoolean":break;case"kHostPort":return"[host:]port";case"kInteger":case"kUInteger":case"kString":case"kStringList":return"...";case void 0:break;default:require("assert").fail(`unknown option type ${e}`)}}function format({options:e,aliases:t=new Map,firstColumn:n,secondColumn:o}){let s="",i=0;for(const[r,{helpText:a,type:p,value:l}]of[...e.entries()].sort()){if(!a)continue;let c=r;const d=getArgDescription(p);d&&(c+=`=${d}`);for(const[n,o]of t){o[0]===r&&1===o.length&&(c=`${n}, ${c}`);const t=e.get(o[0]),s=t?getArgDescription(t.type):"...";n===`${r}=`?c+=`[=${s}]`:n===`${r} <arg>`&&(c+=` [${s}]`)}let h=a;!0===l&&(h+=" (currently set)"),s+=c,i=Math.max(i,c.length),c.length>=n?s+="\n"+" ".repeat(n):s+=" ".repeat(n-c.length),s+=indent(fold(h,o),n).trimLeft()+"\n"}return i<n-4?format({options:e,aliases:t,firstColumn:i+2,secondColumn:o}):s}function print(e){const{options:t,aliases:n}=require("internal/options"),o=Math.max(70,.75*(e.columns||0)),s=Math.floor(.4*o),i=Math.floor(.57*o);t.set("-",{helpText:"script read from stdin (default if no file name is provided, interactive mode if a tty)"}),t.set("--",{helpText:"indicate the end of node options"}),e.write("Usage: node [options] [ -e script | script.js | - ] [arguments]\n       node inspect script.js [arguments]\n\nOptions:\n"),e.write(indent(format({options:t,aliases:n,firstColumn:s,secondColumn:i}),2)),e.write("\nEnvironment variables:\n"),e.write(format({options:envVars,firstColumn:s,secondColumn:i})),e.write("\nDocumentation can be found at https://nodejs.org/\n")}module.exports={print};"use strict";const path=require("path"),{mkdirSync,writeFileSync}=require("fs"),hasInspector=1===process.config.variables.v8_enable_inspector;let session,inspector=null;function writeCoverage(){if(!session)return;const{threadId:e}=require("internal/worker"),s=`coverage-${process.pid}-${Date.now()}-${e}.json`;try{mkdirSync(process.env.NODE_V8_COVERAGE)}catch(e){if("EEXIST"!==e.code)return}const r=path.join(process.env.NODE_V8_COVERAGE,s);try{session.post("Profiler.takePreciseCoverage",(e,s)=>{if(!e)try{writeFileSync(r,JSON.stringify(s))}catch(e){}})}catch(e){}finally{session.disconnect(),session=null}}function setup(){if(!hasInspector)return;(session=new inspector.Session).connect(),session.post("Profiler.enable"),session.post("Profiler.startPreciseCoverage",{callCount:!0,detailed:!0});const e=process.reallyExit;process.reallyExit=function(s){writeCoverage(),e(s)},process.on("exit",writeCoverage)}hasInspector&&(inspector=require("inspector")),exports.writeCoverage=writeCoverage,exports.setup=setup;"use strict";const{setImportModuleDynamicallyCallback,setInitializeImportMetaObjectCallback}=internalBinding("module_wrap"),{pathToFileURL}=require("internal/url"),Loader=require("internal/modules/esm/loader"),path=require("path"),{URL}=require("url"),{initImportMetaMap,wrapToModuleMap}=require("internal/vm/source_text_module");function normalizeReferrerURL(e){return"string"==typeof e&&path.isAbsolute(e)?pathToFileURL(e).href:new URL(e).href}function initializeImportMetaObject(e,t){const r=wrapToModuleMap.get(e);if(void 0===r)t.url=e.url;else{const e=initImportMetaMap.get(r);void 0!==e&&e(t,r)}}let loaderResolve;exports.loaderPromise=new Promise((e,t)=>{loaderResolve=e}),exports.ESMLoader=void 0,exports.setup=function(){setInitializeImportMetaObjectCallback(initializeImportMetaObject);let e=new Loader;const t=(async()=>{const t=require("internal/options").getOptionValue("--loader");if(t){const r=await e.import(t,pathToFileURL(`${process.cwd()}/`).href);(e=new Loader).hook(r),exports.ESMLoader=e}return e})();loaderResolve(t),setImportModuleDynamicallyCallback(async(e,r)=>{return(await t).import(r,normalizeReferrerURL(e))}),exports.ESMLoader=e};"use strict";const{errnoException}=require("internal/errors"),{setupProcessStdio,getMainThreadStdio}=require("internal/process/stdio"),assert=require("assert").strict;function setupStdio(){setupProcessStdio(getMainThreadStdio())}function setupProcessMethods(e,s,t,n,o,r,i,c){void 0!==r&&setupPosixMethods(t,n,o,r,i,c),process.chdir=function(...s){return e(...s)},process.umask=function(...e){return s(...e)}}function setupPosixMethods(e,s,t,n,o,r){process.initgroups=function(...s){return e(...s)},process.setegid=function(...e){return s(...e)},process.seteuid=function(...e){return t(...e)},process.setgid=function(...e){return n(...e)},process.setuid=function(...e){return o(...e)},process.setgroups=function(...e){return r(...e)}}function setupSignalHandlers(){const e=process.binding("constants").os.signals,s=Object.create(null);let t;process.on("newListener",function(n){if("string"==typeof(o=n)&&void 0!==e[o]&&void 0===s[n]){void 0===t&&(t=process.binding("signal_wrap").Signal);const o=new t;o.unref(),o.onsignal=process.emit.bind(process,n,n);const r=e[n],i=o.start(r);if(i)throw o.close(),errnoException(i,"uv_signal_start");s[n]=o}var o}),process.on("removeListener",function(e){void 0!==s[e]&&0===this.listenerCount(e)&&(s[e].close(),delete s[e])})}function setupChildProcessIpcChannel(){if(process.env.NODE_CHANNEL_FD){const e=parseInt(process.env.NODE_CHANNEL_FD,10);assert(e>=0),delete process.env.NODE_CHANNEL_FD,require("child_process")._forkChild(e),assert(process.send)}}module.exports={setupStdio,setupProcessMethods,setupSignalHandlers,setupChildProcessIpcChannel};"use strict";function setupNextTick(e,s){const{getDefaultTriggerAsyncId:t,newAsyncId:i,initHooksExist:r,destroyHooksExist:c,emitInit:n,emitBefore:o,emitAfter:a,emitDestroy:l,symbols:{async_id_symbol:u,trigger_async_id_symbol:f}}=require("internal/async_hooks"),k=require("internal/process/promises").setup(s),{ERR_INVALID_CALLBACK:p}=require("internal/errors").codes,h=require("internal/fixed_queue"),[y,b]=e(m),g=0,d=1,_=new h;function m(){let e;do{for(;e=_.shift();){const s=e[u];o(s,e[f]),c()&&l(s);const t=e.callback;void 0===e.args?t():Reflect.apply(t,void 0,e.args),a(s)}y[g]=0,b()}while(!_.isEmpty()||k());y[d]=0}process.nextTick=function(e){if("function"!=typeof e)throw new p;if(process._exiting)return;var s;switch(arguments.length){case 1:break;case 2:s=[arguments[1]];break;case 3:s=[arguments[1],arguments[2]];break;case 4:s=[arguments[1],arguments[2],arguments[3]];break;default:s=new Array(arguments.length-1);for(var i=1;i<arguments.length;i++)s[i-1]=arguments[i]}_.isEmpty()&&(y[g]=1);_.push(new w(e,s,t()))},process._tickCallback=m;class w{constructor(e,s,t){this.callback=null,this.callback=e,this.args=s;const c=i();this[u]=c,this[f]=t,r()&&n(c,"TickObject",t,this)}}}exports.setup=setupNextTick;"use strict";const{errnoException,codes:{ERR_ASSERTION,ERR_CPU_USAGE,ERR_INVALID_ARG_TYPE,ERR_INVALID_ARRAY_LENGTH,ERR_INVALID_OPT_VALUE,ERR_UNCAUGHT_EXCEPTION_CAPTURE_ALREADY_SET,ERR_UNKNOWN_SIGNAL}}=require("internal/errors"),util=require("util"),constants=process.binding("constants").os.signals,{deprecate}=require("internal/util");function setupAssert(){process.assert=deprecate(function(e,t){if(!e)throw new ERR_ASSERTION(t||"assertion error")},"process.assert() is deprecated. Please use the `assert` module instead.","DEP0100")}function setupCpuUsage(e){const t=new Float64Array(2);function r(e){return Number.isFinite(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=0}process.cpuUsage=function(s){if(s){if(!r(s.user)){if("object"!=typeof s)throw new ERR_INVALID_ARG_TYPE("prevValue","object",s);if("number"!=typeof s.user)throw new ERR_INVALID_ARG_TYPE("prevValue.user","number",s.user);throw new ERR_INVALID_OPT_VALUE.RangeError("prevValue.user",s.user)}if(!r(s.system)){if("number"!=typeof s.system)throw new ERR_INVALID_ARG_TYPE("prevValue.system","number",s.system);throw new ERR_INVALID_OPT_VALUE.RangeError("prevValue.system",s.system)}}const n=e(t);if(n)throw new ERR_CPU_USAGE(n);return s?{user:t[0]-s.user,system:t[1]-s.system}:{user:t[0],system:t[1]}}}function setupHrtime(e,t){const r=new Uint32Array(3);process.hrtime=function(t){if(e(r),void 0!==t){if(!Array.isArray(t))throw new ERR_INVALID_ARG_TYPE("time","Array",t);if(2!==t.length)throw new ERR_INVALID_ARRAY_LENGTH("time",2,t.length);const e=4294967296*r[0]+r[1]-t[0],s=r[2]-t[1],n=s<0;return[n?e-1:e,n?s+1e9:s]}return[4294967296*r[0]+r[1],r[2]]};const s=new BigUint64Array(1);process.hrtime.bigint=function(){return t(s),s[0]}}function setupMemoryUsage(e){const t=new Float64Array(4);process.memoryUsage=function(){return e(t),{rss:t[0],heapTotal:t[1],heapUsed:t[2],external:t[3]}}}function setupConfig(e){const t=e.config;delete e.config,process.config=JSON.parse(t,function(e,t){return"true"===t||"false"!==t&&t})}function setupKillAndExit(){process.exit=function(e){(e||0===e)&&(process.exitCode=e),process._exiting||(process._exiting=!0,process.emit("exit",process.exitCode||0)),process.reallyExit(process.exitCode||0)},process.kill=function(e,t){var r;if(process.env.NODE_V8_COVERAGE){const{writeCoverage:e}=require("internal/process/coverage");e()}if(e!=(0|e))throw new ERR_INVALID_ARG_TYPE("pid","number",e);if(t===(0|t))r=process._kill(e,t);else{if(!constants[t=t||"SIGTERM"])throw new ERR_UNKNOWN_SIGNAL(t);r=process._kill(e,constants[t])}if(r)throw errnoException(r,"kill");return!0}}function setupRawDebug(e){process._rawDebug=function(){e(util.format.apply(null,arguments))}}function setupUncaughtExceptionCapture(e,t){process.setUncaughtExceptionCaptureCallback=function(r){if(null===r)return e.captureFn=r,void(t[0]=1);if("function"!=typeof r)throw new ERR_INVALID_ARG_TYPE("fn",["Function","null"],r);if(null!==e.captureFn)throw new ERR_UNCAUGHT_EXCEPTION_CAPTURE_ALREADY_SET;e.captureFn=r,t[0]=0},process.hasUncaughtExceptionCaptureCallback=function(){return null!==e.captureFn}}module.exports={setupAssert,setupCpuUsage,setupHrtime,setupMemoryUsage,setupConfig,setupKillAndExit,setupRawDebug,setupUncaughtExceptionCapture};"use strict";const{safeToString}=internalBinding("util"),maybeUnhandledPromises=new WeakMap,pendingUnhandledRejections=[],asyncHandledRejections=[],promiseRejectEvents={};let lastPromiseId=0;function setupPromises(e){return e(handler,promiseRejectEvents),emitPromiseRejectionWarnings}function handler(e,n,r){switch(e){case promiseRejectEvents.kPromiseRejectWithNoHandler:return unhandledRejection(n,r);case promiseRejectEvents.kPromiseHandlerAddedAfterReject:return handledRejection(n);case promiseRejectEvents.kPromiseResolveAfterResolved:return resolveError("resolve",n,r);case promiseRejectEvents.kPromiseRejectAfterResolved:return resolveError("reject",n,r)}}function resolveError(e,n,r){process.nextTick(()=>{process.emit("multipleResolves",e,n,r)})}function unhandledRejection(e,n){return maybeUnhandledPromises.set(e,{reason:n,uid:++lastPromiseId,warned:!1}),pendingUnhandledRejections.push(e),!0}function handledRejection(e){const n=maybeUnhandledPromises.get(e);if(void 0!==n&&(maybeUnhandledPromises.delete(e),n.warned)){const{uid:r}=n,t=new Error("Promise rejection was handled "+`asynchronously (rejection id: ${r})`);return t.name="PromiseRejectionHandledWarning",t.id=r,asyncHandledRejections.push({promise:e,warning:t}),!0}return!1}exports.setup=setupPromises;const unhandledRejectionErrName="UnhandledPromiseRejectionWarning";function emitWarning(e,n){const r=new Error("Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). "+`(rejection id: ${e})`);r.name=unhandledRejectionErrName;try{n instanceof Error?(r.stack=n.stack,process.emitWarning(n.stack,unhandledRejectionErrName)):process.emitWarning(safeToString(n),unhandledRejectionErrName)}catch{}process.emitWarning(r),emitDeprecationWarning()}let deprecationWarned=!1;function emitDeprecationWarning(){deprecationWarned||(deprecationWarned=!0,process.emitWarning("Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.","DeprecationWarning","DEP0018"))}function emitPromiseRejectionWarnings(){for(;asyncHandledRejections.length>0;){const{promise:e,warning:n}=asyncHandledRejections.shift();process.emit("rejectionHandled",e)||process.emitWarning(n)}let e=!1,n=pendingUnhandledRejections.length;for(;n--;){const n=pendingUnhandledRejections.shift(),r=maybeUnhandledPromises.get(n);if(void 0!==r){r.warned=!0;const{reason:t,uid:i}=r;process.emit("unhandledRejection",t,n)?e=!0:emitWarning(i,t)}}return e||0!==pendingUnhandledRejections.length}"use strict";const{ERR_UNKNOWN_STDIN_TYPE,ERR_UNKNOWN_STREAM_TYPE}=require("internal/errors").codes;function dummyDestroy(e,r){r(e)}function getMainThreadStdio(){var e,r,t;return{getStdout:function(){return r||((r=createWritableStdioStream(1)).destroySoon=r.destroy,r._destroy=dummyDestroy,r.isTTY&&process.on("SIGWINCH",()=>r._refreshSize()),r)},getStderr:function(){return t||((t=createWritableStdioStream(2)).destroySoon=t.destroy,r._destroy=dummyDestroy,t.isTTY&&process.on("SIGWINCH",()=>t._refreshSize()),t)},getStdin:function(){if(e)return e;switch(internalBinding("tty_wrap").guessHandleType(0)){case"TTY":var r=require("tty");e=new r.ReadStream(0,{highWaterMark:0,readable:!0,writable:!1});break;case"FILE":var t=require("fs");e=new t.ReadStream(null,{fd:0,autoClose:!1});break;case"PIPE":case"TCP":var a=require("net");(e=process.channel&&0===process.channel.fd?new a.Socket({handle:process.channel,readable:!0,writable:!1,manualStart:!0}):new a.Socket({fd:0,readable:!0,writable:!1,manualStart:!0}))._writableState.ended=!0;break;default:throw new ERR_UNKNOWN_STDIN_TYPE}function n(){e._handle&&e._handle.reading&&!e._readableState.flowing&&(e._readableState.reading=!1,e._handle.reading=!1,e._handle.readStop())}return e.fd=0,e._handle&&e._handle.readStop&&(e._handle.reading=!1,e._readableState.reading=!1,e._handle.readStop()),e.on("pause",()=>{process.nextTick(n)}),e}}}function setupProcessStdio({getStdout:e,getStdin:r,getStderr:t}){Object.defineProperty(process,"stdout",{configurable:!0,enumerable:!0,get:e}),Object.defineProperty(process,"stderr",{configurable:!0,enumerable:!0,get:t}),Object.defineProperty(process,"stdin",{configurable:!0,enumerable:!0,get:r}),process.openStdin=function(){return process.stdin.resume(),process.stdin}}function createWritableStdioStream(e){var r;switch(internalBinding("tty_wrap").guessHandleType(e)){case"TTY":(r=new(require("tty").WriteStream)(e))._type="tty";break;case"FILE":(r=new(require("internal/fs/sync_write_stream"))(e,{autoClose:!1}))._type="fs";break;case"PIPE":case"TCP":var t=require("net");(r=process.channel&&process.channel.fd===e?new t.Socket({handle:process.channel,readable:!1,writable:!0}):new t.Socket({fd:e,readable:!1,writable:!0}))._type="pipe";break;default:throw new ERR_UNKNOWN_STREAM_TYPE}return r.fd=e,r._isStdio=!0,r}exports.setupProcessStdio=setupProcessStdio,exports.getMainThreadStdio=getMainThreadStdio;"use strict";const config=process.binding("config"),prefix=`(${process.release.name}:${process.pid}) `,{ERR_INVALID_ARG_TYPE}=require("internal/errors").codes;var cachedFd;exports.setup=setupProcessWarnings;var acquiringFd=!1;function nop(){}var fs=null;function writeOut(n){console&&"function"==typeof console.error||process._rawDebug(n)}function onClose(n){return function(){null===fs&&(fs=require("fs")),fs.close(n,nop)}}function onOpen(n){return function(r,e){acquiringFd=!1,void 0!==e&&(cachedFd=e,process.on("exit",onClose(e))),n(r,e),process.emit("_node_warning_fd_acquired",r,e)}}function onAcquired(n){return function(r,e){if(r)return writeOut(n);null===fs&&(fs=require("fs")),fs.appendFile(e,`${n}\n`,nop)}}function acquireFd(n){void 0!==cachedFd||acquiringFd?void 0===cachedFd||acquiringFd?process.once("_node_warning_fd_acquired",n):n(null,cachedFd):(acquiringFd=!0,null===fs&&(fs=require("fs")),fs.open(config.warningFile,"a",onOpen(n)))}function output(n){"string"!=typeof config.warningFile?writeOut(n):acquireFd(onAcquired(n))}function doEmitWarning(n){return function(){process.emit("warning",n)}}function setupProcessWarnings(){process.noProcessWarnings||"1"===process.env.NODE_NO_WARNINGS||process.on("warning",n=>{if(!(n instanceof Error))return;const r="DeprecationWarning"===n.name;if(r&&process.noDeprecation)return;const e=process.traceProcessWarnings||r&&process.traceDeprecation;var o=prefix;if(n.code&&(o+=`[${n.code}] `),e&&n.stack)o+=`${n.stack}`;else{o+=`${("function"==typeof n.toString?n.toString:Error.prototype.toString).apply(n)}`}"string"==typeof n.detail&&(o+=`\n${n.detail}`),output(o)}),process.emitWarning=function(n,r,e,o,i){var t;if(null===r||"object"!=typeof r||Array.isArray(r)?"function"==typeof r&&(o=r,e=void 0,r="Warning"):(o=r.ctor,e=r.code,"string"==typeof r.detail&&(t=r.detail),r=r.type||"Warning"),"function"==typeof e&&(o=e,e=void 0),void 0!==e&&"string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("code","string",e);if(void 0!==r&&"string"!=typeof r)throw new ERR_INVALID_ARG_TYPE("type","string",r);if(void 0!==n&&"string"!=typeof n||((n=new Error(n)).name=String(r||"Warning"),void 0!==e&&(n.code=e),void 0!==t&&(n.detail=t),Error.captureStackTrace(n,o||process.emitWarning)),!(n instanceof Error))throw new ERR_INVALID_ARG_TYPE("warning",["Error","string"],n);if("DeprecationWarning"===n.name){if(process.noDeprecation)return;if(process.throwDeprecation)throw n}i?process.emit("warning",n):process.nextTick(doEmitWarning(n))}}"use strict";const{setupProcessStdio}=require("internal/process/stdio"),{workerStdio}=require("internal/worker");function setupStdio(){setupProcessStdio({getStdout:()=>workerStdio.stdout,getStderr:()=>workerStdio.stderr,getStdin:()=>workerStdio.stdin})}module.exports={setupStdio};"use strict";const path=require("path"),{mkdirSync,writeFileSync}=require("fs");function writeCoverage(){if(!global.__coverage__)return;const e=path.join(path.dirname(process.execPath),".coverage"),r=`coverage-${process.pid}-${Date.now()}.json`;try{mkdirSync(e)}catch(e){if("EEXIST"!==e.code)return}const t=path.join(e,r),c=JSON.stringify(global.__coverage__);try{writeFileSync(t,c)}catch(e){}}function setup(){const e=process.reallyExit;process.reallyExit=function(r){writeCoverage(),e(r)},process.on("exit",writeCoverage)}exports.setup=setup;"use strict";const hexTable=new Array(256);for(var i=0;i<256;++i)hexTable[i]="%"+((i<16?"0":"")+i.toString(16)).toUpperCase();const isHexTable=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];module.exports={hexTable,isHexTable};"use strict";const ansi=/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,kEscape="";let getStringWidth,isFullWidthCodePoint;function CSI(e,...a){let n=`${kEscape}[`;for(var r=0;r<e.length;r++)n+=e[r],r<a.length&&(n+=a[r]);return n}if(CSI.kEscape=kEscape,CSI.kClearToBeginning=CSI`1K`,CSI.kClearToEnd=CSI`0K`,CSI.kClearLine=CSI`2K`,CSI.kClearScreenDown=CSI`0J`,process.binding("config").hasIntl){const e=process.binding("icu");getStringWidth=function(a,n){return n=n||{},Number.isInteger(a)||(a=stripVTControlCharacters(String(a))),e.getStringWidth(a,Boolean(n.ambiguousAsFullWidth),Boolean(n.expandEmojiSequence))},isFullWidthCodePoint=function(a,n){return"number"==typeof a&&2===e.getStringWidth(a,n)}}else getStringWidth=function(e){if(Number.isInteger(e))return isFullWidthCodePoint(e)?2:1;let a=0;e=stripVTControlCharacters(String(e));for(var n=0;n<e.length;n++){const r=e.codePointAt(n);r>=65536&&n++,isFullWidthCodePoint(r)?a+=2:a++}return a},isFullWidthCodePoint=function(e){return!!Number.isInteger(e)&&(e>=4352&&(e<=4447||9001===e||9002===e||e>=11904&&e<=12871&&12351!==e||e>=12880&&e<=19903||e>=19968&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65131||e>=65281&&e<=65376||e>=65504&&e<=65510||e>=110592&&e<=110593||e>=127488&&e<=127569||e>=131072&&e<=262141))};function stripVTControlCharacters(e){return e.replace(ansi,"")}function*emitKeys(e){for(;;){let a=yield,n=a,r=!1;const t={sequence:null,name:void 0,ctrl:!1,meta:!1,shift:!1};if(a===kEscape&&(r=!0,n+=a=yield,a===kEscape&&(n+=a=yield)),!r||"O"!==a&&"["!==a)"\r"===a?t.name="return":"\n"===a?t.name="enter":"\t"===a?t.name="tab":"\b"===a||""===a?(t.name="backspace",t.meta=r):a===kEscape?(t.name="escape",t.meta=r):" "===a?(t.name="space",t.meta=r):!r&&a<=""?(t.name=String.fromCharCode(a.charCodeAt(0)+"a".charCodeAt(0)-1),t.ctrl=!0):/^[0-9A-Za-z]$/.test(a)?(t.name=a.toLowerCase(),t.shift=/^[A-Z]$/.test(a),t.meta=r):r&&(t.name=a.length?void 0:"escape",t.meta=!0);else{let e=a,r=0;if("O"===a)n+=a=yield,a>="0"&&a<="9"&&(r=(a>>0)-1,n+=a=yield),e+=a;else if("["===a){n+=a=yield,"["===a&&(e+=a,n+=a=yield);const t=n.length-1;a>="0"&&a<="9"&&(n+=a=yield,a>="0"&&a<="9"&&(n+=a=yield)),";"===a&&(n+=a=yield,a>="0"&&a<="9"&&(n+=a=yield));const s=n.slice(t);let c;(c=s.match(/^(\d\d?)(;(\d))?([~^$])$/))?(e+=c[1]+c[4],r=(c[3]||1)-1):(c=s.match(/^((\d;)?(\d))?([A-Za-z])$/))?(e+=c[4],r=(c[3]||1)-1):e+=s}switch(t.ctrl=!!(4&r),t.meta=!!(10&r),t.shift=!!(1&r),t.code=e,e){case"OP":t.name="f1";break;case"OQ":t.name="f2";break;case"OR":t.name="f3";break;case"OS":t.name="f4";break;case"[11~":t.name="f1";break;case"[12~":t.name="f2";break;case"[13~":t.name="f3";break;case"[14~":t.name="f4";break;case"[[A":t.name="f1";break;case"[[B":t.name="f2";break;case"[[C":t.name="f3";break;case"[[D":t.name="f4";break;case"[[E":case"[15~":t.name="f5";break;case"[17~":t.name="f6";break;case"[18~":t.name="f7";break;case"[19~":t.name="f8";break;case"[20~":t.name="f9";break;case"[21~":t.name="f10";break;case"[23~":t.name="f11";break;case"[24~":t.name="f12";break;case"[A":t.name="up";break;case"[B":t.name="down";break;case"[C":t.name="right";break;case"[D":t.name="left";break;case"[E":t.name="clear";break;case"[F":t.name="end";break;case"[H":t.name="home";break;case"OA":t.name="up";break;case"OB":t.name="down";break;case"OC":t.name="right";break;case"OD":t.name="left";break;case"OE":t.name="clear";break;case"OF":t.name="end";break;case"OH":case"[1~":t.name="home";break;case"[2~":t.name="insert";break;case"[3~":t.name="delete";break;case"[4~":t.name="end";break;case"[5~":t.name="pageup";break;case"[6~":t.name="pagedown";break;case"[[5~":t.name="pageup";break;case"[[6~":t.name="pagedown";break;case"[7~":t.name="home";break;case"[8~":t.name="end";break;case"[a":t.name="up",t.shift=!0;break;case"[b":t.name="down",t.shift=!0;break;case"[c":t.name="right",t.shift=!0;break;case"[d":t.name="left",t.shift=!0;break;case"[e":t.name="clear",t.shift=!0;break;case"[2$":t.name="insert",t.shift=!0;break;case"[3$":t.name="delete",t.shift=!0;break;case"[5$":t.name="pageup",t.shift=!0;break;case"[6$":t.name="pagedown",t.shift=!0;break;case"[7$":t.name="home",t.shift=!0;break;case"[8$":t.name="end",t.shift=!0;break;case"Oa":t.name="up",t.ctrl=!0;break;case"Ob":t.name="down",t.ctrl=!0;break;case"Oc":t.name="right",t.ctrl=!0;break;case"Od":t.name="left",t.ctrl=!0;break;case"Oe":t.name="clear",t.ctrl=!0;break;case"[2^":t.name="insert",t.ctrl=!0;break;case"[3^":t.name="delete",t.ctrl=!0;break;case"[5^":t.name="pageup",t.ctrl=!0;break;case"[6^":t.name="pagedown",t.ctrl=!0;break;case"[7^":t.name="home",t.ctrl=!0;break;case"[8^":t.name="end",t.ctrl=!0;break;case"[Z":t.name="tab",t.shift=!0;break;default:t.name="undefined"}}t.sequence=n,0===n.length||void 0===t.name&&!r?1===n.length&&e.emit("keypress",n,t):e.emit("keypress",r?void 0:n,t)}}module.exports={emitKeys,getStringWidth,isFullWidthCodePoint,stripVTControlCharacters,CSI};"use strict";const acorn=require("internal/deps/acorn/dist/acorn"),walk=require("internal/deps/acorn/dist/walk"),noop=()=>{},visitorsWithoutAncestors={ClassDeclaration(e,n,t){n.ancestors[n.ancestors.length-2]===n.body&&n.prepend(e,`${e.id.name}=`),walk.base.ClassDeclaration(e,n,t)},FunctionDeclaration(e,n,t){n.prepend(e,`${e.id.name}=`)},FunctionExpression:noop,ArrowFunctionExpression:noop,MethodDefinition:noop,AwaitExpression(e,n,t){n.containsAwait=!0,walk.base.AwaitExpression(e,n,t)},ReturnStatement(e,n,t){n.containsReturn=!0,walk.base.ReturnStatement(e,n,t)},VariableDeclaration(e,n,t){if("var"===e.kind||n.ancestors[n.ancestors.length-2]===n.body){1===e.declarations.length?n.replace(e.start,e.start+e.kind.length,"void"):n.replace(e.start,e.start+e.kind.length,"void (");for(const t of e.declarations)n.prepend(t,"("),n.append(t,t.init?")":"=undefined)");1!==e.declarations.length&&n.append(e.declarations[e.declarations.length-1],")")}walk.base.VariableDeclaration(e,n,t)}},visitors={};for(const e of Object.keys(walk.base)){const n=visitorsWithoutAncestors[e]||walk.base[e];visitors[e]=((e,t,s)=>{const a=e!==t.ancestors[t.ancestors.length-1];a&&t.ancestors.push(e),n(e,t,s),a&&t.ancestors.pop()})}function processTopLevelAwait(e){const n=`(async () => { ${e} })()`,t=n.split("");let s;try{s=acorn.parse(n,{ecmaVersion:10})}catch{return null}const a=s.body[0].expression.callee.body,o={body:a,ancestors:[],replace(e,n,s){for(var a=e;a<n;a++)t[a]="";e===n&&(s+=t[e]),t[e]=s},prepend(e,n){t[e.start]=n+t[e.start]},append(e,n){t[e.end-1]+=n},containsAwait:!1,containsReturn:!1};if(walk.recursive(a,o,visitors),!o.containsAwait||o.containsReturn)return null;const r=a.body[a.body.length-1];return"ExpressionStatement"===r.type&&(o.prepend(r,"return ("),o.append(r.expression,")")),t.join("")}module.exports={processTopLevelAwait};"use strict";const acorn=require("internal/deps/acorn/dist/acorn"),{tokTypes:tt}=acorn;function isRecoverableError(e,t){let r=!1;if(acorn.plugins.replRecoverable=(e=>{e.extend("nextToken",e=>(function(){Reflect.apply(e,this,[]),this.type===tt.eof&&(r=!0)})),e.extend("raise",e=>(function(t,n){switch(n){case"Unterminated template":case"Unterminated comment":r=!0;break;case"Unterminated string constant":const e=this.input.slice(this.lastTokStart,this.pos);r=/\\(?:\r\n?|\n|\u2028|\u2029)$/.test(e)}Reflect.apply(e,this,[t,n])}))}),/^\s*\{/.test(t)&&isRecoverableError(e,`(${t}`))return!0;try{return acorn.parse(t,{plugins:{replRecoverable:!0},ecmaVersion:10}),!1}catch{return r}}module.exports={isRecoverableError};"use strict";const{Interface}=require("readline"),REPL=require("repl"),path=require("path"),fs=require("fs"),os=require("os"),util=require("util"),debug=util.debuglog("repl");module.exports=Object.create(REPL),module.exports.createInternalRepl=createRepl;const kDebounceHistoryMS=15;function _writeToOutput(e,t){e._writeToOutput(t),e._refreshLine()}function createRepl(e,t,r){"function"==typeof t&&(r=t,t=null),t=util._extend({ignoreUndefined:!1,terminal:process.stdout.isTTY,useGlobal:!0,breakEvalOnSigint:!0},t),parseInt(e.NODE_NO_READLINE)&&(t.terminal=!1),(parseInt(e.NODE_DISABLE_COLORS)||"dumb"===e.TERM)&&(t.useColors=!1),t.replMode={strict:REPL.REPL_MODE_STRICT,sloppy:REPL.REPL_MODE_SLOPPY}[String(e.NODE_REPL_MODE).toLowerCase().trim()],void 0===t.replMode&&(t.replMode=REPL.REPL_MODE_SLOPPY);const i=Number(e.NODE_REPL_HISTORY_SIZE);!Number.isNaN(i)&&i>0?t.historySize=i:t.historySize=1e3;const o=REPL.start(t);if(t.terminal)return setupHistory(o,e.NODE_REPL_HISTORY,r);o._historyPrev=_replHistoryMessage,r(null,o)}function setupHistory(e,t,r){if("string"==typeof t&&(t=t.trim()),""===t)return e._historyPrev=_replHistoryMessage,r(null,e);if(!t)try{t=path.join(os.homedir(),".node_repl_history")}catch(t){return _writeToOutput(e,"\nError: Could not get the home directory.\nREPL session history will not be persisted.\n"),debug(t.stack),e._historyPrev=_replHistoryMessage,r(null,e)}var i=null,o=!1,s=!1;function n(e){if(e)return r(e);fs.readFile(t,"utf8",u)}function u(i,o){if(i)return r(i);e.history=o?o.split(/[\n\r]+/,e.historySize):[],fs.open(t,"r+",l)}function l(t,i){if(t)return r(t);fs.ftruncate(i,0,t=>{e._historyHandle=i,e.on("line",a),e.once("flushHistory",function(){e.resume(),r(null,e)}),f()})}function a(){e._flushing=!0,i&&clearTimeout(i),i=setTimeout(f,kDebounceHistoryMS)}function f(){if(i=null,o)return void(s=!0);o=!0;const t=e.history.join(os.EOL);fs.write(e._historyHandle,t,0,"utf8",p)}function p(t,r){o=!1,s?(s=!1,a()):(e._flushing=Boolean(i),e._flushing||e.emit("flushHistory"))}e.pause(),fs.open(t,"a+",384,function(t,i){if(t)return _writeToOutput(e,"\nError: Could not open history file.\nREPL session history will not be persisted.\n"),debug(t.stack),e._historyPrev=_replHistoryMessage,e.resume(),r(null,e);fs.close(i,n)})}function _replHistoryMessage(){return 0===this.history.length&&_writeToOutput(this,"\nPersistent history support disabled. Set the NODE_REPL_HISTORY environment\nvariable to a valid, user-writable path to enable.\n"),this._historyPrev=Interface.prototype._historyPrev,this._historyPrev()}"use strict";const copyProps=(e,t)=>{for(const o of[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)])Object.getOwnPropertyDescriptor(t,o)||Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))},makeSafe=(e,t)=>(copyProps(e.prototype,t.prototype),copyProps(e,t),Object.setPrototypeOf(t.prototype,null),Object.freeze(t.prototype),Object.freeze(t),t);exports.SafeMap=makeSafe(Map,class extends Map{}),exports.SafeSet=makeSafe(Set,class extends Set{}),exports.SafePromise=makeSafe(Promise,class extends Promise{});"use strict";const{ERR_CHILD_CLOSED_BEFORE_REPLY}=require("internal/errors").codes,EventEmitter=require("events");class SocketListSend extends EventEmitter{constructor(e,t){super(),this.key=t,this.child=e,e.once("exit",()=>this.emit("exit",this))}_request(e,t,i,s){var n=this;if(!this.child.connected)return c();function c(){n.child.removeListener("internalMessage",o),s(new ERR_CHILD_CLOSED_BEFORE_REPLY)}function o(e){e.cmd===t&&e.key===n.key&&(n.child.removeListener("disconnect",c),n.child.removeListener("internalMessage",o),s(null,e))}this.child._send(e,void 0,i),this.child.once("disconnect",c),this.child.on("internalMessage",o)}close(e){this._request({cmd:"NODE_SOCKET_NOTIFY_CLOSE",key:this.key},"NODE_SOCKET_ALL_CLOSED",!0,e)}getConnections(e){this._request({cmd:"NODE_SOCKET_GET_COUNT",key:this.key},"NODE_SOCKET_COUNT",!1,function(t,i){if(t)return e(t);e(null,i.count)})}}class SocketListReceive extends EventEmitter{constructor(e,t){function i(e){e.child.connected&&e.child._send({cmd:"NODE_SOCKET_ALL_CLOSED",key:e.key},void 0,!0)}super(),this.connections=0,this.key=t,this.child=e,this.child.on("internalMessage",e=>{if(e.key===this.key)if("NODE_SOCKET_NOTIFY_CLOSE"===e.cmd){if(0===this.connections)return i(this);this.once("empty",i)}else if("NODE_SOCKET_GET_COUNT"===e.cmd){if(!this.child.connected)return;this.child._send({cmd:"NODE_SOCKET_COUNT",key:this.key,count:this.connections})}})}add(e){this.connections++,e.socket.once("close",()=>{this.connections--,0===this.connections&&this.emit("empty",this)})}}module.exports={SocketListSend,SocketListReceive};"use strict";const{Buffer}=require("buffer"),{WriteWrap}=internalBinding("stream_wrap"),{UV_EOF}=internalBinding("uv"),{errnoException}=require("internal/errors"),{owner_symbol}=require("internal/async_hooks").symbols,kMaybeDestroy=Symbol("kMaybeDestroy"),kUpdateTimer=Symbol("kUpdateTimer");function handleWriteReq(e,r,t){const{handle:n}=e;switch(t){case"buffer":return n.writeBuffer(e,r);case"latin1":case"binary":return n.writeLatin1String(e,r);case"utf8":case"utf-8":return n.writeUtf8String(e,r);case"ascii":return n.writeAsciiString(e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n.writeUcs2String(e,r);default:return n.writeBuffer(e,Buffer.from(r,t))}}function createWriteWrap(e,r){var t=new WriteWrap;return t.handle=e,t.oncomplete=r,t.async=!1,t}function writevGeneric(e,r,t,n){var i,a,o=t.allBuffers;if(o)for(i=t,a=0;a<t.length;a++)t[a]=t[a].chunk;else for(i=new Array(t.length<<1),a=0;a<t.length;a++){var s=t[a];i[2*a]=s.chunk,i[2*a+1]=s.encoding}var c=r.handle.writev(r,i,o);0===c&&(r._chunks=i),afterWriteDispatched(e,r,c,n)}function writeGeneric(e,r,t,n,i){afterWriteDispatched(e,r,handleWriteReq(r,t,n),i)}function afterWriteDispatched(e,r,t,n){if(0!==t)return e.destroy(errnoException(t,"write",r.error),n);r.async?r.callback=n:n()}function onStreamRead(e,r){const t=this,n=this[owner_symbol];if(n[kUpdateTimer](),e>0&&!n.destroyed){if(!n.push(r)&&(t.reading=!1,!n.destroyed)){const e=t.readStop();e&&n.destroy(errnoException(e,"read"))}}else if(0!==e)return e!==UV_EOF?n.destroy(errnoException(e,"read")):void(n._readableState.endEmitted?n[kMaybeDestroy]&&n[kMaybeDestroy]():(n[kMaybeDestroy]&&n.on("end",n[kMaybeDestroy]),n.push(null),n.read(0)))}module.exports={createWriteWrap,writevGeneric,writeGeneric,onStreamRead,kMaybeDestroy,kUpdateTimer};"use strict";const finished=require("internal/streams/end-of-stream"),kLastResolve=Symbol("lastResolve"),kLastReject=Symbol("lastReject"),kError=Symbol("error"),kEnded=Symbol("ended"),kLastPromise=Symbol("lastPromise"),kHandlePromise=Symbol("handlePromise"),kStream=Symbol("stream");function createIterResult(e,t){return{value:e,done:t}}function readAndResolve(e){const t=e[kLastResolve];if(null!==t){const r=e[kStream].read();null!==r&&(e[kLastPromise]=null,e[kLastResolve]=null,e[kLastReject]=null,t(createIterResult(r,!1)))}}function onReadable(e){process.nextTick(readAndResolve,e)}function wrapForNext(e,t){return function(r,l){e.then(function(){t[kHandlePromise](r,l)},l)}}const AsyncIteratorPrototype=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype),ReadableStreamAsyncIteratorPrototype=Object.setPrototypeOf({get stream(){return this[kStream]},next(){const e=this[kError];if(null!==e)return Promise.reject(e);if(this[kEnded])return Promise.resolve(createIterResult(null,!0));if(this[kStream].destroyed)return new Promise((e,t)=>{process.nextTick(()=>{this[kError]?t(this[kError]):e(createIterResult(null,!0))})});const t=this[kLastPromise];let r;if(t)r=new Promise(wrapForNext(t,this));else{const e=this[kStream].read();if(null!==e)return Promise.resolve(createIterResult(e,!1));r=new Promise(this[kHandlePromise])}return this[kLastPromise]=r,r},return(){return new Promise((e,t)=>{this[kStream].destroy(null,r=>{r?t(r):e(createIterResult(null,!0))})})}},AsyncIteratorPrototype),createReadableStreamAsyncIterator=e=>{const t=Object.create(ReadableStreamAsyncIteratorPrototype,{[kStream]:{value:e,writable:!0},[kLastResolve]:{value:null,writable:!0},[kLastReject]:{value:null,writable:!0},[kError]:{value:null,writable:!0},[kEnded]:{value:e._readableState.endEmitted,writable:!0},[kLastPromise]:{value:null,writable:!0},[kHandlePromise]:{value:(e,r)=>{const l=t[kStream].read();l?(t[kLastPromise]=null,t[kLastResolve]=null,t[kLastReject]=null,e(createIterResult(l,!1))):(t[kLastResolve]=e,t[kLastReject]=r)},writable:!0}});return finished(e,e=>{if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){const r=t[kLastReject];return null!==r&&(t[kLastPromise]=null,t[kLastResolve]=null,t[kLastReject]=null,r(e)),void(t[kError]=e)}const r=t[kLastResolve];null!==r&&(t[kLastPromise]=null,t[kLastResolve]=null,t[kLastReject]=null,r(createIterResult(null,!0))),t[kEnded]=!0}),e.on("readable",onReadable.bind(null,t)),t};module.exports=createReadableStreamAsyncIterator;"use strict";const{Buffer}=require("buffer"),{inspect}=require("util");function copyBuffer(t,e,h){Buffer.prototype.copy.call(t,e,h)}module.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){const e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}unshift(t){const e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}shift(){if(0===this.length)return;const t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(0===this.length)return"";for(var e=this.head,h=""+e.data;e=e.next;)h+=t+e.data;return h}concat(t){if(0===this.length)return Buffer.alloc(0);const e=Buffer.allocUnsafe(t>>>0);for(var h=this.head,a=0;h;)copyBuffer(h.data,e,a),a+=h.data.length,h=h.next;return e}consume(t,e){var h;return t<this.head.data.length?(h=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):h=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),h}first(){return this.head.data}_getString(t){var e=this.head,h=1,a=e.data;for(t-=a.length;e=e.next;){const i=e.data,s=t>i.length?i.length:t;if(s===i.length?a+=i:a+=i.slice(0,t),0===(t-=s)){s===i.length?(++h,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=i.slice(s));break}++h}return this.length-=h,a}_getBuffer(t){const e=Buffer.allocUnsafe(t);var h=this.head,a=1;for(h.data.copy(e),t-=h.data.length;h=h.next;){const i=h.data,s=t>i.length?i.length:t;if(i.copy(e,e.length-t,0,s),0===(t-=s)){s===i.length?(++a,h.next?this.head=h.next:this.head=this.tail=null):(this.head=h,h.data=i.slice(s));break}++a}return this.length-=a,e}[inspect.custom](t,e){return inspect(this,{...e,depth:0,customInspect:!1})}};"use strict";function destroy(t,e){const i=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return i||r?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||process.nextTick(emitErrorNT,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,t=>{!e&&t?(process.nextTick(emitErrorAndCloseNT,this,t),this._writableState&&(this._writableState.errorEmitted=!0)):e?(process.nextTick(emitCloseNT,this),e(t)):process.nextTick(emitCloseNT,this)}),this)}function emitErrorAndCloseNT(t,e){emitErrorNT(t,e),emitCloseNT(t)}function emitCloseNT(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(t,e){t.emit("error",e)}module.exports={destroy,undestroy};"use strict";const{Duplex}=require("stream"),kCallback=Symbol("Callback"),kOtherSide=Symbol("Other");class DuplexSocket extends Duplex{constructor(){super(),this[kCallback]=null,this[kOtherSide]=null}_read(){const e=this[kCallback];e&&(this[kCallback]=null,e())}_write(e,t,s){this[kOtherSide][kCallback]=s,this[kOtherSide].push(e)}_final(e){this[kOtherSide].on("end",e),this[kOtherSide].push(null)}}class DuplexPair{constructor(){this.socket1=new DuplexSocket,this.socket2=new DuplexSocket,this.socket1[kOtherSide]=this.socket2,this.socket2[kOtherSide]=this.socket1}}module.exports=DuplexPair;"use strict";const{ERR_STREAM_PREMATURE_CLOSE}=require("internal/errors").codes;function noop(){}function isRequest(e){return e.setHeader&&"function"==typeof e.abort}function once(e){let r=!1;return function(n){r||(r=!0,e.call(this,n))}}function eos(e,r,n){if("function"==typeof r)return eos(e,null,r);r||(r={}),n=once(n||noop);const o=e._writableState,t=e._readableState;let i=r.readable||!1!==r.readable&&e.readable,s=r.writable||!1!==r.writable&&e.writable;const l=()=>{e.writable||c()},c=()=>{s=!1,i||n.call(e)},a=()=>{i=!1,s||n.call(e)},u=r=>{n.call(e,r)},R=()=>(!i||t&&t.ended)&&(!s||o&&o.ended)?void 0:n.call(e,new ERR_STREAM_PREMATURE_CLOSE),d=()=>{e.req.on("finish",c)};return isRequest(e)?(e.on("complete",c),e.on("abort",R),e.req?d():e.on("request",d)):s&&!o&&(e.on("end",l),e.on("close",l)),e.on("end",a),e.on("finish",c),!1!==r.error&&e.on("error",u),e.on("close",R),function(){e.removeListener("complete",c),e.removeListener("abort",R),e.removeListener("request",d),e.req&&e.req.removeListener("finish",c),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",c),e.removeListener("end",a),e.removeListener("error",u),e.removeListener("close",R)}}module.exports=eos;"use strict";const stream=require("stream"),util=require("util"),crypto=require("crypto");function LazyTransform(e){this._options=e,this.writable=!0,this.readable=!0}function makeGetter(e){return function(){return stream.Transform.call(this,this._options),this._writableState.decodeStrings=!1,this._options&&this._options.defaultEncoding||(this._writableState.defaultEncoding=crypto.DEFAULT_ENCODING),this[e]}}function makeSetter(e){return function(t){Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0})}}module.exports=LazyTransform,util.inherits(LazyTransform,stream.Transform),Object.defineProperties(LazyTransform.prototype,{_readableState:{get:makeGetter("_readableState"),set:makeSetter("_readableState"),configurable:!0,enumerable:!0},_writableState:{get:makeGetter("_writableState"),set:makeSetter("_writableState"),configurable:!0,enumerable:!0},_transformState:{get:makeGetter("_transformState"),set:makeSetter("_transformState"),configurable:!0,enumerable:!0}});"use strict";const EE=require("events"),util=require("util");function Stream(){EE.call(this)}util.inherits(Stream,EE),Stream.prototype.pipe=function(e,r){var n=this;function o(r){e.writable&&!1===e.write(r)&&n.pause&&n.pause()}function t(){n.readable&&n.resume&&n.resume()}n.on("data",o),e.on("drain",t),e._isStdio||r&&!1===r.end||(n.on("end",s),n.on("close",u));var i=!1;function s(){i||(i=!0,e.end())}function u(){i||(i=!0,"function"==typeof e.destroy&&e.destroy())}function a(e){if(c(),0===EE.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",o),e.removeListener("drain",t),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",a),e.removeListener("error",a),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",a),e.on("error",a),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e},module.exports=Stream;"use strict";let eos;const{once}=require("internal/util"),{ERR_MISSING_ARGS,ERR_STREAM_DESTROYED}=require("internal/errors").codes;function noop(e){if(e)throw e}function isRequest(e){return e.setHeader&&"function"==typeof e.abort}function destroyer(e,n,t,o){o=once(o);let r=!1;e.on("close",()=>{r=!0}),void 0===eos&&(eos=require("internal/streams/end-of-stream")),eos(e,{readable:n,writable:t},e=>{if(e)return o(e);r=!0,o()});let i=!1;return n=>{if(!r&&!i)return i=!0,isRequest(e)?e.abort():"function"==typeof e.destroy?e.destroy():void o(n||new ERR_STREAM_DESTROYED("pipe"))}}function call(e){e()}function pipe(e,n){return e.pipe(n)}function popCallback(e){return e.length?"function"!=typeof e[e.length-1]?noop:e.pop():noop}function pipeline(...e){const n=popCallback(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new ERR_MISSING_ARGS("streams");let t;const o=e.map(function(r,i){const c=i<e.length-1;return destroyer(r,c,i>0,function(e){t||(t=e),e&&o.forEach(call),c||(o.forEach(call),n(t))})});return e.reduce(pipe)}module.exports=pipeline;"use strict";const{ERR_INVALID_OPT_VALUE}=require("internal/errors").codes;function highWaterMarkFrom(r,e,t){return null!=r.highWaterMark?r.highWaterMark:e?r[t]:null}function getHighWaterMark(r,e,t,a){const i=highWaterMarkFrom(e,a,t);if(null!=i){if(!Number.isInteger(i)||i<0){throw new ERR_INVALID_OPT_VALUE(a?t:"highWaterMark",i)}return Math.floor(i)}return r.objectMode?16:16384}module.exports={getHighWaterMark};"use strict";process.emitWarning("These APIs are exposed only for testing and are not tracked by any versioning system or deprecation process.","internal/test/binding"),module.exports={ModuleWrap:internalBinding("module_wrap").ModuleWrap,internalBinding};"use strict";process.emitWarning("These APIs are exposed only for testing and are not tracked by any versioning system or deprecation process.","internal/test/heap");const{createHeapDump,buildEmbedderGraph}=internalBinding("heap_utils"),assert=require("assert");function createJSHeapDump(){const e=createHeapDump(),n=e.snapshot.meta,t=readHeapInfo(e.nodes,n.node_fields,n.node_types,e.strings),r=readHeapInfo(e.edges,n.edge_fields,n.edge_types,e.strings);for(const e of t)e.incomingEdges=[],e.outgoingEdges=[];let o=0,s=0;for(const{type:e,name_or_index:a,to_node:d}of r){for(;s===t[o].edge_count;)s=0,o++;const r=t[d/n.node_fields.length],i=t[o],p={type:e,to:r,from:i,name:"string"==typeof a?a:null};r.incomingEdges.push(p),i.outgoingEdges.push(p),s++}for(const e of t)assert.strictEqual(e.edge_count,e.outgoingEdges.length);return t}function readHeapInfo(e,n,t,r){const o=[];for(var s=0;s<e.length;s+=n.length){const d={};for(var a=0;a<n.length;a++){const o=n[a];let i=t[a];Array.isArray(i)?d[o]=i[e[s+a]]:"name_or_index"===o&&(i="element"===d.type||"hidden"===d.type?"number":"string"),"string"===i?d[o]=r[e[s+a]]:"number"!==i&&"node"!==i||(d[o]=e[s+a])}o.push(d)}return o}module.exports={createJSHeapDump,buildEmbedderGraph};"use strict";module.exports="✓";"use strict";const{getDefaultTriggerAsyncId,newAsyncId,initHooksExist,emitInit}=require("internal/async_hooks"),async_id_symbol=Symbol("asyncId"),trigger_async_id_symbol=Symbol("triggerId"),{ERR_INVALID_CALLBACK,ERR_OUT_OF_RANGE}=require("internal/errors").codes,{validateNumber}=require("internal/validators"),{inspect}=require("util"),TIMEOUT_MAX=2**31-1,unrefedSymbol=Symbol("unrefed");var timers;function getTimers(){return void 0===timers&&(timers=require("timers")),timers}function initAsyncResource(e,t){const i=e[async_id_symbol]=newAsyncId(),n=e[trigger_async_id_symbol]=getDefaultTriggerAsyncId();initHooksExist()&&emitInit(i,t,n,e)}function Timeout(e,t,i,n,s){(t*=1)>=1&&t<=TIMEOUT_MAX||(t>TIMEOUT_MAX&&process.emitWarning(`${t} does not fit into`+" a 32-bit signed integer.\nTimeout duration was set to 1.","TimeoutOverflowWarning"),t=1),this._called=!1,this._idleTimeout=t,this._idlePrev=this,this._idleNext=this,this._idleStart=null,this._onTimeout=null,this._onTimeout=e,this._timerArgs=i,this._repeat=n?t:null,this._destroyed=!1,this[unrefedSymbol]=s,initAsyncResource(this,"Timeout")}function setUnrefTimeout(e,t,i,n,s){if("function"!=typeof e)throw new ERR_INVALID_CALLBACK;let r,o;switch(arguments.length){case 1:case 2:break;case 3:o=[i];break;case 4:o=[i,n];break;default:for(o=[i,n,s],r=5;r<arguments.length;r++)o[r-2]=arguments[r]}const u=new Timeout(e,t,o,!1,!0);return getTimers()._unrefActive(u),u}function validateTimerDuration(e){if(validateNumber(e,"msecs"),e<0||!isFinite(e))throw new ERR_OUT_OF_RANGE("msecs","a non-negative finite number",e);return e>TIMEOUT_MAX?(process.emitWarning(`${e} does not fit into a 32-bit signed integer.`+`\nTimer duration was truncated to ${TIMEOUT_MAX}.`,"TimeoutOverflowWarning"),TIMEOUT_MAX):e}module.exports={TIMEOUT_MAX,kTimeout:Symbol("timeout"),async_id_symbol,trigger_async_id_symbol,Timeout,initAsyncResource,setUnrefTimeout,validateTimerDuration},Timeout.prototype[inspect.custom]=function(e,t){return inspect(this,{...t,depth:0,customInspect:!1})},Timeout.prototype.refresh=function(){return this._handle?this._handle.start(this._idleTimeout):this[unrefedSymbol]?getTimers()._unrefActive(this):getTimers().active(this),this};"use strict";function parseCertString(r){const t=Object.create(null),e=r.split("\n");for(var n=0,s=e.length;n<s;n++){const r=e[n].indexOf("=");if(r>0){const s=e[n].slice(0,r),i=e[n].slice(r+1);s in t?(Array.isArray(t[s])||(t[s]=[t[s]]),t[s].push(i)):t[s]=i}}return t}module.exports={parseCertString};"use strict";exports.setup=function(e,t){const n=internalBinding("async_wrap"),o=require("async_hooks"),i="b".charCodeAt(0),s="e".charCodeAt(0),c=new Map,r=new Set(Object.keys(n.Providers));o.createHook({init(n,s,d,a){r.has(s)||(c.set(n,s),e.emit(i,t,s,n,"triggerAsyncId",d,"executionAsyncId",o.executionAsyncId()))},before(n){const o=c.get(n);void 0!==o&&e.emit(i,t,o+"_CALLBACK",n)},after(n){const o=c.get(n);void 0!==o&&e.emit(s,t,o+"_CALLBACK",n)},destroy(n){const o=c.get(n);void 0!==o&&(e.emit(s,t,o,n),c.delete(n))}}).enable()};"use strict";let OSRelease;const COLORS_2=1,COLORS_16=4,COLORS_256=8,COLORS_16m=24,TERM_ENVS=["Eterm","cons25","console","cygwin","dtterm","gnome","hurd","jfbterm","konsole","kterm","mlterm","putty","st","terminator"],TERM_ENVS_REG_EXP=[/ansi/,/color/,/linux/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/];function getColorDepth(e=process.env){if(e.NODE_DISABLE_COLORS||"dumb"===e.TERM&&!e.COLORTERM)return COLORS_2;if("win32"===process.platform){if(void 0===OSRelease){const{release:e}=require("os");OSRelease=e().split(".")}if(+OSRelease[0]>=10){const e=+OSRelease[2];if(e>=14931)return COLORS_16m;if(e>=10586)return COLORS_256}return COLORS_16}if(e.TMUX)return COLORS_256;if(e.CI)return"TRAVIS"in e||"CIRCLECI"in e||"APPVEYOR"in e||"GITLAB_CI"in e||"codeship"===e.CI_NAME?COLORS_256:COLORS_2;if("TEAMCITY_VERSION"in e)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(e.TEAMCITY_VERSION)?COLORS_16:COLORS_2;switch(e.TERM_PROGRAM){case"iTerm.app":return!e.TERM_PROGRAM_VERSION||/^[0-2]\./.test(e.TERM_PROGRAM_VERSION)?COLORS_256:COLORS_16m;case"HyperTerm":case"Hyper":case"MacTerm":return COLORS_16m;case"Apple_Terminal":return COLORS_256}if(e.TERM){if(/^xterm-256/.test(e.TERM))return COLORS_256;const O=e.TERM.toLowerCase();for(const e of TERM_ENVS)if(O===e)return COLORS_16;for(const e of TERM_ENVS_REG_EXP)if(e.test(O))return COLORS_16}return e.COLORTERM?COLORS_16:COLORS_2}module.exports={getColorDepth};"use strict";const util=require("util"),{hexTable,isHexTable}=require("internal/querystring"),{getConstructorOf,removeColors}=require("internal/util"),{ERR_ARG_NOT_ITERABLE,ERR_INVALID_ARG_TYPE,ERR_INVALID_CALLBACK,ERR_INVALID_FILE_URL_HOST,ERR_INVALID_FILE_URL_PATH,ERR_INVALID_THIS,ERR_INVALID_TUPLE,ERR_INVALID_URL,ERR_INVALID_URL_SCHEME,ERR_MISSING_ARGS}=require("internal/errors").codes,{CHAR_AMPERSAND,CHAR_BACKWARD_SLASH,CHAR_EQUAL,CHAR_FORWARD_SLASH,CHAR_LOWERCASE_A,CHAR_LOWERCASE_Z,CHAR_PERCENT,CHAR_PLUS}=require("internal/constants"),path=require("path");let querystring;const{platform}=process,isWindows="win32"===platform,{domainToASCII:_domainToASCII,domainToUnicode:_domainToUnicode,encodeAuth,toUSVString:_toUSVString,parse:_parse,setURLConstructor,URL_FLAGS_CANNOT_BE_BASE,URL_FLAGS_HAS_FRAGMENT,URL_FLAGS_HAS_HOST,URL_FLAGS_HAS_PASSWORD,URL_FLAGS_HAS_PATH,URL_FLAGS_HAS_QUERY,URL_FLAGS_HAS_USERNAME,URL_FLAGS_IS_DEFAULT_SCHEME_PORT,URL_FLAGS_SPECIAL,kFragment,kHost,kHostname,kPathStart,kPort,kQuery,kSchemeStart}=process.binding("url"),context=Symbol("context"),cannotBeBase=Symbol("cannot-be-base"),cannotHaveUsernamePasswordPort=Symbol("cannot-have-username-password-port"),special=Symbol("special"),searchParams=Symbol("query"),kFormat=Symbol("format"),IteratorPrototype=Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())),unpairedSurrogateRe=/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/;function toUSVString(e){const t=`${e}`,r=unpairedSurrogateRe.exec(t);return r?_toUSVString(t,r.index):t}const kOpaqueOrigin="null";function serializeTupleOrigin(e,t,r){return`${e}//${t}${null===r?"":`:${r}`}`}class URLContext{constructor(){this.flags=0,this.scheme=":",this.username="",this.password="",this.host=null,this.port=null,this.path=[],this.query=null,this.fragment=null}}class URLSearchParams{constructor(e){if(null==e)this[searchParams]=[];else if("object"==typeof e||"function"==typeof e){const r=e[Symbol.iterator];if(r===this[Symbol.iterator]){const t=e[searchParams];this[searchParams]=t.slice()}else if(null!=r){if("function"!=typeof r)throw new ERR_ARG_NOT_ITERABLE("Query pairs");const t=[];for(const r of e){if("object"!=typeof r&&"function"!=typeof r||null===r||"function"!=typeof r[Symbol.iterator])throw new ERR_INVALID_TUPLE("Each query pair","[name, value]");const e=[];for(const t of r)e.push(toUSVString(t));t.push(e)}this[searchParams]=[];for(const e of t){if(2!==e.length)throw new ERR_INVALID_TUPLE("Each query pair","[name, value]");this[searchParams].push(e[0],e[1])}}else{this[searchParams]=[];const r=Reflect.ownKeys(e);for(var t=0;t<r.length;t++){const a=r[t],s=Reflect.getOwnPropertyDescriptor(e,a);if(void 0!==s&&s.enumerable){const t=toUSVString(a),r=toUSVString(e[a]);this[searchParams].push(t,r)}}}}else"?"===(e=toUSVString(e))[0]&&(e=e.slice(1)),initSearchParams(this,e);this[context]=null}[util.inspect.custom](e,t){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");if("number"==typeof e&&e<0)return t.stylize("[Object]","special");var r=util._extend({},t);null!==e&&(r.depth=e-1);for(var a=e=>util.inspect(e,r),s=this[searchParams],n=[],o=0;o<s.length;o+=2)n.push(`${a(s[o])} => ${a(s[o+1])}`);return n.reduce((e,t)=>e+removeColors(t).length+", ".length,-", ".length)>t.breakLength?`${this.constructor.name} {\n  ${n.join(",\n  ")} }`:n.length?`${this.constructor.name} { ${n.join(", ")} }`:`${this.constructor.name} {}`}}function onParseComplete(e,t,r,a,s,n,o,i,h){var c=this[context];c.flags=e,c.scheme=t,c.username=0!=(e&URL_FLAGS_HAS_USERNAME)?r:"",c.password=0!=(e&URL_FLAGS_HAS_PASSWORD)?a:"",c.port=n,c.path=0!=(e&URL_FLAGS_HAS_PATH)?o:[],c.query=i,c.fragment=h,c.host=s,this[searchParams]||(this[searchParams]=new URLSearchParams,this[searchParams][context]=this),initSearchParams(this[searchParams],i)}function onParseError(e,t){const r=new ERR_INVALID_URL(t);throw r.input=t,r}function parse(e,t,r){const a=r?r[context]:void 0;e[context]=new URLContext,_parse(t.trim(),-1,a,void 0,onParseComplete.bind(e),onParseError)}function onParseProtocolComplete(e,t,r,a,s,n,o,i,h){const c=this[context];0!=(e&URL_FLAGS_SPECIAL)?c.flags|=URL_FLAGS_SPECIAL:c.flags&=~URL_FLAGS_SPECIAL,c.scheme=t,c.port=n}function onParseHostnameComplete(e,t,r,a,s,n,o,i,h){const c=this[context];0!=(e&URL_FLAGS_HAS_HOST)?(c.host=s,c.flags|=URL_FLAGS_HAS_HOST):(c.host=null,c.flags&=~URL_FLAGS_HAS_HOST)}function onParsePortComplete(e,t,r,a,s,n,o,i,h){this[context].port=n}function onParseHostComplete(e,t,r,a,s,n,o,i,h){onParseHostnameComplete.apply(this,arguments),null===n&&0==(e&URL_FLAGS_IS_DEFAULT_SCHEME_PORT)||onParsePortComplete.apply(this,arguments)}function onParsePathComplete(e,t,r,a,s,n,o,i,h){const c=this[context];0!=(e&URL_FLAGS_HAS_PATH)?(c.path=o,c.flags|=URL_FLAGS_HAS_PATH):(c.path=[],c.flags&=~URL_FLAGS_HAS_PATH),0!=(e&URL_FLAGS_HAS_HOST)&&(c.host=s,c.flags|=URL_FLAGS_HAS_HOST)}function onParseSearchComplete(e,t,r,a,s,n,o,i,h){this[context].query=i}function onParseHashComplete(e,t,r,a,s,n,o,i,h){this[context].fragment=h}class URL{constructor(e,t){e=`${e}`,void 0!==t&&(t=new URL(t)),parse(this,e,t)}get[special](){return 0!=(this[context].flags&URL_FLAGS_SPECIAL)}get[cannotBeBase](){return 0!=(this[context].flags&URL_FLAGS_CANNOT_BE_BASE)}get[cannotHaveUsernamePasswordPort](){const{host:e,scheme:t}=this[context];return null==e||""===e||this[cannotBeBase]||"file:"===t}[util.inspect.custom](e,t){if(null==this||Object.getPrototypeOf(this[context])!==URLContext.prototype)throw new ERR_INVALID_THIS("URL");if("number"==typeof e&&e<0)return t.stylize("[Object]","special");var r=getConstructorOf(this),a=Object.create({constructor:null===r?URL:r});return a.href=this.href,a.origin=this.origin,a.protocol=this.protocol,a.username=this.username,a.password=this.password,a.host=this.host,a.hostname=this.hostname,a.port=this.port,a.pathname=this.pathname,a.search=this.search,a.searchParams=this.searchParams,a.hash=this.hash,t.showHidden&&(a.cannotBeBase=this[cannotBeBase],a.special=this[special],a[context]=this[context]),util.inspect(a,t)}}function update(e,t){if(!e)return;const r=e[context],a=t.toString();a?(r.query=a,r.flags|=URL_FLAGS_HAS_QUERY):(r.query=null,r.flags&=~URL_FLAGS_HAS_QUERY)}function initSearchParams(e,t){e[searchParams]=t?parseParams(t):[]}function parseParams(e){const t=[];var r,a=0,s=0,n=!1,o="",i=!1,h=0;for(r=0;r<e.length;++r){const c=e.charCodeAt(r);if(c!==CHAR_AMPERSAND)n||c!==CHAR_EQUAL?c===CHAR_PLUS?(s<r&&(o+=e.slice(s,r)),o+=" ",s=r+1):i||(c===CHAR_PERCENT?h=1:h>0&&(isHexTable[c]?3==++h&&(querystring=require("querystring"),i=!0):h=0)):(s<r&&(o+=e.slice(s,r)),i&&(o=querystring.unescape(o)),t.push(o),n=!0,o="",i=!1,h=0,s=r+1);else{if(a===r){s=a=r+1;continue}s<r&&(o+=e.slice(s,r)),i&&(o=querystring.unescape(o)),t.push(o),n||t.push(""),n=!1,o="",i=!1,h=0,s=a=r+1}}return a===r?t:(s<r&&(o+=e.slice(s,r)),i&&(o=querystring.unescape(o)),t.push(o),n||t.push(""),t)}Object.defineProperties(URL.prototype,{[kFormat]:{enumerable:!1,configurable:!1,value:function(e){if(e&&"object"!=typeof e)throw new ERR_INVALID_ARG_TYPE("options","Object",e);e=util._extend({fragment:!0,unicode:!1,search:!0,auth:!0},e);const t=this[context];var r=t.scheme;if(null!==t.host){r+="//";const a=""!==t.username,s=""!==t.password;e.auth&&(a||s)&&(a&&(r+=t.username),s&&(r+=`:${t.password}`),r+="@"),r+=e.unicode?domainToUnicode(this.hostname):this.hostname,null!==t.port&&(r+=`:${t.port}`)}else"file:"===t.scheme&&(r+="//");return this.pathname&&(r+=this.pathname),e.search&&null!==t.query&&(r+=`?${t.query}`),e.fragment&&null!==t.fragment&&(r+=`#${t.fragment}`),r}},[Symbol.toStringTag]:{configurable:!0,value:"URL"},toString:{writable:!0,enumerable:!0,configurable:!0,value:function(){return this[kFormat]({})}},href:{enumerable:!0,configurable:!0,get(){return this[kFormat]({})},set(e){parse(this,e=`${e}`)}},origin:{enumerable:!0,configurable:!0,get(){const e=this[context];switch(e.scheme){case"blob:":if(e.path.length>0)try{return new URL(e.path[0]).origin}catch{}return"null";case"ftp:":case"gopher:":case"http:":case"https:":case"ws:":case"wss:":return serializeTupleOrigin(e.scheme,e.host,e.port)}return"null"}},protocol:{enumerable:!0,configurable:!0,get(){return this[context].scheme},set(e){if(0===(e=`${e}`).length)return;const t=this[context];("file:"!==t.scheme||""!==t.host&&null!==t.host)&&_parse(e,kSchemeStart,null,t,onParseProtocolComplete.bind(this))}},username:{enumerable:!0,configurable:!0,get(){return this[context].username},set(e){if(e=`${e}`,this[cannotHaveUsernamePasswordPort])return;const t=this[context];if(""===e)return t.username="",void(t.flags&=~URL_FLAGS_HAS_USERNAME);t.username=encodeAuth(e),t.flags|=URL_FLAGS_HAS_USERNAME}},password:{enumerable:!0,configurable:!0,get(){return this[context].password},set(e){if(e=`${e}`,this[cannotHaveUsernamePasswordPort])return;const t=this[context];if(""===e)return t.password="",void(t.flags&=~URL_FLAGS_HAS_PASSWORD);t.password=encodeAuth(e),t.flags|=URL_FLAGS_HAS_PASSWORD}},host:{enumerable:!0,configurable:!0,get(){const e=this[context];var t=e.host||"";return null!==e.port&&(t+=`:${e.port}`),t},set(e){const t=this[context];e=`${e}`,this[cannotBeBase]||_parse(e,kHost,null,t,onParseHostComplete.bind(this))}},hostname:{enumerable:!0,configurable:!0,get(){return this[context].host||""},set(e){const t=this[context];e=`${e}`,this[cannotBeBase]||_parse(e,kHostname,null,t,onParseHostnameComplete.bind(this))}},port:{enumerable:!0,configurable:!0,get(){const e=this[context].port;return null===e?"":String(e)},set(e){if(e=`${e}`,this[cannotHaveUsernamePasswordPort])return;const t=this[context];""!==e?_parse(e,kPort,null,t,onParsePortComplete.bind(this)):t.port=null}},pathname:{enumerable:!0,configurable:!0,get(){const e=this[context];return this[cannotBeBase]?e.path[0]:0===e.path.length?"":`/${e.path.join("/")}`},set(e){e=`${e}`,this[cannotBeBase]||_parse(e,kPathStart,null,this[context],onParsePathComplete.bind(this))}},search:{enumerable:!0,configurable:!0,get(){const{query:e}=this[context];return null===e||""===e?"":`?${e}`},set(e){const t=this[context];""===(e=toUSVString(e))?(t.query=null,t.flags&=~URL_FLAGS_HAS_QUERY):("?"===e[0]&&(e=e.slice(1)),t.query="",t.flags|=URL_FLAGS_HAS_QUERY,e&&_parse(e,kQuery,null,t,onParseSearchComplete.bind(this))),initSearchParams(this[searchParams],e)}},searchParams:{enumerable:!0,configurable:!0,get(){return this[searchParams]}},hash:{enumerable:!0,configurable:!0,get(){const{fragment:e}=this[context];return null===e||""===e?"":`#${e}`},set(e){const t=this[context];if(!(e=`${e}`))return t.fragment=null,void(t.flags&=~URL_FLAGS_HAS_FRAGMENT);"#"===e[0]&&(e=e.slice(1)),t.fragment="",t.flags|=URL_FLAGS_HAS_FRAGMENT,_parse(e,kFragment,null,t,onParseHashComplete.bind(this))}},toJSON:{writable:!0,enumerable:!0,configurable:!0,value:function(){return this[kFormat]({})}}});const noEscape=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0],paramHexTable=hexTable.slice();function encodeStr(e,t,r){const a=e.length;if(0===a)return"";for(var s="",n=0,o=0;o<a;o++){var i=e.charCodeAt(o);if(i<128){if(1===t[i])continue;n<o&&(s+=e.slice(n,o)),n=o+1,s+=r[i]}else{if(n<o&&(s+=e.slice(n,o)),i<2048)n=o+1,s+=r[192|i>>6]+r[128|63&i];else if(i<55296||i>=57344)n=o+1,s+=r[224|i>>12]+r[128|i>>6&63]+r[128|63&i];else n=++o+1,s+=r[240|(i=65536+((1023&i)<<10|(o<a?1023&e.charCodeAt(o):0)))>>18]+r[128|i>>12&63]+r[128|i>>6&63]+r[128|63&i]}}return 0===n?e:n<a?s+e.slice(n):s}function serializeParams(e){const t=e.length;if(0===t)return"";let r=`${encodeStr(e[0],noEscape,paramHexTable)}=${encodeStr(e[1],noEscape,paramHexTable)}`;for(var a=2;a<t;a+=2){r+=`&${encodeStr(e[a],noEscape,paramHexTable)}=${encodeStr(e[a+1],noEscape,paramHexTable)}`}return r}function defineIDLClass(e,t,r){Object.defineProperty(e,Symbol.toStringTag,{writable:!1,enumerable:!1,configurable:!0,value:t});for(const t of Object.keys(r))Object.defineProperty(e,t,{writable:!0,enumerable:!0,configurable:!0,value:r[t]});for(const t of Object.getOwnPropertySymbols(r))Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:r[t]})}function merge(e,t,r,a,s,n){const o=r-t,i=a-r;var h,c,l;for(h=0;h<o;h++)s[h]=e[t+h];for(c=0;c<i;c++)n[c]=e[r+c];for(h=0,c=0,l=t;h<o&&c<i;)s[h]<=n[c]?(e[l++]=s[h++],e[l++]=s[h++]):(e[l++]=n[c++],e[l++]=n[c++]);for(;h<o;)e[l++]=s[h++];for(;c<i;)e[l++]=n[c++]}function createSearchParamsIterator(e,t){const r=Object.create(URLSearchParamsIteratorPrototype);return r[context]={target:e,kind:t,index:0},r}paramHexTable[32]="+",defineIDLClass(URLSearchParams.prototype,"URLSearchParams",{append(e,t){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");if(arguments.length<2)throw new ERR_MISSING_ARGS("name","value");e=toUSVString(e),t=toUSVString(t),this[searchParams].push(e,t),update(this[context],this)},delete(e){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");if(arguments.length<1)throw new ERR_MISSING_ARGS("name");const t=this[searchParams];e=toUSVString(e);for(var r=0;r<t.length;){t[r]===e?t.splice(r,2):r+=2}update(this[context],this)},get(e){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");if(arguments.length<1)throw new ERR_MISSING_ARGS("name");const t=this[searchParams];e=toUSVString(e);for(var r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1];return null},getAll(e){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");if(arguments.length<1)throw new ERR_MISSING_ARGS("name");const t=this[searchParams],r=[];e=toUSVString(e);for(var a=0;a<t.length;a+=2)t[a]===e&&r.push(t[a+1]);return r},has(e){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");if(arguments.length<1)throw new ERR_MISSING_ARGS("name");const t=this[searchParams];e=toUSVString(e);for(var r=0;r<t.length;r+=2)if(t[r]===e)return!0;return!1},set(e,t){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");if(arguments.length<2)throw new ERR_MISSING_ARGS("name","value");const r=this[searchParams];e=toUSVString(e),t=toUSVString(t);for(var a=!1,s=0;s<r.length;){r[s]===e?a?r.splice(s,2):(r[s+1]=t,a=!0,s+=2):s+=2}a||r.push(e,t),update(this[context],this)},sort(){const e=this[searchParams],t=e.length;if(t<=2);else if(t<100)for(var r=2;r<t;r+=2){var a,s=e[r],n=e[r+1];for(a=r-2;a>=0&&e[a]>s;a-=2)e[a+2]=e[a],e[a+3]=e[a+1];e[a+2]=s,e[a+3]=n}else{const r=new Array(t),a=new Array(t);for(var o=2;o<t;o*=2)for(var i=0;i<t-2;i+=2*o){var h=i+o,c=h+o;h>(c=c<t?c:t)||merge(e,i,h,c,r,a)}}update(this[context],this)},entries(){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");return createSearchParamsIterator(this,"key+value")},forEach(e,t){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");if("function"!=typeof e)throw new ERR_INVALID_CALLBACK;let r=this[searchParams];for(var a=0;a<r.length;){const s=r[a],n=r[a+1];e.call(t,n,s,this),r=this[searchParams],a+=2}},keys(){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");return createSearchParamsIterator(this,"key")},values(){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");return createSearchParamsIterator(this,"value")},toString(){if(!this||!this[searchParams]||this[searchParams][searchParams])throw new ERR_INVALID_THIS("URLSearchParams");return serializeParams(this[searchParams])}}),Object.defineProperty(URLSearchParams.prototype,Symbol.iterator,{writable:!0,configurable:!0,value:URLSearchParams.prototype.entries});const URLSearchParamsIteratorPrototype=Object.create(IteratorPrototype);function domainToASCII(e){if(arguments.length<1)throw new ERR_MISSING_ARGS("domain");return _domainToASCII(`${e}`)}function domainToUnicode(e){if(arguments.length<1)throw new ERR_MISSING_ARGS("domain");return _domainToUnicode(`${e}`)}function urlToOptions(e){var t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname}${e.search}`,href:e.href};return""!==e.port&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${e.username}:${e.password}`),t}function getPathFromURLWin32(e){for(var t=e.hostname,r=e.pathname,a=0;a<r.length;a++)if("%"===r[a]){var s=32|r.codePointAt(a+2);if("2"===r[a+1]&&102===s||"5"===r[a+1]&&99===s)throw new ERR_INVALID_FILE_URL_PATH("must not include encoded \\ or / characters")}if(r=decodeURIComponent(r),""!==t)return`//${domainToUnicode(t)}${r}`;var n=32|r.codePointAt(1),o=r[2];if(n<CHAR_LOWERCASE_A||n>CHAR_LOWERCASE_Z||":"!==o)throw new ERR_INVALID_FILE_URL_PATH("must be absolute");return r.slice(1)}function getPathFromURLPosix(e){if(""!==e.hostname)throw new ERR_INVALID_FILE_URL_HOST(platform);for(var t=e.pathname,r=0;r<t.length;r++)if("%"===t[r]){var a=32|t.codePointAt(r+2);if("2"===t[r+1]&&102===a)throw new ERR_INVALID_FILE_URL_PATH("must not include encoded / characters")}return decodeURIComponent(t)}function fileURLToPath(e){if("string"==typeof e)e=new URL(e);else if(null==e||!e[searchParams]||!e[searchParams][searchParams])throw new ERR_INVALID_ARG_TYPE("path",["string","URL"],e);if("file:"!==e.protocol)throw new ERR_INVALID_URL_SCHEME("file");return isWindows?getPathFromURLWin32(e):getPathFromURLPosix(e)}defineIDLClass(URLSearchParamsIteratorPrototype,"URLSearchParams Iterator",{next(){if(!this||Object.getPrototypeOf(this)!==URLSearchParamsIteratorPrototype)throw new ERR_INVALID_THIS("URLSearchParamsIterator");const{target:e,kind:t,index:r}=this[context],a=e[searchParams];if(r>=a.length)return{value:void 0,done:!0};const s=a[r],n=a[r+1];let o;return this[context].index=r+2,{value:o="key"===t?s:"value"===t?n:[s,n],done:!1}},[util.inspect.custom](e,t){if(null==this||null==this[context]||null==this[context].target)throw new ERR_INVALID_THIS("URLSearchParamsIterator");if("number"==typeof e&&e<0)return t.stylize("[Object]","special");const r=util._extend({},t);null!==e&&(r.depth=e-1);const{target:a,kind:s,index:n}=this[context],o=a[searchParams].slice(n).reduce((e,t,r)=>{const o=r%2==0;return"key"===s&&o?e.push(t):"value"!==s||o?"key+value"!==s||o||e.push([a[searchParams][n+r-1],t]):e.push(t),e},[]),i=util.inspect(o,r).includes("\n"),h=o.map(e=>util.inspect(e,r));let c;return c=i?`\n  ${h.join(",\n  ")}`:` ${h.join(", ")}`,`${this[Symbol.toStringTag]} {${c} }`}});const percentRegEx=/%/g,backslashRegEx=/\\/g;function pathToFileURL(e){let t=path.resolve(e);const r=e.charCodeAt(e.length-1);(r===CHAR_FORWARD_SLASH||isWindows&&r===CHAR_BACKWARD_SLASH)&&t[t.length-1]!==path.sep&&(t+="/");const a=new URL("file://");return t.includes("%")&&(t=t.replace(percentRegEx,"%25")),!isWindows&&t.includes("\\")&&(t=t.replace(backslashRegEx,"%5C")),a.pathname=t,a}function toPathIfFileURL(e){return null!=e&&e[searchParams]&&e[searchParams][searchParams]?fileURLToPath(e):e}function NativeURL(e){this[context]=e}function constructUrl(e,t,r,a,s,n,o,i,h){var c=new URLContext;c.flags=e,c.scheme=t,c.username=0!=(e&URL_FLAGS_HAS_USERNAME)?r:"",c.password=0!=(e&URL_FLAGS_HAS_PASSWORD)?a:"",c.port=n,c.path=0!=(e&URL_FLAGS_HAS_PATH)?o:[],c.query=i,c.fragment=h,c.host=s;const l=new NativeURL(c);return l[searchParams]=new URLSearchParams,l[searchParams][context]=l,initSearchParams(l[searchParams],i),l}NativeURL.prototype=URL.prototype,setURLConstructor(constructUrl),module.exports={toUSVString,fileURLToPath,pathToFileURL,toPathIfFileURL,URL,URLSearchParams,domainToASCII,domainToUnicode,urlToOptions,formatSymbol:kFormat,searchParamsSymbol:searchParams,encodeStr};"use strict";const{compare}=process.binding("buffer"),{isArrayBufferView}=require("internal/util/types"),{isDate,isMap,isRegExp,isSet}=internalBinding("types"),{getOwnNonIndexProperties,propertyFilter:{ONLY_ENUMERABLE}}=process.binding("util"),ReflectApply=Reflect.apply;function uncurryThis(e){return(t,...r)=>ReflectApply(e,t,r)}const kStrict=!0,kLoose=!1,kNoIterator=0,kIsArray=1,kIsSet=2,kIsMap=3,objectToString=uncurryThis(Object.prototype.toString),hasOwnProperty=uncurryThis(Object.prototype.hasOwnProperty),propertyIsEnumerable=uncurryThis(Object.prototype.propertyIsEnumerable),objectKeys=Object.keys,getPrototypeOf=Object.getPrototypeOf,getOwnPropertySymbols=Object.getOwnPropertySymbols,objectIs=Object.is,numberIsNaN=Number.isNaN;function areSimilarRegExps(e,t){return e.source===t.source&&e.flags===t.flags}function areSimilarFloatArrays(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function areSimilarTypedArrays(e,t){return e.byteLength===t.byteLength&&0===compare(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function isFloatTypedArrayTag(e){return"[object Float32Array]"===e||"[object Float64Array]"===e}function isArguments(e){return"[object Arguments]"===e}function isObjectOrArrayTag(e){return"[object Array]"===e||"[object Object]"===e}function strictDeepEqual(e,t,r){if("object"!=typeof e)return"number"==typeof e&&numberIsNaN(e)&&numberIsNaN(t);if("object"!=typeof t||null===e||null===t)return!1;const n=objectToString(e);if(n!==objectToString(t))return!1;if(getPrototypeOf(e)!==getPrototypeOf(t))return!1;if("[object Array]"===n){if(e.length!==t.length)return!1;const n=getOwnNonIndexProperties(e,ONLY_ENUMERABLE),i=getOwnNonIndexProperties(t,ONLY_ENUMERABLE);return n.length===i.length&&keyCheck(e,t,kStrict,r,kIsArray,n)}if("[object Object]"===n)return keyCheck(e,t,kStrict,r,kNoIterator);if(isDate(e)){if(e.getTime()!==t.getTime())return!1}else if(isRegExp(e)){if(!areSimilarRegExps(e,t))return!1}else if("[object Error]"===n){if(e.message!==t.message)return!1}else{if(isArrayBufferView(e)){if(!areSimilarTypedArrays(e,t))return!1;const n=getOwnNonIndexProperties(e,ONLY_ENUMERABLE),i=getOwnNonIndexProperties(t,ONLY_ENUMERABLE);return n.length===i.length&&keyCheck(e,t,kStrict,r,kNoIterator,n)}if(isSet(e))return!(!isSet(t)||e.size!==t.size)&&keyCheck(e,t,kStrict,r,kIsSet);if(isMap(e))return!(!isMap(t)||e.size!==t.size)&&keyCheck(e,t,kStrict,r,kIsMap);if("function"==typeof e.valueOf){const r=e.valueOf();if(r!==e&&("function"!=typeof t.valueOf||!innerDeepEqual(r,t.valueOf(),kStrict)))return!1}}return keyCheck(e,t,kStrict,r,kNoIterator)}function looseDeepEqual(e,t,r){if(null===e||"object"!=typeof e)return(null===t||"object"!=typeof t)&&e==t;if(null===t||"object"!=typeof t)return!1;const n=objectToString(e),i=objectToString(t);if(n===i){if(isObjectOrArrayTag(n))return keyCheck(e,t,kLoose,r,kNoIterator);if(isArrayBufferView(e))return isFloatTypedArrayTag(n)?areSimilarFloatArrays(e,t):areSimilarTypedArrays(e,t);if(isDate(e)&&isDate(t))return e.getTime()===t.getTime();if(isRegExp(e)&&isRegExp(t))return areSimilarRegExps(e,t);if(e instanceof Error&&t instanceof Error&&(e.message!==t.message||e.name!==t.name))return!1}else if(isArguments(n)||isArguments(i))return!1;return isSet(e)?!(!isSet(t)||e.size!==t.size)&&keyCheck(e,t,kLoose,r,kIsSet):isMap(e)?!(!isMap(t)||e.size!==t.size)&&keyCheck(e,t,kLoose,r,kIsMap):!isSet(t)&&!isMap(t)&&keyCheck(e,t,kLoose,r,kNoIterator)}function getEnumerables(e,t){return t.filter(t=>propertyIsEnumerable(e,t))}function keyCheck(e,t,r,n,i,o){if(5===arguments.length){o=objectKeys(e);const r=objectKeys(t);if(o.length!==r.length)return!1}let s=0;for(;s<o.length;s++)if(!hasOwnProperty(t,o[s]))return!1;if(r&&5===arguments.length){const r=getOwnPropertySymbols(e);if(0!==r.length){let n=0;for(s=0;s<r.length;s++){const i=r[s];if(propertyIsEnumerable(e,i)){if(!propertyIsEnumerable(t,i))return!1;o.push(i),n++}else if(propertyIsEnumerable(t,i))return!1}const i=getOwnPropertySymbols(t);if(r.length!==i.length&&getEnumerables(t,i).length!==n)return!1}else{const e=getOwnPropertySymbols(t);if(0!==e.length&&0!==getEnumerables(t,e).length)return!1}}if(0===o.length&&(i===kNoIterator||i===kIsArray&&0===e.length||0===e.size))return!0;if(void 0===n)n={val1:new Map,val2:new Map,position:0};else{const r=n.val1.get(e);if(void 0!==r){const e=n.val2.get(t);if(void 0!==e)return r===e}n.position++}n.val1.set(e,n.position),n.val2.set(t,n.position);const u=objEquiv(e,t,r,o,n,i);return n.val1.delete(e),n.val2.delete(t),u}function innerDeepEqual(e,t,r,n){return e===t?0!==e||(!r||objectIs(e,t)):!0===r?strictDeepEqual(e,t,n):looseDeepEqual(e,t,n)}function setHasEqualElement(e,t,r,n){for(const i of e)if(innerDeepEqual(t,i,r,n))return e.delete(i),!0;return!1}function findLooseMatchingPrimitives(e){switch(typeof e){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":e=+e;case"number":if(Number.isNaN(e))return!1}return!0}function setMightHaveLoosePrim(e,t,r){const n=findLooseMatchingPrimitives(r);return null!=n?n:t.has(n)&&!e.has(n)}function mapMightHaveLoosePrim(e,t,r,n,i){const o=findLooseMatchingPrimitives(r);if(null!=o)return o;const s=t.get(o);if(void 0===s&&!t.has(o)||!innerDeepEqual(n,s,!1,i))return!1;const u=e.get(o);return void 0===u&&e.has(o)||innerDeepEqual(n,u,!1,i)}function setEquiv(e,t,r,n){let i=null;for(const n of e)if("object"==typeof n&&null!==n)null===i&&(i=new Set),i.add(n);else if(!t.has(n)){if(r)return!1;if(!setMightHaveLoosePrim(e,t,n))return!1;null===i&&(i=new Set),i.add(n)}if(null!==i){for(const o of t)if("object"==typeof o&&null!==o){if(!setHasEqualElement(i,o,r,n))return!1}else if(!r&&!e.has(o)&&!setHasEqualElement(i,o,r,n))return!1;return 0===i.size}return!0}function mapHasEqualEntry(e,t,r,n,i,o){for(const s of e)if(innerDeepEqual(r,s,i,o)&&innerDeepEqual(n,t.get(s),i,o))return e.delete(s),!0;return!1}function mapEquiv(e,t,r,n){let i=null;for(const[o,s]of e)if("object"==typeof o&&null!==o)null===i&&(i=new Set),i.add(o);else{const u=t.get(o);if(void 0===u&&!t.has(o)||!innerDeepEqual(s,u,r,n)){if(r)return!1;if(!mapMightHaveLoosePrim(e,t,o,s,n))return!1;null===i&&(i=new Set),i.add(o)}}if(null!==i){for(const[o,s]of t)if("object"==typeof o&&null!==o){if(!mapHasEqualEntry(i,e,o,s,r,n))return!1}else if(!(r||e.has(o)&&innerDeepEqual(e.get(o),s,!1,n)||mapHasEqualEntry(i,e,o,s,!1,n)))return!1;return 0===i.size}return!0}function objEquiv(e,t,r,n,i,o){let s=0;if(o===kIsSet){if(!setEquiv(e,t,r,i))return!1}else if(o===kIsMap){if(!mapEquiv(e,t,r,i))return!1}else if(o===kIsArray)for(;s<e.length;s++){if(!hasOwnProperty(e,s)){if(hasOwnProperty(t,s))return!1;{const n=objectKeys(e);for(s++;s<n.length;s++){const o=n[s];if(!hasOwnProperty(t,o)||!innerDeepEqual(e[o],t[s],r,i))return!1}return n.length===objectKeys(t).length}}if(!hasOwnProperty(t,s)||!innerDeepEqual(e[s],t[s],r,i))return!1}for(s=0;s<n.length;s++){const o=n[s];if(!innerDeepEqual(e[o],t[o],r,i))return!1}return!0}function isDeepEqual(e,t){return innerDeepEqual(e,t,kLoose)}function isDeepStrictEqual(e,t){return innerDeepEqual(e,t,kStrict)}module.exports={isDeepEqual,isDeepStrictEqual};"use strict";const{getOwnNonIndexProperties,getPromiseDetails,getProxyDetails,kPending,kRejected,previewEntries,propertyFilter:{ALL_PROPERTIES,ONLY_ENUMERABLE}}=process.binding("util"),{customInspectSymbol,deprecate,isError,join,removeColors}=require("internal/util"),{codes:{ERR_INVALID_ARG_TYPE},isStackOverflowError}=require("internal/errors"),types=internalBinding("types");Object.assign(types,require("internal/util/types"));const{isAnyArrayBuffer,isArrayBuffer,isArgumentsObject,isBoxedPrimitive,isDataView,isExternal,isMap,isMapIterator,isPromise,isSet,isSetIterator,isWeakMap,isWeakSet,isRegExp,isDate,isTypedArray,isStringObject,isNumberObject,isBooleanObject,isBigIntObject,isUint8Array,isUint8ClampedArray,isUint16Array,isUint32Array,isInt8Array,isInt16Array,isInt32Array,isFloat32Array,isFloat64Array,isBigInt64Array,isBigUint64Array}=types,ReflectApply=Reflect.apply;function uncurryThis(e){return(t,...r)=>ReflectApply(e,t,r)}const propertyIsEnumerable=uncurryThis(Object.prototype.propertyIsEnumerable),regExpToString=uncurryThis(RegExp.prototype.toString),dateToISOString=uncurryThis(Date.prototype.toISOString),errorToString=uncurryThis(Error.prototype.toString),bigIntValueOf=uncurryThis(BigInt.prototype.valueOf),booleanValueOf=uncurryThis(Boolean.prototype.valueOf),numberValueOf=uncurryThis(Number.prototype.valueOf),symbolValueOf=uncurryThis(Symbol.prototype.valueOf),stringValueOf=uncurryThis(String.prototype.valueOf),setValues=uncurryThis(Set.prototype.values),mapEntries=uncurryThis(Map.prototype.entries),dateGetTime=uncurryThis(Date.prototype.getTime),hasOwnProperty=uncurryThis(Object.prototype.hasOwnProperty),inspectDefaultOptions=Object.seal({showHidden:!1,depth:2,colors:!1,customInspect:!0,showProxy:!1,maxArrayLength:100,breakLength:60,compact:!0,sorted:!1}),kObjectType=0,kArrayType=1,kArrayExtrasType=2,strEscapeSequencesRegExp=/[\x00-\x1f\x27\x5c]/,strEscapeSequencesReplacer=/[\x00-\x1f\x27\x5c]/g,keyStrRegExp=/^[a-zA-Z_][a-zA-Z_0-9]*$/,numberRegExp=/^(0|[1-9][0-9]*)$/,readableRegExps={},kMinLineLength=16,kWeak=0,kIterator=1,kMapEntries=2,meta=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000b","\\f","\\r","\\u000e","\\u000f","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001a","\\u001b","\\u001c","\\u001d","\\u001e","\\u001f","","","","","","","","\\'","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\"];function inspect(e,t){const r={budget:{},indentationLvl:0,seen:[],stylize:stylizeNoColor,showHidden:inspectDefaultOptions.showHidden,depth:inspectDefaultOptions.depth,colors:inspectDefaultOptions.colors,customInspect:inspectDefaultOptions.customInspect,showProxy:inspectDefaultOptions.showProxy,maxArrayLength:inspectDefaultOptions.maxArrayLength,breakLength:inspectDefaultOptions.breakLength,compact:inspectDefaultOptions.compact,sorted:inspectDefaultOptions.sorted};if(arguments.length>2&&(void 0!==arguments[2]&&(r.depth=arguments[2]),arguments.length>3&&void 0!==arguments[3]&&(r.colors=arguments[3])),"boolean"==typeof t)r.showHidden=t;else if(t){const e=Object.keys(t);for(var n=0;n<e.length;n++)r[e[n]]=t[e[n]]}return r.colors&&(r.stylize=stylizeWithColor),null===r.maxArrayLength&&(r.maxArrayLength=1/0),formatValue(r,e,r.depth)}inspect.custom=customInspectSymbol,Object.defineProperty(inspect,"defaultOptions",{get:()=>inspectDefaultOptions,set(e){if(null===e||"object"!=typeof e)throw new ERR_INVALID_ARG_TYPE("options","Object",e);return Object.assign(inspectDefaultOptions,e)}}),inspect.colors=Object.assign(Object.create(null),{bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]}),inspect.styles=Object.assign(Object.create(null),{special:"cyan",number:"yellow",bigint:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",symbol:"green",date:"magenta",regexp:"red"});const escapeFn=e=>meta[e.charCodeAt(0)];function strEscape(e){if(e.length<5e3&&!strEscapeSequencesRegExp.test(e))return`'${e}'`;if(e.length>100)return`'${e.replace(strEscapeSequencesReplacer,escapeFn)}'`;let t="",r=0;for(var n=0;n<e.length;n++){const i=e.charCodeAt(n);(39===i||92===i||i<32)&&(t+=r===n?meta[i]:`${e.slice(r,n)}${meta[i]}`,r=n+1)}return 0===r?t=e:r!==n&&(t+=e.slice(r)),`'${t}'`}function stylizeWithColor(e,t){const r=inspect.styles[t];if(void 0!==r){const t=inspect.colors[r];return`[${t[0]}m${e}[${t[1]}m`}return e}function stylizeNoColor(e){return e}function getEmptyFormatArray(){return[]}function getConstructorName(e){let t;for(;e;){const r=Object.getOwnPropertyDescriptor(e,"constructor");if(void 0!==r&&"function"==typeof r.value&&""!==r.value.name)return r.value.name;e=Object.getPrototypeOf(e),void 0===t&&(t=e)}return null===t?null:""}function getPrefix(e,t,r){return null===e?""!==t?`[${r}: null prototype] [${t}] `:`[${r}: null prototype] `:""!==e?""!==t&&e!==t?`${e} [${t}] `:`${e} `:""}const getBoxedValue=formatPrimitive.bind(null,stylizeNoColor);function getKeys(e,t){let r;const n=Object.getOwnPropertySymbols(e);if(t)r=Object.getOwnPropertyNames(e),0!==n.length&&r.push(...n);else{try{r=Object.keys(e)}catch(t){if(!types.isNativeError(t)||"ReferenceError"!==t.name||!types.isModuleNamespaceObject(e))throw t;r=Object.getOwnPropertyNames(e)}0!==n.length&&r.push(...n.filter(t=>propertyIsEnumerable(e,t)))}return r}function formatProxy(e,t,r){if(null!=r){if(r<0)return e.stylize("Proxy [Array]","special");r-=1}e.indentationLvl+=2;const n=[formatValue(e,t[0],r),formatValue(e,t[1],r)];return e.indentationLvl-=2,`Proxy ${reduceToSingleString(e,n,"",["[","]"])}`}function findTypedConstructor(e){for(const[t,r]of[[isUint8Array,Uint8Array],[isUint8ClampedArray,Uint8ClampedArray],[isUint16Array,Uint16Array],[isUint32Array,Uint32Array],[isInt8Array,Int8Array],[isInt16Array,Int16Array],[isInt32Array,Int32Array],[isFloat32Array,Float32Array],[isFloat64Array,Float64Array],[isBigInt64Array,BigInt64Array],[isBigUint64Array,BigUint64Array]])if(t(e))return r}let lazyNullPrototypeCache;function clazzWithNullPrototype(e,t){if(void 0===lazyNullPrototypeCache)lazyNullPrototypeCache=new Map;else{const t=lazyNullPrototypeCache.get(e);if(void 0!==t)return t}class r extends e{get[Symbol.toStringTag](){return""}}return Object.defineProperty(r.prototype.constructor,"name",{value:`[${t}: null prototype]`}),lazyNullPrototypeCache.set(e,r),r}function noPrototypeIterator(e,t,r){let n;if(isSet(t)){n=new(Object.getPrototypeOf(t)||clazzWithNullPrototype(Set,"Set"))(setValues(t))}else if(isMap(t)){n=new(Object.getPrototypeOf(t)||clazzWithNullPrototype(Map,"Map"))(mapEntries(t))}else if(Array.isArray(t)){n=new(Object.getPrototypeOf(t)||clazzWithNullPrototype(Array,"Array"))(t.length||0)}else if(isTypedArray(t)){let e=Object.getPrototypeOf(t);if(!e){const r=findTypedConstructor(t);e=clazzWithNullPrototype(r,r.name)}n=new e(t)}if(n)return Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)),formatValue(e,n,r)}function formatValue(e,t,r){if("object"!=typeof t&&"function"!=typeof t)return formatPrimitive(e.stylize,t,e);if(null===t)return e.stylize("null","null");if(e.showProxy){const n=getProxyDetails(t);if(void 0!==n)return formatProxy(e,n,r)}if(e.customInspect){let n=t[customInspectSymbol];if(n||t.inspect===inspect||"function"!=typeof t.inspect||(n=deprecate(t.inspect,"Custom inspection function on Objects via .inspect() is deprecated","DEP0079")),"function"==typeof n&&n!==inspect&&(!t.constructor||t.constructor.prototype!==t)){const i=n.call(t,r,e);if(i!==t)return"string"!=typeof i?formatValue(e,i,r):i}}return-1!==e.seen.indexOf(t)?e.stylize("[Circular]","special"):formatRaw(e,t,r)}function formatRaw(e,t,r){let n;const i=getConstructorName(t);let o=t[Symbol.toStringTag];"string"!=typeof o&&(o="");let s,a="",l=getEmptyFormatArray,c=!0,u=0,p=!1;const f=e.showHidden?ALL_PROPERTIES:ONLY_ENUMERABLE;let y,g=kObjectType;if(t[Symbol.iterator])if(c=!1,Array.isArray(t)){n=getOwnNonIndexProperties(t,f);const e=getPrefix(i,o,"Array");if(s=[`${"Array "===e?"":e}[`,"]"],0===t.length&&0===n.length)return`${s[0]}]`;g=kArrayExtrasType,l=formatArray}else if(isSet(t)){n=getKeys(t,e.showHidden);const r=getPrefix(i,o,"Set");if(0===t.size&&0===n.length)return`${r}{}`;s=[`${r}{`,"}"],l=formatSet}else if(isMap(t)){n=getKeys(t,e.showHidden);const r=getPrefix(i,o,"Map");if(0===t.size&&0===n.length)return`${r}{}`;s=[`${r}{`,"}"],l=formatMap}else if(isTypedArray(t)){if(n=getOwnNonIndexProperties(t,f),s=[`${null!==i?getPrefix(i,o):getPrefix(i,o,findTypedConstructor(t).name)}[`,"]"],0===t.length&&0===n.length&&!e.showHidden)return`${s[0]}]`;l=formatTypedArray,g=kArrayExtrasType}else isMapIterator(t)?(n=getKeys(t,e.showHidden),s=[`[${o}] {`,"}"],l=formatMapIterator):isSetIterator(t)?(n=getKeys(t,e.showHidden),s=[`[${o}] {`,"}"],l=formatSetIterator):c=!0;if(c)if(n=getKeys(t,e.showHidden),s=["{","}"],"Object"===i){if(isArgumentsObject(t)){if(0===n.length)return"[Arguments] {}";s[0]="[Arguments] {"}else if(""!==o){if(s[0]=`${getPrefix(i,o,"Object")}{`,0===n.length)return`${s[0]}}`}else if(0===n.length)return"{}"}else if("function"==typeof t){const r=`${i||o||"Function"}${t.name?`: ${t.name}`:""}`;if(0===n.length)return e.stylize(`[${r}]`,"special");a=`[${r}]`}else if(isRegExp(t)){if(0===n.length||r<0)return e.stylize(regExpToString(t),"regexp");a=`${regExpToString(t)}`}else if(isDate(t)){if(0===n.length)return Number.isNaN(dateGetTime(t))?e.stylize(String(t),"date"):e.stylize(dateToISOString(t),"date");a=dateToISOString(t)}else if(isError(t)){const r=(a=formatError(t)).indexOf("\n    at");if(-1===r&&(a=`[${a}]`),0!==e.indentationLvl){const r=" ".repeat(e.indentationLvl);a=formatError(t).replace(/\n/g,`\n${r}`)}if(0===n.length)return a;!1===e.compact&&-1!==r&&(s[0]+=`${a.slice(r)}`,a=`[${a.slice(0,r)}]`)}else if(isAnyArrayBuffer(t)){const r=getPrefix(i,o,isArrayBuffer(t)?"ArrayBuffer":"SharedArrayBuffer");if(0===n.length)return r+`{ byteLength: ${formatNumber(e.stylize,t.byteLength)} }`;s[0]=`${r}{`,n.unshift("byteLength")}else if(isDataView(t))s[0]=`${getPrefix(i,o,"DataView")}{`,n.unshift("byteLength","byteOffset","buffer");else if(isPromise(t))s[0]=`${getPrefix(i,o,"Promise")}{`,l=formatPromise;else if(isWeakSet(t))s[0]=`${getPrefix(i,o,"WeakSet")}{`,l=e.showHidden?formatWeakSet:formatWeakCollection;else if(isWeakMap(t))s[0]=`${getPrefix(i,o,"WeakMap")}{`,l=e.showHidden?formatWeakMap:formatWeakCollection;else if(types.isModuleNamespaceObject(t))s[0]=`[${o}] {`,l=formatNamespaceObject,p=!0;else if(isBoxedPrimitive(t)){let r;if(isNumberObject(t)?(a=`[Number: ${getBoxedValue(numberValueOf(t))}]`,r="number"):isStringObject(t)?(a=`[String: ${getBoxedValue(stringValueOf(t),e)}]`,r="string",n=n.slice(t.length)):isBooleanObject(t)?(a=`[Boolean: ${getBoxedValue(booleanValueOf(t))}]`,r="boolean"):isBigIntObject(t)?(a=`[BigInt: ${getBoxedValue(bigIntValueOf(t))}]`,r="bigint"):(a=`[Symbol: ${getBoxedValue(symbolValueOf(t))}]`,r="symbol"),0===n.length)return e.stylize(a,r)}else{const a=noPrototypeIterator(e,t,r);if(a)return a;if(isMapIterator(t))s=[`[${o||"Map Iterator"}] {`,"}"],l=formatMapIterator;else if(isSetIterator(t))s=[`[${o||"Set Iterator"}] {`,"}"],l=formatSetIterator;else{if(0===n.length)return isExternal(t)?e.stylize("[External]","special"):`${getPrefix(i,o,"Object")}{}`;s[0]=`${getPrefix(i,o,"Object")}{`}}if(null!=r){if(r<0)return e.stylize(`[${i||o||"Object"}]`,"special");r-=1}e.seen.push(t);const m=e.indentationLvl;try{if(y=l(e,t,r,n),!1===p)for(u=0;u<n.length;u++)y.push(formatProperty(e,t,r,n[u],g))}catch(t){return handleMaxCallStackSize(e,t,i,o,m)}if(e.seen.pop(),e.sorted){const t=!0===e.sorted?void 0:e.sorted;if(g===kObjectType)y=y.sort(t);else if(n.length>1){const e=y.slice(y.length-n.length).sort(t);y.splice(y.length-n.length,n.length,...e)}}return reduceToSingleString(e,y,a,s)}function handleMaxCallStackSize(e,t,r,n,i){if(isStackOverflowError(t))return e.seen.pop(),e.indentationLvl=i,e.stylize(`[${r||n||"Object"}: Inspection interrupted `+"prematurely. Maximum call stack size exceeded.]","special");throw t}function formatNumber(e,t){return Object.is(t,-0)?e("-0","number"):e(`${t}`,"number")}function formatPrimitive(e,t,r){if("string"==typeof t){if(!1===r.compact&&r.indentationLvl+t.length>r.breakLength&&t.length>kMinLineLength){const i=Math.max(r.breakLength-r.indentationLvl,kMinLineLength),o=Math.ceil(t.length/Math.ceil(t.length/i)),s=Math.max(o,kMinLineLength);let a="";void 0===readableRegExps[s]&&(readableRegExps[s]=new RegExp(`(.|\\n){1,${s}}(\\s|$)|(\\n|.)+?(\\s|$)`,"gm"));const l=t.match(readableRegExps[s]);if(l.length>1){const t=" ".repeat(r.indentationLvl);a+=`${e(strEscape(l[0]),"string")} +\n`;for(var n=1;n<l.length-1;n++)a+=`${t}  ${e(strEscape(l[n]),"string")} +\n`;return a+=`${t}  ${e(strEscape(l[n]),"string")}`}}return e(strEscape(t),"string")}return"number"==typeof t?formatNumber(e,t):"bigint"==typeof t?e(`${t}n`,"bigint"):"boolean"==typeof t?e(`${t}`,"boolean"):void 0===t?e("undefined","undefined"):e(t.toString(),"symbol")}function formatError(e){return e.stack||errorToString(e)}function formatNamespaceObject(e,t,r,n){const i=n.length,o=new Array(i);for(var s=0;s<i;s++)try{o[s]=formatProperty(e,t,r,n[s],kObjectType)}catch(t){if(!types.isNativeError(t)||"ReferenceError"!==t.name)throw t;const i={[n[s]]:""};o[s]=formatProperty(e,i,r,n[s],kObjectType);const a=o[s].lastIndexOf(" ");o[s]=o[s].slice(0,a+1)+e.stylize("<uninitialized>","special")}return o}function formatSpecialArray(e,t,r,n,i,o){const s=Object.keys(t);let a=o;for(;o<s.length&&i.length<n;o++){const l=s[o],c=+l;if(c>2**32-2)break;if(`${a}`!==l){if(!numberRegExp.test(l))break;const t=c-a,r=`<${t} empty item${t>1?"s":""}>`;if(i.push(e.stylize(r,"undefined")),a=c,i.length===n)break}i.push(formatProperty(e,t,r,l,kArrayType)),a++}const l=t.length-a;if(i.length!==n){if(l>0){const t=`<${l} empty item${l>1?"s":""}>`;i.push(e.stylize(t,"undefined"))}}else l>0&&i.push(`... ${l} more item${l>1?"s":""}`);return i}function formatArray(e,t,r){const n=t.length,i=Math.min(Math.max(0,e.maxArrayLength),n),o=n-i,s=[];for(var a=0;a<i;a++){if(!hasOwnProperty(t,a))return formatSpecialArray(e,t,r,i,s,a);s.push(formatProperty(e,t,r,a,kArrayType))}return o>0&&s.push(`... ${o} more item${o>1?"s":""}`),s}function formatTypedArray(e,t,r){const n=Math.min(Math.max(0,e.maxArrayLength),t.length),i=t.length-n,o=new Array(n);for(var s=0;s<n;++s)o[s]=formatNumber(e.stylize,t[s]);if(i>0&&(o[s]=`... ${i} more item${i>1?"s":""}`),e.showHidden){e.indentationLvl+=2;for(const n of["BYTES_PER_ELEMENT","length","byteLength","byteOffset","buffer"]){const i=formatValue(e,t[n],r);o.push(`[${n}]: ${i}`)}e.indentationLvl-=2}return o}function formatSet(e,t,r){const n=[];e.indentationLvl+=2;for(const i of t)n.push(formatValue(e,i,r));return e.indentationLvl-=2,e.showHidden&&n.push(`[size]: ${e.stylize(`${t.size}`,"number")}`),n}function formatMap(e,t,r){const n=[];e.indentationLvl+=2;for(const[i,o]of t)n.push(`${formatValue(e,i,r)} => `+formatValue(e,o,r));return e.indentationLvl-=2,e.showHidden&&n.push(`[size]: ${e.stylize(`${t.size}`,"number")}`),n}function formatSetIterInner(e,t,r,n){const i=Math.max(e.maxArrayLength,0),o=Math.min(i,r.length);let s=new Array(o);e.indentationLvl+=2;for(var a=0;a<o;a++)s[a]=formatValue(e,r[a],t);e.indentationLvl-=2,n===kWeak&&(s=s.sort());const l=r.length-o;return l>0&&s.push(`... ${l} more item${l>1?"s":""}`),s}function formatMapIterInner(e,t,r,n){const i=Math.max(e.maxArrayLength,0),o=r.length/2,s=o-i,a=Math.min(i,o);let l=new Array(a),c="",u="",p=" => ",f=0;for(n===kMapEntries&&(c="[ ",u=" ]",p=", "),e.indentationLvl+=2;f<a;f++){const n=2*f;l[f]=`${c}${formatValue(e,r[n],t)}`+`${p}${formatValue(e,r[n+1],t)}${u}`}return e.indentationLvl-=2,n===kWeak&&(l=l.sort()),s>0&&l.push(`... ${s} more item${s>1?"s":""}`),l}function formatWeakCollection(e){return[e.stylize("[items unknown]","special")]}function formatWeakSet(e,t,r){return formatSetIterInner(e,r,previewEntries(t),kWeak)}function formatWeakMap(e,t,r){return formatMapIterInner(e,r,previewEntries(t),kWeak)}function formatSetIterator(e,t,r){return formatSetIterInner(e,r,previewEntries(t),kIterator)}function formatMapIterator(e,t,r){const[n,i]=previewEntries(t,!0);return i?formatMapIterInner(e,r,n,kMapEntries):formatSetIterInner(e,r,n,kIterator)}function formatPromise(e,t,r){let n;const[i,o]=getPromiseDetails(t);if(i===kPending)n=[e.stylize("<pending>","special")];else{e.indentationLvl+=2;const t=formatValue(e,o,r);e.indentationLvl-=2,n=[i===kRejected?`${e.stylize("<rejected>","special")} ${t}`:t]}return n}function formatProperty(e,t,r,n,i){let o,s,a=" ";const l=Object.getOwnPropertyDescriptor(t,n)||{value:t[n],enumerable:!0};if(void 0!==l.value){const t=i!==kObjectType||!1===e.compact?2:3;if(e.indentationLvl+=t,s=formatValue(e,l.value,r),3===t){const t=e.colors?removeColors(s).length:s.length;e.breakLength<t&&(a=`\n${" ".repeat(e.indentationLvl)}`)}e.indentationLvl-=t}else s=void 0!==l.get?void 0!==l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):void 0!==l.set?e.stylize("[Setter]","special"):e.stylize("undefined","undefined");if(i===kArrayType)return s;if("symbol"==typeof n){const t=n.toString().replace(strEscapeSequencesReplacer,escapeFn);o=`[${e.stylize(t,"symbol")}]`}else o=!1===l.enumerable?`[${n.replace(strEscapeSequencesReplacer,escapeFn)}]`:keyStrRegExp.test(n)?e.stylize(n,"name"):e.stylize(strEscape(n),"string");return`${o}:${a}${s}`}function reduceToSingleString(e,t,r,n){const i=e.breakLength;let o=0;if(!1===e.compact){const i=" ".repeat(e.indentationLvl);let s=`${r?`${r} `:""}${n[0]}\n${i}  `;for(;o<t.length-1;o++)s+=`${t[o]},\n${i}  `;return s+=`${t[o]}\n${i}${n[1]}`}if(2*t.length<=i){let s=0;for(;o<t.length&&s<=i;o++)e.colors?s+=removeColors(t[o]).length+1:s+=t[o].length+1;if(s<=i)return`${n[0]}${r?` ${r}`:""} ${join(t,", ")} `+n[1]}const s=" ".repeat(e.indentationLvl),a=""===r&&1===n[0].length?" ":`${r?` ${r}`:""}\n${s}  `,l=join(t,`,\n${s}  `);return`${n[0]}${a}${l} ${n[1]}`}module.exports={inspect};"use strict";const hasInspector=1===process.config.variables.v8_enable_inspector,inspector=hasInspector?require("inspector"):void 0;let session;function sendInspectorCommand(s,n){if(!hasInspector)return n();void 0===session&&(session=new inspector.Session);try{session.connect();try{return s(session)}finally{session.disconnect()}}catch{return n()}}module.exports={sendInspectorCommand};"use strict";const ReflectApply=Reflect.apply;function uncurryThis(r){return(t,...i)=>ReflectApply(r,t,i)}const TypedArrayPrototype=Object.getPrototypeOf(Uint8Array.prototype),TypedArrayProto_toStringTag=uncurryThis(Object.getOwnPropertyDescriptor(TypedArrayPrototype,Symbol.toStringTag).get),isArrayBufferView=ArrayBuffer.isView;function isTypedArray(r){return void 0!==TypedArrayProto_toStringTag(r)}function isUint8Array(r){return"Uint8Array"===TypedArrayProto_toStringTag(r)}function isUint8ClampedArray(r){return"Uint8ClampedArray"===TypedArrayProto_toStringTag(r)}function isUint16Array(r){return"Uint16Array"===TypedArrayProto_toStringTag(r)}function isUint32Array(r){return"Uint32Array"===TypedArrayProto_toStringTag(r)}function isInt8Array(r){return"Int8Array"===TypedArrayProto_toStringTag(r)}function isInt16Array(r){return"Int16Array"===TypedArrayProto_toStringTag(r)}function isInt32Array(r){return"Int32Array"===TypedArrayProto_toStringTag(r)}function isFloat32Array(r){return"Float32Array"===TypedArrayProto_toStringTag(r)}function isFloat64Array(r){return"Float64Array"===TypedArrayProto_toStringTag(r)}function isBigInt64Array(r){return"BigInt64Array"===TypedArrayProto_toStringTag(r)}function isBigUint64Array(r){return"BigUint64Array"===TypedArrayProto_toStringTag(r)}module.exports={isArrayBufferView,isTypedArray,isUint8Array,isUint8ClampedArray,isUint16Array,isUint32Array,isInt8Array,isInt16Array,isInt32Array,isFloat32Array,isFloat64Array,isBigInt64Array,isBigUint64Array};"use strict";const{ERR_INVALID_ARG_TYPE,ERR_NO_CRYPTO,ERR_UNKNOWN_SIGNAL}=require("internal/errors").codes,{signals}=process.binding("constants").os,{getHiddenValue,setHiddenValue,arrow_message_private_symbol:kArrowMessagePrivateSymbolIndex,decorated_private_symbol:kDecoratedPrivateSymbolIndex}=process.binding("util"),{errmap}=process.binding("uv"),noCrypto=!process.versions.openssl,experimentalWarnings=new Set,colorRegExp=/\u001b\[\d\d?m/g;function removeColors(e){return e.replace(colorRegExp,"")}function isError(e){return"[object Error]"===objectToString(e)||e instanceof Error}function objectToString(e){return Object.prototype.toString.call(e)}const codesWarned={};function deprecate(e,t,r){if(!0===process.noDeprecation)return e;if(void 0!==r&&"string"!=typeof r)throw new ERR_INVALID_ARG_TYPE("code","string",r);let n=!1;function o(...i){return n||(n=!0,void 0!==r?codesWarned[r]||(process.emitWarning(t,"DeprecationWarning",r,o),codesWarned[r]=!0):process.emitWarning(t,"DeprecationWarning",o)),new.target?Reflect.construct(e,i,new.target):e.apply(this,i)}return Object.setPrototypeOf(o,e),e.prototype&&(o.prototype=e.prototype),o}function decorateErrorStack(e){if(!isError(e)||!e.stack||!0===getHiddenValue(e,kDecoratedPrivateSymbolIndex))return;const t=getHiddenValue(e,kArrowMessagePrivateSymbolIndex);t&&(e.stack=t+e.stack,setHiddenValue(e,kDecoratedPrivateSymbolIndex,!0))}function assertCrypto(){if(noCrypto)throw new ERR_NO_CRYPTO}function normalizeEncoding(e){return null==e||"utf8"===e||"utf-8"===e?"utf8":slowCases(e)}function slowCases(e){switch(e.length){case 4:if("UTF8"===e)return"utf8";if("ucs2"===e||"UCS2"===e)return"utf16le";if("utf8"===(e=`${e}`.toLowerCase()))return"utf8";if("ucs2"===e)return"utf16le";break;case 3:if("hex"===e||"HEX"===e||"hex"===`${e}`.toLowerCase())return"hex";break;case 5:if("ascii"===e)return"ascii";if("ucs-2"===e)return"utf16le";if("UTF-8"===e)return"utf8";if("ASCII"===e)return"ascii";if("UCS-2"===e)return"utf16le";if("utf-8"===(e=`${e}`.toLowerCase()))return"utf8";if("ascii"===e)return"ascii";if("ucs-2"===e)return"utf16le";break;case 6:if("base64"===e)return"base64";if("latin1"===e||"binary"===e)return"latin1";if("BASE64"===e)return"base64";if("LATIN1"===e||"BINARY"===e)return"latin1";if("base64"===(e=`${e}`.toLowerCase()))return"base64";if("latin1"===e||"binary"===e)return"latin1";break;case 7:if("utf16le"===e||"UTF16LE"===e||"utf16le"===`${e}`.toLowerCase())return"utf16le";break;case 8:if("utf-16le"===e||"UTF-16LE"===e||"utf-16le"===`${e}`.toLowerCase())return"utf16le";break;default:if(""===e)return"utf8"}}function emitExperimentalWarning(e){if(experimentalWarnings.has(e))return;const t=`${e} is an experimental feature. This feature could `+"change at any time";experimentalWarnings.add(e),process.emitWarning(t,"ExperimentalWarning")}function filterDuplicateStrings(e,t){const r=new Map;for(var n=0;n<e.length;n++){const o=e[n],i=o.toLowerCase();t?r.set(i,i):r.set(i,o)}return Array.from(r.values()).sort()}function cachedResult(e){let t;return()=>(void 0===t&&(t=e()),t.slice())}function createClassWrapper(e){function t(...t){return Reflect.construct(e,t,new.target||e)}return Object.defineProperties(t,{name:{value:e.name},length:{value:e.length}}),Object.setPrototypeOf(t,e),t.prototype=e.prototype,t}let signalsToNamesMapping;function getSignalsToNamesMapping(){if(void 0!==signalsToNamesMapping)return signalsToNamesMapping;for(var e in signalsToNamesMapping=Object.create(null),signals)signalsToNamesMapping[signals[e]]=e;return signalsToNamesMapping}function convertToValidSignal(e){if("number"==typeof e&&getSignalsToNamesMapping()[e])return e;if("string"==typeof e){const t=signals[e.toUpperCase()];if(t)return t}throw new ERR_UNKNOWN_SIGNAL(e)}function getConstructorOf(e){for(;e;){const t=Object.getOwnPropertyDescriptor(e,"constructor");if(void 0!==t&&"function"==typeof t.value&&""!==t.value.name)return t.value;e=Object.getPrototypeOf(e)}return null}function getSystemErrorName(e){const t=errmap.get(e);return t?t[0]:`Unknown system error ${e}`}const kCustomPromisifiedSymbol=Symbol("util.promisify.custom"),kCustomPromisifyArgsSymbol=Symbol("customPromisifyArgs");function promisify(e){if("function"!=typeof e)throw new ERR_INVALID_ARG_TYPE("original","Function",e);if(e[kCustomPromisifiedSymbol]){const t=e[kCustomPromisifiedSymbol];if("function"!=typeof t)throw new ERR_INVALID_ARG_TYPE("util.promisify.custom","Function",t);return Object.defineProperty(t,kCustomPromisifiedSymbol,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}const t=e[kCustomPromisifyArgsSymbol];function r(...r){return new Promise((n,o)=>{e.call(this,...r,(e,...r)=>{if(e)return o(e);if(void 0!==t&&r.length>1){const e={};for(var i=0;i<t.length;i++)e[t[i]]=r[i];n(e)}else n(r[0])})})}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.defineProperty(r,kCustomPromisifiedSymbol,{value:r,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(r,Object.getOwnPropertyDescriptors(e))}function join(e,t){let r="";if(0!==e.length){for(var n=0;n<e.length-1;n++)r+=e[n],r+=t;r+=e[n]}return r}function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}promisify.custom=kCustomPromisifiedSymbol;const kNodeModulesRE=/^(.*)[\\\/]node_modules[\\\/]/;let getStructuredStack;function isInsideNodeModules(){if(void 0===getStructuredStack){const{runInNewContext:e}=require("vm");getStructuredStack=e("(function() {\n      Error.prepareStackTrace = function(err, trace) {\n        err.stack = trace;\n      };\n      Error.stackTraceLimit = Infinity;\n\n      return function structuredStack() {\n        return new Error().stack;\n      };\n    })()",{},{filename:"structured-stack"})}const e=getStructuredStack();if(Array.isArray(e))for(const t of e){const e=t.getFileName();if(/^\/|\\/.test(e))return kNodeModulesRE.test(e)}return!1}function once(e){let t=!1;return function(...r){t||(t=!0,e(...r))}}module.exports={assertCrypto,cachedResult,convertToValidSignal,createClassWrapper,decorateErrorStack,deprecate,emitExperimentalWarning,filterDuplicateStrings,getConstructorOf,getSystemErrorName,isError,isInsideNodeModules,join,normalizeEncoding,objectToString,once,promisify,spliceOne,removeColors,customPromisifyArgs:kCustomPromisifyArgsSymbol,customInspectSymbol:Symbol.for("nodejs.util.inspect.custom"),kIsEncodingSymbol:Symbol("kIsEncodingSymbol"),kExpandStackSymbol:Symbol("kExpandStackSymbol")};undefined"use strict";const vm=require("vm"),scriptFiles=["internal/v8_prof_polyfill","internal/deps/v8/tools/splaytree","internal/deps/v8/tools/codemap","internal/deps/v8/tools/csvparser","internal/deps/v8/tools/consarray","internal/deps/v8/tools/profile","internal/deps/v8/tools/profile_view","internal/deps/v8/tools/logreader","internal/deps/v8/tools/arguments","internal/deps/v8/tools/tickprocessor","internal/deps/v8/tools/SourceMap","internal/deps/v8/tools/tickprocessor-driver"];var script="";scriptFiles.forEach(function(r){script+=process.binding("natives")[r]+"\n"});const tickArguments=[];"darwin"===process.platform?tickArguments.push("--mac"):"win32"===process.platform&&tickArguments.push("--windows"),tickArguments.push.apply(tickArguments,process.argv.slice(1)),script=`(function(module, require) {\n  arguments = ${JSON.stringify(tickArguments)};\n  function write (s) { process.stdout.write(s) }\n  function printErr(err) { console.error(err); }\n  ${script}\n})`,vm.runInThisContext(script)(module,require);"use strict";const{ERR_INVALID_ARG_TYPE,ERR_INVALID_ARG_VALUE,ERR_OUT_OF_RANGE}=require("internal/errors").codes;function isInt32(e){return e===(0|e)}function isUint32(e){return e===e>>>0}const octalReg=/^[0-7]+$/,modeDesc="must be a 32-bit unsigned integer or an octal string";function validateMode(e,t,n){if(isUint32(e))return e;if("number"==typeof e)throw Number.isInteger(e)?new ERR_OUT_OF_RANGE(t,">= 0 && < 4294967296",e):new ERR_OUT_OF_RANGE(t,"an integer",e);if("string"==typeof e){if(!octalReg.test(e))throw new ERR_INVALID_ARG_VALUE(t,e,modeDesc);return parseInt(e,8)}if(void 0!==n)return n;throw new ERR_INVALID_ARG_VALUE(t,e,modeDesc)}function validateInteger(e,t){let n;if("number"!=typeof e?n=new ERR_INVALID_ARG_TYPE(t,"number",e):Number.isSafeInteger(e)||(n=new ERR_OUT_OF_RANGE(t,"an integer",e)),n)throw Error.captureStackTrace(n,validateInteger),n;return e}function validateInt32(e,t,n=-2147483648,r=2147483647){if(!isInt32(e)){let i;throw i="number"!=typeof e?new ERR_INVALID_ARG_TYPE(t,"number",e):Number.isInteger(e)?new ERR_OUT_OF_RANGE(t,`>= ${n} && <= ${r}`,e):new ERR_OUT_OF_RANGE(t,"an integer",e),Error.captureStackTrace(i,validateInt32),i}if(e<n||e>r){const i=new ERR_OUT_OF_RANGE(t,`>= ${n} && <= ${r}`,e);throw Error.captureStackTrace(i,validateInt32),i}return e}function validateUint32(e,t,n){if(!isUint32(e)){let r;if("number"!=typeof e)r=new ERR_INVALID_ARG_TYPE(t,"number",e);else if(Number.isInteger(e)){r=new ERR_OUT_OF_RANGE(t,`>= ${n?1:0} && < 4294967296`,e)}else r=new ERR_OUT_OF_RANGE(t,"an integer",e);throw Error.captureStackTrace(r,validateUint32),r}if(n&&0===e){const n=new ERR_OUT_OF_RANGE(t,">= 1 && < 4294967296",e);throw Error.captureStackTrace(n,validateUint32),n}return e}function validateString(e,t){if("string"!=typeof e)throw new ERR_INVALID_ARG_TYPE(t,"string",e)}function validateNumber(e,t){if("number"!=typeof e)throw new ERR_INVALID_ARG_TYPE(t,"number",e)}module.exports={isInt32,isUint32,validateMode,validateInteger,validateInt32,validateUint32,validateString,validateNumber};"use strict";const{URL}=require("internal/url"),{isContext}=process.binding("contextify"),{ERR_INVALID_ARG_TYPE,ERR_OUT_OF_RANGE,ERR_VM_MODULE_ALREADY_LINKED,ERR_VM_MODULE_DIFFERENT_CONTEXT,ERR_VM_MODULE_LINKING_ERRORED,ERR_VM_MODULE_NOT_LINKED,ERR_VM_MODULE_NOT_MODULE,ERR_VM_MODULE_STATUS}=require("internal/errors").codes,{getConstructorOf,customInspectSymbol,emitExperimentalWarning}=require("internal/util"),{SafePromise}=require("internal/safe_globals"),{ModuleWrap,kUninstantiated,kInstantiating,kInstantiated,kEvaluating,kEvaluated,kErrored}=internalBinding("module_wrap"),STATUS_MAP={[kUninstantiated]:"uninstantiated",[kInstantiating]:"instantiating",[kInstantiated]:"instantiated",[kEvaluating]:"evaluating",[kEvaluated]:"evaluated",[kErrored]:"errored"};let globalModuleId=0;const perContextModuleId=new WeakMap,wrapMap=new WeakMap,dependencyCacheMap=new WeakMap,linkingStatusMap=new WeakMap,initImportMetaMap=new WeakMap,wrapToModuleMap=new WeakMap,defaultModuleName="vm:module";class SourceTextModule{constructor(t,e={}){if(emitExperimentalWarning("vm.SourceTextModule"),"string"!=typeof t)throw new ERR_INVALID_ARG_TYPE("src","string",t);if("object"!=typeof e||null===e)throw new ERR_INVALID_ARG_TYPE("options","Object",e);const{context:n,lineOffset:i=0,columnOffset:a=0,initializeImportMeta:o}=e;if(void 0!==n){if("object"!=typeof n||null===n)throw new ERR_INVALID_ARG_TYPE("options.context","Object",n);if(!isContext(n))throw new ERR_INVALID_ARG_TYPE("options.context","vm.Context",n)}let{url:r}=e;if(void 0!==r){if("string"!=typeof r)throw new ERR_INVALID_ARG_TYPE("options.url","string",r);r=new URL(r).href}else if(void 0===n)r=`${defaultModuleName}(${globalModuleId++})`;else if(perContextModuleId.has(n)){const t=perContextModuleId.get(n);r=`${defaultModuleName}(${t})`,perContextModuleId.set(n,t+1)}else r=`${defaultModuleName}(0)`,perContextModuleId.set(n,1);if(validateInteger(i,"options.lineOffset"),validateInteger(a,"options.columnOffset"),void 0!==o){if("function"!=typeof o)throw new ERR_INVALID_ARG_TYPE("options.initializeImportMeta","function",o);initImportMetaMap.set(this,o)}const s=new ModuleWrap(t,r,n,i,a);wrapMap.set(this,s),linkingStatusMap.set(this,"unlinked"),wrapToModuleMap.set(s,this),Object.defineProperties(this,{url:{value:r,enumerable:!0},context:{value:n,enumerable:!0}})}get linkingStatus(){return linkingStatusMap.get(this)}get status(){return STATUS_MAP[wrapMap.get(this).getStatus()]}get namespace(){const t=wrapMap.get(this);if(t.getStatus()<kInstantiated)throw new ERR_VM_MODULE_STATUS("must not be uninstantiated or instantiating");return t.namespace()}get dependencySpecifiers(){let t=dependencyCacheMap.get(this);return void 0!==t?t:(t=wrapMap.get(this).getStaticDependencySpecifiers(),Object.freeze(t),dependencyCacheMap.set(this,t),t)}get error(){const t=wrapMap.get(this);if(t.getStatus()!==kErrored)throw new ERR_VM_MODULE_STATUS("must be errored");return t.getError()}async link(t){if("function"!=typeof t)throw new ERR_INVALID_ARG_TYPE("linker","function",t);if("unlinked"!==linkingStatusMap.get(this))throw new ERR_VM_MODULE_ALREADY_LINKED;const e=wrapMap.get(this);if(e.getStatus()!==kUninstantiated)throw new ERR_VM_MODULE_STATUS("must be uninstantiated");linkingStatusMap.set(this,"linking");const n=e.link(async e=>{const n=await t(e,this);if(!n||!wrapMap.has(n))throw new ERR_VM_MODULE_NOT_MODULE;if(n.context!==this.context)throw new ERR_VM_MODULE_DIFFERENT_CONTEXT;const i=linkingStatusMap.get(n);if("errored"===i)throw new ERR_VM_MODULE_LINKING_ERRORED;return"unlinked"===i&&await n.link(t),wrapMap.get(n)});try{void 0!==n&&await SafePromise.all(n),linkingStatusMap.set(this,"linked")}catch(t){throw linkingStatusMap.set(this,"errored"),t}}instantiate(){const t=wrapMap.get(this),e=t.getStatus();if(e===kInstantiating||e===kEvaluating)throw new ERR_VM_MODULE_STATUS("must not be instantiating or evaluating");if("linked"!==linkingStatusMap.get(this))throw new ERR_VM_MODULE_NOT_LINKED;t.instantiate()}async evaluate(t={}){if("object"!=typeof t||null===t)throw new ERR_INVALID_ARG_TYPE("options","Object",t);let e=t.timeout;if(void 0===e)e=-1;else if(!Number.isInteger(e)||e<=0)throw new ERR_INVALID_ARG_TYPE("options.timeout","a positive integer",e);const{breakOnSigint:n=!1}=t;if("boolean"!=typeof n)throw new ERR_INVALID_ARG_TYPE("options.breakOnSigint","boolean",n);const i=wrapMap.get(this),a=i.getStatus();if(a!==kInstantiated&&a!==kEvaluated&&a!==kErrored)throw new ERR_VM_MODULE_STATUS("must be one of instantiated, evaluated, and errored");return{result:i.evaluate(e,n),__proto__:null}}[customInspectSymbol](t,e){let n=getConstructorOf(this);if(n=null===n?SourceTextModule:n,"number"==typeof t&&t<0)return e.stylize(`[${n.name}]`,"special");const i=Object.create({constructor:n});return i.status=this.status,i.linkingStatus=this.linkingStatus,i.url=this.url,i.context=this.context,require("util").inspect(i,e)}}function validateInteger(t,e){if(!Number.isInteger(t))throw new ERR_INVALID_ARG_TYPE(e,"integer",t);if(t>>0!==t)throw new ERR_OUT_OF_RANGE(e,"32-bit integer",t)}module.exports={SourceTextModule,initImportMetaMap,wrapToModuleMap};"use strict";const EventEmitter=require("events"),assert=require("assert"),path=require("path"),util=require("util"),{Readable,Writable}=require("stream"),{ERR_INVALID_ARG_TYPE,ERR_WORKER_PATH,ERR_WORKER_UNSERIALIZABLE_ERROR,ERR_WORKER_UNSUPPORTED_EXTENSION}=require("internal/errors").codes,{MessagePort,MessageChannel}=internalBinding("messaging"),{handle_onclose:handleOnCloseSymbol,oninit:onInitSymbol}=internalBinding("symbols"),{clearAsyncIdStack}=require("internal/async_hooks"),{serializeError,deserializeError}=require("internal/error-serdes"),{pathToFileURL}=require("url"),{Worker:WorkerImpl,getEnvMessagePort,threadId}=internalBinding("worker"),isMainThread=0===threadId,kOnMessageListener=Symbol("kOnMessageListener"),kHandle=Symbol("kHandle"),kName=Symbol("kName"),kPort=Symbol("kPort"),kPublicPort=Symbol("kPublicPort"),kDispose=Symbol("kDispose"),kOnExit=Symbol("kOnExit"),kOnMessage=Symbol("kOnMessage"),kOnCouldNotSerializeErr=Symbol("kOnCouldNotSerializeErr"),kOnErrorMessage=Symbol("kOnErrorMessage"),kParentSideStdio=Symbol("kParentSideStdio"),kWritableCallbacks=Symbol("kWritableCallbacks"),kStdioWantsMoreDataCallback=Symbol("kStdioWantsMoreDataCallback"),kStartedReading=Symbol("kStartedReading"),kWaitingStreams=Symbol("kWaitingStreams"),kIncrementsPortRef=Symbol("kIncrementsPortRef"),debug=util.debuglog("worker"),messageTypes={UP_AND_RUNNING:"upAndRunning",COULD_NOT_SERIALIZE_ERROR:"couldNotSerializeError",ERROR_MESSAGE:"errorMessage",STDIO_PAYLOAD:"stdioPayload",STDIO_WANTS_MORE_DATA:"stdioWantsMoreData",LOAD_SCRIPT:"loadScript"},MessagePortPrototype=Object.create(Object.getPrototypeOf(MessagePort.prototype),Object.getOwnPropertyDescriptors(MessagePort.prototype));function oninit(){setupPortReferencing(this,this,"message")}function onclose(){"function"==typeof this.onclose&&this.onclose(),this.emit("close")}function setupPortReferencing(e,t,s){e.unref(),t.on("newListener",r=>{r===s&&0===t.listenerCount(s)&&(e.ref(),MessagePortPrototype.start.call(e))}),t.on("removeListener",r=>{r===s&&0===t.listenerCount(s)&&(MessagePortPrototype.stop.call(e),e.unref())})}Object.setPrototypeOf(MessagePort,EventEmitter),Object.setPrototypeOf(MessagePort.prototype,EventEmitter.prototype),delete MessagePort.prototype.stop,delete MessagePort.prototype.drain,MessagePort.prototype.ref=MessagePortPrototype.ref,MessagePort.prototype.unref=MessagePortPrototype.unref,MessagePort.prototype[kOnMessageListener]=function(e){debug(`[${threadId}] received message`,e),this.emit("message",e)},Object.defineProperty(MessagePort.prototype,"onmessage",{enumerable:!0,configurable:!0,get(){return this[kOnMessageListener]},set(e){this[kOnMessageListener]=e,"function"==typeof e?(this.ref(),MessagePortPrototype.start.call(this)):(this.unref(),MessagePortPrototype.stop.call(this))}}),Object.defineProperty(MessagePort.prototype,onInitSymbol,{enumerable:!0,writable:!1,value:oninit}),Object.defineProperty(MessagePort.prototype,handleOnCloseSymbol,{enumerable:!1,writable:!1,value:onclose}),MessagePort.prototype.close=function(e){"function"==typeof e&&this.once("close",e),MessagePortPrototype.close.call(this)},Object.defineProperty(MessagePort.prototype,util.inspect.custom,{enumerable:!1,writable:!1,value:function(){let e;try{e=MessagePortPrototype.hasRef.call(this)}catch{return this}return Object.assign(Object.create(MessagePort.prototype),void 0===e?{active:!1}:{active:!0,refed:e},this)}});class ReadableWorkerStdio extends Readable{constructor(e,t){super(),this[kPort]=e,this[kName]=t,this[kIncrementsPortRef]=!0,this[kStartedReading]=!1,this.on("end",()=>{this[kIncrementsPortRef]&&0==--this[kPort][kWaitingStreams]&&this[kPort].unref()})}_read(){!this[kStartedReading]&&this[kIncrementsPortRef]&&(this[kStartedReading]=!0,0==this[kPort][kWaitingStreams]++&&this[kPort].ref()),this[kPort].postMessage({type:messageTypes.STDIO_WANTS_MORE_DATA,stream:this[kName]})}}class WritableWorkerStdio extends Writable{constructor(e,t){super({decodeStrings:!1}),this[kPort]=e,this[kName]=t,this[kWritableCallbacks]=[]}_write(e,t,s){this[kPort].postMessage({type:messageTypes.STDIO_PAYLOAD,stream:this[kName],chunk:e,encoding:t}),this[kWritableCallbacks].push(s),0==this[kPort][kWaitingStreams]++&&this[kPort].ref()}_final(e){this[kPort].postMessage({type:messageTypes.STDIO_PAYLOAD,stream:this[kName],chunk:null}),e()}[kStdioWantsMoreDataCallback](){const e=this[kWritableCallbacks];this[kWritableCallbacks]=[];for(const t of e)t();0==(this[kPort][kWaitingStreams]-=e.length)&&this[kPort].unref()}}class Worker extends EventEmitter{constructor(e,t={}){if(super(),debug(`[${threadId}] create new worker`,e,t),"string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("filename","string",e);if(!t.eval){if(!(path.isAbsolute(e)||e.startsWith("./")||e.startsWith("../")||e.startsWith("."+path.sep)||e.startsWith(".."+path.sep)))throw new ERR_WORKER_PATH(e);e=path.resolve(e);const t=path.extname(e);if(".js"!==t&&".mjs"!==t)throw new ERR_WORKER_UNSUPPORTED_EXTENSION(t)}const s=t.eval?null:pathToFileURL(e);this[kHandle]=new WorkerImpl(s),this[kHandle].onexit=(e=>this[kOnExit](e)),this[kPort]=this[kHandle].messagePort,this[kPort].on("message",e=>this[kOnMessage](e)),this[kPort].start(),this[kPort].unref(),this[kPort][kWaitingStreams]=0,debug(`[${threadId}] created Worker with ID ${this.threadId}`);let r=null;t.stdin&&(r=new WritableWorkerStdio(this[kPort],"stdin"));const o=new ReadableWorkerStdio(this[kPort],"stdout");t.stdout||(o[kIncrementsPortRef]=!1,pipeWithoutWarning(o,process.stdout));const a=new ReadableWorkerStdio(this[kPort],"stderr");t.stderr||(a[kIncrementsPortRef]=!1,pipeWithoutWarning(a,process.stderr)),this[kParentSideStdio]={stdin:r,stdout:o,stderr:a};const{port1:i,port2:n}=new MessageChannel;this[kPublicPort]=i,this[kPublicPort].on("message",e=>this.emit("message",e)),setupPortReferencing(this[kPublicPort],this,"message"),this[kPort].postMessage({type:messageTypes.LOAD_SCRIPT,filename:e,doEval:!!t.eval,workerData:t.workerData,publicPort:n,hasStdin:!!t.stdin},[n]),this[kHandle].startThread()}[kOnExit](e){debug(`[${threadId}] hears end event for Worker ${this.threadId}`),MessagePortPrototype.drain.call(this[kPublicPort]),this[kDispose](),this.emit("exit",e),this.removeAllListeners()}[kOnCouldNotSerializeErr](){this.emit("error",new ERR_WORKER_UNSERIALIZABLE_ERROR)}[kOnErrorMessage](e){const t=deserializeError(e);this.emit("error",t)}[kOnMessage](e){switch(e.type){case messageTypes.UP_AND_RUNNING:return this.emit("online");case messageTypes.COULD_NOT_SERIALIZE_ERROR:return this[kOnCouldNotSerializeErr]();case messageTypes.ERROR_MESSAGE:return this[kOnErrorMessage](e.error);case messageTypes.STDIO_PAYLOAD:{const{stream:t,chunk:s,encoding:r}=e;return this[kParentSideStdio][t].push(s,r)}case messageTypes.STDIO_WANTS_MORE_DATA:{const{stream:t}=e;return this[kParentSideStdio][t][kStdioWantsMoreDataCallback]()}}assert.fail(`Unknown worker message type ${e.type}`)}[kDispose](){this[kHandle].onexit=null,this[kHandle]=null,this[kPort]=null,this[kPublicPort]=null;const{stdout:e,stderr:t}=this[kParentSideStdio];this[kParentSideStdio]=null,e._readableState.ended||(debug(`[${threadId}] explicitly closes stdout for ${this.threadId}`),e.push(null)),t._readableState.ended||(debug(`[${threadId}] explicitly closes stderr for ${this.threadId}`),t.push(null))}postMessage(...e){this[kPublicPort].postMessage(...e)}terminate(e){null!==this[kHandle]&&(debug(`[${threadId}] terminates Worker with ID ${this.threadId}`),void 0!==e&&this.once("exit",t=>e(null,t)),this[kHandle].stopThread())}ref(){null!==this[kHandle]&&(this[kHandle].ref(),this[kPublicPort].ref())}unref(){null!==this[kHandle]&&(this[kHandle].unref(),this[kPublicPort].unref())}get threadId(){return null===this[kHandle]?-1:this[kHandle].threadId}get stdin(){return this[kParentSideStdio].stdin}get stdout(){return this[kParentSideStdio].stdout}get stderr(){return this[kParentSideStdio].stderr}}const workerStdio={};if(!isMainThread){const e=getEnvMessagePort();e[kWaitingStreams]=0,workerStdio.stdin=new ReadableWorkerStdio(e,"stdin"),workerStdio.stdout=new WritableWorkerStdio(e,"stdout"),workerStdio.stderr=new WritableWorkerStdio(e,"stderr")}let originalFatalException;function setupChild(e){debug(`[${threadId}] is setting up worker child environment`);const t=getEnvMessagePort(),s=require("worker_threads");t.on("message",r=>{if(r.type===messageTypes.LOAD_SCRIPT){const{filename:o,doEval:a,workerData:i,publicPort:n,hasStdin:l}=r;return s.parentPort=n,s.workerData=i,l||workerStdio.stdin.push(null),debug(`[${threadId}] starts worker script ${o} `+`(eval = ${eval}) at cwd = ${process.cwd()}`),t.unref(),t.postMessage({type:messageTypes.UP_AND_RUNNING}),void(a?e("[worker eval]",o):(process.argv[1]=o,require("module").runMain()))}if(r.type!==messageTypes.STDIO_PAYLOAD)if(r.type!==messageTypes.STDIO_WANTS_MORE_DATA)assert.fail(`Unknown worker message type ${r.type}`);else{const{stream:e}=r;workerStdio[e][kStdioWantsMoreDataCallback]()}else{const{stream:e,chunk:t,encoding:s}=r;workerStdio[e].push(t,s)}}),t.start(),originalFatalException=process._fatalException,process._fatalException=function(e){debug(`[${threadId}] gets fatal exception`);let s=!1;try{s=originalFatalException.call(this,e)}catch(t){e=t}if(debug(`[${threadId}] fatal exception caught = ${s}`),!s){let s;try{s=serializeError(e)}catch{}debug(`[${threadId}] fatal exception serialized = ${!!s}`),s?t.postMessage({type:messageTypes.ERROR_MESSAGE,error:s}):t.postMessage({type:messageTypes.COULD_NOT_SERIALIZE_ERROR}),clearAsyncIdStack(),process.exit()}}}function pipeWithoutWarning(e,t){const s=e._maxListeners,r=t._maxListeners;e.setMaxListeners(1/0),t.setMaxListeners(1/0),e.pipe(t),e._maxListeners=s,t._maxListeners=r}module.exports={MessagePort,MessageChannel,threadId,Worker,setupChild,isMainThread,workerStdio};"use strict";const assert=require("assert"),util=require("util"),{Socket}=require("net"),{JSStream}=internalBinding("js_stream"),uv=internalBinding("uv"),debug=util.debuglog("stream_wrap"),{owner_symbol}=require("internal/async_hooks").symbols,{ERR_STREAM_WRAP}=require("internal/errors").codes,kCurrentWriteRequest=Symbol("kCurrentWriteRequest"),kCurrentShutdownRequest=Symbol("kCurrentShutdownRequest");function isClosing(){return this[owner_symbol].isClosing()}function onreadstart(){return this[owner_symbol].readStart()}function onreadstop(){return this[owner_symbol].readStop()}function onshutdown(t){return this[owner_symbol].doShutdown(t)}function onwrite(t,e){return this[owner_symbol].doWrite(t,e)}class JSStreamWrap extends Socket{constructor(t){const e=new JSStream;e.close=(t=>{debug("close"),this.doClose(t)}),e.isClosing=isClosing,e.onreadstart=onreadstart,e.onreadstop=onreadstop,e.onshutdown=onshutdown,e.onwrite=onwrite,t.pause(),t.on("error",t=>this.emit("error",t));const r=e=>{if("string"==typeof e||!0===t._readableState.objectMode)return t.pause(),t.removeListener("data",r),void this.emit("error",new ERR_STREAM_WRAP);debug("data",e.length),this._handle&&this._handle.readBuffer(e)};t.on("data",r),t.once("end",()=>{debug("end"),this._handle&&this._handle.emitEOF()}),t.once("close",()=>{this.destroy()}),super({handle:e,manualStart:!0}),this.stream=t,this[kCurrentWriteRequest]=null,this[kCurrentShutdownRequest]=null,this.readable=t.readable,this.writable=t.writable,this.read(0)}static get StreamWrap(){return JSStreamWrap}isClosing(){return!this.readable||!this.writable}readStart(){return this.stream.resume(),0}readStop(){return this.stream.pause(),0}doShutdown(t){if(null!==this[kCurrentWriteRequest])return this.once("drain",()=>this.doShutdown(t));assert.strictEqual(this[kCurrentWriteRequest],null),assert.strictEqual(this[kCurrentShutdownRequest],null),this[kCurrentShutdownRequest]=t;const e=this._handle;return setImmediate(()=>{this.stream.end(()=>{this.finishShutdown(e,0)})}),0}finishShutdown(t,e){if(null===this[kCurrentShutdownRequest])return;const r=this[kCurrentShutdownRequest];this[kCurrentShutdownRequest]=null,t.finishShutdown(r,e)}doWrite(t,e){assert.strictEqual(this[kCurrentWriteRequest],null),assert.strictEqual(this[kCurrentShutdownRequest],null);const r=this._handle,s=this;let n=e.length;this.stream.cork();for(var i=0;i<e.length;++i)this.stream.write(e[i],u);function u(t){if(!t&&0!=--n)return;n=0;let e=0;t&&(e=uv[`UV_${t.code}`]||uv.UV_EPIPE),setImmediate(()=>{s.finishWrite(r,e)})}return this.stream.uncork(),this[kCurrentWriteRequest]=t,0}finishWrite(t,e){if(null===this[kCurrentWriteRequest])return;const r=this[kCurrentWriteRequest];this[kCurrentWriteRequest]=null,t.finishWrite(r,e)}doClose(t){const e=this._handle;this.stream.destroy(),setImmediate(()=>{assert.strictEqual(this._handle,null),this.finishWrite(e,uv.UV_ECANCELED),this.finishShutdown(e,uv.UV_ECANCELED),t()})}}module.exports=JSStreamWrap;"use strict";module.exports=require("internal/modules/cjs/loader");"use strict";const EventEmitter=require("events"),stream=require("stream"),util=require("util"),internalUtil=require("internal/util"),{isIP,isIPv4,isIPv6,isLegalPort,normalizedArgsSymbol,makeSyncWrite}=require("internal/net"),assert=require("assert"),{UV_EADDRINUSE,UV_EINVAL}=process.binding("uv"),{Buffer}=require("buffer"),TTYWrap=process.binding("tty_wrap"),{ShutdownWrap}=process.binding("stream_wrap"),{TCP,TCPConnectWrap,constants:TCPConstants}=process.binding("tcp_wrap"),{Pipe,PipeConnectWrap,constants:PipeConstants}=process.binding("pipe_wrap"),{newAsyncId,defaultTriggerAsyncIdScope,symbols:{async_id_symbol,owner_symbol}}=require("internal/async_hooks"),{createWriteWrap,writevGeneric,writeGeneric,onStreamRead,kUpdateTimer}=require("internal/stream_base_commons"),errors=require("internal/errors"),{ERR_INVALID_ADDRESS_FAMILY,ERR_INVALID_ARG_TYPE,ERR_INVALID_FD_TYPE,ERR_INVALID_IP_ADDRESS,ERR_INVALID_OPT_VALUE,ERR_SERVER_ALREADY_LISTEN,ERR_SERVER_NOT_RUNNING,ERR_SOCKET_BAD_PORT,ERR_SOCKET_CLOSED}=errors.codes,{validateInt32,validateString}=require("internal/validators"),kLastWriteQueueSize=Symbol("lastWriteQueueSize");let cluster,dns;const{errnoException,exceptionWithHostPort,uvExceptionWithHostPort}=errors,{kTimeout,setUnrefTimeout,validateTimerDuration}=require("internal/timers");function noop(){}function createHandle(e,t){validateInt32(e,"fd",0);const n=TTYWrap.guessHandleType(e);if("PIPE"===n)return new Pipe(t?PipeConstants.SERVER:PipeConstants.SOCKET);if("TCP"===n)return new TCP(t?TCPConstants.SERVER:TCPConstants.SOCKET);throw new ERR_INVALID_FD_TYPE(n)}function getNewAsyncId(e){return e&&"function"==typeof e.getAsyncId?e.getAsyncId():newAsyncId()}const debug=util.debuglog("net");function isPipeName(e){return"string"==typeof e&&!1===toNumber(e)}function createServer(e,t){return new Server(e,t)}function connect(...e){var t=normalizeArgs(e),n=t[0];debug("createConnection",t);var i=new Socket(n);return n.timeout&&i.setTimeout(n.timeout),i.connect(t)}function normalizeArgs(e){var t;if(0===e.length)return(t=[{},null])[normalizedArgsSymbol]=!0,t;const n=e[0];var i={};"object"==typeof n&&null!==n?i=n:isPipeName(n)?i.path=n:(i.port=n,e.length>1&&"string"==typeof e[1]&&(i.host=e[1]));var r=e[e.length-1];return(t="function"!=typeof r?[i,null]:[i,r])[normalizedArgsSymbol]=!0,t}function initSocketHandle(e){e._undestroy(),e._sockname=null,e._handle&&(e._handle[owner_symbol]=e,e._handle.onread=onStreamRead,e[async_id_symbol]=getNewAsyncId(e._handle))}const kBytesRead=Symbol("kBytesRead"),kBytesWritten=Symbol("kBytesWritten");function Socket(e){if(!(this instanceof Socket))return new Socket(e);this.connecting=!1,this[async_id_symbol]=-1,this._hadError=!1,this._handle=null,this._parent=null,this._host=null,this[kLastWriteQueueSize]=0,this[kTimeout]=null,(e="number"==typeof e?{fd:e}:util._extend({},e)).readable=e.readable||!1,e.writable=e.writable||!1;const{allowHalfOpen:t}=e;if(e.allowHalfOpen=!0,e.emitClose=!1,stream.Duplex.call(this,e),this.allowHalfOpen=Boolean(t),e.handle)this._handle=e.handle,this[async_id_symbol]=getNewAsyncId(this._handle);else if(void 0!==e.fd){const{fd:t}=e;let n;if(this._handle=createHandle(t,!1),n=this._handle.open(t))throw errnoException(n,"open");if(this[async_id_symbol]=this._handle.getAsyncId(),(1==t||2==t)&&this._handle instanceof Pipe&&"win32"===process.platform){if(n=this._handle.setBlocking(!0))throw errnoException(n,"setBlocking");this._writev=null,this._write=makeSyncWrite(t),Object.defineProperty(this._handle,"bytesWritten",{value:0,writable:!0})}}this.on("end",onReadableStreamEnd),initSocketHandle(this),this._pendingData=null,this._pendingEncoding="",this._writableState.decodeStrings=!1,this._handle&&!1!==e.readable&&(e.pauseOnCreate?(this._handle.reading=!1,this._handle.readStop(),this.readableFlowing=!1):e.manualStart||this.read(0)),this.server=null,this._server=null,this[kBytesRead]=0,this[kBytesWritten]=0}function shutdownSocket(e,t){var n=new ShutdownWrap;return n.oncomplete=afterShutdown,n.handle=e._handle,n.callback=t,e._handle.shutdown(n)}function afterShutdown(e,t){var n=t[owner_symbol];debug("afterShutdown destroyed=%j",n.destroyed,n._readableState),this.callback(),n.destroyed||n._readableState.ended&&(debug("readableState ended, destroying"),n.destroy())}function writeAfterFIN(e,t,n){"function"==typeof t&&(n=t,t=null);var i=new Error("This socket has been ended by the other party");i.code="EPIPE",this.emit("error",i),"function"==typeof n&&defaultTriggerAsyncIdScope(this[async_id_symbol],process.nextTick,n,i)}function onReadableStreamEnd(){this.allowHalfOpen||(this.write=writeAfterFIN,this.writable&&this.end()),maybeDestroy(this)}function maybeDestroy(e){e.readable||e.writable||e.destroyed||e.connecting||e.writableLength||e.destroy()}function protoGetter(e,t){Object.defineProperty(Socket.prototype,e,{configurable:!1,enumerable:!0,get:t})}function afterWrite(e,t,n){var i=t[owner_symbol];if(i!==process.stderr&&i!==process.stdout&&debug("afterWrite",e),this.async&&(i[kLastWriteQueueSize]=0),i.destroyed)debug("afterWrite destroyed");else{if(e<0){var r=errnoException(e,"write",this.error);return debug("write failure",r),void i.destroy(r,this.callback)}i._unrefTimer(),i!==process.stderr&&i!==process.stdout&&debug("afterWrite call cb"),this.callback&&this.callback.call(void 0)}}function checkBindError(e,t,n){if(0===e&&t>0&&n.getsockname){var i={};0===(e=n.getsockname(i))&&t!==i.port&&(debug(`checkBindError, bound to ${i.port} instead of ${t}`),e=UV_EADDRINUSE)}return e}function internalConnect(e,t,n,i,r,o){var s;if(assert(e.connecting),r||o){if(4===i)r=r||"0.0.0.0",s=e._handle.bind(r,o);else{if(6!==i)return void e.destroy(new ERR_INVALID_ADDRESS_FAMILY(i));r=r||"::",s=e._handle.bind6(r,o)}if(debug("binding to localAddress: %s and localPort: %d (addressType: %d)",r,o,i),s=checkBindError(s,o,e._handle)){const t=exceptionWithHostPort(s,"bind",r,o);return void e.destroy(t)}}if(6===i||4===i){const a=new TCPConnectWrap;a.oncomplete=afterConnect,a.address=t,a.port=n,a.localAddress=r,a.localPort=o,s=4===i?e._handle.connect(a,t,n):e._handle.connect6(a,t,n)}else{const n=new PipeConnectWrap;n.address=t,n.oncomplete=afterConnect,s=e._handle.connect(n,t,afterConnect)}if(s){var a,c=e._getsockname();c&&(a=c.address+":"+c.port);const i=exceptionWithHostPort(s,"connect",t,n,a);e.destroy(i)}}function lookupAndConnect(e,t){var{port:n,localAddress:i,localPort:r}=t,o=t.host||"localhost";if(i&&!isIP(i))throw new ERR_INVALID_IP_ADDRESS(i);if(r&&"number"!=typeof r)throw new ERR_INVALID_ARG_TYPE("options.localPort","number",r);if(void 0!==n){if("number"!=typeof n&&"string"!=typeof n)throw new ERR_INVALID_ARG_TYPE("options.port",["number","string"],n);if(!isLegalPort(n))throw new ERR_SOCKET_BAD_PORT(n)}n|=0;var s=isIP(o);if(s)defaultTriggerAsyncIdScope(e[async_id_symbol],process.nextTick,()=>{e.connecting&&defaultTriggerAsyncIdScope(e[async_id_symbol],internalConnect,e,o,n,s,i,r)});else{if(t.lookup&&"function"!=typeof t.lookup)throw new ERR_INVALID_ARG_TYPE("options.lookup","Function",t.lookup);void 0===dns&&(dns=require("dns"));var a={family:t.family,hints:t.hints||0};"win32"!==process.platform&&4!==a.family&&6!==a.family&&0===a.hints&&(a.hints=dns.ADDRCONFIG),debug("connect: find host",o),debug("connect: dns options",a),e._host=o;var c=t.lookup||dns.lookup;defaultTriggerAsyncIdScope(e[async_id_symbol],function(){c(o,a,function(s,a,c){e.emit("lookup",s,a,c,o),e.connecting&&(s?(s.host=t.host,s.port=t.port,s.message=s.message+" "+t.host+":"+t.port,process.nextTick(connectErrorNT,e,s)):4!==c&&6!==c?((s=new ERR_INVALID_ADDRESS_FAMILY(c)).host=t.host,s.port=t.port,s.message=s.message+" "+t.host+":"+t.port,process.nextTick(connectErrorNT,e,s)):(e._unrefTimer(),defaultTriggerAsyncIdScope(e[async_id_symbol],internalConnect,e,a,n,c,i,r)))})})}}function connectErrorNT(e,t){e.destroy(t)}function afterConnect(e,t,n,i,r){var o=t[owner_symbol];if(!o.destroyed)if(t=o._handle,debug("afterConnect"),assert(o.connecting),o.connecting=!1,o._sockname=null,0===e)o.readable=i,o._writableState.ended||(o.writable=r),o._unrefTimer(),o.emit("connect"),o.emit("ready"),i&&!o.isPaused()&&o.read(0);else{var s;o.connecting=!1,n.localAddress&&n.localPort&&(s=n.localAddress+":"+n.localPort);var a=exceptionWithHostPort(e,"connect",n.address,n.port,s);s&&(a.localAddress=n.localAddress,a.localPort=n.localPort),o.destroy(a)}}function Server(e,t){if(!(this instanceof Server))return new Server(e,t);if(EventEmitter.call(this),"function"==typeof e)t=e,e={},this.on("connection",t);else{if(null!=e&&"object"!=typeof e)throw new ERR_INVALID_ARG_TYPE("options","Object",e);e=e||{},"function"==typeof t&&this.on("connection",t)}this._connections=0,Object.defineProperty(this,"connections",{get:internalUtil.deprecate(()=>this._usingWorkers?null:this._connections,"Server.connections property is deprecated. Use Server.getConnections method instead.","DEP0020"),set:internalUtil.deprecate(e=>this._connections=e,"Server.connections property is deprecated.","DEP0020"),configurable:!0,enumerable:!1}),this[async_id_symbol]=-1,this._handle=null,this._usingWorkers=!1,this._workers=[],this._unref=!1,this.allowHalfOpen=e.allowHalfOpen||!1,this.pauseOnConnect=!!e.pauseOnConnect}function toNumber(e){return(e=Number(e))>=0&&e}function createServerHandle(e,t,n,i){var r,o=0,s=!1;if("number"==typeof i&&i>=0){try{r=createHandle(i,!0)}catch(e){return debug("listen invalid fd=%d:",i,e.message),UV_EINVAL}if(o=r.open(i))return o;r.readable=!0,r.writable=!0,assert(!e&&!t)}else if(-1===t&&-1===n){if(r=new Pipe(PipeConstants.SERVER),"win32"===process.platform){var a=parseInt(process.env.NODE_PENDING_PIPE_INSTANCES);Number.isNaN(a)||r.setPendingInstances(a)}}else r=new TCP(TCPConstants.SERVER),s=!0;if(e||t||s)if(debug("bind to",e||"any"),e)o=6===n?r.bind6(e,t):r.bind(e,t);else if(o=r.bind6("::",t))return r.close(),createServerHandle("0.0.0.0",t);return o?(r.close(),o):r}function setupListenHandle(e,t,n,i,r){if(debug("setupListenHandle",e,t,n,i,r),this._handle)debug("setupListenHandle: have a handle already");else{debug("setupListenHandle: create a handle");var o=null;if(e||"number"==typeof r||("number"==typeof(o=createServerHandle("::",t,6,r))?(o=null,e="0.0.0.0",n=4):(e="::",n=6)),null===o&&(o=createServerHandle(e,t,n,r)),"number"==typeof o){var s=uvExceptionWithHostPort(o,"listen",e,t);return void process.nextTick(emitErrorNT,this,s)}this._handle=o}this[async_id_symbol]=getNewAsyncId(this._handle),this._handle.onconnection=onconnection,this._handle[owner_symbol]=this;var a=this._handle.listen(i||511);if(a){var c=uvExceptionWithHostPort(a,"listen",e,t);return this._handle.close(),this._handle=null,void defaultTriggerAsyncIdScope(this[async_id_symbol],process.nextTick,emitErrorNT,this,c)}this._connectionKey=n+":"+e+":"+t,this._unref&&this.unref(),defaultTriggerAsyncIdScope(this[async_id_symbol],process.nextTick,emitListeningNT,this)}function emitErrorNT(e,t){e.emit("error",t)}function emitListeningNT(e){e._handle&&e.emit("listening")}function listenInCluster(e,t,n,i,r,o,s){if(s=!!s,void 0===cluster&&(cluster=require("cluster")),cluster.isMaster||s)return void e._listen2(t,n,i,r,o);const a={address:t,port:n,addressType:i,fd:o,flags:0};cluster._getServer(e,a,function(s,a){if(s=checkBindError(s,n,a)){var c=exceptionWithHostPort(s,"bind",t,n);return e.emit("error",c)}e._handle=a,e._listen2(t,n,i,r,o)})}function lookupAndListen(e,t,n,i,r){void 0===dns&&(dns=require("dns")),dns.lookup(n,function(n,o,s){n?e.emit("error",n):listenInCluster(e,o,t,s=o?s:4,i,void 0,r)})}function onconnection(e,t){var n=this[owner_symbol];if(debug("onconnection"),e)n.emit("error",errnoException(e,"accept"));else if(n.maxConnections&&n._connections>=n.maxConnections)t.close();else{var i=new Socket({handle:t,allowHalfOpen:n.allowHalfOpen,pauseOnCreate:n.pauseOnConnect,readable:!0,writable:!0});n._connections++,i.server=n,i._server=n,DTRACE_NET_SERVER_CONNECTION(i),COUNTER_NET_SERVER_CONNECTION(i),n.emit("connection",i)}}function emitCloseNT(e){debug("SERVER: emit close"),e.emit("close")}var _setSimultaneousAccepts,simultaneousAccepts;(util.inherits(Socket,stream.Duplex),Socket.prototype._unrefTimer=function(){for(var e=this;null!==e;e=e._parent)e[kTimeout]&&e[kTimeout].refresh()},Socket.prototype._final=function(e){if(this.connecting)return debug("_final: not yet connected"),this.once("connect",()=>this._final(e));if(!this.readable||this._readableState.ended)return debug("_final: ended, destroy",this._readableState),e(),this.destroy();if(debug("_final: not ended, call shutdown()"),!this._handle||!this._handle.shutdown)return e(),this.destroy();var t=defaultTriggerAsyncIdScope(this[async_id_symbol],shutdownSocket,this,e);return t?this.destroy(errnoException(t,"shutdown")):void 0},Socket.prototype.setTimeout=function(e,t){return this.timeout=e,e=validateTimerDuration(e),clearTimeout(this[kTimeout]),0===e?t&&this.removeListener("timeout",t):(this[kTimeout]=setUnrefTimeout(this._onTimeout.bind(this),e),t&&this.once("timeout",t)),this},Socket.prototype._onTimeout=function(){const e=this._handle,t=this[kLastWriteQueueSize];if(t>0&&e){const{writeQueueSize:n}=e;if(t!==n)return this[kLastWriteQueueSize]=n,void this._unrefTimer()}debug("_onTimeout"),this.emit("timeout")},Socket.prototype.setNoDelay=function(e){return this._handle?(this._handle.setNoDelay&&this._handle.setNoDelay(void 0===e||!!e),this):(this.once("connect",e?this.setNoDelay:()=>this.setNoDelay(e)),this)},Socket.prototype.setKeepAlive=function(e,t){return this._handle?(this._handle.setKeepAlive&&this._handle.setKeepAlive(e,~~(t/1e3)),this):(this.once("connect",()=>this.setKeepAlive(e,t)),this)},Socket.prototype.address=function(){return this._getsockname()},Object.defineProperty(Socket.prototype,"_connecting",{get:function(){return this.connecting}}),Object.defineProperty(Socket.prototype,"readyState",{get:function(){return this.connecting?"opening":this.readable&&this.writable?"open":this.readable&&!this.writable?"readOnly":!this.readable&&this.writable?"writeOnly":"closed"}}),Object.defineProperty(Socket.prototype,"bufferSize",{get:function(){if(this._handle)return this[kLastWriteQueueSize]+this.writableLength}}),Object.defineProperty(Socket.prototype,kUpdateTimer,{get:function(){return this._unrefTimer}}),Socket.prototype._read=function(e){if(debug("_read"),this.connecting||!this._handle)debug("_read wait for connection"),this.once("connect",()=>this._read(e));else if(!this._handle.reading){debug("Socket._read readStart"),this._handle.reading=!0;var t=this._handle.readStart();t&&this.destroy(errnoException(t,"read"))}},Socket.prototype.end=function(e,t,n){return stream.Duplex.prototype.end.call(this,e,t,n),DTRACE_NET_STREAM_END(this),this},Socket.prototype.destroySoon=function(){this.writable&&this.end(),this._writableState.finished?this.destroy():this.once("finish",this.destroy)},Socket.prototype._destroy=function(e,t){debug("destroy"),this.connecting=!1,this.readable=this.writable=!1;for(var n=this;null!==n;n=n._parent)clearTimeout(n[kTimeout]);if(debug("close"),this._handle){this!==process.stderr&&debug("close handle");var i=!!e;this[kBytesRead]=this._handle.bytesRead,this[kBytesWritten]=this._handle.bytesWritten,this._handle.close(()=>{debug("emit close"),this.emit("close",i)}),this._handle.onread=noop,this._handle=null,this._sockname=null}t(e),this._server&&(COUNTER_NET_SERVER_CONNECTION_CLOSE(this),debug("has server"),this._server._connections--,this._server._emitCloseIfDrained&&this._server._emitCloseIfDrained())},Socket.prototype._getpeername=function(){if(!this._peername){if(!this._handle||!this._handle.getpeername)return{};var e={};if(this._handle.getpeername(e))return{};this._peername=e}return this._peername},protoGetter("bytesRead",function(){return this._handle?this._handle.bytesRead:this[kBytesRead]}),protoGetter("remoteAddress",function(){return this._getpeername().address}),protoGetter("remoteFamily",function(){return this._getpeername().family}),protoGetter("remotePort",function(){return this._getpeername().port}),Socket.prototype._getsockname=function(){if(!this._handle||!this._handle.getsockname)return{};if(!this._sockname){var e={};if(this._handle.getsockname(e))return{};this._sockname=e}return this._sockname},protoGetter("localAddress",function(){return this._getsockname().address}),protoGetter("localPort",function(){return this._getsockname().port}),Socket.prototype._writeGeneric=function(e,t,n,i){if(this.connecting)return this._pendingData=t,this._pendingEncoding=n,void this.once("connect",function(){this._writeGeneric(e,t,n,i)});if(this._pendingData=null,this._pendingEncoding="",!this._handle)return this.destroy(new ERR_SOCKET_CLOSED,i),!1;this._unrefTimer();var r=createWriteWrap(this._handle,afterWrite);e?writevGeneric(this,r,t,i):writeGeneric(this,r,t,n,i),r.async&&(this[kLastWriteQueueSize]=r.bytes)},Socket.prototype._writev=function(e,t){this._writeGeneric(!0,e,"",t)},Socket.prototype._write=function(e,t,n){this._writeGeneric(!1,e,t,n)},protoGetter("_bytesDispatched",function(){return this._handle?this._handle.bytesWritten:this[kBytesWritten]}),protoGetter("bytesWritten",function(){var e=this._bytesDispatched;const t=this._writableState,n=this._pendingData,i=this._pendingEncoding;if(t){if(this.writableBuffer.forEach(function(t){t.chunk instanceof Buffer?e+=t.chunk.length:e+=Buffer.byteLength(t.chunk,t.encoding)}),Array.isArray(n))for(var r=0;r<n.length;r++){const t=n[r];n.allBuffers||t instanceof Buffer?e+=t.length:e+=Buffer.byteLength(t.chunk,t.encoding)}else n&&(e+="string"!=typeof n?n.length:Buffer.byteLength(n,i));return e}}),Socket.prototype.connect=function(...e){let t;var n=(t=Array.isArray(e[0])&&e[0][normalizedArgsSymbol]?e[0]:normalizeArgs(e))[0],i=t[1];this.write!==Socket.prototype.write&&(this.write=Socket.prototype.write),this.destroyed&&(this._undestroy(),this._handle=null,this._peername=null,this._sockname=null);const{path:r}=n;var o=!!r;return debug("pipe",o,r),this._handle||(this._handle=o?new Pipe(PipeConstants.SOCKET):new TCP(TCPConstants.SOCKET),initSocketHandle(this)),null!==i&&this.once("connect",i),this._unrefTimer(),this.connecting=!0,this.writable=!0,o?(validateString(r,"options.path"),defaultTriggerAsyncIdScope(this[async_id_symbol],internalConnect,this,r)):lookupAndConnect(this,n),this},Socket.prototype.ref=function(){return this._handle?("function"==typeof this._handle.ref&&this._handle.ref(),this):(this.once("connect",this.ref),this)},Socket.prototype.unref=function(){return this._handle?("function"==typeof this._handle.unref&&this._handle.unref(),this):(this.once("connect",this.unref),this)},util.inherits(Server,EventEmitter),Server.prototype._listen2=setupListenHandle,Server.prototype.listen=function(...e){var t=normalizeArgs(e),n=t[0],i=t[1];if(this._handle)throw new ERR_SERVER_ALREADY_LISTEN;null!==i&&this.once("listening",i);var r,o=toNumber(e.length>1&&e[1])||toNumber(e.length>2&&e[2]);if((n=n._handle||n.handle||n)instanceof TCP)return this._handle=n,this[async_id_symbol]=this._handle.getAsyncId(),listenInCluster(this,null,-1,-1,o),this;if("number"==typeof n.fd&&n.fd>=0)return listenInCluster(this,null,null,null,o,n.fd),this;if((0===e.length||"function"==typeof e[0]||void 0===n.port&&"port"in n||null===n.port)&&(n.port=0),"number"==typeof n.port||"string"==typeof n.port){if(!isLegalPort(n.port))throw new ERR_SOCKET_BAD_PORT(n.port);return r=n.backlog||o,n.host?lookupAndListen(this,0|n.port,n.host,r,n.exclusive):listenInCluster(this,null,0|n.port,4,r,void 0,n.exclusive),this}if(n.path&&isPipeName(n.path)){if(listenInCluster(this,this._pipeName=n.path,-1,-1,r=n.backlog||o,void 0,n.exclusive),!this._handle)return this;let e=0;if(!0===n.readableAll&&(e|=PipeConstants.UV_READABLE),!0===n.writableAll&&(e|=PipeConstants.UV_WRITABLE),0!==e){const t=this._handle.fchmod(e);if(t)throw this._handle.close(),this._handle=null,errnoException(t,"uv_pipe_chmod")}return this}throw new ERR_INVALID_OPT_VALUE("options",util.inspect(n))},Object.defineProperty(Server.prototype,"listening",{get:function(){return!!this._handle},configurable:!0,enumerable:!0}),Server.prototype.address=function(){if(this._handle&&this._handle.getsockname){var e={},t=this._handle.getsockname(e);if(t)throw errnoException(t,"address");return e}return this._pipeName?this._pipeName:null},Server.prototype.getConnections=function(e){const t=this;function n(n,i){defaultTriggerAsyncIdScope(t[async_id_symbol],process.nextTick,e,n,i)}if(!this._usingWorkers)return n(null,this._connections),this;var i=this._workers.length,r=this._connections;function o(e,t){return e?(i=-1,n(e)):(r+=t,0==--i?n(null,r):void 0)}for(var s=0;s<this._workers.length;s++)this._workers[s].getConnections(o);return this},Server.prototype.close=function(e){if("function"==typeof e&&(this._handle?this.once("close",e):this.once("close",function(){e(new ERR_SERVER_NOT_RUNNING)})),this._handle&&(this._handle.close(),this._handle=null),this._usingWorkers){var t=this._workers.length;const e=()=>{0==--t&&(this._connections=0,this._emitCloseIfDrained())};this._connections++;for(var n=0;n<this._workers.length;n++)this._workers[n].close(e)}else this._emitCloseIfDrained();return this},Server.prototype._emitCloseIfDrained=function(){debug("SERVER _emitCloseIfDrained"),this._handle||this._connections?debug("SERVER handle? %j   connections? %d",!!this._handle,this._connections):defaultTriggerAsyncIdScope(this[async_id_symbol],process.nextTick,emitCloseNT,this)},Object.defineProperty(TCP.prototype,"owner",{get(){return this[owner_symbol]},set(e){return this[owner_symbol]=e}}),Server.prototype.listenFD=internalUtil.deprecate(function(e,t){return this.listen({fd:e})},"Server.listenFD is deprecated. Use Server.listen({fd: <number>}) instead.","DEP0021"),Server.prototype._setupWorker=function(e){this._usingWorkers=!0,this._workers.push(e),e.once("exit",e=>{const t=this._workers.indexOf(e);this._workers.splice(t,1)})},Server.prototype.ref=function(){return this._unref=!1,this._handle&&this._handle.ref(),this},Server.prototype.unref=function(){return this._unref=!0,this._handle&&this._handle.unref(),this},"win32"===process.platform)?_setSimultaneousAccepts=function(e){void 0!==e&&(void 0===simultaneousAccepts&&(simultaneousAccepts=process.env.NODE_MANY_ACCEPTS&&"0"!==process.env.NODE_MANY_ACCEPTS),e._simultaneousAccepts!==simultaneousAccepts&&(e.setSimultaneousAccepts(!!simultaneousAccepts),e._simultaneousAccepts=simultaneousAccepts))}:_setSimultaneousAccepts=function(){};module.exports={_createServerHandle:createServerHandle,_normalizeArgs:normalizeArgs,_setSimultaneousAccepts,connect,createConnection:connect,createServer,isIP,isIPv4,isIPv6,Server,Socket,Stream:Socket};"use strict";const{pushValToArrayMax,safeGetenv}=internalBinding("util"),constants=process.binding("constants").os,{deprecate}=require("internal/util"),isWindows="win32"===process.platform,{codes:{ERR_SYSTEM_ERROR}}=require("internal/errors"),{validateInt32}=require("internal/validators"),{getCPUs,getFreeMem,getHomeDirectory:_getHomeDirectory,getHostname:_getHostname,getInterfaceAddresses:_getInterfaceAddresses,getLoadAvg,getOSRelease:_getOSRelease,getOSType:_getOSType,getPriority:_getPriority,getTotalMem,getUserInfo,getUptime,isBigEndian,setPriority:_setPriority}=process.binding("os");function getCheckedFunction(e){return function t(...r){const n={},i=e(...r,n);if(void 0===i){const e=new ERR_SYSTEM_ERROR(n);throw Error.captureStackTrace(e,t),e}return i}}const getHomeDirectory=getCheckedFunction(_getHomeDirectory),getHostname=getCheckedFunction(_getHostname),getInterfaceAddresses=getCheckedFunction(_getInterfaceAddresses),getOSRelease=getCheckedFunction(_getOSRelease),getOSType=getCheckedFunction(_getOSType);getFreeMem[Symbol.toPrimitive]=(()=>getFreeMem()),getHostname[Symbol.toPrimitive]=(()=>getHostname()),getHomeDirectory[Symbol.toPrimitive]=(()=>getHomeDirectory()),getOSRelease[Symbol.toPrimitive]=(()=>getOSRelease()),getOSType[Symbol.toPrimitive]=(()=>getOSType()),getTotalMem[Symbol.toPrimitive]=(()=>getTotalMem()),getUptime[Symbol.toPrimitive]=(()=>getUptime());const kEndianness=isBigEndian?"BE":"LE",tmpDirDeprecationMsg="os.tmpDir() is deprecated. Use os.tmpdir() instead.",getNetworkInterfacesDepMsg="os.getNetworkInterfaces is deprecated. Use os.networkInterfaces instead.",avgValues=new Float64Array(3),cpuValues=new Float64Array(6*pushValToArrayMax);function loadavg(){return getLoadAvg(avgValues),[avgValues[0],avgValues[1],avgValues[2]]}function addCPUInfo(){for(var e=0,t=0;e<arguments.length;++e,t+=6)this[this.length]={model:arguments[e],speed:cpuValues[t],times:{user:cpuValues[t+1],nice:cpuValues[t+2],sys:cpuValues[t+3],idle:cpuValues[t+4],irq:cpuValues[t+5]}}}function cpus(){return getCPUs(addCPUInfo,cpuValues,[])}function arch(){return process.arch}function platform(){return process.platform}function tmpdir(){var e;return isWindows?(e=process.env.TEMP||process.env.TMP||(process.env.SystemRoot||process.env.windir)+"\\temp").length>1&&e.endsWith("\\")&&!e.endsWith(":\\")&&(e=e.slice(0,-1)):(e=safeGetenv("TMPDIR")||safeGetenv("TMP")||safeGetenv("TEMP")||"/tmp").length>1&&e.endsWith("/")&&(e=e.slice(0,-1)),e}function endianness(){return kEndianness}function countBinaryOnes(e){let t=0;for(;0!==e;)e&=e-1,t++;return t}function getCIDR({address:e,netmask:t,family:r}){let n=0,i=".",s=10,o=8,a=!1;"IPv6"===r&&(i=":",s=16,o=16);const c=t.split(i);for(var g=0;g<c.length;g++)if(""!==c[g]){const e=parseInt(c[g],s),t=countBinaryOnes(e);if(n+=t,a){if(0!==t)return null}else if(t!==o){if(0!=(1&e))return null;a=!0}}return`${e}/${n}`}function networkInterfaces(){const e=getInterfaceAddresses(),t=Object.keys(e);for(var r=0;r<t.length;r++){const i=e[t[r]];for(var n=0;n<i.length;n++)i[n].cidr=getCIDR(i[n])}return e}function setPriority(e,t){void 0===t&&(t=e,e=0),validateInt32(e,"pid"),validateInt32(t,"priority",-20,19);const r={};if(0!==_setPriority(e,t,r))throw new ERR_SYSTEM_ERROR(r)}function getPriority(e){void 0===e?e=0:validateInt32(e,"pid");const t={},r=_getPriority(e,t);if(void 0===r)throw new ERR_SYSTEM_ERROR(t);return r}function userInfo(e){"object"!=typeof e&&(e=null);const t={},r=getUserInfo(e,t);if(void 0===r)throw new ERR_SYSTEM_ERROR(t);return r}arch[Symbol.toPrimitive]=(()=>process.arch),platform[Symbol.toPrimitive]=(()=>process.platform),tmpdir[Symbol.toPrimitive]=(()=>tmpdir()),endianness[Symbol.toPrimitive]=(()=>kEndianness),module.exports={arch,cpus,endianness,freemem:getFreeMem,getPriority,homedir:getHomeDirectory,hostname:getHostname,loadavg,networkInterfaces,platform,release:getOSRelease,setPriority,tmpdir,totalmem:getTotalMem,type:getOSType,userInfo,uptime:getUptime,getNetworkInterfaces:deprecate(getInterfaceAddresses,getNetworkInterfacesDepMsg,"DEP0023"),tmpDir:deprecate(tmpdir,tmpDirDeprecationMsg,"DEP0022")},Object.defineProperties(module.exports,{constants:{configurable:!1,enumerable:!0,value:constants},EOL:{configurable:!0,enumerable:!0,writable:!1,value:isWindows?"\r\n":"\n"}});"use strict";const{ERR_INVALID_ARG_TYPE}=require("internal/errors").codes,{CHAR_UPPERCASE_A,CHAR_LOWERCASE_A,CHAR_UPPERCASE_Z,CHAR_LOWERCASE_Z,CHAR_DOT,CHAR_FORWARD_SLASH,CHAR_BACKWARD_SLASH,CHAR_COLON,CHAR_QUESTION_MARK}=require("internal/constants");function assertPath(e){if("string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("path","string",e)}function isPathSeparator(e){return e===CHAR_FORWARD_SLASH||e===CHAR_BACKWARD_SLASH}function isPosixPathSeparator(e){return e===CHAR_FORWARD_SLASH}function isWindowsDeviceRoot(e){return e>=CHAR_UPPERCASE_A&&e<=CHAR_UPPERCASE_Z||e>=CHAR_LOWERCASE_A&&e<=CHAR_LOWERCASE_Z}function normalizeString(e,t,r,a){for(var o,i="",n=0,A=-1,s=0,h=0;h<=e.length;++h){if(h<e.length)o=e.charCodeAt(h);else{if(a(o))break;o=CHAR_FORWARD_SLASH}if(a(o)){if(A===h-1||1===s);else if(A!==h-1&&2===s){if(i.length<2||2!==n||i.charCodeAt(i.length-1)!==CHAR_DOT||i.charCodeAt(i.length-2)!==CHAR_DOT){if(i.length>2){const e=i.lastIndexOf(r);-1===e?(i="",n=0):n=(i=i.slice(0,e)).length-1-i.lastIndexOf(r),A=h,s=0;continue}if(2===i.length||1===i.length){i="",n=0,A=h,s=0;continue}}t&&(i.length>0?i+=`${r}..`:i="..",n=2)}else i.length>0?i+=r+e.slice(A+1,h):i=e.slice(A+1,h),n=h-A-1;A=h,s=0}else o===CHAR_DOT&&-1!==s?++s:s=-1}return i}function _format(e,t){const r=t.dir||t.root,a=t.base||(t.name||"")+(t.ext||"");return r?r===t.root?r+a:r+e+a:a}const win32={resolve:function(){for(var e="",t="",r=!1,a=arguments.length-1;a>=-1;a--){var o;if(a>=0?o=arguments[a]:e?void 0!==(o=process.env["="+e]||process.cwd())&&o.slice(0,3).toLowerCase()===e.toLowerCase()+"\\"||(o=e+"\\"):o=process.cwd(),assertPath(o),0===o.length)continue;var i=o.length,n=0,A="",s=!1;const l=o.charCodeAt(0);if(i>1)if(isPathSeparator(l))if(s=!0,isPathSeparator(o.charCodeAt(1))){for(var h=2,c=h;h<i&&!isPathSeparator(o.charCodeAt(h));++h);if(h<i&&h!==c){const e=o.slice(c,h);for(c=h;h<i&&isPathSeparator(o.charCodeAt(h));++h);if(h<i&&h!==c){for(c=h;h<i&&!isPathSeparator(o.charCodeAt(h));++h);h===i?(A="\\\\"+e+"\\"+o.slice(c),n=h):h!==c&&(A="\\\\"+e+"\\"+o.slice(c,h),n=h)}}}else n=1;else isWindowsDeviceRoot(l)&&o.charCodeAt(1)===CHAR_COLON&&(A=o.slice(0,2),n=2,i>2&&isPathSeparator(o.charCodeAt(2))&&(s=!0,n=3));else isPathSeparator(l)&&(n=1,s=!0);if(!(A.length>0&&e.length>0&&A.toLowerCase()!==e.toLowerCase())&&(0===e.length&&A.length>0&&(e=A),r||(t=o.slice(n)+"\\"+t,r=s),e.length>0&&r))break}return e+(r?"\\":"")+(t=normalizeString(t,!r,"\\",isPathSeparator))||"."},normalize:function(e){assertPath(e);const t=e.length;if(0===t)return".";var r,a=0,o=!1;const i=e.charCodeAt(0);if(t>1)if(isPathSeparator(i))if(o=!0,isPathSeparator(e.charCodeAt(1))){for(var n=2,A=n;n<t&&!isPathSeparator(e.charCodeAt(n));++n);if(n<t&&n!==A){const o=e.slice(A,n);for(A=n;n<t&&isPathSeparator(e.charCodeAt(n));++n);if(n<t&&n!==A){for(A=n;n<t&&!isPathSeparator(e.charCodeAt(n));++n);if(n===t)return"\\\\"+o+"\\"+e.slice(A)+"\\";n!==A&&(r="\\\\"+o+"\\"+e.slice(A,n),a=n)}}}else a=1;else isWindowsDeviceRoot(i)&&e.charCodeAt(1)===CHAR_COLON&&(r=e.slice(0,2),a=2,t>2&&isPathSeparator(e.charCodeAt(2))&&(o=!0,a=3));else if(isPathSeparator(i))return"\\";var s;return 0!==(s=a<t?normalizeString(e.slice(a),!o,"\\",isPathSeparator):"").length||o||(s="."),s.length>0&&isPathSeparator(e.charCodeAt(t-1))&&(s+="\\"),void 0===r?o?s.length>0?"\\"+s:"\\":s.length>0?s:"":o?s.length>0?r+"\\"+s:r+"\\":s.length>0?r+s:r},isAbsolute:function(e){assertPath(e);const t=e.length;if(0===t)return!1;const r=e.charCodeAt(0);return!!isPathSeparator(r)||!!(isWindowsDeviceRoot(r)&&t>2&&e.charCodeAt(1)===CHAR_COLON&&isPathSeparator(e.charCodeAt(2)))},join:function(){if(0===arguments.length)return".";for(var e,t,r=0;r<arguments.length;++r){var a=arguments[r];assertPath(a),a.length>0&&(void 0===e?e=t=a:e+="\\"+a)}if(void 0===e)return".";var o=!0,i=0;if(isPathSeparator(t.charCodeAt(0))){++i;const e=t.length;e>1&&isPathSeparator(t.charCodeAt(1))&&(++i,e>2&&(isPathSeparator(t.charCodeAt(2))?++i:o=!1))}if(o){for(;i<e.length&&isPathSeparator(e.charCodeAt(i));++i);i>=2&&(e="\\"+e.slice(i))}return win32.normalize(e)},relative:function(e,t){if(assertPath(e),assertPath(t),e===t)return"";var r=win32.resolve(e),a=win32.resolve(t);if(r===a)return"";if((e=r.toLowerCase())===(t=a.toLowerCase()))return"";for(var o=0;o<e.length&&e.charCodeAt(o)===CHAR_BACKWARD_SLASH;++o);for(var i=e.length;i-1>o&&e.charCodeAt(i-1)===CHAR_BACKWARD_SLASH;--i);for(var n=i-o,A=0;A<t.length&&t.charCodeAt(A)===CHAR_BACKWARD_SLASH;++A);for(var s=t.length;s-1>A&&t.charCodeAt(s-1)===CHAR_BACKWARD_SLASH;--s);for(var h=s-A,c=n<h?n:h,l=-1,C=0;C<=c;++C){if(C===c){if(h>c){if(t.charCodeAt(A+C)===CHAR_BACKWARD_SLASH)return a.slice(A+C+1);if(2===C)return a.slice(A+C)}n>c&&(e.charCodeAt(o+C)===CHAR_BACKWARD_SLASH?l=C:2===C&&(l=3));break}var f=e.charCodeAt(o+C);if(f!==t.charCodeAt(A+C))break;f===CHAR_BACKWARD_SLASH&&(l=C)}if(C!==c&&-1===l)return a;var R="";for(-1===l&&(l=0),C=o+l+1;C<=i;++C)C!==i&&e.charCodeAt(C)!==CHAR_BACKWARD_SLASH||(0===R.length?R+="..":R+="\\..");return R.length>0?R+a.slice(A+l,s):(A+=l,a.charCodeAt(A)===CHAR_BACKWARD_SLASH&&++A,a.slice(A,s))},toNamespacedPath:function(e){if("string"!=typeof e)return e;if(0===e.length)return"";const t=win32.resolve(e);if(t.length>=3)if(t.charCodeAt(0)===CHAR_BACKWARD_SLASH){if(t.charCodeAt(1)===CHAR_BACKWARD_SLASH){const e=t.charCodeAt(2);if(e!==CHAR_QUESTION_MARK&&e!==CHAR_DOT)return"\\\\?\\UNC\\"+t.slice(2)}}else if(isWindowsDeviceRoot(t.charCodeAt(0))&&t.charCodeAt(1)===CHAR_COLON&&t.charCodeAt(2)===CHAR_BACKWARD_SLASH)return"\\\\?\\"+t;return e},dirname:function(e){assertPath(e);const t=e.length;if(0===t)return".";var r=-1,a=-1,o=!0,i=0;const n=e.charCodeAt(0);if(t>1)if(isPathSeparator(n)){if(r=i=1,isPathSeparator(e.charCodeAt(1))){for(var A=2,s=A;A<t&&!isPathSeparator(e.charCodeAt(A));++A);if(A<t&&A!==s){for(s=A;A<t&&isPathSeparator(e.charCodeAt(A));++A);if(A<t&&A!==s){for(s=A;A<t&&!isPathSeparator(e.charCodeAt(A));++A);if(A===t)return e;A!==s&&(r=i=A+1)}}}}else isWindowsDeviceRoot(n)&&e.charCodeAt(1)===CHAR_COLON&&(r=i=2,t>2&&isPathSeparator(e.charCodeAt(2))&&(r=i=3));else if(isPathSeparator(n))return e;for(var h=t-1;h>=i;--h)if(isPathSeparator(e.charCodeAt(h))){if(!o){a=h;break}}else o=!1;if(-1===a){if(-1===r)return".";a=r}return e.slice(0,a)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new ERR_INVALID_ARG_TYPE("ext","string",t);assertPath(e);var r,a=0,o=-1,i=!0;if(e.length>=2){isWindowsDeviceRoot(e.charCodeAt(0))&&e.charCodeAt(1)===CHAR_COLON&&(a=2)}if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var n=t.length-1,A=-1;for(r=e.length-1;r>=a;--r){const s=e.charCodeAt(r);if(isPathSeparator(s)){if(!i){a=r+1;break}}else-1===A&&(i=!1,A=r+1),n>=0&&(s===t.charCodeAt(n)?-1==--n&&(o=r):(n=-1,o=A))}return a===o?o=A:-1===o&&(o=e.length),e.slice(a,o)}for(r=e.length-1;r>=a;--r)if(isPathSeparator(e.charCodeAt(r))){if(!i){a=r+1;break}}else-1===o&&(i=!1,o=r+1);return-1===o?"":e.slice(a,o)},extname:function(e){assertPath(e);var t=0,r=-1,a=0,o=-1,i=!0,n=0;e.length>=2&&e.charCodeAt(1)===CHAR_COLON&&isWindowsDeviceRoot(e.charCodeAt(0))&&(t=a=2);for(var A=e.length-1;A>=t;--A){const t=e.charCodeAt(A);if(isPathSeparator(t)){if(!i){a=A+1;break}}else-1===o&&(i=!1,o=A+1),t===CHAR_DOT?-1===r?r=A:1!==n&&(n=1):-1!==r&&(n=-1)}return-1===r||-1===o||0===n||1===n&&r===o-1&&r===a+1?"":e.slice(r,o)},format:function(e){if(null===e||"object"!=typeof e)throw new ERR_INVALID_ARG_TYPE("pathObject","Object",e);return _format("\\",e)},parse:function(e){assertPath(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var r=e.length,a=0;let o=e.charCodeAt(0);if(r>1){if(isPathSeparator(o)){if(a=1,isPathSeparator(e.charCodeAt(1))){for(var i=2,n=i;i<r&&!isPathSeparator(e.charCodeAt(i));++i);if(i<r&&i!==n){for(n=i;i<r&&isPathSeparator(e.charCodeAt(i));++i);if(i<r&&i!==n){for(n=i;i<r&&!isPathSeparator(e.charCodeAt(i));++i);i===r?a=i:i!==n&&(a=i+1)}}}}else if(isWindowsDeviceRoot(o)&&e.charCodeAt(1)===CHAR_COLON){if(a=2,!(r>2))return t.root=t.dir=e,t;if(isPathSeparator(e.charCodeAt(2))){if(3===r)return t.root=t.dir=e,t;a=3}}}else if(isPathSeparator(o))return t.root=t.dir=e,t;a>0&&(t.root=e.slice(0,a));for(var A=-1,s=a,h=-1,c=!0,l=e.length-1,C=0;l>=a;--l)if(isPathSeparator(o=e.charCodeAt(l))){if(!c){s=l+1;break}}else-1===h&&(c=!1,h=l+1),o===CHAR_DOT?-1===A?A=l:1!==C&&(C=1):-1!==A&&(C=-1);return-1===A||-1===h||0===C||1===C&&A===h-1&&A===s+1?-1!==h&&(t.base=t.name=e.slice(s,h)):(t.name=e.slice(s,A),t.base=e.slice(s,h),t.ext=e.slice(A,h)),t.dir=s>0&&s!==a?e.slice(0,s-1):t.root,t},sep:"\\",delimiter:";",win32:null,posix:null},posix={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var a;assertPath(a=r>=0?arguments[r]:process.cwd()),0!==a.length&&(e=a+"/"+e,t=a.charCodeAt(0)===CHAR_FORWARD_SLASH)}return e=normalizeString(e,!t,"/",isPosixPathSeparator),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(assertPath(e),0===e.length)return".";const t=e.charCodeAt(0)===CHAR_FORWARD_SLASH,r=e.charCodeAt(e.length-1)===CHAR_FORWARD_SLASH;return 0!==(e=normalizeString(e,!t,"/",isPosixPathSeparator)).length||t||(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return assertPath(e),e.length>0&&e.charCodeAt(0)===CHAR_FORWARD_SLASH},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];assertPath(r),r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":posix.normalize(e)},relative:function(e,t){if(assertPath(e),assertPath(t),e===t)return"";if((e=posix.resolve(e))===(t=posix.resolve(t)))return"";for(var r=1;r<e.length&&e.charCodeAt(r)===CHAR_FORWARD_SLASH;++r);for(var a=e.length,o=a-r,i=1;i<t.length&&t.charCodeAt(i)===CHAR_FORWARD_SLASH;++i);for(var n=t.length-i,A=o<n?o:n,s=-1,h=0;h<=A;++h){if(h===A){if(n>A){if(t.charCodeAt(i+h)===CHAR_FORWARD_SLASH)return t.slice(i+h+1);if(0===h)return t.slice(i+h)}else o>A&&(e.charCodeAt(r+h)===CHAR_FORWARD_SLASH?s=h:0===h&&(s=0));break}var c=e.charCodeAt(r+h);if(c!==t.charCodeAt(i+h))break;c===CHAR_FORWARD_SLASH&&(s=h)}var l="";for(h=r+s+1;h<=a;++h)h!==a&&e.charCodeAt(h)!==CHAR_FORWARD_SLASH||(0===l.length?l+="..":l+="/..");return l.length>0?l+t.slice(i+s):(i+=s,t.charCodeAt(i)===CHAR_FORWARD_SLASH&&++i,t.slice(i))},toNamespacedPath:function(e){return e},dirname:function(e){if(assertPath(e),0===e.length)return".";const t=e.charCodeAt(0)===CHAR_FORWARD_SLASH;for(var r=-1,a=!0,o=e.length-1;o>=1;--o)if(e.charCodeAt(o)===CHAR_FORWARD_SLASH){if(!a){r=o;break}}else a=!1;return-1===r?t?"/":".":t&&1===r?"//":e.slice(0,r)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new ERR_INVALID_ARG_TYPE("ext","string",t);assertPath(e);var r,a=0,o=-1,i=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var n=t.length-1,A=-1;for(r=e.length-1;r>=0;--r){const s=e.charCodeAt(r);if(s===CHAR_FORWARD_SLASH){if(!i){a=r+1;break}}else-1===A&&(i=!1,A=r+1),n>=0&&(s===t.charCodeAt(n)?-1==--n&&(o=r):(n=-1,o=A))}return a===o?o=A:-1===o&&(o=e.length),e.slice(a,o)}for(r=e.length-1;r>=0;--r)if(e.charCodeAt(r)===CHAR_FORWARD_SLASH){if(!i){a=r+1;break}}else-1===o&&(i=!1,o=r+1);return-1===o?"":e.slice(a,o)},extname:function(e){assertPath(e);for(var t=-1,r=0,a=-1,o=!0,i=0,n=e.length-1;n>=0;--n){const A=e.charCodeAt(n);if(A!==CHAR_FORWARD_SLASH)-1===a&&(o=!1,a=n+1),A===CHAR_DOT?-1===t?t=n:1!==i&&(i=1):-1!==t&&(i=-1);else if(!o){r=n+1;break}}return-1===t||-1===a||0===i||1===i&&t===a-1&&t===r+1?"":e.slice(t,a)},format:function(e){if(null===e||"object"!=typeof e)throw new ERR_INVALID_ARG_TYPE("pathObject","Object",e);return _format("/",e)},parse:function(e){assertPath(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var r,a=e.charCodeAt(0)===CHAR_FORWARD_SLASH;a?(t.root="/",r=1):r=0;for(var o=-1,i=0,n=-1,A=!0,s=e.length-1,h=0;s>=r;--s){const t=e.charCodeAt(s);if(t!==CHAR_FORWARD_SLASH)-1===n&&(A=!1,n=s+1),t===CHAR_DOT?-1===o?o=s:1!==h&&(h=1):-1!==o&&(h=-1);else if(!A){i=s+1;break}}return-1===o||-1===n||0===h||1===h&&o===n-1&&o===i+1?-1!==n&&(t.base=t.name=0===i&&a?e.slice(1,n):e.slice(i,n)):(0===i&&a?(t.name=e.slice(1,o),t.base=e.slice(1,n)):(t.name=e.slice(i,o),t.base=e.slice(i,n)),t.ext=e.slice(o,n)),i>0?t.dir=e.slice(0,i-1):a&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};posix.win32=win32.win32=win32,posix.posix=win32.posix=posix,win32._makeLong=win32.toNamespacedPath,posix._makeLong=posix.toNamespacedPath,"win32"===process.platform?module.exports=win32:module.exports=posix;"use strict";const{PerformanceEntry,mark:_mark,clearMark:_clearMark,measure:_measure,milestones,observerCounts,setupObservers,timeOrigin,timeOriginTimestamp,timerify,constants}=process.binding("performance"),{NODE_PERFORMANCE_ENTRY_TYPE_NODE,NODE_PERFORMANCE_ENTRY_TYPE_MARK,NODE_PERFORMANCE_ENTRY_TYPE_MEASURE,NODE_PERFORMANCE_ENTRY_TYPE_GC,NODE_PERFORMANCE_ENTRY_TYPE_FUNCTION,NODE_PERFORMANCE_ENTRY_TYPE_HTTP2,NODE_PERFORMANCE_MILESTONE_NODE_START,NODE_PERFORMANCE_MILESTONE_V8_START,NODE_PERFORMANCE_MILESTONE_LOOP_START,NODE_PERFORMANCE_MILESTONE_LOOP_EXIT,NODE_PERFORMANCE_MILESTONE_BOOTSTRAP_COMPLETE,NODE_PERFORMANCE_MILESTONE_ENVIRONMENT}=constants,{AsyncResource}=require("async_hooks"),L=require("internal/linkedlist"),kInspect=require("internal/util").customInspectSymbol,{inherits}=require("util"),kCallback=Symbol("callback"),kTypes=Symbol("types"),kEntries=Symbol("entries"),kBuffer=Symbol("buffer"),kBuffering=Symbol("buffering"),kQueued=Symbol("queued"),kTimerified=Symbol("timerified"),kInsertEntry=Symbol("insert-entry"),kGetEntries=Symbol("get-entries"),kIndex=Symbol("index"),kMarks=Symbol("marks"),kCount=Symbol("count"),observers={},observerableTypes=["node","mark","measure","gc","function","http2"],IDX_STREAM_STATS_ID=0,IDX_STREAM_STATS_TIMETOFIRSTBYTE=1,IDX_STREAM_STATS_TIMETOFIRSTHEADER=2,IDX_STREAM_STATS_TIMETOFIRSTBYTESENT=3,IDX_STREAM_STATS_SENTBYTES=4,IDX_STREAM_STATS_RECEIVEDBYTES=5,IDX_SESSION_STATS_TYPE=0,IDX_SESSION_STATS_PINGRTT=1,IDX_SESSION_STATS_FRAMESRECEIVED=2,IDX_SESSION_STATS_FRAMESSENT=3,IDX_SESSION_STATS_STREAMCOUNT=4,IDX_SESSION_STATS_STREAMAVERAGEDURATION=5,IDX_SESSION_STATS_DATA_SENT=6,IDX_SESSION_STATS_DATA_RECEIVED=7,IDX_SESSION_STATS_MAX_CONCURRENT_STREAMS=8;let sessionStats,streamStats,errors;function collectHttp2Stats(e){switch(e.name){case"Http2Stream":void 0===streamStats&&(streamStats=process.binding("http2").streamStats),e.id=streamStats[IDX_STREAM_STATS_ID]>>>0,e.timeToFirstByte=streamStats[IDX_STREAM_STATS_TIMETOFIRSTBYTE],e.timeToFirstHeader=streamStats[IDX_STREAM_STATS_TIMETOFIRSTHEADER],e.timeToFirstByteSent=streamStats[IDX_STREAM_STATS_TIMETOFIRSTBYTESENT],e.bytesWritten=streamStats[IDX_STREAM_STATS_SENTBYTES],e.bytesRead=streamStats[IDX_STREAM_STATS_RECEIVEDBYTES];break;case"Http2Session":void 0===sessionStats&&(sessionStats=process.binding("http2").sessionStats),e.type=sessionStats[IDX_SESSION_STATS_TYPE]>>>0==0?"server":"client",e.pingRTT=sessionStats[IDX_SESSION_STATS_PINGRTT],e.framesReceived=sessionStats[IDX_SESSION_STATS_FRAMESRECEIVED],e.framesSent=sessionStats[IDX_SESSION_STATS_FRAMESSENT],e.streamCount=sessionStats[IDX_SESSION_STATS_STREAMCOUNT],e.streamAverageDuration=sessionStats[IDX_SESSION_STATS_STREAMAVERAGEDURATION],e.bytesWritten=sessionStats[IDX_SESSION_STATS_DATA_SENT],e.bytesRead=sessionStats[IDX_SESSION_STATS_DATA_RECEIVED],e.maxConcurrentStreams=sessionStats[IDX_SESSION_STATS_MAX_CONCURRENT_STREAMS]}}function lazyErrors(){return void 0===errors&&(errors=require("internal/errors").codes),errors}function now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}function getMilestoneTimestamp(e){const t=milestones[e];return-1===t?t:t/1e6-timeOrigin}class PerformanceNodeTiming{constructor(){}get name(){return"node"}get entryType(){return"node"}get startTime(){return 0}get duration(){return now()-timeOrigin}get nodeStart(){return getMilestoneTimestamp(NODE_PERFORMANCE_MILESTONE_NODE_START)}get v8Start(){return getMilestoneTimestamp(NODE_PERFORMANCE_MILESTONE_V8_START)}get environment(){return getMilestoneTimestamp(NODE_PERFORMANCE_MILESTONE_ENVIRONMENT)}get loopStart(){return getMilestoneTimestamp(NODE_PERFORMANCE_MILESTONE_LOOP_START)}get loopExit(){return getMilestoneTimestamp(NODE_PERFORMANCE_MILESTONE_LOOP_EXIT)}get bootstrapComplete(){return getMilestoneTimestamp(NODE_PERFORMANCE_MILESTONE_BOOTSTRAP_COMPLETE)}[kInspect](){return{name:"node",entryType:"node",startTime:this.startTime,duration:this.duration,nodeStart:this.nodeStart,v8Start:this.v8Start,bootstrapComplete:this.bootstrapComplete,environment:this.environment,loopStart:this.loopStart,loopExit:this.loopExit,thirdPartyMainStart:this.thirdPartyMainStart,thirdPartyMainEnd:this.thirdPartyMainEnd,clusterSetupStart:this.clusterSetupStart,clusterSetupEnd:this.clusterSetupEnd,moduleLoadStart:this.moduleLoadStart,moduleLoadEnd:this.moduleLoadEnd,preloadModuleLoadStart:this.preloadModuleLoadStart,preloadModuleLoadEnd:this.preloadModuleLoadEnd}}}inherits(PerformanceNodeTiming,PerformanceEntry);const nodeTiming=new PerformanceNodeTiming;class PerformanceObserverEntryList{constructor(){Object.defineProperties(this,{[kEntries]:{writable:!0,enumerable:!1,value:{}},[kCount]:{writable:!0,enumerable:!1,value:0}}),L.init(this[kEntries])}[kInsertEntry](e){const t={entry:e};L.append(this[kEntries],t),this[kCount]++}get length(){return this[kCount]}[kGetEntries](e,t){const r=[],s=this[kEntries];if(!L.isEmpty(s)){let n=L.peek(s);for(;n&&n!==s;){const s=n.entry;e&&s.name!==e||t&&s.entryType!==t?n=n._idlePrev:(sortedInsert(r,s),n=n._idlePrev)}}return r}getEntries(){return this[kGetEntries]()}getEntriesByType(e){return this[kGetEntries](void 0,`${e}`)}getEntriesByName(e,t){return this[kGetEntries](`${e}`,void 0!==t?`${t}`:t)}}class PerformanceObserver extends AsyncResource{constructor(e){if("function"!=typeof e){throw new(lazyErrors().ERR_INVALID_CALLBACK)}super("PerformanceObserver"),Object.defineProperties(this,{[kTypes]:{enumerable:!1,writable:!0,value:{}},[kCallback]:{enumerable:!1,writable:!0,value:e},[kBuffer]:{enumerable:!1,writable:!0,value:new PerformanceObserverEntryList},[kBuffering]:{enumerable:!1,writable:!0,value:!1},[kQueued]:{enumerable:!1,writable:!0,value:!1}})}disconnect(){const e=this[kTypes],t=Object.keys(e);for(var r=0;r<t.length;r++){const s=e[t[r]];s&&(L.remove(s),observerCounts[t[r]]--)}this[kTypes]={}}observe(e){const t=lazyErrors();if("object"!=typeof e||null==e)throw new t.ERR_INVALID_ARG_TYPE("options","Object",e);if(!Array.isArray(e.entryTypes))throw new t.ERR_INVALID_OPT_VALUE("entryTypes",e);const r=e.entryTypes.filter(filterTypes).map(mapTypes);if(0===r.length)throw new t.ERR_VALID_PERFORMANCE_ENTRY_TYPE;this.disconnect(),this[kBuffer][kEntries]=[],L.init(this[kBuffer][kEntries]),this[kBuffering]=Boolean(e.buffered);for(var s=0;s<r.length;s++){const e=r[s],t=getObserversList(e),n={obs:this};this[kTypes][e]=n,L.append(t,n),observerCounts[e]++}}}class Performance{constructor(){this[kIndex]={[kMarks]:new Set}}get nodeTiming(){return nodeTiming}get timeOrigin(){return timeOriginTimestamp}now(){return now()-timeOrigin}mark(e){_mark(e=`${e}`),this[kIndex][kMarks].add(e)}measure(e,t,r){if(e=`${e}`,r=`${r}`,t=void 0!==t?`${t}`:"",!(this[kIndex][kMarks].has(r)||r in nodeTiming)){throw new(lazyErrors().ERR_INVALID_PERFORMANCE_MARK)(r)}_measure(e,t,r)}clearMarks(e){void 0!==(e=void 0!==e?`${e}`:e)?(this[kIndex][kMarks].delete(e),_clearMark(e)):(this[kIndex][kMarks].clear(),_clearMark())}timerify(e){if("function"!=typeof e){throw new(lazyErrors().ERR_INVALID_ARG_TYPE)("fn","Function",e)}if(e[kTimerified])return e[kTimerified];const t=timerify(e,e.length);return Object.defineProperty(e,kTimerified,{enumerable:!1,configurable:!0,writable:!1,value:t}),Object.defineProperties(t,{[kTimerified]:{enumerable:!1,configurable:!0,writable:!1,value:t},name:{enumerable:!1,configurable:!0,writable:!1,value:`timerified ${e.name}`}}),t}[kInspect](){return{nodeTiming:this.nodeTiming,timeOrigin:this.timeOrigin}}}const performance=new Performance;function getObserversList(e){let t=observers[e];return void 0===t&&(t=observers[e]={},L.init(t)),t}function doNotify(){this[kQueued]=!1,this.runInAsyncScope(this[kCallback],this,this[kBuffer],this),this[kBuffer][kEntries]=[],L.init(this[kBuffer][kEntries])}function observersCallback(e){const t=mapTypes(e.entryType);t===NODE_PERFORMANCE_ENTRY_TYPE_HTTP2&&collectHttp2Stats(e);const r=getObserversList(t);let s=L.peek(r);for(;s&&s.obs;){const t=s.obs;t[kBuffer][kInsertEntry](e),t[kBuffering]?t[kQueued]||(t[kQueued]=!0,setImmediate(doNotify.bind(t))):doNotify.call(t),s=s._idlePrev}}function filterTypes(e){return observerableTypes.indexOf(`${e}`)>=0}function mapTypes(e){switch(e){case"node":return NODE_PERFORMANCE_ENTRY_TYPE_NODE;case"mark":return NODE_PERFORMANCE_ENTRY_TYPE_MARK;case"measure":return NODE_PERFORMANCE_ENTRY_TYPE_MEASURE;case"gc":return NODE_PERFORMANCE_ENTRY_TYPE_GC;case"function":return NODE_PERFORMANCE_ENTRY_TYPE_FUNCTION;case"http2":return NODE_PERFORMANCE_ENTRY_TYPE_HTTP2}}function getInsertLocation(e,t){let r=0,s=e.length;for(;r<s;){const n=s+r>>>1;if(e[n].startTime===t)return n;e[n].startTime<t?r=n+1:s=n}return r}function sortedInsert(e,t){const r=t.startTime;if(0===e.length||e[e.length-1].startTime<r)return void e.push(t);if(e[0]&&e[0].startTime>r)return void e.unshift(t);const s=getInsertLocation(e,r);e.splice(s,0,t)}setupObservers(observersCallback),module.exports={performance,PerformanceObserver},Object.defineProperty(module.exports,"constants",{configurable:!1,enumerable:!0,value:constants});"use strict";module.exports=process;"use strict";const maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\0-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=35,floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(o){throw new RangeError(errors[o])}function map(o,e){const r=[];let t=o.length;for(;t--;)r[t]=e(o[t]);return r}function mapDomain(o,e){const r=o.split("@");let t="";return r.length>1&&(t=r[0]+"@",o=r[1]),t+map((o=o.replace(regexSeparators,".")).split("."),e).join(".")}function ucs2decode(o){const e=[];let r=0;const t=o.length;for(;r<t;){const n=o.charCodeAt(r++);if(n>=55296&&n<=56319&&r<t){const t=o.charCodeAt(r++);56320==(64512&t)?e.push(((1023&n)<<10)+(1023&t)+65536):(e.push(n),r--)}else e.push(n)}return e}const ucs2encode=o=>String.fromCodePoint(...o),basicToDigit=function(o){return o-48<10?o-22:o-65<26?o-65:o-97<26?o-97:36},digitToBasic=function(o,e){return o+22+75*(o<26)-((0!=e)<<5)},adapt=function(o,e,r){let t=0;for(o=r?floor(o/700):o>>1,o+=floor(o/e);o>455;t+=36)o=floor(o/35);return floor(t+36*o/(o+38))},decode=function(o){const e=[],r=o.length;let t=0,n=128,i=72,c=o.lastIndexOf("-");c<0&&(c=0);for(let r=0;r<c;++r)o.charCodeAt(r)>=128&&error("not-basic"),e.push(o.charCodeAt(r));for(let a=c>0?c+1:0;a<r;){let c=t;for(let e=1,n=36;;n+=36){a>=r&&error("invalid-input");const c=(s=o.charCodeAt(a++))-48<10?s-22:s-65<26?s-65:s-97<26?s-97:36;(c>=36||c>floor((maxInt-t)/e))&&error("overflow"),t+=c*e;const d=n<=i?1:n>=i+26?26:n-i;if(c<d)break;const l=36-d;e>floor(maxInt/l)&&error("overflow"),e*=l}const d=e.length+1;i=adapt(t-c,d,0==c),floor(t/d)>maxInt-n&&error("overflow"),n+=floor(t/d),t%=d,e.splice(t++,0,n)}var s;return String.fromCodePoint(...e)},encode=function(o){const e=[];let r=(o=ucs2decode(o)).length,t=128,n=0,i=72;for(const r of o)r<128&&e.push(stringFromCharCode(r));let c=e.length,s=c;for(c&&e.push("-");s<r;){let r=maxInt;for(const e of o)e>=t&&e<r&&(r=e);const a=s+1;r-t>floor((maxInt-n)/a)&&error("overflow"),n+=(r-t)*a,t=r;for(const r of o)if(r<t&&++n>maxInt&&error("overflow"),r==t){let o=n;for(let r=36;;r+=36){const t=r<=i?1:r>=i+26?26:r-i;if(o<t)break;const n=o-t,c=36-t;e.push(stringFromCharCode(digitToBasic(t+n%c,0))),o=floor(n/c)}e.push(stringFromCharCode(digitToBasic(o,0))),i=adapt(n,a,s==c),n=0,++s}++n,++t}return e.join("")},toUnicode=function(o){return mapDomain(o,function(o){return regexPunycode.test(o)?decode(o.slice(4).toLowerCase()):o})},toASCII=function(o){return mapDomain(o,function(o){return regexNonASCII.test(o)?"xn--"+encode(o):o})},punycode={version:"2.1.0",ucs2:{decode:ucs2decode,encode:ucs2encode},decode,encode,toASCII,toUnicode};module.exports=punycode;"use strict";const{Buffer}=require("buffer"),{ERR_INVALID_URI}=require("internal/errors").codes,{hexTable,isHexTable}=require("internal/querystring"),QueryString=module.exports={unescapeBuffer,unescape:qsUnescape,escape:qsEscape,stringify,encode:stringify,parse,decode:parse},unhexTable=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];function unescapeBuffer(e,n){for(var t,r,i,o,s=Buffer.allocUnsafe(e.length),c=0,f=0,a=e.length-2,l=!1;c<e.length;)43===(t=e.charCodeAt(c))&&n?(s[f++]=32,c++):(37===t&&c<a&&(t=e.charCodeAt(++c),(i=unhexTable[t])>=0?(r=e.charCodeAt(++c),(o=unhexTable[r])>=0?(l=!0,t=16*i+o):(s[f++]=37,s[f++]=t,t=r)):s[f++]=37),s[f++]=t,c++);return l?s.slice(0,f):s}function qsUnescape(e,n){try{return decodeURIComponent(e)}catch{return QueryString.unescapeBuffer(e,n).toString()}}const noEscape=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0];function qsEscape(e){"string"!=typeof e&&("object"==typeof e?e=String(e):e+="");for(var n="",t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);if(i<128){if(1===noEscape[i])continue;t<r&&(n+=e.slice(t,r)),t=r+1,n+=hexTable[i]}else if(t<r&&(n+=e.slice(t,r)),i<2048)t=r+1,n+=hexTable[192|i>>6]+hexTable[128|63&i];else if(i<55296||i>=57344)t=r+1,n+=hexTable[224|i>>12]+hexTable[128|i>>6&63]+hexTable[128|63&i];else{if(++r>=e.length)throw new ERR_INVALID_URI;var o=1023&e.charCodeAt(r);t=r+1,n+=hexTable[240|(i=65536+((1023&i)<<10|o))>>18]+hexTable[128|i>>12&63]+hexTable[128|i>>6&63]+hexTable[128|63&i]}}return 0===t?e:t<e.length?n+e.slice(t):n}function stringifyPrimitive(e){return"string"==typeof e?e:"number"==typeof e&&isFinite(e)?""+e:"boolean"==typeof e?e?"true":"false":""}function stringify(e,n,t,r){n=n||"&",t=t||"=";var i=QueryString.escape;if(r&&"function"==typeof r.encodeURIComponent&&(i=r.encodeURIComponent),null!==e&&"object"==typeof e){for(var o=Object.keys(e),s=o.length,c=s-1,f="",a=0;a<s;++a){var l=o[a],u=e[l],h=i(stringifyPrimitive(l))+t;if(Array.isArray(u)){for(var d=u.length,g=d-1,p=0;p<d;++p)f+=h+i(stringifyPrimitive(u[p])),p<g&&(f+=n);d&&a<c&&(f+=n)}else f+=h+i(stringifyPrimitive(u)),a<c&&(f+=n)}return f}return""}function charCodes(e){if(0===e.length)return[];if(1===e.length)return[e.charCodeAt(0)];const n=[];for(var t=0;t<e.length;++t)n[n.length]=e.charCodeAt(t);return n}const defSepCodes=[38],defEqCodes=[61];function parse(e,n,t,r){const i=Object.create(null);if("string"!=typeof e||0===e.length)return i;var o=n?charCodes(n+""):defSepCodes,s=t?charCodes(t+""):defEqCodes;const c=o.length,f=s.length;var a=1e3;r&&"number"==typeof r.maxKeys&&(a=r.maxKeys>0?r.maxKeys:-1);var l=QueryString.unescape;r&&"function"==typeof r.decodeURIComponent&&(l=r.decodeURIComponent);const u=l!==qsUnescape;var h=0,d=0,g=0,p="",y="",b=u,x=u;const v=u?"%20":" ";for(var C=0,T=0;T<e.length;++T){const n=e.charCodeAt(T);if(n===o[d]){if(++d===c){const n=T-d+1;if(g<f){if(h<n)p+=e.slice(h,n);else if(0===p.length){if(0==--a)return i;h=T+1,d=g=0;continue}}else h<n&&(y+=e.slice(h,n));if(p.length>0&&b&&(p=decodeStr(p,l)),y.length>0&&x&&(y=decodeStr(y,l)),void 0===i[p])i[p]=y;else{const e=i[p];e.pop?e[e.length]=y:i[p]=[e,y]}if(0==--a)return i;b=x=u,p=y="",C=0,h=T+1,d=g=0}}else{if(d=0,g<f){if(n===s[g]){if(++g===f){const n=T-g+1;h<n&&(p+=e.slice(h,n)),C=0,h=T+1}continue}if(g=0,!b){if(37===n){C=1;continue}if(C>0){if(isHexTable[n]){3==++C&&(b=!0);continue}C=0}}if(43===n){h<T&&(p+=e.slice(h,T)),p+=v,h=T+1;continue}}43===n?(h<T&&(y+=e.slice(h,T)),y+=v,h=T+1):x||(37===n?C=1:C>0&&(isHexTable[n]?3==++C&&(x=!0):C=0))}}if(h<e.length)g<f?p+=e.slice(h):d<c&&(y+=e.slice(h));else if(0===g&&0===p.length)return i;if(p.length>0&&b&&(p=decodeStr(p,l)),y.length>0&&x&&(y=decodeStr(y,l)),void 0===i[p])i[p]=y;else{const e=i[p];e.pop?e[e.length]=y:i[p]=[e,y]}return i}function decodeStr(e,n){try{return n(e)}catch{return QueryString.unescape(e,!0)}}"use strict";const{ERR_INVALID_ARG_TYPE,ERR_INVALID_CURSOR_POS,ERR_INVALID_OPT_VALUE}=require("internal/errors").codes,{debug,inherits}=require("util"),{Buffer}=require("buffer"),EventEmitter=require("events"),{CSI,emitKeys,getStringWidth,isFullWidthCodePoint,stripVTControlCharacters}=require("internal/readline"),{kEscape,kClearToBeginning,kClearToEnd,kClearLine,kClearScreenDown}=CSI;let StringDecoder;const kHistorySize=30,kMincrlfDelay=100,lineEnding=/\r?\n|\r(?!\n)/,KEYPRESS_DECODER=Symbol("keypress-decoder"),ESCAPE_DECODER=Symbol("escape-decoder"),ESCAPE_CODE_TIMEOUT=500;function createInterface(e,t,i,r){return new Interface(e,t,i,r)}function Interface(e,t,i,r){if(!(this instanceof Interface))return new Interface(e,t,i,r);var s;void 0===StringDecoder&&(StringDecoder=require("string_decoder").StringDecoder),this._sawReturnAt=0,this.isCompletionEnabled=!0,this._sawKeyPress=!1,this._previousKey=null,EventEmitter.call(this);var n=!1;let o,h="> ";if(e&&e.input&&(t=e.output,i=e.completer,r=e.terminal,s=e.historySize,n=e.removeHistoryDuplicates,void 0!==e.prompt&&(h=e.prompt),o=e.crlfDelay,e=e.input),i&&"function"!=typeof i)throw new ERR_INVALID_OPT_VALUE("completer",i);if(void 0===s&&(s=kHistorySize),"number"!=typeof s||Number.isNaN(s)||s<0)throw new ERR_INVALID_OPT_VALUE.RangeError("historySize",s);void 0===r&&null!=t&&(r=!!t.isTTY);var c=this;function l(e){c._normalWrite(e)}function u(){"string"==typeof c._line_buffer&&c._line_buffer.length>0&&c.emit("line",c._line_buffer),c.close()}function a(){"string"==typeof c.line&&c.line.length>0&&c.emit("line",c.line),c.close()}function f(e,t){if(c._ttyWrite(e,t),t&&t.sequence){const e=t.sequence.codePointAt(0);e>=55296&&e<=57343&&c._refreshLine()}}function p(){c._refreshLine()}if(this.output=t,this.input=e,this.historySize=s,this.removeHistoryDuplicates=!!n,this.crlfDelay=o?Math.max(kMincrlfDelay,o):kMincrlfDelay,"function"==typeof i&&(this.completer=2===i.length?i:function(e,t){t(null,i(e))}),this.setPrompt(h),this.terminal=!!r,this.terminal){emitKeypressEvents(e,this),e.on("keypress",f),e.on("end",a),this.line="",this._setRawMode(!0),this.terminal=!0,this.cursor=0,this.history=[],this.historyIndex=-1,null!=t&&t.on("resize",p),c.once("close",function(){e.removeListener("keypress",f),e.removeListener("end",a),null!=t&&t.removeListener("resize",p)})}else{e.on("data",l),e.on("end",u),c.once("close",function(){e.removeListener("data",l),e.removeListener("end",u)}),this._decoder=new StringDecoder("utf8")}e.resume()}function handleGroup(e,t,i,r){if(0!==t.length){for(var s=Math.ceil(t.length/r),n=0;n<s;n++){for(var o=0;o<r;o++){var h=n*r+o;if(h>=t.length)break;var c=t[h];if(e._writeToOutput(c),o<r-1)for(var l=0;l<i-c.length;l++)e._writeToOutput(" ")}e._writeToOutput("\r\n")}e._writeToOutput("\r\n")}}function commonPrefix(e){if(!e||0===e.length)return"";if(1===e.length)return e[0];for(var t=e.slice().sort(),i=t[0],r=t[t.length-1],s=0,n=i.length;s<n;s++)if(i[s]!==r[s])return i.slice(0,s);return i}function emitKeypressEvents(e,t){if(e[KEYPRESS_DECODER])return;void 0===StringDecoder&&(StringDecoder=require("string_decoder").StringDecoder),e[KEYPRESS_DECODER]=new StringDecoder("utf8"),e[ESCAPE_DECODER]=emitKeys(e),e[ESCAPE_DECODER].next();const i=()=>e[ESCAPE_DECODER].next("");let r;function s(o){if(e.listenerCount("keypress")>0){var h=e[KEYPRESS_DECODER].write(o);if(h){clearTimeout(r),t&&(t._sawKeyPress=1===h.length);for(var c=0;c<h.length;c++){"\t"===h[c]&&"string"==typeof h[c+1]&&t&&(t.isCompletionEnabled=!1);try{e[ESCAPE_DECODER].next(h[c]),h[c]===kEscape&&c+1===h.length&&(r=setTimeout(i,ESCAPE_CODE_TIMEOUT))}catch(t){throw e[ESCAPE_DECODER]=emitKeys(e),e[ESCAPE_DECODER].next(),t}finally{t&&(t.isCompletionEnabled=!0)}}}}else e.removeListener("data",s),e.on("newListener",n)}function n(t){"keypress"===t&&(e.on("data",s),e.removeListener("newListener",n))}e.listenerCount("keypress")>0?e.on("data",s):e.on("newListener",n)}function cursorTo(e,t,i){if(null!=e&&("number"==typeof t||"number"==typeof i)){if("number"!=typeof t)throw new ERR_INVALID_CURSOR_POS;"number"!=typeof i?e.write(CSI`${t+1}G`):e.write(CSI`${i+1};${t+1}H`)}}function moveCursor(e,t,i){null!=e&&(t<0?e.write(CSI`${-t}D`):t>0&&e.write(CSI`${t}C`),i<0?e.write(CSI`${-i}A`):i>0&&e.write(CSI`${i}B`))}function clearLine(e,t){null!=e&&(t<0?e.write(kClearToBeginning):t>0?e.write(kClearToEnd):e.write(kClearLine))}function clearScreenDown(e){null!=e&&e.write(kClearScreenDown)}inherits(Interface,EventEmitter),Object.defineProperty(Interface.prototype,"columns",{configurable:!0,enumerable:!0,get:function(){var e=1/0;return this.output&&this.output.columns&&(e=this.output.columns),e}}),Interface.prototype.setPrompt=function(e){this._prompt=e},Interface.prototype._setRawMode=function(e){const t=this.input.isRaw;return"function"==typeof this.input.setRawMode&&this.input.setRawMode(e),t},Interface.prototype.prompt=function(e){this.paused&&this.resume(),this.terminal?(e||(this.cursor=0),this._refreshLine()):this._writeToOutput(this._prompt)},Interface.prototype.question=function(e,t){"function"==typeof t&&(this._questionCallback?this.prompt():(this._oldPrompt=this._prompt,this.setPrompt(e),this._questionCallback=t,this.prompt()))},Interface.prototype._onLine=function(e){if(this._questionCallback){var t=this._questionCallback;this._questionCallback=null,this.setPrompt(this._oldPrompt),t(e)}else this.emit("line",e)},Interface.prototype._writeToOutput=function(e){if("string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("stringToWrite","string",e);null!==this.output&&void 0!==this.output&&this.output.write(e)},Interface.prototype._addHistory=function(){if(0===this.line.length)return"";if(0===this.historySize)return this.line;if(0===this.line.trim().length)return this.line;if(0===this.history.length||this.history[0]!==this.line){if(this.removeHistoryDuplicates){const e=this.history.indexOf(this.line);-1!==e&&this.history.splice(e,1)}this.history.unshift(this.line),this.history.length>this.historySize&&this.history.pop()}return this.historyIndex=-1,this.history[0]},Interface.prototype._refreshLine=function(){var e=this._prompt+this.line,t=this._getDisplayPos(e),i=t.cols,r=t.rows,s=this._getCursorPos(),n=this.prevRows||0;n>0&&moveCursor(this.output,0,-n),cursorTo(this.output,0),clearScreenDown(this.output),this._writeToOutput(e),0===i&&this._writeToOutput(" "),cursorTo(this.output,s.cols);var o=r-s.rows;o>0&&moveCursor(this.output,0,-o),this.prevRows=s.rows},Interface.prototype.close=function(){this.closed||(this.pause(),this.terminal&&this._setRawMode(!1),this.closed=!0,this.emit("close"))},Interface.prototype.pause=function(){if(!this.paused)return this.input.pause(),this.paused=!0,this.emit("pause"),this},Interface.prototype.resume=function(){if(this.paused)return this.input.resume(),this.paused=!1,this.emit("resume"),this},Interface.prototype.write=function(e,t){this.paused&&this.resume(),this.terminal?this._ttyWrite(e,t):this._normalWrite(e)},Interface.prototype._normalWrite=function(e){if(void 0!==e){var t=this._decoder.write(e);this._sawReturnAt&&Date.now()-this._sawReturnAt<=this.crlfDelay&&(t=t.replace(/^\n/,""),this._sawReturnAt=0);var i=lineEnding.test(t);if(this._line_buffer&&(t=this._line_buffer+t,this._line_buffer=null),i){this._sawReturnAt=t.endsWith("\r")?Date.now():0;var r=t.split(lineEnding);t=r.pop(),this._line_buffer=t;for(var s=0;s<r.length;s++)this._onLine(r[s])}else t&&(this._line_buffer=t)}},Interface.prototype._insertString=function(e){if(this.cursor<this.line.length){var t=this.line.slice(0,this.cursor),i=this.line.slice(this.cursor,this.line.length);this.line=t+e+i,this.cursor+=e.length,this._refreshLine()}else this.line+=e,this.cursor+=e.length,0===this._getCursorPos().cols?this._refreshLine():this._writeToOutput(e),this._moveCursor(0)},Interface.prototype._tabComplete=function(e){var t=this;t.pause(),t.completer(t.line.slice(0,t.cursor),function(i,r){if(t.resume(),i)return void debug("tab completion error %j",i);const s=r[0],n=r[1];if(s&&s.length){if(e){t._writeToOutput("\r\n");var o=s.reduce(function(e,t){return e.length>t.length?e:t}).length+2,h=Math.floor(t.columns/o);h&&h!==1/0||(h=1);for(var c=[],l=0;l<s.length;l++){var u=s[l];""===u?(handleGroup(t,c,o,h),c=[]):c.push(u)}handleGroup(t,c,o,h)}var a=commonPrefix(s.filter(e=>e));a.length>n.length&&t._insertString(a.slice(n.length)),t._refreshLine()}})},Interface.prototype._wordLeft=function(){if(this.cursor>0){var e=this.line.slice(0,this.cursor).match(/(?:[^\w\s]+|\w+|)\s*$/);this._moveCursor(-e[0].length)}},Interface.prototype._wordRight=function(){if(this.cursor<this.line.length){var e=this.line.slice(this.cursor).match(/^(?:\s+|\W+|\w+)\s*/);this._moveCursor(e[0].length)}},Interface.prototype._deleteLeft=function(){this.cursor>0&&this.line.length>0&&(this.line=this.line.slice(0,this.cursor-1)+this.line.slice(this.cursor,this.line.length),this.cursor--,this._refreshLine())},Interface.prototype._deleteRight=function(){this.line=this.line.slice(0,this.cursor)+this.line.slice(this.cursor+1,this.line.length),this._refreshLine()},Interface.prototype._deleteWordLeft=function(){if(this.cursor>0){var e=this.line.slice(0,this.cursor),t=e.match(/(?:[^\w\s]+|\w+|)\s*$/);e=e.slice(0,e.length-t[0].length),this.line=e+this.line.slice(this.cursor,this.line.length),this.cursor=e.length,this._refreshLine()}},Interface.prototype._deleteWordRight=function(){if(this.cursor<this.line.length){var e=this.line.slice(this.cursor),t=e.match(/^(?:\s+|\W+|\w+)\s*/);this.line=this.line.slice(0,this.cursor)+e.slice(t[0].length),this._refreshLine()}},Interface.prototype._deleteLineLeft=function(){this.line=this.line.slice(this.cursor),this.cursor=0,this._refreshLine()},Interface.prototype._deleteLineRight=function(){this.line=this.line.slice(0,this.cursor),this._refreshLine()},Interface.prototype.clearLine=function(){this._moveCursor(1/0),this._writeToOutput("\r\n"),this.line="",this.cursor=0,this.prevRows=0},Interface.prototype._line=function(){var e=this._addHistory();this.clearLine(),this._onLine(e)},Interface.prototype._historyNext=function(){this.historyIndex>0?(this.historyIndex--,this.line=this.history[this.historyIndex],this.cursor=this.line.length,this._refreshLine()):0===this.historyIndex&&(this.historyIndex=-1,this.cursor=0,this.line="",this._refreshLine())},Interface.prototype._historyPrev=function(){this.historyIndex+1<this.history.length&&(this.historyIndex++,this.line=this.history[this.historyIndex],this.cursor=this.line.length,this._refreshLine())},Interface.prototype._getDisplayPos=function(e){for(var t,i=0,r=this.columns,s=0,n=0,o=(e=stripVTControlCharacters(e)).length;n<o;n++){if((t=e.codePointAt(n))>=65536&&n++,10===t){i=0,s+=1;continue}const o=getStringWidth(t);0===o||1===o?i+=o:((i+1)%r==0&&i++,i+=2)}var h=i%r;return{cols:h,rows:s+(i-h)/r}},Interface.prototype._getCursorPos=function(){var e=this.columns,t=this._prompt+this.line.substring(0,this.cursor),i=this._getDisplayPos(stripVTControlCharacters(t)),r=i.cols,s=i.rows;return r+1===e&&this.cursor<this.line.length&&isFullWidthCodePoint(this.line.codePointAt(this.cursor))&&(s++,r=0),{cols:r,rows:s}},Interface.prototype._moveCursor=function(e){var t=this.cursor,i=this._getCursorPos();this.cursor+=e,this.cursor<0?this.cursor=0:this.cursor>this.line.length&&(this.cursor=this.line.length);var r=this._getCursorPos();if(i.rows===r.rows){var s,n=this.cursor-t;n<0?s=-getStringWidth(this.line.substring(this.cursor,t)):n>0&&(s=getStringWidth(this.line.substring(this.cursor,t))),moveCursor(this.output,s,0),this.prevRows=r.rows}else this._refreshLine()},Interface.prototype._ttyWrite=function(e,t){const i=this._previousKey;var r;if(t=t||{},this._previousKey=t,"escape"!==t.name)if(t.ctrl&&t.shift)switch(t.name){case"backspace":this._deleteLineLeft();break;case"delete":this._deleteLineRight()}else if(t.ctrl)switch(t.name){case"c":this.listenerCount("SIGINT")>0?this.emit("SIGINT"):this.close();break;case"h":this._deleteLeft();break;case"d":0===this.cursor&&0===this.line.length?this.close():this.cursor<this.line.length&&this._deleteRight();break;case"u":this.cursor=0,this.line="",this._refreshLine();break;case"k":this._deleteLineRight();break;case"a":this._moveCursor(-1/0);break;case"e":this._moveCursor(1/0);break;case"b":this._moveCursor(-1);break;case"f":this._moveCursor(1);break;case"l":cursorTo(this.output,0,0),clearScreenDown(this.output),this._refreshLine();break;case"n":this._historyNext();break;case"p":this._historyPrev();break;case"z":if("win32"===process.platform)break;this.listenerCount("SIGTSTP")>0?this.emit("SIGTSTP"):(process.once("SIGCONT",(r=this,function(){r.paused||(r.pause(),r.emit("SIGCONT")),r._setRawMode(!0),r._refreshLine()})),this._setRawMode(!1),process.kill(process.pid,"SIGTSTP"));break;case"w":case"backspace":this._deleteWordLeft();break;case"delete":this._deleteWordRight();break;case"left":this._wordLeft();break;case"right":this._wordRight()}else if(t.meta)switch(t.name){case"b":this._wordLeft();break;case"f":this._wordRight();break;case"d":case"delete":this._deleteWordRight();break;case"backspace":this._deleteWordLeft()}else switch(this._sawReturnAt&&"enter"!==t.name&&(this._sawReturnAt=0),t.name){case"return":this._sawReturnAt=Date.now(),this._line();break;case"enter":(0===this._sawReturnAt||Date.now()-this._sawReturnAt>this.crlfDelay)&&this._line(),this._sawReturnAt=0;break;case"backspace":this._deleteLeft();break;case"delete":this._deleteRight();break;case"left":this._moveCursor(-1);break;case"right":this._moveCursor(1);break;case"home":this._moveCursor(-1/0);break;case"end":this._moveCursor(1/0);break;case"up":this._historyPrev();break;case"down":this._historyNext();break;case"tab":if("function"==typeof this.completer&&this.isCompletionEnabled){const e=i&&"tab"===i.name;this._tabComplete(e);break}default:if(e instanceof Buffer&&(e=e.toString("utf-8")),e)for(var s=e.split(/\r\n|\n|\r/),n=0,o=s.length;n<o;n++)n>0&&this._line(),this._insertString(s[n])}},module.exports={Interface,clearLine,clearScreenDown,createInterface,cursorTo,emitKeypressEvents,moveCursor};"use strict";const{builtinLibs,makeRequireFunction,addBuiltinLibsToObject}=require("internal/modules/cjs/helpers"),{isIdentifierStart,isIdentifierChar}=require("internal/deps/acorn/dist/acorn"),internalUtil=require("internal/util"),util=require("util"),utilBinding=process.binding("util"),{inherits}=util,Stream=require("stream"),vm=require("vm"),path=require("path"),fs=require("fs"),{Interface}=require("readline"),{Console}=require("console"),CJSModule=require("internal/modules/cjs/loader"),domain=require("domain"),debug=util.debuglog("repl"),{ERR_CANNOT_WATCH_SIGINT,ERR_INVALID_ARG_TYPE,ERR_INVALID_REPL_EVAL_CONFIG,ERR_SCRIPT_EXECUTION_INTERRUPTED}=require("internal/errors").codes,{sendInspectorCommand}=require("internal/util/inspector"),experimentalREPLAwait=require("internal/options").getOptionValue("--experimental-repl-await"),{isRecoverableError}=require("internal/repl/recoverable"),{getOwnNonIndexProperties,propertyFilter:{ALL_PROPERTIES,SKIP_SYMBOLS}}=process.binding("util");let processTopLevelAwait;const parentModule=module,replMap=new WeakMap,GLOBAL_OBJECT_PROPERTIES=["NaN","Infinity","undefined","eval","parseInt","parseFloat","isNaN","isFinite","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","Object","Function","Array","String","Boolean","Number","Date","RegExp","Error","EvalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError","Math","JSON"],GLOBAL_OBJECT_PROPERTY_MAP={};for(var n=0;n<GLOBAL_OBJECT_PROPERTIES.length;n++)GLOBAL_OBJECT_PROPERTY_MAP[GLOBAL_OBJECT_PROPERTIES[n]]=GLOBAL_OBJECT_PROPERTIES[n];const kBufferedCommandSymbol=Symbol("bufferedCommand"),kContextId=Symbol("contextId");try{module.filename=path.resolve("repl")}catch{const e=path.dirname(process.execPath);module.filename=path.resolve(e,"repl")}function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}module.paths=CJSModule._nodeModulePaths(module.filename);const writer=exports.writer=(e=>util.inspect(e,writer.options));function REPLServer(e,t,r,n,i,o){if(!(this instanceof REPLServer))return new REPLServer(e,t,r,n,i,o);var s,a,l,c,d;if(null!==e&&"object"==typeof e?(t=(s=e).stream||s.socket,a=s.input,l=s.output,r=s.eval,n=s.useGlobal,i=s.ignoreUndefined,e=s.prompt,c=s.domain,o=s.replMode,d=s.breakEvalOnSigint):s={},d&&r)throw new ERR_INVALID_REPL_EVAL_CONFIG;var u=this;u._domain=c||domain.create(),u.useGlobal=!!n,u.ignoreUndefined=!!i,u.replMode=o||exports.REPL_MODE_SLOPPY,u.underscoreAssigned=!1,u.last=void 0,u.underscoreErrAssigned=!1,u.lastError=void 0,u.breakEvalOnSigint=!!d,u.editorMode=!1,u[kContextId]=void 0,u.rli=this;const p=["","","","","","","","","",""],f="\0\0\0",m=new RegExp(`^${f}(.*)${f}(.*)${f}(.*)${f}(.*)`+`${f}(.*)${f}(.*)${f}(.*)${f}(.*)`+`${f}(.*)$`);r=r||function(e,t,r,n){var i,o,s,a,l=!1,c=!1,d=e;/^\s*\{/.test(e)&&/\}\s*$/.test(e)&&(e=`(${e.trim()})\n`,l=!0);if(experimentalREPLAwait&&e.includes("await")){void 0===processTopLevelAwait&&({processTopLevelAwait}=require("internal/repl/await"));const t=processTopLevelAwait(e);null!==t&&(e=t,l=!0,c=!0)}if("\n"===e)return n(null);for(;;){try{/^\s*$/.test(e)||u.replMode!==exports.REPL_MODE_STRICT||(e=`'use strict'; void 0;\n${e}`),s=vm.createScript(e,{filename:r,displayErrors:!0})}catch(t){if(debug("parse error %j",e,t),l){l=!1,c=!1,e=d,a=t;continue}const r=a||t;i=isRecoverableError(r,e)?new Recoverable(r):r}break}m.test(p.join(f));let v=!1;function y(e,t){if(!v){v=!0;for(var r=1;r<p.length;r+=1)p[r]=RegExp[`$${r}`];n(e,t)}}if(!i){let e;if(u.breakEvalOnSigint){if(!utilBinding.startSigintWatchdog())throw new ERR_CANNOT_WATCH_SIGINT;e=u._setRawMode(!1)}try{try{const r={displayErrors:!1,breakOnSigint:u.breakEvalOnSigint};o=u.useGlobal?s.runInThisContext(r):s.runInContext(t,r)}finally{u.breakEvalOnSigint&&(u._setRawMode(e),utilBinding.stopSigintWatchdog()&&u.emit("SIGINT"))}}catch(e){if(i=e,process.domain)return debug("not recoverable, send to domain"),process.domain.emit("error",i),void process.domain.exit()}if(c&&!i){let e;E=!0;let t=o;if(u.breakEvalOnSigint){const r=new Promise((t,r)=>{e=(()=>{const e=Error.stackTraceLimit;Error.stackTraceLimit=0;const t=new ERR_SCRIPT_EXECUTION_INTERRUPTED;Error.stackTraceLimit=e,r(t)}),b.add(e)});t=Promise.race([t,r])}t.then(e=>{y(void 0,e)},e=>{if(e&&process.domain)return debug("not recoverable, send to domain"),process.domain.emit("error",e),void process.domain.exit();y(e)}).finally(()=>{b.delete(e),function(){if(!E)return;let e;E=!1;for(;e=h.shift();){const[t,r]=e;switch(t){case"key":{const[e,t]=r;u._ttyWrite(e,t);break}case"close":u.emit("exit")}if(E)break}}()})}}c&&!i||y(i,o)};const h=[];let E=!1;function v(e,t){var r=this.commands[e];return!!r&&(r.action.call(this,t),!0)}u.eval=u._domain.bind(r),u._domain.on("error",function(e){debug("domain error");let t="";if("object"==typeof e&&null!==e){const n=Error.prepareStackTrace;Error.prepareStackTrace=(r=n,(e,t)=>{const n=function(e){if("object"!=typeof e)return e;const t=e.reverse().findIndex(e=>null===e.getFunctionName());return e=e.splice(t+1)}(t);return r?r(e,n):(n.push(e),n.reverse().join("\n    at "))}),internalUtil.decorateErrorStack(e),Error.prepareStackTrace=n,e.domainThrown&&(delete e.domain,delete e.domainThrown),internalUtil.isError(e)&&(e.stack&&("SyntaxError"===e.name?e.stack=e.stack.replace(/^repl:\d+\r?\n/,"").replace(/^\s+at\s.*\n?/gm,""):u.replMode===exports.REPL_MODE_STRICT&&(e.stack=e.stack.replace(/(\s+at\s+repl:)(\d+)/,(e,t,r)=>t+(r-1)))),"]"===(t=util.inspect(e))[t.length-1]&&(t=t.slice(1,-1)))}var r;""===t&&(t=`Thrown: ${util.inspect(e)}`),u.underscoreErrAssigned||(u.lastError=e);const n=replMap.get(u);n.outputStream.write(`${t}\n`),n.clearBufferedCommand(),n.lines.level=[],n.displayPrompt()}),a||l||(t||(t=process),a=t.stdin||t,l=t.stdout||t),u.inputStream=a,u.outputStream=l,u.resetContext(),u.lines.level=[],u.clearBufferedCommand(),Object.defineProperty(this,"bufferedCommand",{get:util.deprecate(()=>u[kBufferedCommandSymbol],"REPLServer.bufferedCommand is deprecated","DEP0074"),set:util.deprecate(e=>u[kBufferedCommandSymbol]=e,"REPLServer.bufferedCommand is deprecated","DEP0074"),enumerable:!0}),u.completer="function"==typeof s.completer?s.completer:function(e,t){complete.call(u,e,u.editorMode?u.completeOnEditorMode(t):t)},Interface.call(this,{input:u.inputStream,output:u.outputStream,completer:u.completer,terminal:s.terminal,historySize:s.historySize,prompt:e}),this.commands=Object.create(null),defineDefaultCommands(this),u.writer=s.writer||exports.writer,void 0===s.useColors&&(s.useColors=u.terminal),u.useColors=!!s.useColors,u.useColors&&u.writer===writer&&(u.writer=(e=>util.inspect(e,u.writer.options)),u.writer.options=Object.assign({},writer.options,{colors:!0})),u.parseREPLKeyword=util.deprecate(v,"REPLServer.parseREPLKeyword() is deprecated","DEP0075"),u.on("close",function(){E?h.push(["close"]):u.emit("exit")});var y=!1,S=!1;const b=new Set;u.on("SIGINT",function(){if(b.size>0){for(const e of b)e();return}var e=0===u.line.length;u.clearLine(),_turnOffEditorMode(u);const t=u[kBufferedCommandSymbol];if(t&&t.length>0||!e)y=!1;else{if(y)return u.close(),void(y=!1);u.output.write("(To exit, press ^C again or type .exit)\n"),y=!0}u.clearBufferedCommand(),u.lines.level=[],u.displayPrompt()}),u.on("line",function(e){if(debug("line %j",e),e=e||"",y=!1,u.editorMode){u[kBufferedCommandSymbol]+=e+"\n";const t=u._sawKeyPress?e.match(/^\s+/):null;if(t){const e=t[0];u.write(e),u.line=e,u.cursor=e.length}return void _memory.call(u,e)}const t=e.trim();if(t&&"."===t.charAt(0)&&"."!==t.charAt(1)&&Number.isNaN(parseFloat(t))){const e=t.match(/^\.([^\s]+)\s*(.*)$/),r=e&&e[1],i=e&&e[2];if(!0===v.call(u,r,i))return;if(!u[kBufferedCommandSymbol])return u.outputStream.write("Invalid REPL keyword\n"),void n(null)}const r=u[kBufferedCommandSymbol]+e+"\n";function n(t,r){if(debug("finish",t,r),_memory.call(u,e),t&&!u[kBufferedCommandSymbol]&&e.trim().startsWith("npm "))return u.outputStream.write("npm should be run outside of the node repl, in your normal shell.\n(Press Control-D to exit.)\n"),u.clearBufferedCommand(),void u.displayPrompt();if(t){if(t instanceof Recoverable&&!S)return u[kBufferedCommandSymbol]+=e+"\n",void u.displayPrompt();u._domain.emit("error",t.err||t)}u.clearBufferedCommand(),S=!1,t||2!==arguments.length||u.ignoreUndefined&&void 0===r||(u.underscoreAssigned||(u.last=r),u.outputStream.write(u.writer(r)+"\n")),u.displayPrompt()}debug("eval %j",r),u.eval(r,u.context,"repl",n)}),u.on("SIGCONT",function(){u.editorMode?(u.outputStream.write(`${u._initialPrompt}.editor\n`),u.outputStream.write("// Entering editor mode (^D to finish, ^C to cancel)\n"),u.outputStream.write(`${u[kBufferedCommandSymbol]}\n`),u.prompt(!0)):u.displayPrompt(!0)});const g=u._ttyWrite.bind(u);u._ttyWrite=((e,t)=>{if(t=t||{},!E||u.breakEvalOnSigint&&t.ctrl&&"c"===t.name)if(u.editorMode&&u.terminal)if(t.ctrl&&!t.shift)switch(t.name){case"d":_turnOffEditorMode(u),S=!0,g(e,{name:"return"});break;case"n":case"p":break;default:g(e,t)}else switch(t.name){case"up":case"down":break;case"tab":u._previousKey=null,g(e,t);break;default:g(e,t)}else g(e,t);else h.push(["key",[e,t]])}),u.displayPrompt()}function ArrayStream(){Stream.call(this),this.run=function(e){for(var t=0;t<e.length;t++)this.emit("data",`${e[t]}\n`)}}writer.options=Object.assign({},util.inspect.defaultOptions,{showProxy:!0}),exports._builtinLibs=builtinLibs,inherits(REPLServer,Interface),exports.REPLServer=REPLServer,exports.REPL_MODE_SLOPPY=Symbol("repl-sloppy"),exports.REPL_MODE_STRICT=Symbol("repl-strict"),exports.start=function(e,t,r,n,i,o){var s=new REPLServer(e,t,r,n,i,o);return exports.repl||(exports.repl=s),replMap.set(s,s),s},REPLServer.prototype.clearBufferedCommand=function(){this[kBufferedCommandSymbol]=""},REPLServer.prototype.close=function(){if(this.terminal&&this._flushing&&!this._closingOnFlush)return this._closingOnFlush=!0,void this.once("flushHistory",()=>Interface.prototype.close.call(this));process.nextTick(()=>Interface.prototype.close.call(this))},REPLServer.prototype.createContext=function(){var e;if(this.useGlobal)e=global;else{sendInspectorCommand(t=>{t.post("Runtime.enable"),t.once("Runtime.executionContextCreated",({params:e})=>{this[kContextId]=e.context.id}),e=vm.createContext(),t.post("Runtime.disable")},()=>{e=vm.createContext()}),e.global=e;const i=new Console(this.outputStream);Object.defineProperty(e,"console",{configurable:!0,writable:!0,value:i});for(var t=Object.getOwnPropertyNames(global),r=0;r<t.length;r++){var n=t[r];"console"!==n&&"global"!==n&&(void 0===GLOBAL_OBJECT_PROPERTY_MAP[n]&&Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(global,n)))}}var i=new CJSModule("<repl>");return i.paths=CJSModule._resolveLookupPaths("<repl>",parentModule,!0)||[],Object.defineProperty(e,"module",{configurable:!0,writable:!0,value:i}),Object.defineProperty(e,"require",{configurable:!0,writable:!0,value:makeRequireFunction(i)}),addBuiltinLibsToObject(e),e},REPLServer.prototype.resetContext=function(){this.context=this.createContext(),this.underscoreAssigned=!1,this.underscoreErrAssigned=!1,this.lines=[],this.lines.level=[],Object.defineProperty(this.context,"_",{configurable:!0,get:()=>this.last,set:e=>{this.last=e,this.underscoreAssigned||(this.underscoreAssigned=!0,this.outputStream.write("Expression assignment to _ now disabled.\n"))}}),Object.defineProperty(this.context,"_error",{configurable:!0,get:()=>this.lastError,set:e=>{this.lastError=e,this.underscoreErrAssigned||(this.underscoreErrAssigned=!0,this.outputStream.write("Expression assignment to _error now disabled.\n"))}}),this.emit("reset",this.context)},REPLServer.prototype.displayPrompt=function(e){var t=this._initialPrompt;if(this[kBufferedCommandSymbol].length){t="...";const e=this.lines.level.length?this.lines.level.length-1:0;t+="..".repeat(e)+" "}REPLServer.super_.prototype.setPrompt.call(this,t),this.prompt(e)},REPLServer.prototype.setPrompt=function(e){this._initialPrompt=e,REPLServer.super_.prototype.setPrompt.call(this,e)},REPLServer.prototype.turnOffEditorMode=util.deprecate(function(){_turnOffEditorMode(this)},"REPLServer.turnOffEditorMode() is deprecated","DEP0078"),util.inherits(ArrayStream,Stream),ArrayStream.prototype.readable=!0,ArrayStream.prototype.writable=!0,ArrayStream.prototype.resume=function(){},ArrayStream.prototype.write=function(){};const requireRE=/\brequire\s*\(['"](([\w@.\/-]+\/)?(?:[\w@.\/-]*))/,simpleExpressionRE=/(?:[a-zA-Z_$](?:\w|\$)*\.)*[a-zA-Z_$](?:\w|\$)*\.?$/;function isIdentifier(e){if(""===e)return!1;const t=e.codePointAt(0);if(!isIdentifierStart(t))return!1;for(var r=t>65535?2:1;r<e.length;r+=1){const t=e.codePointAt(r);if(!isIdentifierChar(t))return!1;t>65535&&(r+=1)}return!0}function filteredOwnPropertyNames(e){if(!e)return[];return getOwnNonIndexProperties(e,ALL_PROPERTIES|SKIP_SYMBOLS).filter(isIdentifier)}function getGlobalLexicalScopeNames(e){return sendInspectorCommand(t=>{let r=[];return t.post("Runtime.globalLexicalScopeNames",{executionContextId:e},(e,t)=>{e||(r=t.names)}),r},()=>[])}function complete(e,t){if(void 0!==this[kBufferedCommandSymbol]&&this[kBufferedCommandSymbol].length){for(var r=this.lines.slice(),n=0;n<this.lines.level.length;n++){var i=this.lines.level[n];i.isFunction&&(r[i.line]="")}var o=new ArrayStream,s=new REPLServer("",o);if(replMap.set(s,replMap.get(this)),o.run(r),!s[kBufferedCommandSymbol])return s.complete(e,t)}var a,l,c,d,u,p,f=[],m=null;if(m=e.match(/^\s*\.(\w*)$/))f.push(Object.keys(this.commands)),l=m[1],m[1].length&&(p=m[1]),A();else if(m=e.match(requireRE)){const e=Object.keys(this.context.require.extensions);var h=new RegExp("^index(?:"+e.map(regexpEscape).join("|")+")$"),E=/-\d+\.\d+/;l=m[1];var v,y,S,b,g,P,R,_,O,w,C=m[2]||"";p=m[1],d=[];let t=[];for("."===l?d=["./","../"]:".."===l?d=["../"]:t=/^\.\.?\//.test(l)?[process.cwd()]:module.paths.concat(CJSModule.globalPaths),c=0;c<t.length;c++){v=path.resolve(t[c],C);try{y=fs.readdirSync(v)}catch{continue}for(S=0;S<y.length;S++)if(b=y[S],P=path.extname(b),g=b.slice(0,-P.length),!E.test(g)&&".npm"!==b){R=path.resolve(v,b);try{w=fs.statSync(R).isDirectory()}catch{continue}if(w){d.push(C+b+"/");try{_=fs.readdirSync(R)}catch{continue}for(O=0;O<_.length;O++)h.test(_[O])&&d.push(C+b)}else!e.includes(P)||C&&"index"===g||d.push(C+g)}}d.length&&f.push(d),C||f.push(exports._builtinLibs),A()}else if(0===e.length||/\w|\.|\$/.test(e[e.length-1]))if(m=simpleExpressionRE.exec(e),0===e.length||m){var L;if(l=m?m[0]:"",0===e.length)p="",L="";else if("."===e[e.length-1])p="",L=m[0].slice(0,m[0].length-1);else{var x=m[0].split(".");p=x.pop(),L=x.join(".")}var I=[];if(L){const e=`try { ${L} } catch {}`;this.eval(e,this.context,"repl",(e,t)=>{if(null!=t){if("object"==typeof t||"function"==typeof t)try{I.push(filteredOwnPropertyNames.call(this,t))}catch{}try{var r,n=5;for(r="object"==typeof t||"function"==typeof t?Object.getPrototypeOf(t):t.constructor?t.constructor.prototype:null;null!==r&&(I.push(filteredOwnPropertyNames.call(this,r)),r=Object.getPrototypeOf(r),!(--n<=0)););}catch{}}if(I.length){for(c=0;c<I.length;c++)f.push(I[c].map(e=>`${L}.${e}`));p&&(p=`${L}.${p}`)}A()})}else if(this.useGlobal||vm.isContext(this.context)){f.push(getGlobalLexicalScopeNames(this[kContextId]));for(var T=this.context;T=Object.getPrototypeOf(T);)f.push(filteredOwnPropertyNames.call(this,T));f.push(filteredOwnPropertyNames.call(this,this.context)),addStandardGlobals(f,p),A()}else this.eval(".scope",this.context,"repl",function(e,t){if(e||!Array.isArray(t))addStandardGlobals(f,p);else if(Array.isArray(t[0]))for(var r=0;r<t.length;r++)f.push(t[r]);else f.push(t),addStandardGlobals(f,p);A()})}else A();else A();function A(){if(f.length&&p){var e=[];for(c=0;c<f.length;c++)(d=f[c].filter(e=>0===e.indexOf(p))).length&&e.push(d);f=e}if(f.length){var r={};for(a=[],c=0;c<f.length;c++){(d=f[c]).sort();for(var n=d.length-1;n>=0;n--)hasOwnProperty(r,u=d[n])||(a.unshift(u),r[u]=!0);a.unshift("")}for(;a.length&&""===a[0];)a.shift()}t(null,[a||[],l])}}function longestCommonPrefix(e=[]){const t=e.length;if(0===t)return"";if(1===t)return e[0];const r=e[0];for(var n=0;n<r.length;n++){const o=r[n];for(var i=1;i<t;i++){const t=e[i];if(n>=t.length||o!==t[n])return r.substring(0,n)}}return r}function _memory(e){const t=this;if(t.lines=t.lines||[],t.lines.level=t.lines.level||[],e){const r=t.lines.level.length?t.lines.level.length-1:0;t.lines.push("  ".repeat(r)+e)}else t.lines.push("");if(e){var r=e.match(/{|\(/g),n=e.match(/}|\)/g);n=n?n.length:0;var i=(r=r?r.length:0)-n;i&&function r(){if(i>0)t.lines.level.push({line:t.lines.length-1,depth:i,isFunction:/\bfunction\b/.test(e)});else if(i<0){var n=t.lines.level.pop();if(n){var o=n.depth+i;o<0?(i+=n.depth,r()):o>0&&(n.depth+=i,t.lines.level.push(n))}}}()}else t.lines.level=[]}function addStandardGlobals(e,t){e.push(GLOBAL_OBJECT_PROPERTIES),t&&e.push(["async","await","break","case","catch","const","continue","debugger","default","delete","do","else","export","false","finally","for","function","if","import","in","instanceof","let","new","null","return","switch","this","throw","true","try","typeof","undefined","var","void","while","with","yield"])}function _turnOnEditorMode(e){e.editorMode=!0,REPLServer.super_.prototype.setPrompt.call(e,"")}function _turnOffEditorMode(e){e.editorMode=!1,e.setPrompt(e._initialPrompt)}function defineDefaultCommands(e){var t;e.defineCommand("break",{help:"Sometimes you get stuck, this gets you out",action:function(){this.clearBufferedCommand(),this.displayPrompt()}}),t=e.useGlobal?"Alias for .break":"Break, and also clear the local context",e.defineCommand("clear",{help:t,action:function(){this.clearBufferedCommand(),this.useGlobal||(this.outputStream.write("Clearing context...\n"),this.resetContext()),this.displayPrompt()}}),e.defineCommand("exit",{help:"Exit the repl",action:function(){this.close()}}),e.defineCommand("help",{help:"Print this help message",action:function(){const e=Object.keys(this.commands).sort(),t=e.reduce((e,t)=>Math.max(e,t.length),0);for(var r=0;r<e.length;r++){var n=e[r],i=this.commands[n],o=" ".repeat(t-n.length+3),s=`.${n}${i.help?o+i.help:""}\n`;this.outputStream.write(s)}this.displayPrompt()}}),e.defineCommand("save",{help:"Save all evaluated commands in this REPL session to a file",action:function(e){try{fs.writeFileSync(e,this.lines.join("\n")+"\n"),this.outputStream.write("Session saved to: "+e+"\n")}catch{this.outputStream.write("Failed to save: "+e+"\n")}this.displayPrompt()}}),e.defineCommand("load",{help:"Load JS from a file into the REPL session",action:function(e){try{var t=fs.statSync(e);if(t&&t.isFile()){_turnOnEditorMode(this);for(var r=fs.readFileSync(e,"utf8").split("\n"),n=0;n<r.length;n++)r[n]&&this.write(`${r[n]}\n`);_turnOffEditorMode(this),this.write("\n")}else this.outputStream.write("Failed to load: "+e+" is not a valid file\n")}catch{this.outputStream.write("Failed to load: "+e+"\n")}this.displayPrompt()}}),e.defineCommand("editor",{help:"Enter editor mode",action(){this.terminal&&(_turnOnEditorMode(this),this.outputStream.write("// Entering editor mode (^D to finish, ^C to cancel)\n"))}})}function regexpEscape(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function Recoverable(e){this.err=e}REPLServer.prototype.complete=function(){this.completer.apply(this,arguments)},REPLServer.prototype.completeOnEditorMode=(e=>(t,r)=>{if(t)return e(t);const[n,i=""]=r,o=i.length;if(0===o)return e(null,[[],i]);const s=n.filter(e=>e.length>0).map(e=>e.substring(o));e(null,[[`${i}${longestCommonPrefix(s)}`],i])}),REPLServer.prototype.defineCommand=function(e,t){if("function"==typeof t)t={action:t};else if("function"!=typeof t.action)throw new ERR_INVALID_ARG_TYPE("action","Function",t.action);this.commands[e]=t},REPLServer.prototype.memory=util.deprecate(_memory,"REPLServer.memory() is deprecated","DEP0082"),inherits(Recoverable,SyntaxError),exports.Recoverable=Recoverable;"use strict";const{Buffer}=require("buffer"),pipeline=require("internal/streams/pipeline"),eos=require("internal/streams/end-of-stream"),Stream=module.exports=require("internal/streams/legacy");Stream.Readable=require("_stream_readable"),Stream.Writable=require("_stream_writable"),Stream.Duplex=require("_stream_duplex"),Stream.Transform=require("_stream_transform"),Stream.PassThrough=require("_stream_passthrough"),Stream.pipeline=pipeline,Stream.finished=eos,Stream.Stream=Stream;try{const r=require("util").types;r&&"function"==typeof r.isUint8Array?Stream._isUint8Array=r.isUint8Array:Stream._isUint8Array=process.binding("util").isUint8Array}catch(r){}Stream._isUint8Array||(Stream._isUint8Array=function(r){return"[object Uint8Array]"===Object.prototype.toString.call(r)});const version=process.version.substr(1).split(".");if(0===version[0]&&version[1]<12)Stream._uint8ArrayToBuffer=Buffer;else{try{const r=require("internal/buffer");Stream._uint8ArrayToBuffer=function(e){return new r.FastBuffer(e.buffer,e.byteOffset,e.byteLength)}}catch(r){}Stream._uint8ArrayToBuffer||(Stream._uint8ArrayToBuffer=function(r){return Buffer.prototype.slice.call(r)})}"use strict";const{Buffer}=require("buffer"),{kIncompleteCharactersStart,kIncompleteCharactersEnd,kMissingBytes,kBufferedBytes,kEncodingField,kSize,decode,flush,encodings}=internalBinding("string_decoder"),internalUtil=require("internal/util"),{ERR_INVALID_ARG_TYPE,ERR_UNKNOWN_ENCODING}=require("internal/errors").codes,isEncoding=Buffer[internalUtil.kIsEncodingSymbol],kNativeDecoder=Symbol("kNativeDecoder");function normalizeEncoding(e){const i=internalUtil.normalizeEncoding(e);if(void 0===i){if(Buffer.isEncoding===isEncoding||!Buffer.isEncoding(e))throw new ERR_UNKNOWN_ENCODING(e);return e}return i}const encodingsMap={};for(var i=0;i<encodings.length;++i)encodingsMap[encodings[i]]=i;function StringDecoder(e){this.encoding=normalizeEncoding(e),this[kNativeDecoder]=Buffer.alloc(kSize),this[kNativeDecoder][kEncodingField]=encodingsMap[this.encoding]}StringDecoder.prototype.write=function(e){if("string"==typeof e)return e;if(!ArrayBuffer.isView(e))throw new ERR_INVALID_ARG_TYPE("buf",["Buffer","TypedArray","DataView"],e);return decode(this[kNativeDecoder],e)},StringDecoder.prototype.end=function(e){let i="";return void 0!==e&&(i=this.write(e)),this[kNativeDecoder][kBufferedBytes]>0&&(i+=flush(this[kNativeDecoder])),i},StringDecoder.prototype.text=function(e,i){return this[kNativeDecoder][kMissingBytes]=0,this[kNativeDecoder][kBufferedBytes]=0,this.write(e.slice(i))},Object.defineProperties(StringDecoder.prototype,{lastChar:{configurable:!0,enumerable:!0,get(){return this[kNativeDecoder].subarray(kIncompleteCharactersStart,kIncompleteCharactersEnd)}},lastNeed:{configurable:!0,enumerable:!0,get(){return this[kNativeDecoder][kMissingBytes]}},lastTotal:{configurable:!0,enumerable:!0,get(){return this[kNativeDecoder][kBufferedBytes]+this[kNativeDecoder][kMissingBytes]}}}),exports.StringDecoder=StringDecoder;"use strict";module.exports=require("util"),process.emitWarning("sys is deprecated. Use util instead.","DeprecationWarning","DEP0025");"use strict";const{Timer:TimerWrap,setupTimers}=process.binding("timer_wrap"),L=require("internal/linkedlist"),{async_id_symbol,trigger_async_id_symbol,Timeout,initAsyncResource,validateTimerDuration}=require("internal/timers"),internalUtil=require("internal/util"),assert=require("assert"),util=require("util"),{ERR_INVALID_CALLBACK}=require("internal/errors").codes,debug=util.debuglog("timer"),{destroyHooksExist,emitBefore,emitAfter,emitDestroy,symbols:{owner_symbol}}=require("internal/async_hooks"),kCount=0,kRefCount=1,kHasOutstanding=2,[immediateInfo,toggleImmediateRef]=setupTimers(processImmediate,processTimers),kRefed=Symbol("refed"),refedLists=Object.create(null),unrefedLists=Object.create(null),active=exports.active=function(e){insert(e,!1)};function insert(e,t,i){const n=e._idleTimeout;if(n<0||void 0===n)return;e._idleStart="number"==typeof i?i:TimerWrap.now();const s=!0===t?unrefedLists:refedLists;var o=s[n];void 0===o&&(debug("no %d list was found in insert, creating a new one",n),s[n]=o=new TimersList(n,t)),e[async_id_symbol]&&!e._destroyed||(e._destroyed=!1,initAsyncResource(e,"Timeout")),L.append(o,e),assert(!L.isEmpty(o))}function TimersList(e,t){this._idleNext=this,this._idlePrev=this,this._unrefed=t,this.msecs=e;const i=this._timer=new TimerWrap;i._list=this,!0===t&&i.unref(),i.start(e)}function processTimers(e){return this[owner_symbol]?unrefdHandle(this[owner_symbol],e):listOnTimeout(this,e)}function listOnTimeout(e,t){const i=e._list,n=i.msecs;var s,o;for(debug("timeout callback %d",n),debug("now: %d",t);o=L.peek(i);){if((s=t-o._idleStart)<n){var r=n-(TimerWrap.now()-o._idleStart);return r<=0&&(r=1),e.start(r),debug("%d list wait because diff is %d",n,s),!0}L.remove(o),assert(o!==L.peek(i)),o._onTimeout?tryOnTimeout(o):destroyHooksExist()&&!o._destroyed&&"number"==typeof o[async_id_symbol]&&(emitDestroy(o[async_id_symbol]),o._destroyed=!0)}return debug("%d list empty",n),assert(L.isEmpty(i)),!0===i._unrefed&&i===unrefedLists[n]?delete unrefedLists[n]:i===refedLists[n]&&delete refedLists[n],e[owner_symbol]||e.close(),!0}function tryOnTimeout(e,t){e._called=!0;const i="number"==typeof e[async_id_symbol]?e[async_id_symbol]:null;var n=!0;null!==i&&emitBefore(i,e[trigger_async_id_symbol]);try{ontimeout(e,t),n=!1}finally{null!==i&&(n||emitAfter(i),!n&&e._repeat||!destroyHooksExist()||e._destroyed||(emitDestroy(i),e._destroyed=!0))}}function reuse(e){L.remove(e);const t=refedLists[e._idleTimeout];return void 0!==t&&L.isEmpty(t)?(debug("reuse hit"),t._timer.stop(),delete refedLists[e._idleTimeout],t._timer):null}function unenroll(e){destroyHooksExist()&&"number"==typeof e[async_id_symbol]&&!e._destroyed&&(emitDestroy(e[async_id_symbol]),e._destroyed=!0);const t=reuse(e);null!==t&&(debug("unenroll: list empty"),t.close()),e._idleTimeout=-1}function enroll(e,t){t=validateTimerDuration(t),e._idleNext&&unenroll(e),L.init(e),e._idleTimeout=t}function setTimeout(e,t,i,n,s){if("function"!=typeof e)throw new ERR_INVALID_CALLBACK;var o,r;switch(arguments.length){case 1:case 2:break;case 3:r=[i];break;case 4:r=[i,n];break;default:for(r=[i,n,s],o=5;o<arguments.length;o++)r[o-2]=arguments[o]}const l=new Timeout(e,t,r,!1,!1);return active(l),l}function ontimeout(e,t){const i=e._timerArgs;if("function"!=typeof e._onTimeout)return Promise.resolve(e._onTimeout,i[0]);void 0===t&&e._repeat&&(t=TimerWrap.now()),i?Reflect.apply(e._onTimeout,e,i):e._onTimeout(),e._repeat&&rearm(e,t)}function rearm(e,t=TimerWrap.now()){if(-1!==e._idleTimeout)if(e._handle&&e instanceof Timeout)e._handle.start(e._repeat);else{e._idleTimeout=e._repeat;const i=TimerWrap.now()-t;i>=e._repeat?insert(e,!1,t+i-e._repeat+1):insert(e,!1,t)}}exports._unrefActive=function(e){insert(e,!0)},TimersList.prototype[util.inspect.custom]=function(e,t){return util.inspect(this,{...t,depth:0,customInspect:!1})},exports.unenroll=util.deprecate(unenroll,"timers.unenroll() is deprecated. Please use clearTimeout instead.","DEP0096"),exports.enroll=util.deprecate(enroll,"timers.enroll() is deprecated. Please use setTimeout instead.","DEP0095"),setTimeout[internalUtil.promisify.custom]=function(e,t){return new Promise(i=>{active(new Timeout(i,e,[t],!1,!1))})},exports.setTimeout=setTimeout;const clearTimeout=exports.clearTimeout=function(e){e&&e._onTimeout&&(e._onTimeout=null,e instanceof Timeout?e.close():unenroll(e))};function unrefdHandle(e,t){try{"function"==typeof e._onTimeout&&tryOnTimeout(e,t)}finally{e._repeat&&"function"==typeof e._onTimeout||e.close()}return!0}function ImmediateList(){this.head=null,this.tail=null}exports.setInterval=function(e,t,i,n,s){if("function"!=typeof e)throw new ERR_INVALID_CALLBACK;var o,r;switch(arguments.length){case 1:case 2:break;case 3:r=[i];break;case 4:r=[i,n];break;default:for(r=[i,n,s],o=5;o<arguments.length;o++)r[o-2]=arguments[o]}const l=new Timeout(e,t,r,!0,!1);return active(l),l},exports.clearInterval=function(e){clearTimeout(e)},Timeout.prototype.unref=function(){if(this._handle)this._handle.unref();else if("function"==typeof this._onTimeout){const t=TimerWrap.now();this._idleStart||(this._idleStart=t);var e=this._idleStart+this._idleTimeout-t;if(e<0&&(e=0),this._called&&!this._repeat)return void unenroll(this);const i=reuse(this);null!==i&&(i._list=void 0),this._handle=i||new TimerWrap,this._handle[owner_symbol]=this,this._handle.start(e),this._handle.unref()}return this},Timeout.prototype.ref=function(){return this._handle&&this._handle.ref(),this},Timeout.prototype.close=function(){return this._onTimeout=null,this._handle?(destroyHooksExist()&&"number"==typeof this[async_id_symbol]&&!this._destroyed&&(emitDestroy(this[async_id_symbol]),this._destroyed=!0),this._idleTimeout=-1,this._handle.close()):unenroll(this),this},ImmediateList.prototype.append=function(e){null!==this.tail?(this.tail._idleNext=e,e._idlePrev=this.tail):this.head=e,this.tail=e},ImmediateList.prototype.remove=function(e){null!==e._idleNext&&(e._idleNext._idlePrev=e._idlePrev),null!==e._idlePrev&&(e._idlePrev._idleNext=e._idleNext),e===this.head&&(this.head=e._idleNext),e===this.tail&&(this.tail=e._idlePrev),e._idleNext=null,e._idlePrev=null};const immediateQueue=new ImmediateList,outstandingQueue=new ImmediateList;function processImmediate(){const e=null!==outstandingQueue.head?outstandingQueue:immediateQueue;var t=e.head;const i=e.tail;e.head=e.tail=null;let n=0,s=0;for(;null!==t;){t._destroyed=!0;const e=t[async_id_symbol];emitBefore(e,t[trigger_async_id_symbol]),n++,t[kRefed]&&s++,t[kRefed]=void 0,tryOnImmediate(t,i,n,s),emitAfter(e),t=t._idleNext}immediateInfo[kCount]-=n,immediateInfo[kRefCount]-=s,immediateInfo[kHasOutstanding]=0}function tryOnImmediate(e,t,i,n){var s=!0;try{runCallback(e),s=!1}finally{e._onImmediate=null,destroyHooksExist()&&emitDestroy(e[async_id_symbol]),s&&(immediateInfo[kCount]-=i,immediateInfo[kRefCount]-=n,null!==e._idleNext&&(outstandingQueue.head=e._idleNext,outstandingQueue.tail=t,immediateInfo[kHasOutstanding]=1))}}function runCallback(e){const t=e._argv;return"function"!=typeof e._onImmediate?Promise.resolve(e._onImmediate,t[0]):t?void Reflect.apply(e._onImmediate,e,t):e._onImmediate()}const Immediate=class{constructor(e,t){this._idleNext=null,this._idlePrev=null,this._onImmediate=null,this._onImmediate=e,this._argv=t,this._destroyed=!1,this[kRefed]=!1,initAsyncResource(this,"Immediate"),this.ref(),immediateInfo[kCount]++,immediateQueue.append(this)}ref(){return!1===this[kRefed]&&(this[kRefed]=!0,0==immediateInfo[kRefCount]++&&toggleImmediateRef(!0)),this}unref(){return!0===this[kRefed]&&(this[kRefed]=!1,0==--immediateInfo[kRefCount]&&toggleImmediateRef(!1)),this}};function setImmediate(e,t,i,n){if("function"!=typeof e)throw new ERR_INVALID_CALLBACK;var s,o;switch(arguments.length){case 1:break;case 2:o=[t];break;case 3:o=[t,i];break;default:for(o=[t,i,n],s=4;s<arguments.length;s++)o[s-1]=arguments[s]}return new Immediate(e,o)}setImmediate[internalUtil.promisify.custom]=function(e){return new Promise(t=>new Immediate(t,[e]))},exports.setImmediate=setImmediate,exports.clearImmediate=function(e){e&&!e._destroyed&&(immediateInfo[kCount]--,e._destroyed=!0,e[kRefed]&&0==--immediateInfo[kRefCount]&&toggleImmediateRef(!1),e[kRefed]=void 0,destroyHooksExist()&&emitDestroy(e[async_id_symbol]),e._onImmediate=null,immediateQueue.remove(e))},Object.defineProperty(TimerWrap.prototype,"owner",{get(){return this[owner_symbol]},set(e){return this[owner_symbol]=e}});"use strict";const{ERR_TLS_CERT_ALTNAME_INVALID}=require("internal/errors").codes,internalUtil=require("internal/util"),internalTLS=require("internal/tls");internalUtil.assertCrypto();const{isUint8Array}=require("internal/util/types"),net=require("net"),url=require("url"),binding=internalBinding("crypto"),{Buffer}=require("buffer"),EventEmitter=require("events"),DuplexPair=require("internal/streams/duplexpair"),{canonicalizeIP}=process.binding("cares_wrap"),_tls_common=require("_tls_common"),_tls_wrap=require("_tls_wrap");function convertProtocols(e){const t=new Array(e.length),r=Buffer.allocUnsafe(e.reduce((e,r,n)=>{var s=Buffer.byteLength(r);return t[n]=s,e+1+s},0));for(var n=0,s=0,i=e.length;s<i;s++)r[n++]=t[s],r.write(e[s],n),n+=t[s];return r}function unfqdn(e){return e.replace(/[.]$/,"")}function splitHost(e){return unfqdn(e).replace(/[A-Z]/g,e=>String.fromCharCode(32+e.charCodeAt(0))).split(".")}function check(e,t,r){if(!t)return!1;const n=splitHost(t);if(e.length!==n.length)return!1;if(n.includes(""))return!1;if(n.some(e=>/[^\u0021-\u007F]/u.test(e)))return!1;for(var s=e.length-1;s>0;s-=1)if(e[s]!==n[s])return!1;const i=e[0],o=n[0],c=o.split("*");if(1===c.length||o.includes("xn--"))return i===o;if(!r)return!1;if(c.length>2)return!1;if(n.length<=2)return!1;const[l,a]=c;return!(l.length+a.length>i.length)&&(!!i.startsWith(l)&&!!i.endsWith(a))}exports.CLIENT_RENEG_LIMIT=3,exports.CLIENT_RENEG_WINDOW=600,exports.DEFAULT_CIPHERS=process.binding("constants").crypto.defaultCipherList,exports.DEFAULT_ECDH_CURVE="auto",exports.getCiphers=internalUtil.cachedResult(()=>internalUtil.filterDuplicateStrings(binding.getSSLCiphers(),!0)),exports.convertNPNProtocols=internalUtil.deprecate(function(e,t){Array.isArray(e)?t.NPNProtocols=convertProtocols(e):isUint8Array(e)&&(t.NPNProtocols=Buffer.from(e))},"tls.convertNPNProtocols() is deprecated.","DEP0107"),exports.convertALPNProtocols=function(e,t){Array.isArray(e)?t.ALPNProtocols=convertProtocols(e):isUint8Array(e)&&(t.ALPNProtocols=Buffer.from(e))},exports.checkServerIdentity=function(e,t){const r=t.subject,n=t.subjectaltname,s=[],i=[],o=[];if(e=""+e,n)for(const e of n.split(", "))if(e.startsWith("DNS:"))s.push(e.slice(4));else if(e.startsWith("URI:")){const t=url.parse(e.slice(4));i.push(t.hostname)}else e.startsWith("IP Address:")&&o.push(canonicalizeIP(e.slice(11)));let c=!1,l="Unknown reason";if(net.isIP(e))(c=o.includes(canonicalizeIP(e)))||(l=`IP: ${e} is not in the cert's list: ${o.join(", ")}`);else if(r){const t=splitHost(e=unfqdn(e)),a=e=>check(t,e,!0),u=e=>check(t,e,!1);if(0===s.length&&0===o.length&&0===i.length){const t=r.CN;Array.isArray(t)?c=t.some(a):t&&(c=a(t)),c||(l=`Host: ${e}. is not cert's CN: ${t}`)}else(c=s.some(a)||i.some(u))||(l=`Host: ${e}. is not in the cert's altnames: ${n}`)}else l="Cert is empty";if(!c){const r=new ERR_TLS_CERT_ALTNAME_INVALID(l);return r.reason=l,r.host=e,r.cert=t,r}};class SecurePair extends EventEmitter{constructor(e=exports.createSecureContext(),t=!1,r=!t,n=!1,s={}){super();const{socket1:i,socket2:o}=new DuplexPair;this.server=s.server,this.credentials=e,this.encrypted=i,this.cleartext=new exports.TLSSocket(o,Object.assign({secureContext:e,isServer:t,requestCert:r,rejectUnauthorized:n},s)),this.cleartext.once("secure",()=>this.emit("secure"))}destroy(){this.cleartext.destroy(),this.encrypted.destroy()}}exports.parseCertString=internalUtil.deprecate(internalTLS.parseCertString,"tls.parseCertString() is deprecated. Please use querystring.parse() instead.","DEP0076"),exports.createSecureContext=_tls_common.createSecureContext,exports.SecureContext=_tls_common.SecureContext,exports.TLSSocket=_tls_wrap.TLSSocket,exports.Server=_tls_wrap.Server,exports.createServer=_tls_wrap.createServer,exports.connect=_tls_wrap.connect,exports.createSecurePair=internalUtil.deprecate(function(...e){return new SecurePair(...e)},"tls.createSecurePair() is deprecated. Please use tls.TLSSocket instead.","DEP0064");"use strict";const{hasTracing}=process.binding("config"),kHandle=Symbol("handle"),kEnabled=Symbol("enabled"),kCategories=Symbol("categories"),kMaxTracingCount=10,{ERR_TRACE_EVENTS_CATEGORY_REQUIRED,ERR_TRACE_EVENTS_UNAVAILABLE,ERR_INVALID_ARG_TYPE}=require("internal/errors").codes;if(!hasTracing)throw new ERR_TRACE_EVENTS_UNAVAILABLE;const{CategorySet,getEnabledCategories}=internalBinding("trace_events"),{customInspectSymbol}=require("internal/util"),{format}=require("util"),enabledTracingObjects=new Set;class Tracing{constructor(e){this[kHandle]=new CategorySet(e),this[kCategories]=e,this[kEnabled]=!1}enable(){this[kEnabled]||(this[kEnabled]=!0,this[kHandle].enable(),enabledTracingObjects.add(this),enabledTracingObjects.size>kMaxTracingCount&&process.emitWarning("Possible trace_events memory leak detected. There are more than "+`${kMaxTracingCount} enabled Tracing objects.`))}disable(){this[kEnabled]&&(this[kEnabled]=!1,this[kHandle].disable(),enabledTracingObjects.delete(this))}get enabled(){return this[kEnabled]}get categories(){return this[kCategories].join(",")}[customInspectSymbol](e,t){const a={enabled:this.enabled,categories:this.categories};return`Tracing ${format(a)}`}}function createTracing(e){if("object"!=typeof e||null==e)throw new ERR_INVALID_ARG_TYPE("options","object",e);if(!Array.isArray(e.categories))throw new ERR_INVALID_ARG_TYPE("options.categories","string[]",e.categories);if(e.categories.length<=0)throw new ERR_TRACE_EVENTS_CATEGORY_REQUIRED;return new Tracing(e.categories)}module.exports={createTracing,getEnabledCategories};"use strict";const{inherits,_extend}=require("util"),net=require("net"),{TTY,isTTY}=internalBinding("tty_wrap"),errors=require("internal/errors"),{ERR_INVALID_FD,ERR_TTY_INIT_FAILED}=errors.codes,{getColorDepth}=require("internal/tty");let readline;function isatty(e){return Number.isInteger(e)&&e>=0&&isTTY(e)}function ReadStream(e,t){if(!(this instanceof ReadStream))return new ReadStream(e,t);if(e>>0!==e||e<0)throw new ERR_INVALID_FD(e);const r={},i=new TTY(e,!0,r);if(void 0!==r.code)throw new ERR_TTY_INIT_FAILED(r);t=_extend({highWaterMark:0,readable:!0,writable:!1,handle:i},t),net.Socket.call(this,t),this.isRaw=!1,this.isTTY=!0}function WriteStream(e){if(!(this instanceof WriteStream))return new WriteStream(e);if(e>>0!==e||e<0)throw new ERR_INVALID_FD(e);const t={},r=new TTY(e,!1,t);if(void 0!==t.code)throw new ERR_TTY_INIT_FAILED(t);net.Socket.call(this,{handle:r,readable:!1,writable:!0}),this._handle.setBlocking(!0);const i=new Array(2);this._handle.getWindowSize(i)||(this.columns=i[0],this.rows=i[1])}inherits(ReadStream,net.Socket),ReadStream.prototype.setRawMode=function(e){e=!!e;const t=this._handle.setRawMode(e);return t?(this.emit("error",errors.errnoException(t,"setRawMode")),this):(this.isRaw=e,this)},inherits(WriteStream,net.Socket),WriteStream.prototype.isTTY=!0,WriteStream.prototype.getColorDepth=getColorDepth,WriteStream.prototype._refreshSize=function(){const e=this.columns,t=this.rows,r=new Array(2),i=this._handle.getWindowSize(r);if(i)return void this.emit("error",errors.errnoException(i,"getWindowSize"));const[n,o]=r;e===n&&t===o||(this.columns=n,this.rows=o,this.emit("resize"))},WriteStream.prototype.cursorTo=function(e,t){void 0===readline&&(readline=require("readline")),readline.cursorTo(this,e,t)},WriteStream.prototype.moveCursor=function(e,t){void 0===readline&&(readline=require("readline")),readline.moveCursor(this,e,t)},WriteStream.prototype.clearLine=function(e){void 0===readline&&(readline=require("readline")),readline.clearLine(this,e)},WriteStream.prototype.clearScreenDown=function(){void 0===readline&&(readline=require("readline")),readline.clearScreenDown(this)},WriteStream.prototype.getWindowSize=function(){return[this.columns,this.rows]},module.exports={isatty,ReadStream,WriteStream};"use strict";const{toASCII}=process.binding("config").hasIntl?process.binding("icu"):require("punycode"),{hexTable}=require("internal/querystring"),{ERR_INVALID_ARG_TYPE}=require("internal/errors").codes,{spliceOne}=require("internal/util"),{URL,URLSearchParams,domainToASCII,domainToUnicode,formatSymbol,encodeStr,pathToFileURL,fileURLToPath}=require("internal/url");function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}const protocolPattern=/^[a-z0-9.+-]+:/i,portPattern=/:[0-9]*$/,hostPattern=/^\/\/[^@\/]+@[^@\/]+/,simplePathPattern=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,hostnameMaxLen=255,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,"http:":!0,https:!0,"https:":!0,ftp:!0,"ftp:":!0,gopher:!0,"gopher:":!0,file:!0,"file:":!0},{CHAR_SPACE,CHAR_TAB,CHAR_CARRIAGE_RETURN,CHAR_LINE_FEED,CHAR_FORM_FEED,CHAR_NO_BREAK_SPACE,CHAR_ZERO_WIDTH_NOBREAK_SPACE,CHAR_HASH,CHAR_FORWARD_SLASH,CHAR_LEFT_SQUARE_BRACKET,CHAR_RIGHT_SQUARE_BRACKET,CHAR_LEFT_ANGLE_BRACKET,CHAR_RIGHT_ANGLE_BRACKET,CHAR_LEFT_CURLY_BRACKET,CHAR_RIGHT_CURLY_BRACKET,CHAR_QUESTION_MARK,CHAR_LOWERCASE_A,CHAR_LOWERCASE_Z,CHAR_UPPERCASE_A,CHAR_UPPERCASE_Z,CHAR_DOT,CHAR_0,CHAR_9,CHAR_HYPHEN_MINUS,CHAR_PLUS,CHAR_UNDERSCORE,CHAR_DOUBLE_QUOTE,CHAR_SINGLE_QUOTE,CHAR_PERCENT,CHAR_SEMICOLON,CHAR_BACKWARD_SLASH,CHAR_CIRCUMFLEX_ACCENT,CHAR_GRAVE_ACCENT,CHAR_VERTICAL_LINE,CHAR_AT}=require("internal/constants");let querystring;function urlParse(t,e,s){if(t instanceof Url)return t;var h=new Url;return h.parse(t,e,s),h}function validateHostname(t,e,s){for(var h=0;h<s.length;++h){const r=s.charCodeAt(h);if(!(r>=CHAR_LOWERCASE_A&&r<=CHAR_LOWERCASE_Z||r===CHAR_DOT||r>=CHAR_UPPERCASE_A&&r<=CHAR_UPPERCASE_Z||r>=CHAR_0&&r<=CHAR_9||r===CHAR_HYPHEN_MINUS||r===CHAR_PLUS||r===CHAR_UNDERSCORE||r>127))return t.hostname=s.slice(0,h),"/"+s.slice(h)+e}}Url.prototype.parse=function(t,e,s){if("string"!=typeof t)throw new ERR_INVALID_ARG_TYPE("url","string",t);for(var h=!1,r=-1,a=-1,o="",n=0,A=0,i=!1,R=!1;A<t.length;++A){const e=t.charCodeAt(A),s=e===CHAR_SPACE||e===CHAR_TAB||e===CHAR_CARRIAGE_RETURN||e===CHAR_LINE_FEED||e===CHAR_FORM_FEED||e===CHAR_NO_BREAK_SPACE||e===CHAR_ZERO_WIDTH_NOBREAK_SPACE;if(-1===r){if(s)continue;n=r=A}else i?s||(a=-1,i=!1):s&&(a=A,i=!0);if(R)h||e!==CHAR_HASH||(h=!0);else switch(e){case CHAR_HASH:h=!0;case CHAR_QUESTION_MARK:R=!0;break;case CHAR_BACKWARD_SLASH:A-n>0&&(o+=t.slice(n,A)),o+="/",n=A+1}}if(-1!==r&&(n===r?o=-1===a?0===r?t:t.slice(r):t.slice(r,a):-1===a&&n<t.length?o+=t.slice(n):-1!==a&&n<a&&(o+=t.slice(n,a))),!s&&!h){const t=simplePathPattern.exec(o);if(t)return this.path=o,this.href=o,this.pathname=t[1],t[2]?(this.search=t[2],e?(void 0===querystring&&(querystring=require("querystring")),this.query=querystring.parse(this.search.slice(1))):this.query=this.search.slice(1)):e&&(this.search=null,this.query=Object.create(null)),this}var l=protocolPattern.exec(o);if(l){var _=(l=l[0]).toLowerCase();this.protocol=_,o=o.slice(l.length)}if(s||l||hostPattern.test(o)){var C=o.charCodeAt(0)===CHAR_FORWARD_SLASH&&o.charCodeAt(1)===CHAR_FORWARD_SLASH;!C||l&&hostlessProtocol[_]||(o=o.slice(2),this.slashes=!0)}if(!hostlessProtocol[_]&&(C||l&&!slashedProtocol[l])){var c=-1,E=-1,H=-1;for(A=0;A<o.length;++A){switch(o.charCodeAt(A)){case CHAR_TAB:case CHAR_LINE_FEED:case CHAR_CARRIAGE_RETURN:case CHAR_SPACE:case CHAR_DOUBLE_QUOTE:case CHAR_PERCENT:case CHAR_SINGLE_QUOTE:case CHAR_SEMICOLON:case CHAR_LEFT_ANGLE_BRACKET:case CHAR_RIGHT_ANGLE_BRACKET:case CHAR_BACKWARD_SLASH:case CHAR_CIRCUMFLEX_ACCENT:case CHAR_GRAVE_ACCENT:case CHAR_LEFT_CURLY_BRACKET:case CHAR_VERTICAL_LINE:case CHAR_RIGHT_CURLY_BRACKET:-1===H&&(H=A);break;case CHAR_HASH:case CHAR_FORWARD_SLASH:case CHAR_QUESTION_MARK:-1===H&&(H=A),c=A;break;case CHAR_AT:E=A,H=-1}if(-1!==c)break}r=0,-1!==E&&(this.auth=decodeURIComponent(o.slice(0,E)),r=E+1),-1===H?(this.host=o.slice(r),o=""):(this.host=o.slice(r,H),o=o.slice(H)),this.parseHost(),"string"!=typeof this.hostname&&(this.hostname="");var u=this.hostname,p=u.charCodeAt(0)===CHAR_LEFT_SQUARE_BRACKET&&u.charCodeAt(u.length-1)===CHAR_RIGHT_SQUARE_BRACKET;if(!p){const t=validateHostname(this,o,u);void 0!==t&&(o=t)}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),p||(this.hostname=toASCII(this.hostname,!0));var f=this.port?":"+this.port:"",m=this.hostname||"";this.host=m+f,p&&(this.hostname=this.hostname.slice(1,-1),"/"!==o[0]&&(o="/"+o))}unsafeProtocol[_]||(o=autoEscapeStr(o));var T=-1,S=-1;for(A=0;A<o.length;++A){const t=o.charCodeAt(A);if(t===CHAR_HASH){this.hash=o.slice(A),S=A;break}t===CHAR_QUESTION_MARK&&-1===T&&(T=A)}-1!==T?(-1===S?(this.search=o.slice(T),this.query=o.slice(T+1)):(this.search=o.slice(T,S),this.query=o.slice(T+1,S)),e&&(void 0===querystring&&(querystring=require("querystring")),this.query=querystring.parse(this.query))):e&&(this.search=null,this.query=Object.create(null));const L=-1!==T&&(-1===S||T<S)?T:S;if(-1===L?o.length>0&&(this.pathname=o):L>0&&(this.pathname=o.slice(0,L)),slashedProtocol[_]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){const t=this.pathname||"",e=this.search||"";this.path=t+e}return this.href=this.format(),this};const escapedCodes=["","","","","","","","","","%09","%0A","","","%0D","","","","","","","","","","","","","","","","","","","%20","","%22","","","","","%27","","","","","","","","","","","","","","","","","","","","","%3C","","%3E","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","%5C","","%5E","","%60","","","","","","","","","","","","","","","","","","","","","","","","","","","%7B","%7C","%7D"];function autoEscapeStr(t){for(var e="",s=0,h=0;h<t.length;++h){var r=escapedCodes[t.charCodeAt(h)];r&&(h>s&&(e+=t.slice(s,h)),e+=r,s=h+1)}return 0===s?t:(s<t.length&&(e+=t.slice(s)),e)}function urlFormat(t,e){if("string"==typeof t)t=urlParse(t);else{if("object"!=typeof t||null===t)throw new ERR_INVALID_ARG_TYPE("urlObject",["Object","string"],t);if(!(t instanceof Url)){var s=t[formatSymbol];return s?s.call(t,e):Url.prototype.format.call(t)}}return t.format()}const noEscapeAuth=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0];function urlResolve(t,e){return urlParse(t,!1,!0).resolve(e)}function urlResolveObject(t,e){return t?urlParse(t,!1,!0).resolveObject(e):e}Url.prototype.format=function(){var t=this.auth||"";t&&(t=encodeStr(t,noEscapeAuth,hexTable),t+="@");var e=this.protocol||"",s=this.pathname||"",h=this.hash||"",r="",a="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),null!==this.query&&"object"==typeof this.query&&(void 0===querystring&&(querystring=require("querystring")),a=querystring.stringify(this.query));var o=this.search||a&&"?"+a||"";e&&58!==e.charCodeAt(e.length-1)&&(e+=":");for(var n="",A=0,i=0;i<s.length;++i)switch(s.charCodeAt(i)){case CHAR_HASH:i-A>0&&(n+=s.slice(A,i)),n+="%23",A=i+1;break;case CHAR_QUESTION_MARK:i-A>0&&(n+=s.slice(A,i)),n+="%3F",A=i+1}return A>0&&(s=A!==s.length?n+s.slice(A):n),(this.slashes||slashedProtocol[e])&&(this.slashes||r?(s&&s.charCodeAt(0)!==CHAR_FORWARD_SLASH&&(s="/"+s),r="//"+r):e.length>=4&&102===e.charCodeAt(0)&&105===e.charCodeAt(1)&&108===e.charCodeAt(2)&&101===e.charCodeAt(3)&&(r="//")),o=o.replace(/#/g,"%23"),h&&h.charCodeAt(0)!==CHAR_HASH&&(h="#"+h),o&&o.charCodeAt(0)!==CHAR_QUESTION_MARK&&(o="?"+o),e+r+s+o+h},Url.prototype.resolve=function(t){return this.resolveObject(urlParse(t,!1,!0)).format()},Url.prototype.resolveObject=function(t){if("string"==typeof t){var e=new Url;e.parse(t,!1,!0),t=e}for(var s=new Url,h=Object.keys(this),r=0;r<h.length;r++){var a=h[r];s[a]=this[a]}if(s.hash=t.hash,""===t.href)return s.href=s.format(),s;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),n=0;n<o.length;n++){var A=o[n];"protocol"!==A&&(s[A]=t[A])}return slashedProtocol[s.protocol]&&s.hostname&&!s.pathname&&(s.path=s.pathname="/"),s.href=s.format(),s}if(t.protocol&&t.protocol!==s.protocol){if(!slashedProtocol[t.protocol]){for(var i=Object.keys(t),R=0;R<i.length;R++){var l=i[R];s[l]=t[l]}return s.href=s.format(),s}if(s.protocol=t.protocol,t.host||/^file:?$/.test(t.protocol)||hostlessProtocol[t.protocol])s.pathname=t.pathname;else{const e=(t.pathname||"").split("/");for(;e.length&&!(t.host=e.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),s.pathname=e.join("/")}if(s.search=t.search,s.query=t.query,s.host=t.host||"",s.auth=t.auth,s.hostname=t.hostname||t.host,s.port=t.port,s.pathname||s.search){var _=s.pathname||"",C=s.search||"";s.path=_+C}return s.slashes=s.slashes||t.slashes,s.href=s.format(),s}var c=s.pathname&&"/"===s.pathname.charAt(0),E=t.host||t.pathname&&"/"===t.pathname.charAt(0),H=E||c||s.host&&t.pathname,u=H,p=s.pathname&&s.pathname.split("/")||[],f=t.pathname&&t.pathname.split("/")||[],m=s.protocol&&!slashedProtocol[s.protocol];if(m&&(s.hostname="",s.port=null,s.host&&(""===p[0]?p[0]=s.host:p.unshift(s.host)),s.host="",t.protocol&&(t.hostname=null,t.port=null,s.auth=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),H=H&&(""===f[0]||""===p[0])),E)(t.host||""===t.host)&&(s.host!==t.host&&(s.auth=null),s.host=t.host,s.port=t.port),(t.hostname||""===t.hostname)&&(s.hostname!==t.hostname&&(s.auth=null),s.hostname=t.hostname),s.search=t.search,s.query=t.query,p=f;else if(f.length)p||(p=[]),p.pop(),p=p.concat(f),s.search=t.search,s.query=t.query;else if(null!==t.search&&void 0!==t.search){if(m){s.hostname=s.host=p.shift();const t=s.host&&s.host.indexOf("@")>0&&s.host.split("@");t&&(s.auth=t.shift(),s.host=s.hostname=t.shift())}return s.search=t.search,s.query=t.query,null===s.pathname&&null===s.search||(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.href=s.format(),s}if(!p.length)return s.pathname=null,s.search?s.path="/"+s.search:s.path=null,s.href=s.format(),s;for(var T=p.slice(-1)[0],S=(s.host||t.host||p.length>1)&&("."===T||".."===T)||""===T,L=0,U=p.length-1;U>=0;U--)"."===(T=p[U])?spliceOne(p,U):".."===T?(spliceOne(p,U),L++):L&&(spliceOne(p,U),L--);if(!H&&!u)for(;L--;)p.unshift("..");!H||""===p[0]||p[0]&&"/"===p[0].charAt(0)||p.unshift(""),S&&"/"!==p.join("/").substr(-1)&&p.push("");var O=""===p[0]||p[0]&&"/"===p[0].charAt(0);if(m){s.hostname=s.host=O?"":p.length?p.shift():"";const t=!!(s.host&&s.host.indexOf("@")>0)&&s.host.split("@");t&&(s.auth=t.shift(),s.host=s.hostname=t.shift())}return(H=H||s.host&&p.length)&&!O&&p.unshift(""),p.length?s.pathname=p.join("/"):(s.pathname=null,s.path=null),null===s.pathname&&null===s.search||(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.auth=t.auth||s.auth,s.slashes=s.slashes||t.slashes,s.href=s.format(),s},Url.prototype.parseHost=function(){var t=this.host,e=portPattern.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.slice(1)),t=t.slice(0,t.length-e.length)),t&&(this.hostname=t)},module.exports={Url,parse:urlParse,resolve:urlResolve,resolveObject:urlResolveObject,format:urlFormat,URL,URLSearchParams,domainToASCII,domainToUnicode,pathToFileURL,fileURLToPath};"use strict";const errors=require("internal/errors"),{inspect}=require("internal/util/inspect"),{ERR_FALSY_VALUE_REJECTION,ERR_INVALID_ARG_TYPE,ERR_OUT_OF_RANGE}=errors.codes,{validateNumber}=require("internal/validators"),{TextDecoder,TextEncoder}=require("internal/encoding"),{isBuffer}=require("buffer").Buffer,types=internalBinding("types");Object.assign(types,require("internal/util/types"));const{isRegExp,isDate}=types,{deprecate,getSystemErrorName:internalErrorName,isError,promisify}=require("internal/util");let CIRCULAR_ERROR_MESSAGE,internalDeepEqual;function tryStringify(e){try{return JSON.stringify(e)}catch(e){if(!CIRCULAR_ERROR_MESSAGE)try{const e={};e.a=e,JSON.stringify(e)}catch(e){CIRCULAR_ERROR_MESSAGE=e.message}if("TypeError"===e.name&&e.message===CIRCULAR_ERROR_MESSAGE)return"[Circular]";throw e}}const emptyOptions={};function format(...e){return formatWithOptions(emptyOptions,...e)}function formatWithOptions(e,t){let r,n;if("string"!=typeof t){if(1===arguments.length)return"";let t="";for(r=1;r<arguments.length-1;r++)t+=inspect(arguments[r],e),t+=" ";return t+=inspect(arguments[r],e)}if(2===arguments.length)return t;let i="",o=2,s=0;for(r=0;r<t.length-1;r++)if(37===t.charCodeAt(r)){const c=t.charCodeAt(++r);if(o!==arguments.length){switch(c){case 115:n=String(arguments[o++]);break;case 106:n=tryStringify(arguments[o++]);break;case 100:const u=arguments[o++];n="bigint"==typeof u?`${u}n`:`${Number(u)}`;break;case 79:n=inspect(arguments[o++],e);break;case 111:{const t=Object.assign({},e,{showHidden:!0,showProxy:!0,depth:4});n=inspect(arguments[o++],t);break}case 105:const a=arguments[o++];n="bigint"==typeof a?`${a}n`:`${parseInt(a)}`;break;case 102:n=`${parseFloat(arguments[o++])}`;break;case 37:i+=t.slice(s,r),s=r+1;continue;default:continue}s!==r-1&&(i+=t.slice(s,r-1)),i+=n,s=r+1}else 37===c&&(i+=t.slice(s,r),s=r+1)}for(0===s?i=t:s<t.length&&(i+=t.slice(s));o<arguments.length;){const t=arguments[o++];i+="object"!=typeof t&&"symbol"!=typeof t||null===t?` ${t}`:` ${inspect(t,e)}`}return i}const debugs={};let debugEnvRegex=/^$/;if(process.env.NODE_DEBUG){let e=process.env.NODE_DEBUG;e=e.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),debugEnvRegex=new RegExp(`^${e}$`,"i")}function debuglog(e){if(e=e.toUpperCase(),!debugs[e])if(debugEnvRegex.test(e)){process.pid;debugs[e]=function(){exports.format.apply(exports,arguments)}}else debugs[e]=function(){};return debugs[e]}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isObject(e){return null!==e&&"object"==typeof e}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"object"!=typeof e&&"function"!=typeof e}function pad(e){return e.toString().padStart(2,"0")}const months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){const e=new Date,t=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],t].join(" ")}function log(){}function inherits(e,t){if(null==e)throw new ERR_INVALID_ARG_TYPE("ctor","Function",e);if(null==t)throw new ERR_INVALID_ARG_TYPE("superCtor","Function",t);if(void 0===t.prototype)throw new ERR_INVALID_ARG_TYPE("superCtor.prototype","Function",t.prototype);e.super_=t,Object.setPrototypeOf(e.prototype,t.prototype)}function _extend(e,t){if(null===t||"object"!=typeof t)return e;const r=Object.keys(t);let n=r.length;for(;n--;)e[r[n]]=t[r[n]];return e}function print(...e){for(var t=0,r=e.length;t<r;++t)process.stdout.write(String(e[t]))}function puts(...e){for(var t=0,r=e.length;t<r;++t)process.stdout.write(`${e[t]}\n`)}function debug(e){process.stderr.write(`DEBUG: ${e}\n`)}function error(...e){for(var t=0,r=e.length;t<r;++t)process.stderr.write(`${e[t]}\n`)}function callbackifyOnRejected(e,t){if(!e){const t=new ERR_FALSY_VALUE_REJECTION;t.reason=e,e=t,Error.captureStackTrace(e,callbackifyOnRejected)}return t(e)}function callbackify(e){if("function"!=typeof e)throw new ERR_INVALID_ARG_TYPE("original","Function",e);function t(...t){const r=t.pop();if("function"!=typeof r)throw new ERR_INVALID_ARG_TYPE("last argument","Function",r);const n=(...e)=>{Reflect.apply(r,this,e)};Reflect.apply(e,this,t).then(e=>process.nextTick(n,null,e),e=>process.nextTick(callbackifyOnRejected,e,n))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)),t}function getSystemErrorName(e){if(validateNumber(e,"err"),e>=0||!Number.isSafeInteger(e))throw new ERR_OUT_OF_RANGE("err","a negative integer",e);return internalErrorName(e)}module.exports=exports={_errnoException:errors.errnoException,_exceptionWithHostPort:errors.exceptionWithHostPort,_extend,callbackify,debuglog,deprecate,format,formatWithOptions,getSystemErrorName,inherits,inspect,isArray:Array.isArray,isBoolean,isBuffer,isDeepStrictEqual:(e,t)=>(void 0===internalDeepEqual&&(internalDeepEqual=require("internal/util/comparisons").isDeepStrictEqual),internalDeepEqual(e,t)),isNull,isNullOrUndefined,isNumber,isString,isSymbol,isUndefined,isRegExp,isObject,isDate,isError,isFunction,isPrimitive,log,promisify,TextDecoder,TextEncoder,types,debug:deprecate(debug,"util.debug is deprecated. Use console.error instead.","DEP0028"),error:deprecate(error,"util.error is deprecated. Use console.error instead.","DEP0029"),print:deprecate(print,"util.print is deprecated. Use console.log instead.","DEP0026"),puts:deprecate(puts,"util.puts is deprecated. Use console.log instead.","DEP0027")};"use strict";const{Buffer}=require("buffer"),{ERR_INVALID_ARG_TYPE}=require("internal/errors").codes,{Serializer:_Serializer,Deserializer:_Deserializer}=process.binding("serdes"),{copy}=process.binding("buffer"),{objectToString}=require("internal/util"),{FastBuffer}=require("internal/buffer");class Serializer extends _Serializer{}class Deserializer extends _Deserializer{}const{cachedDataVersionTag,setFlagsFromString:_setFlagsFromString,heapStatisticsArrayBuffer,heapSpaceStatisticsArrayBuffer,updateHeapStatisticsArrayBuffer,updateHeapSpaceStatisticsArrayBuffer,kTotalHeapSizeIndex,kTotalHeapSizeExecutableIndex,kTotalPhysicalSizeIndex,kTotalAvailableSize,kUsedHeapSizeIndex,kHeapSizeLimitIndex,kDoesZapGarbageIndex,kMallocedMemoryIndex,kPeakMallocedMemoryIndex,kHeapSpaces,kHeapSpaceStatisticsPropertiesCount,kSpaceSizeIndex,kSpaceUsedSizeIndex,kSpaceAvailableSizeIndex,kPhysicalSpaceSizeIndex}=process.binding("v8"),kNumberOfHeapSpaces=kHeapSpaces.length,heapStatisticsBuffer=new Float64Array(heapStatisticsArrayBuffer),heapSpaceStatisticsBuffer=new Float64Array(heapSpaceStatisticsArrayBuffer);function setFlagsFromString(e){if("string"!=typeof e)throw new ERR_INVALID_ARG_TYPE("flags","string",e);_setFlagsFromString(e)}function getHeapStatistics(){const e=heapStatisticsBuffer;return updateHeapStatisticsArrayBuffer(),{total_heap_size:e[kTotalHeapSizeIndex],total_heap_size_executable:e[kTotalHeapSizeExecutableIndex],total_physical_size:e[kTotalPhysicalSizeIndex],total_available_size:e[kTotalAvailableSize],used_heap_size:e[kUsedHeapSizeIndex],heap_size_limit:e[kHeapSizeLimitIndex],malloced_memory:e[kMallocedMemoryIndex],peak_malloced_memory:e[kPeakMallocedMemoryIndex],does_zap_garbage:e[kDoesZapGarbageIndex]}}function getHeapSpaceStatistics(){const e=new Array(kNumberOfHeapSpaces),a=heapSpaceStatisticsBuffer;updateHeapSpaceStatisticsArrayBuffer();for(var r=0;r<kNumberOfHeapSpaces;r++){const t=r*kHeapSpaceStatisticsPropertiesCount;e[r]={space_name:kHeapSpaces[r],space_size:a[t+kSpaceSizeIndex],space_used_size:a[t+kSpaceUsedSizeIndex],space_available_size:a[t+kSpaceAvailableSizeIndex],physical_space_size:a[t+kPhysicalSpaceSizeIndex]}}return e}Serializer.prototype._getDataCloneError=Error,Deserializer.prototype.readRawBytes=function(e){const a=this._readRawBytes(e);return new FastBuffer(this.buffer.buffer,this.buffer.byteOffset+a,e)};const arrayBufferViewTypes=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,DataView],arrayBufferViewTypeToIndex=new Map;{const e=new ArrayBuffer;for(const[a,r]of arrayBufferViewTypes.entries()){const t=objectToString(new r(e));arrayBufferViewTypeToIndex.set(t,a)}}const bufferConstructorIndex=arrayBufferViewTypes.push(FastBuffer)-1;class DefaultSerializer extends Serializer{constructor(){super(),this._setTreatArrayBufferViewsAsHostObjects(!0)}_writeHostObject(e){let a=0;if(e.constructor===Buffer)a=bufferConstructorIndex;else{const r=objectToString(e);if(void 0===(a=arrayBufferViewTypeToIndex.get(r)))throw new this._getDataCloneError(`Unknown host object type: ${r}`)}this.writeUint32(a),this.writeUint32(e.byteLength),this.writeRawBytes(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}}class DefaultDeserializer extends Deserializer{constructor(e){super(e)}_readHostObject(){const e=this.readUint32(),a=arrayBufferViewTypes[e],r=this.readUint32(),t=this._readRawBytes(r),i=a.BYTES_PER_ELEMENT||1,s=this.buffer.byteOffset+t;if(s%i==0)return new a(this.buffer.buffer,s,r/i);{const e=Buffer.allocUnsafe(r);return copy(this.buffer,e,0,t,t+r),new a(e.buffer,e.byteOffset,r/i)}}}function serialize(e){const a=new DefaultSerializer;return a.writeHeader(),a.writeValue(e),a.releaseBuffer()}function deserialize(e){const a=new DefaultDeserializer(e);return a.readHeader(),a.readValue()}module.exports={cachedDataVersionTag,getHeapStatistics,getHeapSpaceStatistics,setFlagsFromString,Serializer,Deserializer,DefaultSerializer,DefaultDeserializer,deserialize,serialize};"use strict";const{ContextifyScript,makeContext,isContext:_isContext,compileFunction:_compileFunction}=process.binding("contextify"),{ERR_INVALID_ARG_TYPE,ERR_OUT_OF_RANGE}=require("internal/errors").codes,{isUint8Array}=require("internal/util/types"),{validateUint32}=require("internal/validators"),kParsingContext=Symbol("script parsing context"),ArrayForEach=Function.call.bind(Array.prototype.forEach),ArrayIsArray=Array.isArray;class Script extends ContextifyScript{constructor(t,e={}){if(t=`${t}`,"string"==typeof e&&(e={filename:e}),"object"!=typeof e||null===e)throw new ERR_INVALID_ARG_TYPE("options","Object",e);const{filename:n="evalmachine.<anonymous>",lineOffset:o=0,columnOffset:i=0,cachedData:r,produceCachedData:a=!1,[kParsingContext]:s}=e;if("string"!=typeof n)throw new ERR_INVALID_ARG_TYPE("options.filename","string",n);if(validateInteger(o,"options.lineOffset"),validateInteger(i,"options.columnOffset"),void 0!==r&&!isUint8Array(r))throw new ERR_INVALID_ARG_TYPE("options.cachedData",["Buffer","Uint8Array"],r);if("boolean"!=typeof a)throw new ERR_INVALID_ARG_TYPE("options.produceCachedData","boolean",a);try{super(t,n,o,i,r,a,s)}catch(t){throw t}}runInThisContext(t){const{breakOnSigint:e,args:n}=getRunInContextArgs(t);return e&&process.listenerCount("SIGINT")>0?sigintHandlersWrap(super.runInThisContext,this,n):super.runInThisContext(...n)}runInContext(t,e){validateContext(t);const{breakOnSigint:n,args:o}=getRunInContextArgs(e);return n&&process.listenerCount("SIGINT")>0?sigintHandlersWrap(super.runInContext,this,[t,...o]):super.runInContext(t,...o)}runInNewContext(t,e){const n=createContext(t,getContextOptions(e));return this.runInContext(n,e)}}function validateContext(t){if("object"!=typeof t||null===t)throw new ERR_INVALID_ARG_TYPE("contextifiedSandbox","Object",t);if(!_isContext(t))throw new ERR_INVALID_ARG_TYPE("contextifiedSandbox","vm.Context",t)}function validateInteger(t,e){if(!Number.isInteger(t))throw new ERR_INVALID_ARG_TYPE(e,"integer",t);if(t>>0!==t)throw new ERR_OUT_OF_RANGE(e,"32-bit integer",t)}function validateString(t,e){if(void 0!==t&&"string"!=typeof t)throw new ERR_INVALID_ARG_TYPE(e,"string",t)}function validateBool(t,e){if(void 0!==t&&"boolean"!=typeof t)throw new ERR_INVALID_ARG_TYPE(e,"boolean",t)}function validateObject(t,e){if(void 0!==t&&("object"!=typeof t||null===t))throw new ERR_INVALID_ARG_TYPE(e,"Object",t)}function getRunInContextArgs(t={}){if("object"!=typeof t||null===t)throw new ERR_INVALID_ARG_TYPE("options","Object",t);let e=t.timeout;if(void 0===e)e=-1;else if(!Number.isInteger(e)||e<=0)throw new ERR_INVALID_ARG_TYPE("options.timeout","a positive integer",e);const{displayErrors:n=!0,breakOnSigint:o=!1}=t;if("boolean"!=typeof n)throw new ERR_INVALID_ARG_TYPE("options.displayErrors","boolean",n);if("boolean"!=typeof o)throw new ERR_INVALID_ARG_TYPE("options.breakOnSigint","boolean",o);return{breakOnSigint:o,args:[e,n,o]}}function getContextOptions(t){if(t){validateObject(t.contextCodeGeneration,"options.contextCodeGeneration");const e={name:t.contextName,origin:t.contextOrigin,codeGeneration:"object"==typeof t.contextCodeGeneration?{strings:t.contextCodeGeneration.strings,wasm:t.contextCodeGeneration.wasm}:void 0};return validateString(e.name,"options.contextName"),validateString(e.origin,"options.contextOrigin"),e.codeGeneration&&(validateBool(e.codeGeneration.strings,"options.contextCodeGeneration.strings"),validateBool(e.codeGeneration.wasm,"options.contextCodeGeneration.wasm")),e}return{}}function isContext(t){if("object"!=typeof t||null===t)throw new ERR_INVALID_ARG_TYPE("sandbox","Object",t);return _isContext(t)}let defaultContextNameIndex=1;function createContext(t={},e={}){if(isContext(t))return t;if("object"!=typeof e||null===e)throw new ERR_INVALID_ARG_TYPE("options","Object",e);const{name:n=`VM Context ${defaultContextNameIndex++}`,origin:o,codeGeneration:i}=e;if("string"!=typeof n)throw new ERR_INVALID_ARG_TYPE("options.name","string",e.name);validateString(o,"options.origin"),validateObject(i,"options.codeGeneration");let r=!0,a=!0;return void 0!==i&&(({strings:r=!0,wasm:a=!0}=i),validateBool(r,"options.codeGeneration.strings"),validateBool(a,"options.codeGeneration.wasm")),makeContext(t,n,o,r,a),t}function createScript(t,e){return new Script(t,e)}function sigintHandlersWrap(t,e,n){const o=process.rawListeners("SIGINT");process.removeAllListeners("SIGINT");try{return t.apply(e,n)}finally{for(const t of o)process.addListener("SIGINT",t)}}function runInContext(t,e,n){return validateContext(e),createScript(t,n="string"==typeof n?{filename:n,[kParsingContext]:e}:Object.assign({},n,{[kParsingContext]:e})).runInContext(e,n)}function runInNewContext(t,e,n){return"string"==typeof n&&(n={filename:n}),e=createContext(e,getContextOptions(n)),createScript(t,n=Object.assign({},n,{[kParsingContext]:e})).runInNewContext(e,n)}function runInThisContext(t,e){return"string"==typeof e&&(e={filename:e}),createScript(t,e).runInThisContext(e)}function compileFunction(t,e,n={}){if("string"!=typeof t)throw new ERR_INVALID_ARG_TYPE("code","string",t);if(void 0!==e){if(!ArrayIsArray(e))throw new ERR_INVALID_ARG_TYPE("params","Array",e);ArrayForEach(e,(t,e)=>{if("string"!=typeof t)throw new ERR_INVALID_ARG_TYPE(`params[${e}]`,"string",t)})}const{filename:o="",columnOffset:i=0,lineOffset:r=0,cachedData:a,produceCachedData:s=!1,parsingContext:c,contextExtensions:p=[]}=n;if("string"!=typeof o)throw new ERR_INVALID_ARG_TYPE("options.filename","string",o);if(validateUint32(i,"options.columnOffset"),validateUint32(r,"options.lineOffset"),void 0!==a&&!isUint8Array(a))throw new ERR_INVALID_ARG_TYPE("options.cachedData","Uint8Array",a);if("boolean"!=typeof s)throw new ERR_INVALID_ARG_TYPE("options.produceCachedData","boolean",s);if(void 0!==c&&("object"!=typeof c||null===c||!isContext(c)))throw new ERR_INVALID_ARG_TYPE("options.parsingContext","Context",c);if(!ArrayIsArray(p))throw new ERR_INVALID_ARG_TYPE("options.contextExtensions","Array",p);return ArrayForEach(p,(t,e)=>{if("object"!=typeof t)throw new ERR_INVALID_ARG_TYPE(`options.contextExtensions[${e}]`,"object",t)}),_compileFunction(t,o,r,i,a,s,c,p,e)}if(module.exports={Script,createContext,createScript,runInContext,runInNewContext,runInThisContext,isContext,compileFunction},require("internal/options").getOptionValue("--experimental-vm-modules")){const{SourceTextModule:t}=require("internal/vm/source_text_module");module.exports.SourceTextModule=t}"use strict";const{isMainThread,MessagePort,MessageChannel,threadId,Worker}=require("internal/worker");module.exports={isMainThread,MessagePort,MessageChannel,threadId,Worker,parentPort:null};"use strict";const{ERR_BUFFER_TOO_LARGE,ERR_INVALID_ARG_TYPE,ERR_OUT_OF_RANGE,ERR_ZLIB_INITIALIZATION_FAILED}=require("internal/errors").codes,Transform=require("_stream_transform"),{_extend,inherits,types:{isAnyArrayBuffer,isArrayBufferView}}=require("util"),binding=process.binding("zlib"),assert=require("assert").ok,{Buffer,kMaxLength}=require("buffer"),{owner_symbol}=require("internal/async_hooks").symbols,constants=process.binding("constants").zlib,{Z_NO_FLUSH,Z_BLOCK,Z_PARTIAL_FLUSH,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH,Z_MIN_CHUNK,Z_MIN_WINDOWBITS,Z_MAX_WINDOWBITS,Z_MIN_LEVEL,Z_MAX_LEVEL,Z_MIN_MEMLEVEL,Z_MAX_MEMLEVEL,Z_DEFAULT_CHUNK,Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY,Z_DEFAULT_WINDOWBITS,Z_DEFAULT_MEMLEVEL,Z_FIXED,DEFLATE,DEFLATERAW,INFLATE,INFLATERAW,GZIP,GUNZIP,UNZIP}=constants,codes={Z_OK:constants.Z_OK,Z_STREAM_END:constants.Z_STREAM_END,Z_NEED_DICT:constants.Z_NEED_DICT,Z_ERRNO:constants.Z_ERRNO,Z_STREAM_ERROR:constants.Z_STREAM_ERROR,Z_DATA_ERROR:constants.Z_DATA_ERROR,Z_MEM_ERROR:constants.Z_MEM_ERROR,Z_BUF_ERROR:constants.Z_BUF_ERROR,Z_VERSION_ERROR:constants.Z_VERSION_ERROR},ckeys=Object.keys(codes);for(var ck=0;ck<ckeys.length;ck++){var ckey=ckeys[ck];codes[codes[ckey]]=ckey}function zlibBuffer(e,t,n){isArrayBufferView(t)&&Object.getPrototypeOf(t)!==Buffer.prototype?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):isAnyArrayBuffer(t)&&(t=Buffer.from(t)),e.buffers=null,e.nread=0,e.cb=n,e.on("data",zlibBufferOnData),e.on("error",zlibBufferOnError),e.on("end",zlibBufferOnEnd),e.end(t)}function zlibBufferOnData(e){this.buffers?this.buffers.push(e):this.buffers=[e],this.nread+=e.length}function zlibBufferOnError(e){this.removeAllListeners("end"),this.cb(e)}function zlibBufferOnEnd(){var e,t;if(this.nread>=kMaxLength)t=new ERR_BUFFER_TOO_LARGE;else if(0===this.nread)e=Buffer.alloc(0);else{var n=this.buffers;e=1===n.length?n[0]:Buffer.concat(n,this.nread)}this.close(),t?this.cb(t):this._info?this.cb(null,{buffer:e,engine:this}):this.cb(null,e)}function zlibBufferSync(e,t){if("string"==typeof t)t=Buffer.from(t);else if(!isArrayBufferView(t)){if(!isAnyArrayBuffer(t))throw new ERR_INVALID_ARG_TYPE("buffer",["string","Buffer","TypedArray","DataView","ArrayBuffer"],t);t=Buffer.from(t)}return t=processChunkSync(e,t,e._finishFlushFlag),e._info?{buffer:t,engine:e}:t}function zlibOnError(e,t,n){var i=this[owner_symbol];_close(i),i._hadError=!0;const r=new Error(e);r.errno=t,r.code=n,i.emit("error",r)}function checkFiniteNumber(e,t){if(void 0===e)return!1;if(Number.isFinite(e))return!0;if(Number.isNaN(e))return!1;if("number"!=typeof e){const n=new ERR_INVALID_ARG_TYPE(t,"number",e);throw Error.captureStackTrace(n,checkFiniteNumber),n}const n=new ERR_OUT_OF_RANGE(t,"a finite number",e);throw Error.captureStackTrace(n,checkFiniteNumber),n}function checkRangesOrGetDefault(e,t,n,i,r){if(!checkFiniteNumber(e,t))return r;if(e<n||e>i){const r=new ERR_OUT_OF_RANGE(t,`>= ${n} and <= ${i}`,e);throw Error.captureStackTrace(r,checkRangesOrGetDefault),r}return e}function Zlib(e,t){var n,i=Z_DEFAULT_CHUNK,r=Z_NO_FLUSH,s=Z_FINISH,f=Z_DEFAULT_WINDOWBITS,a=Z_DEFAULT_COMPRESSION,o=Z_DEFAULT_MEMLEVEL,_=Z_DEFAULT_STRATEGY;if(assert("number"==typeof t),assert(t>=DEFLATE&&t<=UNZIP),e){if(checkFiniteNumber(i=e.chunkSize,"options.chunkSize")){if(i<Z_MIN_CHUNK)throw new ERR_OUT_OF_RANGE("options.chunkSize",`>= ${Z_MIN_CHUNK}`,i)}else i=Z_DEFAULT_CHUNK;if(r=checkRangesOrGetDefault(e.flush,"options.flush",Z_NO_FLUSH,Z_BLOCK,Z_NO_FLUSH),s=checkRangesOrGetDefault(e.finishFlush,"options.finishFlush",Z_NO_FLUSH,Z_BLOCK,Z_FINISH),f=null!=e.windowBits&&0!==e.windowBits||t!==INFLATE&&t!==GUNZIP&&t!==UNZIP?checkRangesOrGetDefault(e.windowBits,"options.windowBits",Z_MIN_WINDOWBITS,Z_MAX_WINDOWBITS,Z_DEFAULT_WINDOWBITS):0,a=checkRangesOrGetDefault(e.level,"options.level",Z_MIN_LEVEL,Z_MAX_LEVEL,Z_DEFAULT_COMPRESSION),o=checkRangesOrGetDefault(e.memLevel,"options.memLevel",Z_MIN_MEMLEVEL,Z_MAX_MEMLEVEL,Z_DEFAULT_MEMLEVEL),_=checkRangesOrGetDefault(e.strategy,"options.strategy",Z_DEFAULT_STRATEGY,Z_FIXED,Z_DEFAULT_STRATEGY),void 0!==(n=e.dictionary)&&!isArrayBufferView(n)){if(!isAnyArrayBuffer(n))throw new ERR_INVALID_ARG_TYPE("options.dictionary",["Buffer","TypedArray","DataView","ArrayBuffer"],n);n=Buffer.from(n)}(e.encoding||e.objectMode||e.writableObjectMode)&&((e=_extend({},e)).encoding=null,e.objectMode=!1,e.writableObjectMode=!1)}if(Transform.call(this,e),this.bytesWritten=0,this._handle=new binding.Zlib(t),this._handle[owner_symbol]=this,this._handle.onerror=zlibOnError,this._hadError=!1,this._writeState=new Uint32Array(2),!this._handle.init(f,a,o,_,this._writeState,processCallback,n))throw new ERR_ZLIB_INITIALIZATION_FAILED;this._outBuffer=Buffer.allocUnsafe(i),this._outOffset=0,this._level=a,this._strategy=_,this._chunkSize=i,this._defaultFlushFlag=r,this._finishFlushFlag=s,this._nextFlush=-1,this._info=e&&e.info,this.once("end",this.close)}function paramsAfterFlushCallback(e,t,n){this._handle||assert(!1,"zlib binding closed"),this._handle.params(e,t),this._hadError||(this._level=e,this._strategy=t,n&&n())}inherits(Zlib,Transform),Object.defineProperty(Zlib.prototype,"_closed",{configurable:!0,enumerable:!0,get(){return!this._handle}}),Object.defineProperty(Zlib.prototype,"bytesRead",{configurable:!0,enumerable:!0,get(){return this.bytesWritten},set(e){this.bytesWritten=e}}),Zlib.prototype.params=function(e,t,n){checkRangesOrGetDefault(e,"level",Z_MIN_LEVEL,Z_MAX_LEVEL),checkRangesOrGetDefault(t,"strategy",Z_DEFAULT_STRATEGY,Z_FIXED),this._level!==e||this._strategy!==t?this.flush(Z_SYNC_FLUSH,paramsAfterFlushCallback.bind(this,e,t,n)):process.nextTick(n)},Zlib.prototype.reset=function(){return this._handle||assert(!1,"zlib binding closed"),this._handle.reset()},Zlib.prototype._flush=function(e){this._transform(Buffer.alloc(0),"",e)};const flushiness=[];let i=0;for(const e of[Z_NO_FLUSH,Z_BLOCK,Z_PARTIAL_FLUSH,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH])flushiness[e]=i++;function maxFlush(e,t){return flushiness[e]>flushiness[t]?e:t}const flushBuffer=Buffer.alloc(0);function processChunkSync(e,t,n){var i,r,s,f=t.byteLength,a=e._chunkSize-e._outOffset,o=0,_=null,l=0,u=0,c=e._writeState,h=e._handle,E=e._outBuffer,b=e._outOffset,R=e._chunkSize;for(e.on("error",function(e){s=e});;){if(h.writeSync(n,t,o,f,E,b,a),s)throw s;i=c[0];var Z=f-(r=c[1]);u+=Z;var L=a-i;if(L>0){var I=E.slice(b,b+L);b+=L,_?_.push(I):_=[I],l+=I.byteLength}else L<0&&assert(!1,"have should not go down");if((0===i||b>=R)&&(a=R,b=0,E=Buffer.allocUnsafe(R)),0!==i)break;o+=Z,f=r}if(e.bytesWritten=u,_close(e),l>=kMaxLength)throw new ERR_BUFFER_TOO_LARGE;return 0===l?Buffer.alloc(0):1===_.length?_[0]:Buffer.concat(_,l)}function processChunk(e,t,n,i){var r=e._handle;r||assert(!1,"zlib binding closed"),r.buffer=t,r.cb=i,r.availOutBefore=e._chunkSize-e._outOffset,r.availInBefore=t.byteLength,r.inOff=0,r.flushFlag=n,r.write(n,t,0,r.availInBefore,e._outBuffer,e._outOffset,r.availOutBefore)}function processCallback(){var e=this.jsref,t=e._writeState;if(e._hadError)return void(this.buffer=null);if(e.destroyed)return void(this.buffer=null);var n=t[0],i=t[1];const r=this.availInBefore-i;e.bytesWritten+=r;var s=this.availOutBefore-n;if(s>0){var f=e._outBuffer.slice(e._outOffset,e._outOffset+s);e._outOffset+=s,e.push(f)}else s<0&&assert(!1,"have should not go down");if((0===n||e._outOffset>=e._chunkSize)&&(this.availOutBefore=e._chunkSize,e._outOffset=0,e._outBuffer=Buffer.allocUnsafe(e._chunkSize)),0===n)return this.inOff+=r,this.availInBefore=i,void this.write(this.flushFlag,this.buffer,this.inOff,this.availInBefore,e._outBuffer,e._outOffset,e._chunkSize);this.buffer=null,this.cb()}function _close(e,t){t&&process.nextTick(t),e._handle&&(e._handle.close(),e._handle=null)}function Deflate(e){if(!(this instanceof Deflate))return new Deflate(e);Zlib.call(this,e,DEFLATE)}function Inflate(e){if(!(this instanceof Inflate))return new Inflate(e);Zlib.call(this,e,INFLATE)}function Gzip(e){if(!(this instanceof Gzip))return new Gzip(e);Zlib.call(this,e,GZIP)}function Gunzip(e){if(!(this instanceof Gunzip))return new Gunzip(e);Zlib.call(this,e,GUNZIP)}function DeflateRaw(e){if(e&&8===e.windowBits&&(e.windowBits=9),!(this instanceof DeflateRaw))return new DeflateRaw(e);Zlib.call(this,e,DEFLATERAW)}function InflateRaw(e){if(!(this instanceof InflateRaw))return new InflateRaw(e);Zlib.call(this,e,INFLATERAW)}function Unzip(e){if(!(this instanceof Unzip))return new Unzip(e);Zlib.call(this,e,UNZIP)}function createConvenienceMethod(e,t){return t?function(t,n){return zlibBufferSync(new e(n),t)}:function(t,n,i){return"function"==typeof n&&(i=n,n={}),zlibBuffer(new e(n),t,i)}}function createProperty(e){return{configurable:!0,enumerable:!0,value:function(t){return new e(t)}}}Zlib.prototype.flush=function(e,t){var n=this._writableState;("function"==typeof e||void 0===e&&!t)&&(t=e,e=Z_FULL_FLUSH),n.ended?t&&process.nextTick(t):n.ending?t&&this.once("end",t):-1!==this._nextFlush?this._nextFlush=maxFlush(this._nextFlush,e):(this._nextFlush=e,this.write(flushBuffer,"",t))},Zlib.prototype.close=function(e){_close(this,e),this.destroy()},Zlib.prototype._transform=function(e,t,n){var i=this._defaultFlushFlag;e===flushBuffer&&(i=this._nextFlush,this._nextFlush=-1);var r=this._writableState;(r.ending||r.ended)&&r.length===e.byteLength&&(i=maxFlush(i,this._finishFlushFlag)),processChunk(this,e,i,n)},Zlib.prototype._processChunk=function(e,t,n){if("function"!=typeof n)return processChunkSync(this,e,t);processChunk(this,e,t,n)},inherits(Deflate,Zlib),inherits(Inflate,Zlib),inherits(Gzip,Zlib),inherits(Gunzip,Zlib),inherits(DeflateRaw,Zlib),inherits(InflateRaw,Zlib),inherits(Unzip,Zlib),Object.defineProperty(binding.Zlib.prototype,"jsref",{get(){return this[owner_symbol]},set(e){return this[owner_symbol]=e}}),module.exports={Deflate,Inflate,Gzip,Gunzip,DeflateRaw,InflateRaw,Unzip,deflate:createConvenienceMethod(Deflate,!1),deflateSync:createConvenienceMethod(Deflate,!0),gzip:createConvenienceMethod(Gzip,!1),gzipSync:createConvenienceMethod(Gzip,!0),deflateRaw:createConvenienceMethod(DeflateRaw,!1),deflateRawSync:createConvenienceMethod(DeflateRaw,!0),unzip:createConvenienceMethod(Unzip,!1),unzipSync:createConvenienceMethod(Unzip,!0),inflate:createConvenienceMethod(Inflate,!1),inflateSync:createConvenienceMethod(Inflate,!0),gunzip:createConvenienceMethod(Gunzip,!1),gunzipSync:createConvenienceMethod(Gunzip,!0),inflateRaw:createConvenienceMethod(InflateRaw,!1),inflateRawSync:createConvenienceMethod(InflateRaw,!0)},Object.defineProperties(module.exports,{createDeflate:createProperty(Deflate),createInflate:createProperty(Inflate),createDeflateRaw:createProperty(DeflateRaw),createInflateRaw:createProperty(InflateRaw),createGzip:createProperty(Gzip),createGunzip:createProperty(Gunzip),createUnzip:createProperty(Unzip),constants:{configurable:!1,enumerable:!0,value:constants},codes:{enumerable:!0,writable:!1,value:Object.freeze(codes)}});const bkeys=Object.keys(constants);for(var bk=0;bk<bkeys.length;bk++){var bkey=bkeys[bk];Object.defineProperty(module.exports,bkey,{enumerable:!0,value:constants[bkey],writable:!1})}